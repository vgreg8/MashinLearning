<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Временные ряды | Вводный курс</title>
	<meta name="description" content="Изучение временных рядов позволяет проанализировать цену акций, объемы продаж или изменение температуры и сделать прогноз на будущее" />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Временные ряды | Вводный курс" />
	<meta property="og:description" content="Изучение временных рядов позволяет проанализировать цену акций, объемы продаж или изменение температуры и сделать прогноз на будущее" />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/intro/time-series/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2025-01-01T06:05:00+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/09/time-series-diff-scaled.jpg" />
	<meta property="og:image:width" content="2560" />
	<meta property="og:image:height" content="1313" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="26 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/intro/time-series/","url":"https://www.dmitrymakarov.ru/intro/time-series/","name":"Временные ряды | Вводный курс","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/intro/time-series/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/intro/time-series/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2021/09/time-series-diff-1024x525.jpg","datePublished":"2021-09-03T03:51:03+00:00","dateModified":"2025-01-01T06:05:00+00:00","description":"Изучение временных рядов позволяет проанализировать цену акций, объемы продаж или изменение температуры и сделать прогноз на будущее","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/intro/time-series/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/intro/time-series/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/intro/time-series/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2021/09/time-series-diff-scaled.jpg","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2021/09/time-series-diff-scaled.jpg","width":2560,"height":1313},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/intro/time-series/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Вводный курс","item":"https://www.dmitrymakarov.ru/intro/"},{"@type":"ListItem","position":3,"name":"Временные ряды"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-4472 page-child parent-pageid-202 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa62413e9aa">Поиск:</label>
	<input type="search" id="search-form-67aa62413e9aa" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa62413ea60">Поиск:</label>
	<input type="search" id="search-form-67aa62413ea60" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-4472 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Временные ряды</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Вводный курс</a></p>



<h3 class="wp-block-heading" id="0-ponyatie-vremennogo-ryada">Понятие временного ряда</h3>



<p><strong>Временной ряд</strong> (time series) &#8212; это данные, последовательно собранные в регулярные промежутки времени.</p>



<p>К таким данным относятся, например, цены на акции, объемы продаж чего-либо, изменения температуры с течением времени и т.д. Посмотрим на <strong>изменение обычных данных и временных рядов</strong>.</p>



<figure class="wp-block-image size-large"><img fetchpriority="high" decoding="async" width="1024" height="525" src="../../wp-content/uploads/2021/09/time-series-diff-1024x525.jpg" alt="отличие структурных/перекрестных данных от временного ряда" class="wp-image-4919" srcset="../../wp-content/uploads/2021/09/time-series-diff-1024x525.jpg 1024w, ../../wp-content/uploads/2021/09/time-series-diff-300x154.jpg 300w, ../../wp-content/uploads/2021/09/time-series-diff-768x394.jpg 768w, ../../wp-content/uploads/2021/09/time-series-diff-1536x788.jpg 1536w, ../../wp-content/uploads/2021/09/time-series-diff-2048x1050.jpg 2048w, ../../wp-content/uploads/2021/09/time-series-diff-1200x615.jpg 1200w, ../../wp-content/uploads/2021/09/time-series-diff-600x308.jpg 600w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p class="has-background" style="background-color:#ffe8c4">Основное отличие: перекрестные данные предполагают независимость наблюдений, во временных рядах будущее зависит от прошлого.</p>



<p>Работа с временными рядами предполагает два аспекта:</p>



<ol class="wp-block-list">
<li><strong>анализ временного ряда</strong> (time series analysis), т.е. понимание его структуры и закономерностей; и</li>



<li>моделирование и <strong>построение прогноза</strong> на будущее (time series forecasting).</li>
</ol>



<p>Договоримся о терминах:</p>



<ul class="wp-block-list">
<li>во-первых, определим нотацию периодов. Временем t обозначим настоящее, $t-1, t-2, \ldots$ прошлое, $t+1, t+2, \ldots$ будущее;</li>



<li>во-вторых, введем важное понятие временного лага (lag), т.е. запаздывания по сравнению с заданным периодом.</li>
</ul>



<figure class="wp-block-image size-large"><img decoding="async" width="1024" height="672" src="../../wp-content/uploads/2021/10/time_series_gen-1024x672.jpg" alt="терминология временных рядов" class="wp-image-5113" srcset="../../wp-content/uploads/2021/10/time_series_gen-1024x672.jpg 1024w, ../../wp-content/uploads/2021/10/time_series_gen-300x197.jpg 300w, ../../wp-content/uploads/2021/10/time_series_gen-768x504.jpg 768w, ../../wp-content/uploads/2021/10/time_series_gen-1536x1008.jpg 1536w, ../../wp-content/uploads/2021/10/time_series_gen-2048x1344.jpg 2048w, ../../wp-content/uploads/2021/10/time_series_gen-1200x787.jpg 1200w, ../../wp-content/uploads/2021/10/time_series_gen-600x394.jpg 600w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<h3 class="wp-block-heading" id="1-datasety">Датасеты</h3>



<p>Мы будем использовать два популярных набора данных, а именно (1) ежемесячные данные о количестве пассажиров, перевезенных одной американской авиакомпанией с 1949 по 1960 годы и (2) ежедневные данные о родившихся в Калифорнии в 1959 году девочках.</p>



<div class="wp-block-file"><a id="wp-block-file--media-303787a5-16bc-492d-9959-f82779439601" href="../../wp-content/uploads/2021/09/passengers.csv">passengers.csv</a><a href="../../wp-content/uploads/2021/09/passengers.csv" class="wp-block-file__button wp-element-button" download aria-describedby="wp-block-file--media-303787a5-16bc-492d-9959-f82779439601">Скачать</a></div>



<div class="wp-block-file"><a id="wp-block-file--media-79cd166a-1a1d-4e9c-bf6f-857a773b631b" href="../../wp-content/uploads/2021/09/births.csv">births.csv</a><a href="../../wp-content/uploads/2021/09/births.csv" class="wp-block-file__button wp-element-button" download aria-describedby="wp-block-file--media-79cd166a-1a1d-4e9c-bf6f-857a773b631b">Скачать</a></div>



<p><a href="../recommender/index.html">Подгрузим данные</a> в блокнот Google Colab.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/17JQsqabF63Y4KM71MjRy4gqbBr8uPDHg?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<h3 class="wp-block-heading" id="2-analiz-vremennykh-ryadov">Анализ временных рядов</h3>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c4c957308984" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c4c957308984-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c4c957308984-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c4c957308984-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c4c957308984-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c4c957308984-1"><span class="crayon-c"># импортируем необходимые библиотеки</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c4c957308984-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">pd</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c4c957308984-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c4c957308984-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">matplotlib</span><span class="crayon-sy">.</span><span class="crayon-e">pyplot </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">plt</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<h4 class="wp-block-heading" id="3-import-dannykh-i-rabota-v-biblioteke-pandas">Импорт данных и работа в библиотеке Pandas</h4>



<p>Для начала давайте <strong>импортируем данные</strong>. Пока что мы будем использовать только первый набор данных с информацией об авиаперевозках.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c58268585965" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c58268585965-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c58268585965-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c58268585965-1"><span class="crayon-v">passengers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">"/content/passengers.csv"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c58268585965-2"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img decoding="async" width="316" height="308" src="../../wp-content/uploads/2021/09/df1.jpg" alt="временной ряд: данные о пассажирах авиакомпании" class="wp-image-4954" style="width:205px;height:200px" srcset="../../wp-content/uploads/2021/09/df1.jpg 316w, ../../wp-content/uploads/2021/09/df1-300x292.jpg 300w" sizes="(max-width: 316px) 100vw, 316px" /></figure>



<p>Сделаем дату индексом.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c5b599730583" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5b599730583-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c5b599730583-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5b599730583-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5b599730583-1"><span class="crayon-c"># превратим дату в индекс и сделаем изменение постоянным</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c5b599730583-2"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">set_index</span><span class="crayon-sy">(</span><span class="crayon-s">'Month'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5b599730583-3"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="284" height="357" src="../../wp-content/uploads/2021/09/df2.jpg" alt="данные о пассажирах: дата стала индексом" class="wp-image-4955" style="width:207px;height:260px" srcset="../../wp-content/uploads/2021/09/df2.jpg 284w, ../../wp-content/uploads/2021/09/df2-239x300.jpg 239w" sizes="auto, (max-width: 284px) 100vw, 284px" /></figure>



<p>Питон воспринимает дату как число. Это не очень удобно, если мы хотим делать срезы и в целом изменять данные во времени. Дату можно преобразовать в специальный <a href="../../python/datetime/index.html">объект datetime</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c5d479738335" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5d479738335-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c5d479738335-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5d479738335-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c5d479738335-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5d479738335-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5d479738335-1"><span class="crayon-c"># превратим дату (индекс) в объект datetime</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c5d479738335-2"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">to_datetime</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5d479738335-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c5d479738335-4"><span class="crayon-c"># посмотрим на первые пять дат и на тип данных</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5d479738335-5"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c5f978778907" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5f978778907-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c5f978778907-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c5f978778907-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5f978778907-1">DatetimeIndex(['1949-01-01', '1949-02-01', '1949-03-01', '1949-04-01',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c5f978778907-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; '1949-05-01'],</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c5f978778907-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dtype='datetime64[ns]', name='Month', freq=None)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Все эти операции также можно проделать в одну строчку.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c61033099928" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c61033099928-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c61033099928-1"><span class="crayon-v">passengers</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/passengers.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Month'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Теперь мы можем <strong>делать срезы</strong> за определенный период, например, с августа 1949 по март 1950 года.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c63281335790" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c63281335790-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c63281335790-1"><span class="crayon-v">passengers</span><span class="crayon-sy">[</span><span class="crayon-s">'1949-08'</span><span class="crayon-o">:</span><span class="crayon-s">'1950-03'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="355" height="589" src="../../wp-content/uploads/2024/02/image-22.png" alt="срез временного ряда" class="wp-image-25413" style="width:216px;height:auto" srcset="../../wp-content/uploads/2024/02/image-22.png 355w, ../../wp-content/uploads/2024/02/image-22-181x300.png 181w" sizes="auto, (max-width: 355px) 100vw, 355px" /></figure>



<p>Обратите внимание, что в отличие от других перечней в Питоне (например, списков), во временном ряде мы получаем данные и по начальной, и по конечной дате среза (в частности, март 1950 года вошел в интервал).</p>



<h4 class="wp-block-heading" id="4-izmenenie-shaga-vremennogo-ryada-sdvig-i-skolzyashchee-srednee">Изменение шага временного ряда, сдвиг и скользящее среднее</h4>



<p>Отдельно хотелось бы поговорить про возможность обобщения и изменения данных. Помимо прочего, мы можем <strong>изменить шаг</strong> (resample) временного ряда, и посмотреть средние показатели перевозок, например, за год.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c65752697368" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c65752697368-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c65752697368-1"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">resample</span><span class="crayon-sy">(</span><span class="crayon-v">rule</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'YS'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="345" height="365" src="../../wp-content/uploads/2021/09/resample-df.jpg" alt="изменение шага временного ряда (resample)" class="wp-image-4969" style="width:239px;height:253px" srcset="../../wp-content/uploads/2021/09/resample-df.jpg 345w, ../../wp-content/uploads/2021/09/resample-df-284x300.jpg 284w" sizes="auto, (max-width: 345px) 100vw, 345px" /></figure>



<p>Кроме того, мы можем <strong>сдвинуть</strong> (shift) данные на $n$ периодов вперед или назад.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c67586865724" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c67586865724-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c67586865724-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c67586865724-1"><span class="crayon-c"># произведем сдвиг на два периода (в данном случае месяца) вперед</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c67586865724-2"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="248" height="280" src="../../wp-content/uploads/2021/09/shift.png" alt="сдвиг временного ряда (shift)" class="wp-image-5067"/></figure>



<p>Что логично, после сдвига первые два значения определяются как пропущенные (NaN или Not a number).</p>



<p>Мы также можем рассчитать <strong>скользящее среднее</strong> (moving average, rolling average) за $n$ предыдущих периодов. Вначале посмотрим, что это такое.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="449" src="../../wp-content/uploads/2021/09/3ma-1024x449.jpg" alt="пример трехдневного скользящего среднего (moving average)" class="wp-image-4912" style="width:653px;height:286px" srcset="../../wp-content/uploads/2021/09/3ma-1024x449.jpg 1024w, ../../wp-content/uploads/2021/09/3ma-300x131.jpg 300w, ../../wp-content/uploads/2021/09/3ma-768x336.jpg 768w, ../../wp-content/uploads/2021/09/3ma-1536x673.jpg 1536w, ../../wp-content/uploads/2021/09/3ma-1200x526.jpg 1200w, ../../wp-content/uploads/2021/09/3ma-600x263.jpg 600w, ../../wp-content/uploads/2021/09/3ma.jpg 1947w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Теперь давайте рассчитаем его для наших данных. Период, за который рассчитывается скользящее среднее, также называется <em>окном</em> (window).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c69189093362" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c69189093362-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c69189093362-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c69189093362-1"><span class="crayon-c"># рассчитаем скользящее среднее для трех месяцев</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c69189093362-2"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">rolling</span><span class="crayon-sy">(</span><span class="crayon-v">window</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="249" height="280" src="../../wp-content/uploads/2021/09/ma-example.png" alt="скользящее среднее в библиотеке pandas" class="wp-image-5068"/></figure>



<p>Опять же, так как в данном случае мы использовали три месяца для расчета скользящего среднего, этот показатель недоступен для первых двух значений. В целом, скользящее среднее сглаживает временные показатели (мы это увидим на графике в следующем разделе).</p>



<h4 class="wp-block-heading" id="5-postroenie-grafikov">Построение графиков</h4>



<p>Для того чтобы построить график временного ряда мы можем воспользоваться инструментами, которые уже содержатся в библиотеке Pandas. Например, простым <strong>методом .plot()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c6c192498534" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6c192498534-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6c192498534-1"><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="375" height="262" src="../../wp-content/uploads/2021/09/basic-plot.png" alt="график временного ряда в библиотеке pandas" class="wp-image-5072" srcset="../../wp-content/uploads/2021/09/basic-plot.png 375w, ../../wp-content/uploads/2021/09/basic-plot-300x210.png 300w" sizes="auto, (max-width: 375px) 100vw, 375px" /></figure>



<p>График можно усложнить.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c6d388545201" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6d388545201-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6d388545201-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6d388545201-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6d388545201-1"><span class="crayon-c"># изменим размер графика, уберем легенду и добавим подписи</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6d388545201-2"><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">legend</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6d388545201-3"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-k ">set</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Перевозки пассажиров с 1949 по 1960 год'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Месяцы'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylabel</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Количество пассажиров'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="723" height="387" src="../../wp-content/uploads/2021/09/detailed-plot.png" alt="усложненный график временного ряда в библиотеке pandas" class="wp-image-5073" srcset="../../wp-content/uploads/2021/09/detailed-plot.png 723w, ../../wp-content/uploads/2021/09/detailed-plot-300x161.png 300w, ../../wp-content/uploads/2021/09/detailed-plot-600x321.png 600w" sizes="auto, (max-width: 723px) 100vw, 723px" /></figure>



<p>Визуализацию можно также построить с помощью библиотеки Matplotlib. Давайте выведем на одном графике перевозки пассажиров и скользящее среднее.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c6f253109053" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c6f253109053-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-1"><span class="crayon-c"># зададим размер графика</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-4"><span class="crayon-c"># поочередно зададим кривые (перевозки и скользящее среднее) с подписями и цветом</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Перевозки пассажиров по месяцам'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'steelblue'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">.</span><span class="crayon-e">rolling</span><span class="crayon-sy">(</span><span class="crayon-v">window</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Скользящее среднее за 12 месяцев'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'orange'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-8"><span class="crayon-c"># добавим легенду, ее положение на графике и размер шрифта</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'upper left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-11"><span class="crayon-c"># добавим подписи к осям и заголовки</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-12"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Месяцы'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-13"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Количество пассажиров'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-14"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Перевозки пассажиров с 1949 по 1960 год'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-16"><span class="crayon-c"># выведем обе кривые на одном графике</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c6f253109053-17"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="895" height="502" src="../../wp-content/uploads/2021/09/plt-plot.png" alt="перевозки пассажиров по месяцам и скользящее среднее за 12 месяцев" class="wp-image-5074" srcset="../../wp-content/uploads/2021/09/plt-plot.png 895w, ../../wp-content/uploads/2021/09/plt-plot-300x168.png 300w, ../../wp-content/uploads/2021/09/plt-plot-768x431.png 768w, ../../wp-content/uploads/2021/09/plt-plot-600x337.png 600w" sizes="auto, (max-width: 895px) 100vw, 895px" /></figure>



<p>Как вы видите, скользящее среднее сильно сглаживает показатели. Также обратите внимание, что так как в данном случае мы взяли окно равное двенадцати месяцам, то первое значение скользящего среднего мы получили только за декабрь 1949 года (самое начало желтой кривой на графике).</p>



<p class="has-background" style="background-color:#ffe8c4">В целом не стоит недооценивать важность визуальной оценки ряда на графике. Многие особенности можно выявить именно так.</p>



<h4 class="wp-block-heading" id="6-razlozhenie-vremennogo-ryada-na-komponenty">Разложение временного ряда на компоненты</h4>



<p>Выявление компонентов временного ряда (time series decomposition) предполагает его разложение на тренд, сезонность и случайные колебания. Дадим несколько неформальных определений:</p>



<ul class="wp-block-list">
<li><strong>тренд</strong> &#8212; долгосрочное изменение уровня ряда;</li>



<li><strong>сезонность</strong> предполагает циклические изменения уровня ряда с постоянным периодом;</li>



<li><strong>случайные колебания</strong> &#8212; непрогнозируемое случайное изменение ряда.</li>
</ul>



<p>В Питоне в модуле statsmodels есть <strong>функция seasonal_decompose()</strong>. Воспользуемся ей для визуализации компонентов ряда.</p>



<p>Перед этим импортируем второй датасет для последующего сравнения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c72739975368" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c72739975368-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c72739975368-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c72739975368-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c72739975368-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c72739975368-1"><span class="crayon-c"># для наглядности импортируем второй датасет</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c72739975368-2"><span class="crayon-c"># сразу превратим дату в индекс и преобразуем ее в объект datetime</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c72739975368-3"><span class="crayon-v">births</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/births.csv'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index_col</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Date'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parse_dates</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c72739975368-4"><span class="crayon-v">births</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="283" height="297" src="../../wp-content/uploads/2024/02/image-24.png" alt="временной ряд: рождаемость в 1959 году" class="wp-image-25415" style="width:192px;height:auto"/></figure>



<p>Теперь давайте разложим временной ряд по авиаперевозкам на компоненты.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c74185416634" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c74185416634-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-1"><span class="crayon-c"># импортируем функцию seasonal_decompose из statsmodels </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">seasonal </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">seasonal</span><span class="crayon-sy">_</span>decompose</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-4"><span class="crayon-c"># задаем размер графика</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">pylab </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">rcParams</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-6"><span class="crayon-v">rcParams</span><span class="crayon-sy">[</span><span class="crayon-s">'figure.figsize'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-8"><span class="crayon-c"># применяем функцию к данным о перевозках</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-9"><span class="crayon-v">decompose</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">seasonal_decompose</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-10"><span class="crayon-v">decompose</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c74185416634-12"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="837" src="../../wp-content/uploads/2024/02/passengers_decompose-1024x837.png" alt="разложение временного ряда по авиаперевозкам на компоненты" class="wp-image-25419" srcset="../../wp-content/uploads/2024/02/passengers_decompose-1024x837.png 1024w, ../../wp-content/uploads/2024/02/passengers_decompose-300x245.png 300w, ../../wp-content/uploads/2024/02/passengers_decompose-768x628.png 768w, ../../wp-content/uploads/2024/02/passengers_decompose-600x490.png 600w, ../../wp-content/uploads/2024/02/passengers_decompose.png 1089w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Сделаем то же самое с данными о рождаемости.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c76758756666" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c76758756666-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c76758756666-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c76758756666-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c76758756666-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c76758756666-1"><span class="crayon-v">decompose</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">seasonal_decompose</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c76758756666-2"><span class="crayon-v">decompose</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c76758756666-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c76758756666-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="837" src="../../wp-content/uploads/2024/02/births_decompose-1024x837.png" alt="разложение временного ряда по рождаемости на компоненты" class="wp-image-25420" srcset="../../wp-content/uploads/2024/02/births_decompose-1024x837.png 1024w, ../../wp-content/uploads/2024/02/births_decompose-300x245.png 300w, ../../wp-content/uploads/2024/02/births_decompose-768x628.png 768w, ../../wp-content/uploads/2024/02/births_decompose-600x490.png 600w, ../../wp-content/uploads/2024/02/births_decompose.png 1089w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Как мы видим, графики совершенно разные. В следующем разделе мы изучим это различие более подробно.</p>



<h4 class="wp-block-heading" id="7-statsionarnost">Стационарность</h4>



<p>Стационарность (stationarity) временного ряда как раз означает, что такие компоненты как тренд и сезонность отсутствуют. Говоря более точно, среднее значение и дисперсия не меняются со смещением во времени.</p>



<p class="has-background" style="background-color:#ffe8c4">Понимание того, стационарные ли у нас данные или нестационарные важно для последующего моделирования.</p>



<p>Стационарность процесса можно <strong>оценить визуально</strong>. Датасет о перевозках демонстрирует очевидный тренд и сезонность, в то время как в наборе данных о рождаемости этого не видно (см. графики выше).</p>



<p>Для более точной оценки стационарности можно применить <strong>тест Дики-Фуллера</strong> (Dickey-Fuller test). О том, что такое <a href="../inference/index.html">статистический вывод</a> мы уже говорили.</p>



<p>В данном случае гипотезы звучат следующим образом:</p>



<ul class="wp-block-list">
<li><em>нулевая гипотеза</em> предполагает, что процесс нестационарный;</li>



<li><em>альтернативная гипотеза</em> соответственно говорит об обратном.</li>
</ul>



<p>Применим этот тест к обоим датасетам. Используем пороговое значение, равное 0,05 (5%).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c7e302638045" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c7e302638045-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-1"><span class="crayon-c"># импортируем необходимую функцию </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-e">stattools </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">adfuller</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-4"><span class="crayon-c"># передадим ей столбец с данными о перевозках и поместим результат в adf_test</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-5"><span class="crayon-v">adf_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">adfuller</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">[</span><span class="crayon-s">'#Passengers'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-7"><span class="crayon-c"># выведем p-value</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c7e302638045-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'p-value = '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">adf_test</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c80815807181" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c80815807181-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c80815807181-1">p-value = 0.991880243437641</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как мы видим, вероятность (p-value) для данных о перевозках существенно выше 0,05. Мы не можем отвергнуть нулевую гипотезу. Процесс нестанионарный. Проведем тест для второго набора данных.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c82496784557" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c82496784557-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c82496784557-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c82496784557-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c82496784557-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c82496784557-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c82496784557-1"><span class="crayon-c"># теперь посмотрим на данные о рождаемости</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c82496784557-2"><span class="crayon-v">adf_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">adfuller</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Births'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c82496784557-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c82496784557-4"><span class="crayon-c"># выведем p-value</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c82496784557-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'p-value = '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-v">adf_test</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c83015328200" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c83015328200-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c83015328200-1">p-value = 5.2434129901498554e-05</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Результат существенно меньше 5%. Временной ряд стационарен.</p>



<p>Надо сказать, что визуальная оценка полностью совпала с математическими вычислениями.</p>



<h4 class="wp-block-heading" id="8-avtokorrelyatsiya">Автокорреляция</h4>



<p>Изучая статистику, мы уже познакомились с <a href="../relationship/index.html">корреляцией</a>. Корреляция показывает силу взаимосвязи двух переменных и позволяет строить модель.</p>



<p>Автокорреляция также показывает степень взаимосвязи в диапазоне от –1 до 1, но только не двух переменных, а одной и той же переменной в разные моменты времени.</p>



<p>Допустим, есть временной ряд и этот же ряд, взятый с лагом 1, 2 и 3.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="270" src="../../wp-content/uploads/2021/10/lag_example-1024x270.jpg" alt="временной ряд и его лаги" class="wp-image-5101" srcset="../../wp-content/uploads/2021/10/lag_example-1024x270.jpg 1024w, ../../wp-content/uploads/2021/10/lag_example-300x79.jpg 300w, ../../wp-content/uploads/2021/10/lag_example-768x203.jpg 768w, ../../wp-content/uploads/2021/10/lag_example-1536x406.jpg 1536w, ../../wp-content/uploads/2021/10/lag_example-2048x541.jpg 2048w, ../../wp-content/uploads/2021/10/lag_example-1200x317.jpg 1200w, ../../wp-content/uploads/2021/10/lag_example-600x158.jpg 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Мы можем посчитать автокорреляцию ряда с лагом 1.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c86223849918" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c86223849918-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-1"><span class="crayon-c"># для начала возьмем искусственные данные</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">24</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-4"><span class="crayon-c"># для сдвига на одно значение достаточно взять этот ряд, начиная со второго элемента</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-5"><span class="crayon-v">lag_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-7"><span class="crayon-c"># посчитаем корреляцию для лага 1 (у исходных данных мы убрали последний элемент)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-8"><span class="crayon-c"># так как мы получим корреляционную матрицу, возьмем первую строку и второй столбец [0, 1]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c86223849918-9"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">corrcoef</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag_1</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c88242521690" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c88242521690-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c88242521690-1">-0.71</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Визуально это будет выглядеть следующим образом (вспомните график обычной корреляции).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c8a491578712" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8a491578712-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-1"><span class="crayon-c"># построим точечную диаграмму</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lag_1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-4"><span class="crayon-c"># добавим подписи</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'timeseries'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'lag 1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Автокорреляция с лагом 1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8a491578712-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="666" height="559" src="../../wp-content/uploads/2021/10/lag_1_plot.png" alt="пример автокорреляции с лагом 1" class="wp-image-5104" srcset="../../wp-content/uploads/2021/10/lag_1_plot.png 666w, ../../wp-content/uploads/2021/10/lag_1_plot-300x252.png 300w, ../../wp-content/uploads/2021/10/lag_1_plot-600x504.png 600w" sizes="auto, (max-width: 666px) 100vw, 666px" /></figure>



<p>Аналогично мы можем посчитать корреляцию для лагов 2 и 3 и на самом деле любого другого лага. Такие измерения автокорреляции удобно вычислить и изобразить с помощью графика <strong>автокорреляционной функции</strong> (autocorrelation function, ACF).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c8c924461139" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8c924461139-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-1"><span class="crayon-c"># импортируем автокорреляционную функцию (ACF)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">graphics</span><span class="crayon-sy">.</span><span class="crayon-e">tsaplots </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">plot</span><span class="crayon-sy">_</span>acf</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-4"><span class="crayon-c"># применим функцию к набору данных</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-5"><span class="crayon-e">plot_acf</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lags</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-7"><span class="crayon-c"># добавим отступы сверху и снизу на графике</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-8"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'tight'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8c924461139-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="665" height="536" src="../../wp-content/uploads/2021/10/dummy_acf.png" alt="автокорреляционная функция (ACF)" class="wp-image-5107" srcset="../../wp-content/uploads/2021/10/dummy_acf.png 665w, ../../wp-content/uploads/2021/10/dummy_acf-300x242.png 300w, ../../wp-content/uploads/2021/10/dummy_acf-600x484.png 600w" sizes="auto, (max-width: 665px) 100vw, 665px" /></figure>



<p>В частности, мы видим, что автокорреляция ряда с самим собой (первый столбец) равна 1, что логично. Второй столбец (то есть лаг 1) как раз примерно равен –0,71.</p>



<p>Разные значения, полученные через <strong>np.corrcoef()</strong> и <strong>plot_acf()</strong>, объясняются небольшим различием в заложенных в этих функциях формулах.</p>



<p>Теперь построим график ACF для данных о перевозках.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c8f147479210" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8f147479210-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8f147479210-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c8f147479210-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c8f147479210-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8f147479210-1"><span class="crayon-c"># применим ее к данным о пассажирах</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8f147479210-2"><span class="crayon-e">plot_acf</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c8f147479210-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'tight'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c8f147479210-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="665" height="536" src="../../wp-content/uploads/2021/10/pas_acf.png" alt="автокорреляционная функция (ACF) временного ряда по авиаперевозкам" class="wp-image-5087" srcset="../../wp-content/uploads/2021/10/pas_acf.png 665w, ../../wp-content/uploads/2021/10/pas_acf-300x242.png 300w, ../../wp-content/uploads/2021/10/pas_acf-600x484.png 600w" sizes="auto, (max-width: 665px) 100vw, 665px" /></figure>



<p>Автокорреляция позволяет выявлять тренд и сезонность, а также используется при подборе параметров моделей. В частности, мы видим, что лаг 12 сильнее коррелирует с исходным рядом, чем соседние лаги 10 и 11. То же самое можно сказать и про лаг 24. Такая автокорреляция позволяет предположить наличие (ежегодных) <em>сезонных колебаний</em>.</p>



<p>Постоянно положительная корреляция говорит о наличии<em> тренда</em>. Все это согласуется с тем, что мы узнали о данных, когда раскладывали их на компоненты.</p>



<p>Также замечу, что синяя граница позволяет оценить <em>статистическую значимость</em> корреляции. Если столбец выходит за ее пределы, то автокорреляция достаточно сильна и ее можно использовать при построении модели.</p>



<p>Сравним полученный выше график с графиком автокорреляционной функции данных о рождаемости.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c91484442345" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c91484442345-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c91484442345-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c91484442345-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c91484442345-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c91484442345-1"><span class="crayon-c"># построим аналогичный график для данных о рождаемости</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c91484442345-2"><span class="crayon-e">plot_acf</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c91484442345-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'tight'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c91484442345-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="651" height="536" src="../../wp-content/uploads/2021/10/bir_acf.png" alt="автокорреляционная функция (ACF) временного ряда по рождаемости" class="wp-image-5088" srcset="../../wp-content/uploads/2021/10/bir_acf.png 651w, ../../wp-content/uploads/2021/10/bir_acf-300x247.png 300w, ../../wp-content/uploads/2021/10/bir_acf-600x494.png 600w" sizes="auto, (max-width: 651px) 100vw, 651px" /></figure>



<p>Во-первых, важно отметить, что автокорреляция в данном случае намного слабее. Во-вторых, мы не можем выявить четкой сезонности и тренда.</p>



<h3 class="wp-block-heading" id="9-modelirovanie-i-postroenie-prognoza">Моделирование и построение прогноза</h3>



<p>На сегодняшнем занятии мы познакомимся с двумя типами моделей: экспоненциальное сглаживание и модель ARMA (и ее более продвинутые версии, ARIMA, SARIMA и SARIMAX).</p>



<h4 class="wp-block-heading" id="10-eksponentsialnoe-sglazhivanie">Экспоненциальное сглаживание</h4>



<p>Вновь обратимся к скользящему среднему (см. выше). В этой модели (1) всем предыдущим наблюдениям задавался одинаковый вес и (2) количество таких наблюдений было ограничено (мы называли это размером окна).</p>



<p class="has-background" style="background-color:#ffe8c4">Однако логично предположить, что недавние наблюдения более важны для прогноза, чем более отдаленные. Кроме того, мы можем взять все, а не некоторые из имеющихся наблюдений.</p>



<p>В модели экспоненциального сглаживания (exponential smoothing) или экспоненциально взвешенного скользящего среднего мы как раз (1) берем <em>все</em> предыдущие значения и (2) задаем каждому из наблюдений определенный <em>вес</em> и (экспоненциально) уменьшаем этот вес по мере углубления в прошлое.</p>



<p>Приведем формулу.</p>



<p>$$ \hat{y}_{t+1} = \alpha \cdot y_t + (1-\alpha) \cdot \hat{y}_{t}, $$</p>



<p>где $ \hat{y}_{t+1} $ &#8212; это будущее прогнозное значение, $ y_t $ &#8212; истинное значение в текущий период, $\hat{y}_{t}$ &#8212; прогнозное значение в текущий период.</p>



<p>Как мы видим, будущее прогнозное значение зависит как от текущего истинного, так и от текущего прогнозного значений. Важность этих значений определяется параметром $\alpha,$ который варьируется от 0 до 1. Чем $\alpha$ больше, тем больший вес у истинного наблюдения.</p>



<p>Формула рекурсивна, т.е. каждый раз мы умножаем ($1-\alpha$) на очередное прогнозное значение и так до конца временного ряда.</p>



<p id="practice"><strong>Практика</strong></p>



<p>На Питоне эту модель не сложно прописать руками.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c94299770016" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c94299770016-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-1"><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-3"><span class="crayon-c"># первое значение совпадает со значением временного ряда</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-4"><span class="crayon-v">exp_smoothing</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Births'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-6"><span class="crayon-c"># в цикле for последовательно применяем формулу ко всем элементам ряда</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Births'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">exp_smoothing</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Births'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">exp_smoothing</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-10"><span class="crayon-c"># выведем прогнозное значение для 366-го дня (1 января 1960 года)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c94299770016-11"><span class="crayon-v">exp_smoothing</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c97635109280" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c97635109280-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c97635109280-1">46.6051933602952</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Для временного ряда, состоящего из 365 наблюдений (весь 1959 год), мы получим 365 прогнозных значений (вплоть до 1 января 1960 года включительно).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c99677245543" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c99677245543-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c99677245543-1"><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">exp_smoothing</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c9b864322834" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9b864322834-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9b864322834-1">(365, 365)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Теперь добавим эти данные в исходный датафрейм births.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c9d394226764" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9d394226764-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c9d394226764-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9d394226764-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9d394226764-1"><span class="crayon-c"># добавим кривую сглаживаия в качестве столбца в датафрейм</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c9d394226764-2"><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Exp_smoothing'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">exp_smoothing</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9d394226764-3"><span class="crayon-v">births</span><span class="crayon-sy">.</span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="334" height="207" src="../../wp-content/uploads/2022/04/two-columns.png" alt="создание нового столбца в Pandas dataframe" class="wp-image-12061" style="width:287px;height:178px" srcset="../../wp-content/uploads/2022/04/two-columns.png 334w, ../../wp-content/uploads/2022/04/two-columns-300x186.png 300w" sizes="auto, (max-width: 334px) 100vw, 334px" /></figure>



<p>Единственный нюанс, так как фактические значения описывают период с 1 января по 31 декабря 1959 года, а прогнозные со 2 января 1959 года по 1 января 1960, мы не можем просто их соединить. Второй столбец нужно сдвинуть на один день вперед.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131c9f273273986" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131c9f273273986-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-1"><span class="crayon-c"># для этого импортируем класс timedelta</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">datetime</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">timedelta</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-4"><span class="crayon-c"># возьмём последний индекс (31 декабря 1959 года)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-5"><span class="crayon-v">last_date</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">births</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-i">index</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-7"><span class="crayon-c"># # "прибавим" один день</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-8"><span class="crayon-v">last_date</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">last_date</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">timedelta</span><span class="crayon-sy">(</span><span class="crayon-v">days</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131c9f273273986-9"><span class="crayon-v">last_date</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131ca2956345864" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca2956345864-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca2956345864-1">DatetimeIndex(['1960-01-01'], dtype='datetime64[ns]', name='Date', freq=None)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131ca3292379285" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca3292379285-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131ca3292379285-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca3292379285-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131ca3292379285-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca3292379285-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca3292379285-1"><span class="crayon-c"># добавим его в датафрейм</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131ca3292379285-2"><span class="crayon-v">births</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">births</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">last_date</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca3292379285-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131ca3292379285-4"><span class="crayon-c"># значения за этот день останутся пустыми</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca3292379285-5"><span class="crayon-v">births</span><span class="crayon-sy">.</span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="339" height="278" src="../../wp-content/uploads/2022/04/empty-row.png" alt="добавление новой строки с индексом в виде объекта datetime" class="wp-image-12062" style="width:287px;height:235px" srcset="../../wp-content/uploads/2022/04/empty-row.png 339w, ../../wp-content/uploads/2022/04/empty-row-300x246.png 300w" sizes="auto, (max-width: 339px) 100vw, 339px" /></figure>



<p>Сдвинем второй столбец.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131ca5793400925" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca5793400925-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca5793400925-1"><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Exp_smoothing'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Exp_smoothing'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">shift</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>И посмотрим на начало и конец датафрейма.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131ca7200358860" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca7200358860-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131ca7200358860-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca7200358860-1"><span class="crayon-c"># как и должно быть, первое прогнозное значение совпадает с предыдущим фактическим</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131ca7200358860-2"><span class="crayon-v">births</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="339" height="277" src="../../wp-content/uploads/2022/04/result-head.png" alt="смещение одного из столбцов датафрейма на один день вперед, первые пять значений" class="wp-image-12063" style="width:283px;height:232px" srcset="../../wp-content/uploads/2022/04/result-head.png 339w, ../../wp-content/uploads/2022/04/result-head-300x245.png 300w" sizes="auto, (max-width: 339px) 100vw, 339px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131ca9434095825" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131ca9434095825-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131ca9434095825-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131ca9434095825-1"><span class="crayon-c"># и у нас есть прогноз на один день вперед</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131ca9434095825-2"><span class="crayon-v">births</span><span class="crayon-sy">.</span><span class="crayon-e">tail</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="334" height="280" src="../../wp-content/uploads/2022/04/result-tail.png" alt="смещение одного из столбцов датафрейма на один день вперед, последние пять значений" class="wp-image-12064" style="width:282px;height:236px" srcset="../../wp-content/uploads/2022/04/result-tail.png 334w, ../../wp-content/uploads/2022/04/result-tail-300x251.png 300w" sizes="auto, (max-width: 334px) 100vw, 334px" /></figure>



<p>Проверим правильность расчетов, найдя последнее прогнозное значение по формуле выше.</p>



<p>$$ \hat{y}_{366} = 0{,}2 \times y_{355} + 0{,}8 \times \hat{y}_{355} = 0{,}2 \times 50 + 0{,}8 \times 45{,}756492 = 46{,}6051936 $$</p>



<p>Результаты совпадают. Теперь выведем фактические и прогнозные значения на графике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131cab941165154" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cab941165154-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-1"><span class="crayon-c"># зададим размер</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">15</span><span class="crayon-sy">,</span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-4"><span class="crayon-c"># выведем данные о рождаемости и кривую экспоненциального сглаживания</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Births'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Данные о рождаемости'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'steelblue'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">births</span><span class="crayon-sy">[</span><span class="crayon-s">'Exp_smoothing'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Экспоненциальное сглаживание'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'orange'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-8"><span class="crayon-c"># добавим легенду, ее положение на графике и размер шрифта</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">''</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'upper left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-11"><span class="crayon-c"># добавим подписи к осям и заголовки</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-12"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Количество родившихся'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-13"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Месяцы'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-14"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Рождаемость в 1959 году. Прогноз на 1 января 1960 года'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cab941165154-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="889" height="502" src="../../wp-content/uploads/2022/04/exponential-smoothing.png" alt="сравнение фактических данных и прогнозных значений в результате экспоненциального сглаживания" class="wp-image-12065" srcset="../../wp-content/uploads/2022/04/exponential-smoothing.png 889w, ../../wp-content/uploads/2022/04/exponential-smoothing-300x169.png 300w, ../../wp-content/uploads/2022/04/exponential-smoothing-768x434.png 768w, ../../wp-content/uploads/2022/04/exponential-smoothing-600x339.png 600w" sizes="auto, (max-width: 889px) 100vw, 889px" /></figure>



<p class="has-background" style="background-color:#ffe8c4">В качестве упражнения можно построить график с несколькими значениями $\alpha$ от 0 до 1.</p>



<p>Модель экспоненциального сглаживания можно усложнить, и тогда она будет улавливать тренд и сезонность. Кроме того, усложненные модели способны предсказывать более одного значения (обратите внимание, здесь мы смогли сделать прогноз лишь на один день вперёд).</p>



<p>Теперь поговорим про модели семейства ARMA.</p>



<h4 class="wp-block-heading" id="11-model-arma">Модель ARMA</h4>



<p>Модель ARMA состоит из двух компонентов.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="559" src="../../wp-content/uploads/2021/10/ARMA-1024x559.jpg" alt="компоненты модели ARMA: авторегрессия и скользящее среднее" class="wp-image-5351" style="width:489px;height:266px" srcset="../../wp-content/uploads/2021/10/ARMA-1024x559.jpg 1024w, ../../wp-content/uploads/2021/10/ARMA-300x164.jpg 300w, ../../wp-content/uploads/2021/10/ARMA-768x419.jpg 768w, ../../wp-content/uploads/2021/10/ARMA-1536x839.jpg 1536w, ../../wp-content/uploads/2021/10/ARMA-1200x655.jpg 1200w, ../../wp-content/uploads/2021/10/ARMA-600x328.jpg 600w, ../../wp-content/uploads/2021/10/ARMA.jpg 1780w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure></div>


<p><strong>Авторегрессия</strong> (autoregressive model, AR) &#8212; это регрессия ряда на собственные значения в прошлом. Другими словами, признаки в модели обычной регрессии мы заменяем значениями той же переменной, но за предыдущие периоды.</p>



<p>Когда мы прогнозируем значение в период $t$ с помощью данных за предыдущий период (AR(1)), уравнение будет выглядеть следующим образом.</p>



<p>$$ y_t = c + \varphi \cdot y_{t-1}, $$</p>



<p>где $c$ &#8212; это константа, $\varphi$ &#8212; вес модели, $ y_{t-1} $ &#8212; значение в период $t-1.$</p>



<p>Количество используемых предыдущих периодов определяется параметром $p.$ Обычно записывается как AR(p).</p>



<p><strong>Модель скользящего среднего</strong> (moving average, MA) помогает учесть случайные колебания или отклонения (ошибки) истинного значения от прогнозного. Можно также сказать, что модель скользящего среднего &#8212; это авторегрессия на ошибку.</p>



<p class="has-background" style="background-color:#ffe8c4">Обратите внимание, что скользящее среднее временного ряда, которое мы рассмотрели выше, и модель скользящего среднего &#8212; это разные понятия.</p>



<p>Если использовать ошибку только предыдущего наблюдения, то уравнение будет выглядеть следующим образом.</p>



<p>$$ y_t = \mu + \varphi \cdot \varepsilon_{t-1}, $$</p>



<p>где $ \mu $ &#8212; это среднее значение временного ряда, $ \varphi $ &#8212; вес модели, $ \varepsilon_{t-1} $ &#8212; ошибка в период $t-1.$</p>



<p>Такую модель принято называть моделью скользящего среднего с параметром q = 1 или MA(1). Разумеется, параметр q может принимать и другие значения (MA(q)).</p>



<p class="has-background" style="background-color:#ffe8c4">Модель ARMA с параметрами (или как еще говорят порядками, orders) p и q или ARMA(p, q) позволяет описать любой стационарный временной ряд.</p>



<p>ARMA предполагает, что в данных отсутствует тренд и сезонность (данные стационарны). Если данные <em>нестационарны, </em>нужно использовать более сложные версии этих моделей:</p>



<ul class="wp-block-list">
<li><strong>ARIMA</strong>, здесь добавляется компонент Integrated (I), который отвечает за удаление тренда (сам процесс называется дифференцированием);</li>



<li><strong>SARIMA</strong>, эта модель учитывает сезонность (Seasonality, S);</li>



<li><strong>SARIMAX</strong> включает еще и внешние или экзогенные факторы (eXogenous factors, отсюда и буква X в названии), которые напрямую не учитываются моделью, но влияют на нее.</li>
</ul>



<p>Параметров у модели SARIMAX больше. Полная версия выглядит как SARIMAX(p, d, q) x (P, D, Q, s). В данном случае, помимо известных параметров p и q, появляется параметр d, отвечающий за тренд, а также набор параметров (P, D, Q, s), отвечающих за сезонность.</p>



<p>Теперь давайте воспользуемся моделью SARIMAX для прогнозирования авиаперевозок.</p>



<p><strong>Практика</strong></p>



<p>В первую очередь нужно разбить данные на обучающую и тестовую выборки. Как мы помним, у нас есть данные с января 1949 года по декабрь 1960 года. </p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131cf7603745151" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cf7603745151-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cf7603745151-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cf7603745151-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cf7603745151-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cf7603745151-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cf7603745151-1"><span class="crayon-c"># обучающая выборка будет включать данные до декабря 1959 года включительно</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cf7603745151-2"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">passengers</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-s">'1959-12'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cf7603745151-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cf7603745151-4"><span class="crayon-c"># тестовая выборка начнется с января 1960 года (по сути, один год)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cf7603745151-5"><span class="crayon-k ">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">passengers</span><span class="crayon-sy">[</span><span class="crayon-s">'1960-01'</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Посмотрим на разделение на графике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131cfc198312672" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfc198312672-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"black"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"red"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-4"><span class="crayon-c"># заголовок и подписи к осям</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Разделение данных о перевозках на обучающую и тестовую выборки'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Количество пассажиров'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Месяцы'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-9"><span class="crayon-c"># добавим сетку</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-10"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfc198312672-12"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="668" height="550" src="../../wp-content/uploads/2021/10/train_test.png" alt="разделение данных о перевозках на обучающую и тестовую выборки" class="wp-image-5207" srcset="../../wp-content/uploads/2021/10/train_test.png 668w, ../../wp-content/uploads/2021/10/train_test-300x247.png 300w, ../../wp-content/uploads/2021/10/train_test-600x494.png 600w" sizes="auto, (max-width: 668px) 100vw, 668px" /></figure>



<p>Далее нужно обучить модель. При обучении модели SARIMAX, самое важное — правильно подобрать гиперпараметры, о которых говорилось выше. Процесс подбора гиперпараметров достаточно сложен, и сегодня мы воспользуемся уже готовыми значениями.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131cfe146925008" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131cfe146925008-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-1"><span class="crayon-c"># принудительно отключим предупреждения системы</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">warnings</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-3"><span class="crayon-k ">warnings</span><span class="crayon-sy">.</span><span class="crayon-e">simplefilter</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ignore'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">category</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">Warning</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-5"><span class="crayon-c"># обучим модель с соответствующими параметрами, SARIMAX(3, 0, 0)x(0, 1, 0, 12)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-6"><span class="crayon-c"># импортируем класс модели</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-7"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">statsmodels</span><span class="crayon-sy">.</span><span class="crayon-v">tsa</span><span class="crayon-sy">.</span><span class="crayon-v">statespace</span><span class="crayon-sy">.</span><span class="crayon-e">sarimax </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">SARIMAX</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-9"><span class="crayon-c"># создадим объект этой модели</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-10"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SARIMAX</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">order</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">seasonal_order</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-14"><span class="crayon-c"># применим метод .fit()</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131cfe146925008-15"><span class="crayon-v">result</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p>Теперь мы готовы делать прогноз. Вначале сделаем тестовый прогноз, соответствующий периоду тестовой выборки (1960 год), для того, чтобы оценить качество работы модели.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d01122247493" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d01122247493-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-1"><span class="crayon-c"># тестовый прогнозный период начнется с конца обучающего периода</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-2"><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-4"><span class="crayon-c"># и закончится в конце тестового</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-5"><span class="crayon-v">end</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-6"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-7"><span class="crayon-c"># применим метод .predict()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-8"><span class="crayon-v">predictions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">start</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">end</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d01122247493-9"><span class="crayon-v">predictions</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d03503629942" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d03503629942-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-1">1960-01-01&nbsp;&nbsp;&nbsp;&nbsp;422.703385</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-2">1960-02-01&nbsp;&nbsp;&nbsp;&nbsp;404.947178</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-3">1960-03-01&nbsp;&nbsp;&nbsp;&nbsp;466.293258</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-4">1960-04-01&nbsp;&nbsp;&nbsp;&nbsp;454.781296</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-5">1960-05-01&nbsp;&nbsp;&nbsp;&nbsp;476.848628</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-6">1960-06-01&nbsp;&nbsp;&nbsp;&nbsp;527.162826</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-7">1960-07-01&nbsp;&nbsp;&nbsp;&nbsp;601.449809</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-8">1960-08-01&nbsp;&nbsp;&nbsp;&nbsp;610.821691</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-9">1960-09-01&nbsp;&nbsp;&nbsp;&nbsp;513.229987</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-10">1960-10-01&nbsp;&nbsp;&nbsp;&nbsp;455.692619</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-11">1960-11-01&nbsp;&nbsp;&nbsp;&nbsp;409.200047</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-12">1960-12-01&nbsp;&nbsp;&nbsp;&nbsp;450.754161</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d03503629942-13">Freq: MS, Name: predicted_mean, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Построим соответствующий график.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d05221739423" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d05221739423-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-1"><span class="crayon-c"># выведем три кривые (обучающая, тестовая выборка и тестовый прогноз)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"black"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"red"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">predictions</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"green"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-6"><span class="crayon-c"># заголовок и подписи к осям</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">"Обучающая выборка, тестовая выборка и тестовый прогноз"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-8"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Количество пассажиров'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Месяцы'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-11"><span class="crayon-c"># добавим сетку</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-12"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d05221739423-14"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="668" height="550" src="../../wp-content/uploads/2021/10/train-test-prediction.png" alt="обучающая выборка, тестовая выборка и тестовый прогноз временного ряда по авиаперевозкам" class="wp-image-5556" srcset="../../wp-content/uploads/2021/10/train-test-prediction.png 668w, ../../wp-content/uploads/2021/10/train-test-prediction-300x247.png 300w, ../../wp-content/uploads/2021/10/train-test-prediction-600x494.png 600w" sizes="auto, (max-width: 668px) 100vw, 668px" /></figure>



<p>В целом модель хорошо описывает временной ряд. Мы также можем использовать знакомые метрики <a href="../optimization/index.html">среднеквадратической ошибки</a> (MSE) и корня среднеквадратической ошибки (RMSE) для оценки качества.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d07481614565" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d07481614565-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-1"><span class="crayon-c"># импортируем функции метрик</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">mean_squared_error</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">root_mean_squared</span><span class="crayon-sy">_</span>error</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-4"><span class="crayon-c"># рассчитаем MSE</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-k ">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-7"><span class="crayon-c"># и RMSE</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d07481614565-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-k ">test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">predictions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d0a909280442" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0a909280442-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0a909280442-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0a909280442-1">317.39565432961956</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0a909280442-2">17.81560143047715</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Теперь можно делать прогноз на будущее. Возьмём горизонт равный трем годам (1961, 1962 и 1963 год). Всего должно получиться 36 прогнозных значений.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d0c521185129" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0c521185129-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-1"><span class="crayon-c"># прогнозный период с конца имеющихся данных</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-2"><span class="crayon-v">start</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-4"><span class="crayon-c"># и закончится 36 месяцев спустя</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-5"><span class="crayon-v">end</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">12</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-7"><span class="crayon-c"># теперь построим прогноз на три года вперед</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-8"><span class="crayon-v">forecast</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">result</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">start</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">end</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-10"><span class="crayon-c"># посмотрим на весь 1963 год</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0c521185129-11"><span class="crayon-v">forecast</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d0e681064425" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d0e681064425-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-1">1963-01-01&nbsp;&nbsp;&nbsp;&nbsp;518.603436</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-2">1963-02-01&nbsp;&nbsp;&nbsp;&nbsp;497.908988</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-3">1963-03-01&nbsp;&nbsp;&nbsp;&nbsp;556.406784</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-4">1963-04-01&nbsp;&nbsp;&nbsp;&nbsp;542.133835</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-5">1963-05-01&nbsp;&nbsp;&nbsp;&nbsp;561.524762</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-6">1963-06-01&nbsp;&nbsp;&nbsp;&nbsp;609.244563</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-7">1963-07-01&nbsp;&nbsp;&nbsp;&nbsp;681.016637</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-8">1963-08-01&nbsp;&nbsp;&nbsp;&nbsp;687.950665</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-9">1963-09-01&nbsp;&nbsp;&nbsp;&nbsp;587.995801</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-10">1963-10-01&nbsp;&nbsp;&nbsp;&nbsp;528.167677</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-11">1963-11-01&nbsp;&nbsp;&nbsp;&nbsp;479.454536</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-12">1963-12-01&nbsp;&nbsp;&nbsp;&nbsp;518.856117</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d0e681064425-13">Freq: MS, Name: predicted_mean, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Посмотрим на прогнозные значения на графике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa624131d10233040460" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa624131d10233040460-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-1"><span class="crayon-c"># выведем две кривые (фактические данные и прогноз на будущее)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">passengers</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'black'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">forecast</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'blue'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-5"><span class="crayon-c"># заголовок и подписи к осям</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Фактические данные и прогноз на будущее'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Количество пассажиров'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-8"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Месяцы'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-10"><span class="crayon-c"># добавим сетку</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-11"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa624131d10233040460-13"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="668" height="550" src="../../wp-content/uploads/2021/11/actual-forecast.png" alt="фактические данные и прогноз на будущее с помощью модели SARIMAX" class="wp-image-6065" srcset="../../wp-content/uploads/2021/11/actual-forecast.png 668w, ../../wp-content/uploads/2021/11/actual-forecast-300x247.png 300w, ../../wp-content/uploads/2021/11/actual-forecast-600x494.png 600w" sizes="auto, (max-width: 668px) 100vw, 668px" /></figure>



<h3 class="wp-block-heading" id="12-podvedem-itog">Подведем итог</h3>



<p>Занятие было насыщенным. Мы узнали, (1) чем временные ряды отличаются от структурных данных, (2) научились анализировать временные ряды с помощью Питона, а также (3) строить графики.</p>



<p>При прогнозировании временных рядов мы (4) использовали модель экспоненциального сглаживания и (5) познакомились с семейством моделей ARMA.</p>



<h4 class="wp-block-heading" id="14-otvety-na-voprosy">Ответы на вопросы</h4>



<p><strong>Вопрос</strong>. Вы не могли бы более детально рассказать, как подбираются параметры в модели SARIMAX. В частности, как были подобраны параметры (3, 0, 0)x(0, 1, 0, 12)?</p>



<p><strong>Ответ</strong>. Параметры SARIMAX можно подобрать с помощью функции auto_arima. Выбор наиболее удачных параметров осуществляется на основе определенного критерия.</p>



<p>По умолчанию используется, так называемый, Akaike Information Criterion или AIC, который рассчитывается для каждой комбинации параметров. Чем ниже AIC модели, тем лучше.</p>



<p>Я привел код auto_arima в конце <a href="https://colab.research.google.com/drive/17JQsqabF63Y4KM71MjRy4gqbBr8uPDHg#scrollTo=4NOoamM6z6Gh" target="_blank" rel="noreferrer noopener">блокнота</a>⧉.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"intro\\\/time-series\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
