<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Обработка естественного языка | Вводный курс</title>
	<meta name="description" content="Как компьютер определяет, о чем говорится в тексте? Обработка естественного языка - тема сегодняшнего занятия." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Обработка естественного языка | Вводный курс" />
	<meta property="og:description" content="Как компьютер определяет, о чем говорится в тексте? Обработка естественного языка - тема сегодняшнего занятия." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/intro/topic-identification/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2025-01-01T06:04:00+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2024/02/image-8.png" />
	<meta property="og:image:width" content="1810" />
	<meta property="og:image:height" content="299" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="24 минуты" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/intro/topic-identification/","url":"https://www.dmitrymakarov.ru/intro/topic-identification/","name":"Обработка естественного языка | Вводный курс","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/intro/topic-identification/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/intro/topic-identification/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2024/02/image-8-1024x169.png","datePublished":"2021-03-25T19:01:16+00:00","dateModified":"2025-01-01T06:04:00+00:00","description":"Как компьютер определяет, о чем говорится в тексте? Обработка естественного языка - тема сегодняшнего занятия.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/intro/topic-identification/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/intro/topic-identification/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/intro/topic-identification/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2024/02/image-8.png","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2024/02/image-8.png","width":1810,"height":299},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/intro/topic-identification/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Вводный курс","item":"https://www.dmitrymakarov.ru/intro/"},{"@type":"ListItem","position":3,"name":"Обработка естественного языка"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-1336 page-child parent-pageid-202 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa623f8f2fa">Поиск:</label>
	<input type="search" id="search-form-67aa623f8f2fa" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa623f8f3b4">Поиск:</label>
	<input type="search" id="search-form-67aa623f8f3b4" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-1336 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Обработка естественного языка</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Вводный курс</a></p>



<p>Сегодня мы рассмотрим тему <strong>обработки естественного языка</strong> (Natural Language Processing, NLP), области на стыке математики, информатики и лингвистики, занимающейся пониманием (анализом) и созданием (синтезом) текстов с помощью компьютера.</p>



<p>В частности мы разберем тему (1) предварительной обработки языка (language pre-processing), (2) а также изучим два несложных способа <strong>анализа содержания текста</strong> (topic identification).</p>



<h3 class="wp-block-heading" id="0-postanovka-zadachi">Постановка задачи</h3>



<p>В школьных учебниках можно встретить такое задание: &#171;Прочитайте текст. Определите его тему&#187;. У человека, как правило, это не вызывает никаких сложностей. Попробуем привить этот навык компьютеру.</p>



<p>В качестве примера, возьмем следующий текст на английском языке:</p>



<p class="has-background" style="background-color:#ffe8c4">When we were in Paris we visited a lot of museums. We first went to the Louvre, the largest art museum in the world. I have always been interested in art so I spent many hours there. The museum is enourmous, so a week there would not be enough.</p>



<p>Содержание этого текста можно описать словами &#171;музей&#187; (museum), &#171;Лувр&#187; (Louvre), &#171;Париж&#187; (Paris), &#171;искусство&#187; (art). Посмотрим, что скажет компьютер.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/1Qabs4d13EZZPiVZivZ7fAi5ZqfrSTPdA?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87528419157136" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87528419157136-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87528419157136-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87528419157136-1"><span class="crayon-c"># возьмём исходный текст для анализа</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87528419157136-2"><span class="crayon-v">corpus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'When we were in Paris we visited a lot of museums. We first went to the Louvre, the largest art museum in the world. I have always been interested in art so I spent many hours there. The museum is enourmous, so a week there would not be enough.'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p class="has-background" style="background-color:#ffe8c4">В лингвистике совокупность рассматриваемых текстов принято называть <strong>корпусом</strong> (corpus, мн.ч. кóрпусы, corpora).</p>



<p>Импортируем пакет библиотек для обработки естественного языка (Natural Language Toolkit или NLTK) и другие уже известные нам библиотеки.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87534291035216" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87534291035216-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87534291035216-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87534291035216-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87534291035216-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">nltk</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87534291035216-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">pandas </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">pd</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87534291035216-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">np</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h3 class="wp-block-heading" id="1-predvaritelnaya-obrabotka-teksta">Предварительная обработка текста</h3>



<h4 class="wp-block-heading" id="2-shag-1-razdelenie-na-predlozheniya">Шаг 1. Разделение на предложения</h4>



<p>Вначале текст логично разделить на предложения или токенизировать. Хотя задача кажется тривиальной (достаточно разделить текст по точкам, восклицательным и вопросительным знакам), есть несколько сложностей. Например, фраза &#171;Мороженое стоит 100 руб. 20 коп.&#187; может быть ошибочно разбита на два предложения. Помимо сокращений есть и другие сложности. Например, из-за опечатки предложение может заканчиваться пробелом, а не знаком препинания.</p>



<p>Для решения этой задачи можно использовать функцию библиотеки NLTK <strong>sent_tokenize()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87535236185332" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87535236185332-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-1"><span class="crayon-c"># импортируем функцию sent_tokenize()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-k ">tokenize</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">sent</span><span class="crayon-sy">_</span>tokenize</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-4"><span class="crayon-c"># скачиваем модель, которая будет делить текст на предложения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-5"><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">download</span><span class="crayon-sy">(</span><span class="crayon-s">'punkt'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-7"><span class="crayon-c"># и применяем функцию к тексту</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-8"><span class="crayon-v">sentences</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sent_tokenize</span><span class="crayon-sy">(</span><span class="crayon-v">corpus</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87535236185332-9"><span class="crayon-v">sentences</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87537386248434" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87537386248434-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87537386248434-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87537386248434-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87537386248434-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87537386248434-1">['When we were in Paris we visited a lot of museums.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87537386248434-2"> 'We first went to the Louvre, the largest art museum in the world.',</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87537386248434-3"> 'I have always been interested in art so I spent many hours there.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87537386248434-4"> 'The museum is enourmous, so a week there would not be enough.']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"></div>



<p>Функция использует уже <a href="../principle/index.html">обученную модель</a>, в нашем случае, для английского языка: 
			<span id="urvanov-syntax-highlighter-67aa623f87538868395413" class="urvanov-syntax-highlighter-syntax urvanov-syntax-highlighter-syntax-inline  crayon-theme-familiar-my-copy crayon-theme-familiar-my-copy-inline urvanov-syntax-highlighter-font-consolas" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important;"><span class="crayon-pre urvanov-syntax-highlighter-code" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">nltk_data</span><span class="crayon-o">/</span><span class="crayon-v">tokenizers</span><span class="crayon-o">/</span><span class="crayon-v">punkt</span><span class="crayon-o">/</span><span class="crayon-v">english</span><span class="crayon-sy">.</span><span class="crayon-k ">pickle</span></span></span>. Также можно использовать модели для других языков или обучить собственную модель.</p>



<h4 class="wp-block-heading" id="3-shag-2-razdelenie-na-slova">Шаг 2. Разделение на слова</h4>



<p>Разделение на слова или токенизация слов &#8212; следующий шаг в обработке текста. В целом используется аналогичный подход и функция <strong>word_tokenize()</strong>. Для примера, разобьем на слова первое предложение.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87539593762939" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87539593762939-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87539593762939-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87539593762939-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87539593762939-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87539593762939-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87539593762939-1"><span class="crayon-c"># импортируем функцию word_tokenize()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87539593762939-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-k ">tokenize</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">word</span><span class="crayon-sy">_</span>tokenize</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87539593762939-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87539593762939-4"><span class="crayon-c"># и разобьём на слова первое предложение</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87539593762939-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-e">word_tokenize</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8753a211576260" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753a211576260-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753a211576260-1">['When', 'we', 'were', 'in', 'Paris', 'we', 'visited', 'a', 'lot', 'of', 'museums', '.']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Сделаем то же самое для всего текста.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8753c969897348" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753c969897348-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-1"><span class="crayon-c"># для этого создадим пустой список</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-2"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-4"><span class="crayon-c"># в цикле for пройдемся по каждому предложению</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">sentence </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">sentences</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># создадим списки из токенов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">t</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">word_tokenize</span><span class="crayon-sy">(</span><span class="crayon-v">sentence</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># и присоединим списки друг к другу</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tokens</span><span class="crayon-sy">.</span><span class="crayon-e">extend</span><span class="crayon-sy">(</span><span class="crayon-v">t</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-12"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753c969897348-13"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8753d360832252" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753d360832252-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753d360832252-1">['When', 'we', 'were', 'in', 'Paris', 'we', 'visited', 'a', 'lot', 'of', 'museums', '.', 'We', 'first', 'went', 'to', 'the', 'Louvre', ',', 'the', 'largest', 'art', 'museum', 'in', 'the', 'world', '.', 'I', 'have', 'always', 'been', 'interested', 'in', 'art', 'so', 'I', 'spent', 'many', 'hours', 'there', '.', 'The', 'museum', 'is', 'enourmous', ',', 'so', 'a', 'week', 'there', 'would', 'not', 'be', 'enough', '.']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<h4 class="wp-block-heading" id="4-shag-3-perevod-v-nizhniy-registr-udalenie-stop-slov-i-znakov-punktuatsii">Шаг 3. Перевод в нижний регистр, удаление стоп-слов и знаков пунктуации</h4>



<p>Выясняется, что для анализа текста далеко не все слова являются релевантными. Если мы попробуем применить к тексту статистические методы, то многие важные с точки зрения человеческой грамматики слова будут только мешать. В частности, это предлоги, союзы и артикли. Назовем их &#171;стоп-словами&#187; и попробуем опустить.</p>



<p>Перед этим обязательно преобразуем все заглавные буквы в строчные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8753e929358208" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753e929358208-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-1"><span class="crayon-c"># импортируем модуль стоп-слов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">corpus </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">stopwords</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-4"><span class="crayon-c"># скачаем словарь стоп-слов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-5"><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">download</span><span class="crayon-sy">(</span><span class="crayon-s">'stopwords'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-7"><span class="crayon-c"># мы используем set, чтобы оставить только уникальные значения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-8"><span class="crayon-v">unique_stops</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">set</span><span class="crayon-sy">(</span><span class="crayon-v">stopwords</span><span class="crayon-sy">.</span><span class="crayon-e">words</span><span class="crayon-sy">(</span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-10"><span class="crayon-c"># создаём пустой список без стоп-слов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-11"><span class="crayon-v">no_stops</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-12"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-13"><span class="crayon-c"># проходимся по всем токенам</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-14"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-15"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># переводим все слова в нижний регистр</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">token</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-18"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># если токен не в списке стоп-слов и не является знаком пунктуации,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-e">unique_stops </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-k ">token</span><span class="crayon-sy">.</span><span class="crayon-e">isalpha</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-21"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># добавляем его в список</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">no_stops</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">token</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-24"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753e929358208-25"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">no_stops</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8753f241874472" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8753f241874472-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8753f241874472-1">['paris', 'visited', 'lot', 'museums', 'first', 'went', 'louvre', 'largest', 'art', 'museum', 'world', 'always', 'interested', 'art', 'spent', 'many', 'hours', 'museum', 'enourmous', 'week', 'would', 'enough']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как вы вероятно заметили, мы дополнительно удалили пунктуацию с помощью метода <strong>.isalpha()</strong>.</p>



<h4 class="wp-block-heading" id="5-shag-4-lemmatizatsiya">Шаг 4. Лемматизация</h4>



<p>Кроме того, с точки зрения анализа содержания слова &#171;музеи&#187; и &#171;музей&#187; означают одно и то же, но компьютер посчитает их разными словами. Значит, слова нужно привести к начальной (словарной) форме или лемме.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87540607784822" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87540607784822-22">22</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-1"><span class="crayon-c"># импортируем класс для лемматизации</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">stem </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">WordNetLemmatizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-4"><span class="crayon-c"># импортируем словарь</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-5"><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">download</span><span class="crayon-sy">(</span><span class="crayon-s">'wordnet'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-7"><span class="crayon-c"># создаём объект этого класса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-8"><span class="crayon-v">lemmatizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">WordNetLemmatizer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-10"><span class="crayon-c"># и пустой список для слов после лемматизации</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-11"><span class="crayon-v">lemmatized</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-12"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-13"><span class="crayon-c"># проходимся по всем токенам</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-14"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">no_stops</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-15"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># применяем лемматизацию</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">token</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lemmatizer</span><span class="crayon-sy">.</span><span class="crayon-e">lemmatize</span><span class="crayon-sy">(</span><span class="crayon-k ">token</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-18"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># добавляем слово после лемматизации в список</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">lemmatized</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">token</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87540607784822-22"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">lemmatized</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87543770627851" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87543770627851-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87543770627851-1">['paris', 'visited', 'lot', 'museum', 'first', 'went', 'louvre', 'largest', 'art', 'museum', 'world', 'always', 'interested', 'art', 'spent', 'many', 'hour', 'museum', 'enourmous', 'week', 'would', 'enough']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>WordNet Lemmatizer библиотеки NLTK использует базу данных <a href="https://wordnet.princeton.edu/" target="_blank" rel="noreferrer noopener">WordNet</a>⧉  для поиска словарной формы слова.</p>



<h4 class="wp-block-heading" id="6-shag-5-stemming">Шаг 5. Стемминг</h4>



<p>Стемминг (stemming), в отличие от лемматизации, ориентирован на поиск основы слова (stem). Попробуем применить и его.</p>



<p>Для начала используем стеммер (т.е. инструмент стемминга) Портера. Он достаточно консервативен, т.е. не так активно обрезает слова в поисках основы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87544109322893" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87544109322893-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-1"><span class="crayon-c"># импортируем класс стеммера Porter и создаём объект этого класса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">stem </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">PorterStemmer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-3"><span class="crayon-v">porter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">PorterStemmer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-5"><span class="crayon-c"># используем list comprehension вместо цикла for для стемминга и создания нового списка</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-6"><span class="crayon-c"># такая запись намного короче</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-7"><span class="crayon-v">stemmed_p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">porter</span><span class="crayon-sy">.</span><span class="crayon-e">stem</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lemmatized</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87544109322893-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">stemmed_p</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87545274702353" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87545274702353-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87545274702353-1">['pari', 'visit', 'lot', 'museum', 'first', 'went', 'louvr', 'largest', 'art', 'museum', 'world', 'alway', 'interest', 'art', 'spent', 'mani', 'hour', 'museum', 'enourm', 'week', 'would', 'enough']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p class="has-background" style="background-color:#ffe8c4">Как вы видите, list comprehension позволяет в одну строчку создавать список. Подробнее этот прием мы рассмотрим на <a href="../../python/list-tuple-set/index.html">следующем курсе</a>.</p>



<p>Теперь применим более агрессивный стеммер Ланкастера.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87546793013823" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87546793013823-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-1"><span class="crayon-c"># аналогично импортируем класс Lancaster и создаём объект этого класса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">nltk</span><span class="crayon-sy">.</span><span class="crayon-e">stem </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LancasterStemmer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-3"><span class="crayon-v">lancaster</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LancasterStemmer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-5"><span class="crayon-c"># также используем list_comprehension</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-6"><span class="crayon-v">stemmed_l</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">lancaster</span><span class="crayon-sy">.</span><span class="crayon-e">stem</span><span class="crayon-sy">(</span><span class="crayon-v">s</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">lemmatized</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87546793013823-7"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">stemmed_l</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87548044371437" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87548044371437-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87548044371437-1">['par', 'visit', 'lot', 'muse', 'first', 'went', 'louvr', 'largest', 'art', 'muse', 'world', 'alway', 'interest', 'art', 'spent', 'many', 'hour', 'muse', 'enourm', 'week', 'would', 'enough']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>К сожалению, ни тот, ни другой не показали хороших результатов. Стемминг к тексту мы применять не будем.</p>



<h3 class="wp-block-heading" id="7-meshok-slov">Мешок слов</h3>



<p>Принцип метода <strong>мешка слов</strong> (Bag of Words, BoW) чрезвычайно прост. Мы считаем, как часто встречается каждое слово в тексте.</p>



<p>Несмотря на простоту, при правильной предобработке текста (в первую очередь удалении стоп-слов, которые и будут наиболее частотными) этот метод показывает неплохие результаты. Применим его к тексту с помощью класса <strong>Counter </strong>модуля <strong>Collections</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87549455076785" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87549455076785-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-1"><span class="crayon-c"># из модуля collections импортируем класс Counter</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-k ">collections</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-4"><span class="crayon-c"># применяем класс Counter к словам после лемматизации</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-5"><span class="crayon-c"># на выходе возвращается словарь { слово : его частота в тексте }</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-6"><span class="crayon-v">bow_counter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Counter</span><span class="crayon-sy">(</span><span class="crayon-v">lemmatized</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-7"><span class="crayon-c"># print(bow_counter)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-8"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-9"><span class="crayon-c"># функция most_common() упорядочивает словарь по значению</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-10"><span class="crayon-c"># посмотрим на первые 10 наиболее частотных слов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87549455076785-11"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">bow_counter</span><span class="crayon-sy">.</span><span class="crayon-e">most_common</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8754a437396807" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754a437396807-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754a437396807-1">[('museum', 3), ('art', 2), ('paris', 1), ('visited', 1), ('lot', 1), ('first', 1), ('went', 1), ('louvre', 1), ('largest', 1), ('world', 1)]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Этот же метод можно реализовать с помощью класса <strong>CountVectorizer</strong> библиотеки <strong>Scikit-learn</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8754b954035652" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754b954035652-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-1"><span class="crayon-c"># импортируем класс CountVectorizer из библиотеки Scikit-learn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">feature_extraction</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">CountVectorizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-4"><span class="crayon-c"># создаём объект этого класса и</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-5"><span class="crayon-c"># указываем, что хотим перевести слова в нижний регистр, а также</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-6"><span class="crayon-c"># отфильтровать стоп-слова через stop_words = 'english'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-7"><span class="crayon-v">vectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CountVectorizer</span><span class="crayon-sy">(</span><span class="crayon-v">analyzer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"word"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">lowercase</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">tokenizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">preprocessor</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'english'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754b954035652-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">max_features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5000</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8754d211768182" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754d211768182-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754d211768182-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754d211768182-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754d211768182-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754d211768182-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754d211768182-1"><span class="crayon-c"># применяем этот объект к предложениям (ещё говорят документам)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754d211768182-2"><span class="crayon-v">bow_cv</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754d211768182-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754d211768182-4"><span class="crayon-c"># на выходе получается матрица csr</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754d211768182-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-k ">type</span><span class="crayon-sy">(</span><span class="crayon-v">bow_cv</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8754e520730075" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754e520730075-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754e520730075-1">&lt;class 'scipy.sparse.csr.csr_matrix'&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Преобразуем матрицу csr в привычный формат массива Numpy.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8754f331279899" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8754f331279899-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8754f331279899-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8754f331279899-1"><span class="crayon-c"># для этого можно использовать .toarray()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8754f331279899-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">bow_cv</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87550846878800" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87550846878800-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87550846878800-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87550846878800-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87550846878800-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87550846878800-1">[[0 0 0 0 0 1 0 0 1 1 0 1 0 0 0]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87550846878800-2"> [1 0 0 0 1 0 1 1 0 0 0 0 0 1 1]</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87550846878800-3"> [1 0 1 1 0 0 0 0 0 0 1 0 0 0 0]</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87550846878800-4"> [0 1 0 0 0 0 0 1 0 0 0 0 1 0 0]]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Строки предсталяют собой предложения (документы), столбцы &#8212; слова (токены).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87551187366010" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87551187366010-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87551187366010-1"><span class="crayon-v">bow_cv</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87552029684003" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87552029684003-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87552029684003-1">(4, 15)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Есть два способа посмотреть на используемые токены. С помощью атрибута vocabulary_.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87553204665520" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87553204665520-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87553204665520-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87553204665520-1"><span class="crayon-v">vocab</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">vocabulary_</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87553204665520-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">vocab</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87555822771037" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87555822771037-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87555822771037-1">{'paris': 9, 'visited': 11, 'lot': 5, 'museums': 8, 'went': 13, 'louvre': 6, 'largest': 4, 'art': 0, 'museum': 7, 'world': 14, 'interested': 3, 'spent': 10, 'hours': 2, 'enourmous': 1, 'week': 12}</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Здесь числа это не частотность слов, а просто их порядковый номер или индекс. Также токены можно вывести с помощью метода <strong>.get_feature_names_out()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87556207447387" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87556207447387-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87556207447387-1"><span class="crayon-v">tokens</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">get_feature_names_out</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87557538961996" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87557538961996-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87557538961996-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87557538961996-1">['art' 'enourmous' 'hours' 'interested' 'largest' 'lot' 'louvre' 'museum'</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87557538961996-2"> 'museums' 'paris' 'spent' 'visited' 'week' 'went' 'world']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p id="cvbowdf">Результат для удобства также можно преобразовать в датафрейм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87558776922077" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87558776922077-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-1"><span class="crayon-c"># вначале создадим индекс предложений (документов)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-2"><span class="crayon-v">index_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-4"><span class="crayon-c"># в цикле пройдемся по элементам матрицы, обозначим их через '_'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-5"><span class="crayon-c"># функция enumerate задаст каждому элементу индекс, начиная с 0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">bow_cv</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-7"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># прибавим индекс к слову Sentence </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">index_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-s">'Sentence_{i}'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-10"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-11"><span class="crayon-c"># теперь можно использовать pd.DataFrame()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-12"><span class="crayon-v">bow_cv_df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bow_cv</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">index_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87558776922077-15"><span class="crayon-v">bow_cv_df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image size-large"><img fetchpriority="high" decoding="async" width="1024" height="169" src="../../wp-content/uploads/2024/02/image-8-1024x169.png" alt="мешок слов через CountVectorizer" class="wp-image-25403" srcset="../../wp-content/uploads/2024/02/image-8-1024x169.png 1024w, ../../wp-content/uploads/2024/02/image-8-300x50.png 300w, ../../wp-content/uploads/2024/02/image-8-768x127.png 768w, ../../wp-content/uploads/2024/02/image-8-1536x254.png 1536w, ../../wp-content/uploads/2024/02/image-8-1200x198.png 1200w, ../../wp-content/uploads/2024/02/image-8-600x99.png 600w, ../../wp-content/uploads/2024/02/image-8.png 1810w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Итог работы CountVectorizer может показаться менее наглядным, чем метод мешка слов (и кроме того у него нет встроенной возможности лемматизации и стемминга), однако этот класс позволяет выразить слова с помощью <strong>числовых векторов</strong>.</p>



<p>Это очень важный результат, о котором мы поговорим в конце занятия.</p>



<h3 class="wp-block-heading" id="8-metod-tf-idf">Метод TF-IDF</h3>



<p>Чуть более сложный и продвинутый метод определения значимости слов в тексте называется TF-IDF (term frequency &#8212; inverse document frequency).</p>



<h4 class="wp-block-heading" id="9-osnovnaya-ideya">Основная идея</h4>



<p>Если слово часто встречается во всех документах (это в первую очередь касается предлогов, союзов и других стоп-слов), то вряд ли эти слова имеют большое значение. И наоборот, если слово встречаться только в одном документе, вероятно оно в большей степени определяет его содержание.</p>



<p>Другими словами, определяется не только значимость слова в тексте, но и значимость слова с учётом всех текстов.</p>



<h4 class="wp-block-heading" id="10-prostoy-primer-i-formula">Простой пример и формула</h4>



<p>Предположим, что у нас есть два текста, и мы посчитали частотность слов в каждом из них (т.е. создали мешок слов).</p>


<div class="wp-block-image is-resized">
<figure class="aligncenter size-full"><img decoding="async" width="932" height="399" src="../../wp-content/uploads/2021/09/tfidf-wiki.jpg" alt="пример метода TF-IDF" class="wp-image-4784" style="width:729px;height:auto" srcset="../../wp-content/uploads/2021/09/tfidf-wiki.jpg 932w, ../../wp-content/uploads/2021/09/tfidf-wiki-300x128.jpg 300w, ../../wp-content/uploads/2021/09/tfidf-wiki-768x329.jpg 768w, ../../wp-content/uploads/2021/09/tfidf-wiki-600x257.jpg 600w" sizes="(max-width: 932px) 100vw, 932px" /><figcaption class="wp-element-caption"><em>Пример взят из <a href="https://en.m.wikipedia.org/wiki/Tf%E2%80%93idf" target="_blank" rel="noreferrer noopener">Википедии</a> ⧉ </em></figcaption></figure></div>


<h5 class="wp-block-heading" id="11-raschet-tf-idf-dlya-slova-this">Расчет tf-idf для слова this</h5>



<p>Поставим задачу рассчитать TF-IDF для слова <em>this </em>в каждом из документов. На первом этапе вычисляем <strong>частоту слова</strong> (term frequency или TF) относительно всех слов в документе.</p>



<p class="has-text-align-left">$$ tf(this, d_1)  = \frac{частотность \space слова}{всего \space слов} = \frac{1}{5} = 0.2 $$</p>



<p class="has-text-align-left"> $$ tf(this, d_2)  = \frac{частотность \space слова}{всего \space слов} = \frac{1}{7} \approx 0.14 $$ </p>



<p>Такой подход гарантирует, что мы учитываем, как часто встречается слово относительно длины документа.</p>



<p>На втором этапе рассчитаем <strong>IDF</strong> слова <em>this</em>. То есть мы делим общее количество документов в корпусе на количество документов, в которых встречается искомый токен, и берем логарифм (в данном случае, десятичный) частного.</p>



<p>$$ idf(this, D) = \log_{10} \left(\frac{всего\spaceдокументов}{документов\spaceс\spaceтокеном}\right) = \log_{10} \left( \frac{2}{2} \right) = 0 $$</p>



<p>Остаётся перемножить TF и IDF.</p>



<p class="has-text-align-left">$$ tf-idf (this, d_1, D) = 0.2 \times 0 = 0 $$</p>



<p class="has-text-align-left">$$ tf-idf (this, d_2, D) = 0.14 \times 0 = 0 $$ </p>



<p>Этот показатель равен нулю, что отражает низкую значимость слова <em>this </em>для обоих документов. Теперь сделаем аналогичный расчет для слова <em>example</em>.</p>



<h5 class="wp-block-heading" id="12-raschet-tf-idf-dlya-slova-example">Расчет tf-idf для слова example</h5>



<p>$$ tf(example, d_1)  =  \frac{0}{5} = 0 $$</p>



<p>$$ tf(example, d_2)  =  \frac{3}{7}  \approx 0.429 $$</p>



<p>$$ idf(example, D) = \log_{10} \left( \frac{2}{1} \right) \approx 0.301 $$</p>



<p>$$ tf-idf (example, d_1, D) = 0 \times 0.301 = 0 $$</p>



<p>$$ tf-idf (example, d_2, D) = 0.429 \times 0.301  \approx 0.129 $$ </p>



<p>В данном случае слово example имеет заметно большее значение для второго документа. Для первого документа его значимость по-прежнему равна нулю (такого слова там нет).</p>



<p class="has-background" style="background-color:#ffe8c4">Логика формулы следующая, чем выше частота слова в документе (tf) и чем реже оно встречается в целом в документах (idf), тем выше общий показатель (tf-idf).</p>



<p>Также замечу, что на практике эти формулы часто модифицируют. Например, к знаменателю формулы расчета idf добавляют единицу, чтобы избежать деления на ноль, если документов с таким токеном не найдется.</p>



<p>$$ idf = \log \left(\frac{всего\spaceдокументов}{документов\spaceс\spaceтокеном + 1}\right) $$</p>



<h4 class="wp-block-heading" id="13-tf-idf-s-pomoshchyu-biblioteki-scikit-learn">TF-IDF с помощью библиотеки Scikit-learn</h4>



<p>Применим этот метод к исходному тексту про Париж и музеи. Вначале последовательно используем классы CountVectorizer и TfidfTransformer.</p>



<h5 class="wp-block-heading" id="14-sposob-1-countvectorizer-tfidftransformer">Способ&nbsp;1.&nbsp;CountVectorizer&nbsp;+&nbsp;TfidfTransformer</h5>



<p><strong>TF </strong>или <strong>частоту слов</strong> можно взять из предыдущего раздела.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8755a955884578" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8755a955884578-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8755a955884578-1"><span class="crayon-v">bow_cv</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87562881382066" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87562881382066-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87562881382066-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87562881382066-1">&lt;4x15 sparse matrix of type '&lt;class 'numpy.int64'&gt;'</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87562881382066-2">&nbsp;&nbsp;&nbsp;&nbsp;with 17 stored elements in Compressed Sparse Row format&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Теперь нужно рассчитать <strong>IDF</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87563505460684" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87563505460684-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-1"><span class="crayon-c"># импортируем TfidfTransformer (CountVectorizer уже импортирован)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">feature_extraction</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">TfidfTransformer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-4"><span class="crayon-c"># создадим объект класса TfidfTransformer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-5"><span class="crayon-v">tfidf_trans</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TfidfTransformer</span><span class="crayon-sy">(</span><span class="crayon-v">smooth_idf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">use_idf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-7"><span class="crayon-c"># и рассчитаем IDF слов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-8"><span class="crayon-v">tfidf_trans</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">bow_cv</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-10"><span class="crayon-c"># поместим результат в датафрейм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87563505460684-11"><span class="crayon-v">df_idf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">tfidf_trans</span><span class="crayon-sy">.</span><span class="crayon-v">idf_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tokens</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">"idf_weights"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p>Остается <strong>TF x IDF</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87564432560987" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87564432560987-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87564432560987-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87564432560987-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87564432560987-1"><span class="crayon-c"># рассчитаем TF-IDF (по сути умножаем TF на IDF)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87564432560987-2"><span class="crayon-v">tf_idf_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfidf_trans</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">bow_cv</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87564432560987-3"><span class="crayon-v">tf_idf_vector</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87565052031281" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87565052031281-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87565052031281-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87565052031281-1">&lt;4x15 sparse matrix of type '&lt;class 'numpy.float64'&gt;'</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87565052031281-2">&nbsp;&nbsp;&nbsp;&nbsp;with 17 stored elements in Compressed Sparse Row format&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Теперь мы можем посмотреть на показатель TF-IDF для конкретного слова в конкретном документе.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87566893326647" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87566893326647-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87566893326647-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87566893326647-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87566893326647-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87566893326647-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87566893326647-1"><span class="crayon-c"># для этого переведем матрицу csr в обычный массив Numpy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87566893326647-2"><span class="crayon-v">df_tfidf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">tf_idf_vector</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">get_feature_names_out</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87566893326647-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87566893326647-4"><span class="crayon-c"># и траспонируем его (запишем столбцы в виде строк) </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87566893326647-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">df_tfidf</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87567102978311" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87567102978311-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-2">art&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.344315&nbsp;&nbsp;0.414289&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-3">enourmous&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.617614</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-4">hours&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.525473&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-5">interested&nbsp;&nbsp;0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.525473&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-6">largest&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-7">lot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-8">louvre&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-9">museum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.344315&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.486934</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-10">museums&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-11">paris&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-12">spent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.525473&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-13">visited&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-14">week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.617614</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-15">went&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87567102978311-16">world&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Всего после обработки метод оставил 15 слов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87569007808058" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87569007808058-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87569007808058-1"><span class="crayon-v">df_tfidf</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8756a933201152" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756a933201152-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756a933201152-1">(15, 4)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Такого же результата можно добиться, применив метод Tfidfvectorizer.</p>



<h5 class="wp-block-heading" id="15-sposob-2-tfidfvectorizer">Способ 2. Tfidfvectorizer</h5>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8756b385167749" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8756b385167749-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-1"><span class="crayon-c"># импортируем класс TfidfVectorizer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-v">feature_extraction</span><span class="crayon-sy">.</span><span class="crayon-e">text </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">TfidfVectorizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-4"><span class="crayon-c"># создаем объект класса TfidfVectorizer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-5"><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TfidfVectorizer</span><span class="crayon-sy">(</span><span class="crayon-v">use_idf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-7"><span class="crayon-c"># сразу рассчитываем TF-IDF слов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8756b385167749-8"><span class="crayon-v">tfIdf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">sentences</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<p>Мы можем посмотреть, какие слова остались после фильтрации.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8756c579989188" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756c579989188-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756c579989188-1"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">get_feature_names_out</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8756d636354685" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756d636354685-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8756d636354685-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756d636354685-1">['art' 'enourmous' 'hours' 'interested' 'largest' 'lot' 'louvre' 'museum'</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8756d636354685-2"> 'museums' 'paris' 'spent' 'visited' 'week' 'went' 'world']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В частности мы видим, что метод Tfidfvectorizer оставил те же слова, что и CountVectorizer и TfidfTransformer. Посмотрим IDF слов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8756e376613845" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756e376613845-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756e376613845-1"><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-v">idf_</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8756f892016593" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756f892016593-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8756f892016593-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8756f892016593-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756f892016593-1">array([1.51082562, 1.91629073, 1.91629073, 1.91629073, 1.91629073,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8756f892016593-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.91629073, 1.91629073, 1.51082562, 1.91629073, 1.91629073,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8756f892016593-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1.91629073, 1.91629073, 1.91629073, 1.91629073, 1.91629073])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Посмотрим на количество документов и количество токенов (слов).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87570545057144" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87570545057144-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87570545057144-1"><span class="crayon-v">tfIdf</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87572025469435" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87572025469435-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87572025469435-1">(4, 15)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Рассчитаем <strong>значение TF-IDF для каждого слова по каждому тексту</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87573764196945" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87573764196945-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87573764196945-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87573764196945-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87573764196945-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87573764196945-1"><span class="crayon-c"># посмотрим на значение TF-IDF для конкретного слова в конкретном документе</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87573764196945-2"><span class="crayon-c"># чем оно уникальнее для конкретного документа, тем выше показатель</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87573764196945-3"><span class="crayon-v">df_tfidf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">tfIdf</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">get_feature_names_out</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87573764196945-4"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">df_tfidf</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87574176877118" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87574176877118-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-1">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-2">art&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.344315&nbsp;&nbsp;0.414289&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-3">enourmous&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.617614</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-4">hours&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.525473&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-5">interested&nbsp;&nbsp;0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.525473&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-6">largest&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-7">lot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-8">louvre&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-9">museum&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.344315&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.486934</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-10">museums&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-11">paris&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-12">spent&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.525473&nbsp;&nbsp;0.000000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-13">visited&nbsp;&nbsp;&nbsp;&nbsp; 0.5&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-14">week&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.617614</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-15">went&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87574176877118-16">world&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0&nbsp;&nbsp;0.436719&nbsp;&nbsp;0.000000&nbsp;&nbsp;0.000000</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>В целом упражнение можно завершить. Однако напомню, что нашей целью было определить тему текста. Для этого мы также можем рассчитать <strong>среднее значение TF-IDF для каждого слова по всем текстам</strong>.</p>



<p id="arr">Вычислим среднее арифметическое по строкам матрицы, приведенной выше (подробное объяснение кода вы найдете в <a href="https://colab.research.google.com/drive/1Qabs4d13EZZPiVZivZ7fAi5ZqfrSTPdA#scrollTo=FbD1jsJ4epdk" target="_blank" rel="noreferrer noopener">блокноте</a>⧉).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87575084486574" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87575084486574-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87575084486574-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87575084486574-1"><span class="crayon-v">mean_weights</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">tfIdf</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">ravel</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">tolist</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87575084486574-2"><span class="crayon-v">mean_weights</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87576646043399" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87576646043399-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-1">[0.18965081782108964,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-2"> 0.15440359274390048,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-3"> 0.13136818731601646,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-4"> 0.13136818731601646,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-5"> 0.10917982746877804,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-6"> 0.125,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-7"> 0.10917982746877804,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-8"> 0.2078121960479979,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-9"> 0.125,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-10"> 0.125,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-11"> 0.13136818731601646,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-12"> 0.125,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-13"> 0.15440359274390048,</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-14"> 0.10917982746877804,</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87576646043399-15"> 0.10917982746877804]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>И создадим датафрейм, отсортировав слова по убыванию средних весов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87577013778828" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87577013778828-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87577013778828-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87577013778828-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87577013778828-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87577013778828-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87577013778828-1"><span class="crayon-c"># создаём датафрейм из словаря</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87577013778828-2"><span class="crayon-v">mean_weights_df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'term'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">get_feature_names_out</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mean_weights'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">mean_weights</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87577013778828-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87577013778828-4"><span class="crayon-c"># сортируем по убыванию 10 слов с максимальным средним TF-IDF</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87577013778828-5"><span class="crayon-v">mean_weights_df</span><span class="crayon-sy">.</span><span class="crayon-e">sort_values</span><span class="crayon-sy">(</span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'mean_weights'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ascending</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reset_index</span><span class="crayon-sy">(</span><span class="crayon-v">drop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img decoding="async" width="355" height="553" src="../../wp-content/uploads/2021/09/result-df.jpg" alt="веса модели TF-IDF через Tfidfvectorizer" class="wp-image-5015" style="width:274px;height:auto" srcset="../../wp-content/uploads/2021/09/result-df.jpg 355w, ../../wp-content/uploads/2021/09/result-df-193x300.jpg 193w" sizes="(max-width: 355px) 100vw, 355px" /></figure>



<h3 class="wp-block-heading" id="16-rezultaty">Результаты</h3>



<p>Как мы видим, ни один из алгоритмов не справился со своей задачей на отлично. Отчасти это связано с ограничениями самих методов, отчасти с тем, что мы взяли очень небольшой текст для анализа.</p>



<p>При этом несмотря на неидеальный результат, мы добились, как уже было сказано, <strong>векторизации текста</strong>, то есть описания его с помощью чисел.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="796" src="../../wp-content/uploads/2021/09/vector-model-1024x796.jpg" alt="векторизация текста" class="wp-image-4831" style="width:592px;height:auto" srcset="../../wp-content/uploads/2021/09/vector-model-1024x796.jpg 1024w, ../../wp-content/uploads/2021/09/vector-model-300x233.jpg 300w, ../../wp-content/uploads/2021/09/vector-model-768x597.jpg 768w, ../../wp-content/uploads/2021/09/vector-model-1536x1194.jpg 1536w, ../../wp-content/uploads/2021/09/vector-model-1200x933.jpg 1200w, ../../wp-content/uploads/2021/09/vector-model-600x466.jpg 600w, ../../wp-content/uploads/2021/09/vector-model.jpg 1781w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<h3 class="wp-block-heading" id="17-dopolnitelnye-primery">Дополнительные примеры</h3>



<p>Прежде чем завершить, приведем два примера применения текстовых векторов.</p>



<h4 class="wp-block-heading" id="18-kosinusnoe-rasstoyanie-mezhdu-tekstovymi-vektorami">Косинусное расстояние между текстовыми векторами</h4>



<p>Возьмем два предложения и объединим их в корпус.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87579257177186" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87579257177186-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87579257177186-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87579257177186-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87579257177186-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87579257177186-1"><span class="crayon-v">text1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'all the world’s a stage, and all the men and women merely players'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87579257177186-2"><span class="crayon-v">text2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'you must be the change you wish to see in the world'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87579257177186-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87579257177186-4"><span class="crayon-v">corpus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">text1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text2</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Создадим объект класса TfidfVectorizer и рассчитаем веса tf-idf.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8757a579697564" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757a579697564-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-1"><span class="crayon-c"># создадим объект класса TfidfVectorizer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-2"><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TfidfVectorizer</span><span class="crayon-sy">(</span><span class="crayon-v">use_idf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-4"><span class="crayon-c"># на выходе получаем два вектора, где каждое значение - это вес (показатель tf-idf) слова</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-5"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">corpus</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-7"><span class="crayon-c"># преобразуем данные в массив Numpy</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757a579697564-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8757c989048221" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757c989048221-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757c989048221-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757c989048221-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757c989048221-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757c989048221-1">[[0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.4261596&nbsp;&nbsp;0.4261596&nbsp;&nbsp;0.4261596&nbsp;&nbsp;0.4261596&nbsp;&nbsp;0.</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757c989048221-2">&nbsp;&nbsp;0.4261596&nbsp;&nbsp;0.30321606]</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757c989048221-3"> [0.6316672&nbsp;&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.6316672</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757c989048221-4">&nbsp;&nbsp;0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.44943642]]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Для удобства, мы можем преобразовать данные в датафрейм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8757d346657343" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757d346657343-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757d346657343-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757d346657343-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757d346657343-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757d346657343-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757d346657343-1"><span class="crayon-c"># данными станут веса ti-idf, индексом - список векторов, столбцами - токены</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757d346657343-2"><span class="crayon-v">vectors_df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757d346657343-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'vector1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'vector2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757d346657343-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">get_feature_names_out</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757d346657343-5"><span class="crayon-v">vectors_df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="922" height="140" src="../../wp-content/uploads/2021/12/angle_tvec.jpg" alt="текстовые вектора для расчета косинусного расстояния" class="wp-image-8239" srcset="../../wp-content/uploads/2021/12/angle_tvec.jpg 922w, ../../wp-content/uploads/2021/12/angle_tvec-300x46.jpg 300w, ../../wp-content/uploads/2021/12/angle_tvec-768x117.jpg 768w, ../../wp-content/uploads/2021/12/angle_tvec-600x91.jpg 600w" sizes="auto, (max-width: 922px) 100vw, 922px" /></figure>



<p>Вектора готовы. Напомню формулу расчета косинусного расстояния.</p>



<p>$$&nbsp;\cos \theta&nbsp;={\mathbf&nbsp;{a}&nbsp;\cdot&nbsp;\mathbf&nbsp;{b}&nbsp;\over&nbsp;\|\mathbf&nbsp;{a}&nbsp;\|\|\mathbf&nbsp;{b}&nbsp;\|}&nbsp;$$</p>



<p>Теперь поместим каждый вектор в отдельную переменную.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8757e381443383" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757e381443383-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757e381443383-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757e381443383-1"><span class="crayon-v">vector1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757e381443383-2"><span class="crayon-v">vector2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">toarray</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Выполним операции в числителе формулы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8757f769342755" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8757f769342755-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8757f769342755-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8757f769342755-1"><span class="crayon-c"># рассчитаем скалярное произведение векторов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8757f769342755-2"><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">vector1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vector2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Займемся знаменателем.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87581940835773" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87581940835773-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87581940835773-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87581940835773-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87581940835773-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87581940835773-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87581940835773-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87581940835773-1"><span class="crayon-c"># (1) рассчитаем длины (по большому счету, это теорема Пифагора)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87581940835773-2"><span class="crayon-v">vector1Len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">vector1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87581940835773-3"><span class="crayon-v">vector2Len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">vector2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87581940835773-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87581940835773-5"><span class="crayon-c"># (2) перемножим их</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87581940835773-6"><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vector1Len</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">vector2Len</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Остается рассчитать косинус угла.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87582930611297" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87582930611297-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87582930611297-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87582930611297-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87582930611297-1"><span class="crayon-c"># посмотрим, чему равен косинус угла между векторами</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87582930611297-2"><span class="crayon-v">cosine</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-o">/</span><span class="crayon-e">denominator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87582930611297-3"><span class="crayon-v">cosine</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87583017657138" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87583017657138-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87583017657138-1">0.13627634143908643</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>И после этого перевести его в радианы, а затем в градусы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87584083227055" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87584083227055-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-1"><span class="crayon-c"># найдем угол в градусах по его косинусу</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-2"><span class="crayon-c"># для этого вначале вычислим угол в радианах</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-3"><span class="crayon-v">angle_radians</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arccos</span><span class="crayon-sy">(</span><span class="crayon-v">cosine</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-5"><span class="crayon-c"># затем в градусах</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-6"><span class="crayon-v">angle_degrees</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">angle_radians</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">360</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-o">/</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">pi</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87584083227055-7"><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-v">angle_degrees</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87585487287109" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87585487287109-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87585487287109-1">82.17</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="19-klasternyy-analiz-teksta">Кластерный анализ текста</h4>



<p>Теперь давайте посмотрим, как можно разделить предложения в тексте на темы (кластеры). Возьмем текст с предложениями из Википедии, посвященными науке о данных и Большому театру.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87586479212225" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87586479212225-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-1"><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'''</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-2"><span class="crayon-s">Data science is an interdisciplinary field that uses scientific methods, processes, algorithms and systems to extract knowledge and insights from noisy, structured and unstructured data.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-3"><span class="crayon-s">It applies knowledge and actionable insights from data across a broad range of application domains.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-4"><span class="crayon-s">Data science is related to data mining, machine learning and big data.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-5"><span class="crayon-s">The Bolshoi Theatre is a historic theatre in Moscow, Russia.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-6"><span class="crayon-s">It was originally designed by architect Joseph Bové, which holds ballet and opera performances.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-7"><span class="crayon-s">Before the October Revolution it was a part of the Imperial Theatres of the Russian Empire along with Maly Theatre in Moscow and a few theatres in Saint Petersburg.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-8"><span class="crayon-s">Data science is a concept to unify statistics, data analysis, informatics, and their related methods in order to understand and analyze actual phenomena with data.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-9"><span class="crayon-s">However, data science is different from computer science and information science.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-10"><span class="crayon-s">The main building of the theatre, rebuilt and renovated several times during its history, is a landmark of Moscow and Russia.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-11"><span class="crayon-s">On 28 October 2011, the Bolshoi re-opened after an extensive six-year renovation.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87586479212225-12"><span class="crayon-s">'''</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Разобьем текст на преложения и переведем в нижний регистр.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87587089688407" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87587089688407-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-1"><span class="crayon-c"># создадим список из предложений</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-2"><span class="crayon-v">corpus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-4"><span class="crayon-c"># для этого в цикле for пройдемся по тексту, разделив его по символу новой строки \n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">line </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">'\n'</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># если строка не пустая (т.е. True)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># переводим ее в нижний регистр</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">line</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">line</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># и добавляем в список</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">corpus</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">line</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87587089688407-15"><span class="crayon-v">corpus</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f87589940027975" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f87589940027975-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-1">['data science is an interdisciplinary field that uses scientific methods, processes, algorithms and systems to extract knowledge and insights from noisy, structured and unstructured data.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-2"> 'it applies knowledge and actionable insights from data across a broad range of application domains.',</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-3"> 'data science is related to data mining, machine learning and big data.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-4"> 'the bolshoi theatre is a historic theatre in moscow, russia.',</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-5"> 'it was originally designed by architect joseph bové, which holds ballet and opera performances.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-6"> 'before the october revolution it was a part of the imperial theatres of the russian empire along with maly theatre in moscow and a few theatres in saint petersburg.',</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-7"> 'data science is a concept to unify statistics, data analysis, informatics, and their related methods in order to understand and analyze actual phenomena with data.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-8"> 'however, data science is different from computer science and information science.',</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-9"> 'the main building of the theatre, rebuilt and renovated several times during its history, is a landmark of moscow and russia.',</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f87589940027975-10"> 'on 28 october 2011, the bolshoi re-opened after an extensive six-year renovation.']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Создадим векторы каждого из предложений.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8758a292082354" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758a292082354-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758a292082354-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758a292082354-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758a292082354-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758a292082354-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758a292082354-1"><span class="crayon-c"># применим TfidfVectorizer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758a292082354-2"><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">TfidfVectorizer</span><span class="crayon-sy">(</span><span class="crayon-v">use_idf</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">stop_words</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'english'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758a292082354-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758a292082354-4"><span class="crayon-c"># на выходе получаем векторы предложений</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758a292082354-5"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">corpus</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Применим <a href="../clustering/index.html">алгоритм k-средних</a> и разделим предложения на кластеры.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8758b968175761" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758b968175761-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758b968175761-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758b968175761-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758b968175761-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758b968175761-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758b968175761-1"><span class="crayon-c"># импортируем алгоритм k-средних из библиотеки sklearn</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758b968175761-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">cluster </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">KMeans</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758b968175761-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758b968175761-4"><span class="crayon-c"># так как мы знаем, что темы две, используем гиперпараметр k = 2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758b968175761-5"><span class="crayon-v">kmeans</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KMeans</span><span class="crayon-sy">(</span><span class="crayon-v">n_clusters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_init</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Как результат, мы создали две модели:</p>



<ul class="wp-block-list">
<li>модель векторизации через tfIdfVectorizer;</li>



<li>модель кластеризации.</li>
</ul>



<p>Возьмем новые предложения и с помощью обученных моделей разобьем их на кластеры.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8758c547163229" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa623f8758c547163229-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-1"><span class="crayon-c"># первое предложение из области Data Science, два других - про Большой театр</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-2"><span class="crayon-v">prediction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Many statisticians, including Nate Silver, have argued that data science is not a new field, but rather another name for statistics.'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Urusov set up the theatre in collaboration with English tightrope walker Michael Maddox.'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'Until the mid-1990s, most foreign operas were sung in Russian, but Italian and other languages have been heard more frequently on the Bolshoi stage in recent years.'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-6"><span class="crayon-c"># применим две модели, сначала создадим векторы новых предложений (tfIdfVectorizer.transform),</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-7"><span class="crayon-c"># затем отнесем их к одному из кластеров (kmeans.predict)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa623f8758c547163229-8"><span class="crayon-v">kmeans</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">tfIdfVectorizer</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">prediction</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa623f8758e990779408" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa623f8758e990779408-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa623f8758e990779408-1">array([0, 1, 1], dtype=int32)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как мы видим, первое предложение отнесено к одному кластеру, второе и третье &#8212; к другому.</p>



<h3 class="wp-block-heading" id="20-podvedem-itog">Подведем итог</h3>



<p>Сегодня мы впервые поработали с текстами. В частности, научились предварительно обрабатывать их и анализировать содержание. Для этого мы использовали метод мешка слов и метод TF-IDF. Второй метод позволил превратить предложения в числа или векторизовать их.</p>



<p>Благодаря векторизации предложений, мы смогли рассчитать косинусное сходство между двумя документами и провести кластерный анализ.</p>



<h4 class="wp-block-heading" id="22-otvety-na-voprosy">Ответы на вопросы</h4>



<p><strong>Вопрос</strong>. Имеет ли значение какое основание логарифма использовать в формуле TF-IDF?</p>



<p><strong>Ответ</strong>. Нет, не имеет, основание может быть любым. В формуле выше используется десятичный логарифм, sklearn использует натуральный.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Во втором дополнительном примере, откуда мы знаем, что кластеров должно быть два (в алгоритме k-means)?</p>



<p><strong>Ответ</strong>. В данном случае, мы либо заранее знаем, что темы две, и нужно научить алгоритм разделять тексты на эти два кластера, либо попробовать <a href="../clustering/index.html">метод локтя</a>, как мы это делали на занятии по кластеризации.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Зачем мы применили <strong>.ravel()</strong> к массиву при работе с TfidfVectorizer (способ 2)? То есть зачем убирали второе измерение?</p>



<p><strong>Ответ</strong>. Мы это сделали, чтобы затем корректно сработала функция <strong>tolist()</strong>. Если не использовать <strong>.ravel()</strong>, то применив только <strong>tolist()</strong> мы получим вложенные списки 
			<span id="urvanov-syntax-highlighter-67aa623f8758f260509106" class="urvanov-syntax-highlighter-syntax urvanov-syntax-highlighter-syntax-inline  crayon-theme-familiar-my-copy crayon-theme-familiar-my-copy-inline urvanov-syntax-highlighter-font-consolas" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important;"><span class="crayon-pre urvanov-syntax-highlighter-code" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-v">some_list</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></span></span>, а нам нужен обычный список 
			<span id="urvanov-syntax-highlighter-67aa623f87591379382666" class="urvanov-syntax-highlighter-syntax urvanov-syntax-highlighter-syntax-inline  crayon-theme-familiar-my-copy crayon-theme-familiar-my-copy-inline urvanov-syntax-highlighter-font-consolas" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important;"><span class="crayon-pre urvanov-syntax-highlighter-code" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-sy">[</span><span class="crayon-v">some_list</span><span class="crayon-sy">]</span></span></span>.</p>



<p>Попробуйте в качестве эксперимента обойтись без <strong>.ravel()</strong>.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"intro\\\/topic-identification\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
