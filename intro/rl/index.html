<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v26.8 - https://yoast.com/product/yoast-seo-wordpress/ -->
	<title>Обучение с подкреплением</title>
	<meta name="description" content="Обучение с подкреплением позволяет агенту эффективно взаимодействовать со средой на основе вознаграждения за совершаемые им действия." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Обучение с подкреплением" />
	<meta property="og:description" content="Обучение с подкреплением позволяет агенту эффективно взаимодействовать со средой на основе вознаграждения за совершаемые им действия." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/intro/rl/" />
	<meta property="og:site_name" content="Дмитрий Макаров" />
	<meta property="article:modified_time" content="2025-10-08T06:55:02+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2025/09/frozen_lake_initial.png" />
	<meta property="og:image:width" content="256" />
	<meta property="og:image:height" content="256" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="7 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/intro/rl/","url":"https://www.dmitrymakarov.ru/intro/rl/","name":"Обучение с подкреплением","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/intro/rl/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/intro/rl/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/09/frozen_lake_initial.png","datePublished":"2025-10-07T19:09:10+00:00","dateModified":"2025-10-08T06:55:02+00:00","description":"Обучение с подкреплением позволяет агенту эффективно взаимодействовать со средой на основе вознаграждения за совершаемые им действия.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/intro/rl/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/intro/rl/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/intro/rl/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/09/frozen_lake_initial.png","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/09/frozen_lake_initial.png","width":256,"height":256},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/intro/rl/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Вводный курс","item":"https://www.dmitrymakarov.ru/intro/"},{"@type":"ListItem","position":3,"name":"Обучение с подкреплением"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/17fb646123c8fccd118e1f2da611da3de8d8e72250637fb08b246e33d4c95395?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/17fb646123c8fccd118e1f2da611da3de8d8e72250637fb08b246e33d4c95395?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Дмитрий Макаров &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Дмитрий Макаров &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<style id='wp-img-auto-sizes-contain-inline-css' type='text/css'>
img:is([sizes=auto i],[sizes^="auto," i]){contain-intrinsic-size:3000px 1500px}
/*# sourceURL=wp-img-auto-sizes-contain-inline-css */
</style>

<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.9.0.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.9.0.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.9.0.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
/*# sourceURL=wp-emoji-styles-inline-css */
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.9.css' type='text/css' media='all' />
<style id='wp-block-heading-inline-css' type='text/css'>
h1:where(.wp-block-heading).has-background,h2:where(.wp-block-heading).has-background,h3:where(.wp-block-heading).has-background,h4:where(.wp-block-heading).has-background,h5:where(.wp-block-heading).has-background,h6:where(.wp-block-heading).has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/heading/style.min.css */
</style>
<style id='wp-block-image-inline-css' type='text/css'>
.wp-block-image>a,.wp-block-image>figure>a{display:inline-block}.wp-block-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom}@media not (prefers-reduced-motion){.wp-block-image img.hide{visibility:hidden}.wp-block-image img.show{animation:show-content-image .4s}}.wp-block-image[style*=border-radius] img,.wp-block-image[style*=border-radius]>a{border-radius:inherit}.wp-block-image.has-custom-border img{box-sizing:border-box}.wp-block-image.aligncenter{text-align:center}.wp-block-image.alignfull>a,.wp-block-image.alignwide>a{width:100%}.wp-block-image.alignfull img,.wp-block-image.alignwide img{height:auto;width:100%}.wp-block-image .aligncenter,.wp-block-image .alignleft,.wp-block-image .alignright,.wp-block-image.aligncenter,.wp-block-image.alignleft,.wp-block-image.alignright{display:table}.wp-block-image .aligncenter>figcaption,.wp-block-image .alignleft>figcaption,.wp-block-image .alignright>figcaption,.wp-block-image.aligncenter>figcaption,.wp-block-image.alignleft>figcaption,.wp-block-image.alignright>figcaption{caption-side:bottom;display:table-caption}.wp-block-image .alignleft{float:left;margin:.5em 1em .5em 0}.wp-block-image .alignright{float:right;margin:.5em 0 .5em 1em}.wp-block-image .aligncenter{margin-left:auto;margin-right:auto}.wp-block-image :where(figcaption){margin-bottom:1em;margin-top:.5em}.wp-block-image.is-style-circle-mask img{border-radius:9999px}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}:root :where(.wp-block-image.is-style-rounded img,.wp-block-image .is-style-rounded img){border-radius:9999px}.wp-block-image figure{margin:0}.wp-lightbox-container{display:flex;flex-direction:column;position:relative}.wp-lightbox-container img{cursor:zoom-in}.wp-lightbox-container img:hover+button{opacity:1}.wp-lightbox-container button{align-items:center;backdrop-filter:blur(16px) saturate(180%);background-color:#5a5a5a40;border:none;border-radius:4px;cursor:zoom-in;display:flex;height:20px;justify-content:center;opacity:0;padding:0;position:absolute;right:16px;text-align:center;top:16px;width:20px;z-index:100}@media not (prefers-reduced-motion){.wp-lightbox-container button{transition:opacity .2s ease}}.wp-lightbox-container button:focus-visible{outline:3px auto #5a5a5a40;outline:3px auto -webkit-focus-ring-color;outline-offset:3px}.wp-lightbox-container button:hover{cursor:pointer;opacity:1}.wp-lightbox-container button:focus{opacity:1}.wp-lightbox-container button:focus,.wp-lightbox-container button:hover,.wp-lightbox-container button:not(:hover):not(:active):not(.has-background){background-color:#5a5a5a40;border:none}.wp-lightbox-overlay{box-sizing:border-box;cursor:zoom-out;height:100vh;left:0;overflow:hidden;position:fixed;top:0;visibility:hidden;width:100%;z-index:100000}.wp-lightbox-overlay .close-button{align-items:center;cursor:pointer;display:flex;justify-content:center;min-height:40px;min-width:40px;padding:0;position:absolute;right:calc(env(safe-area-inset-right) + 16px);top:calc(env(safe-area-inset-top) + 16px);z-index:5000000}.wp-lightbox-overlay .close-button:focus,.wp-lightbox-overlay .close-button:hover,.wp-lightbox-overlay .close-button:not(:hover):not(:active):not(.has-background){background:none;border:none}.wp-lightbox-overlay .lightbox-image-container{height:var(--wp--lightbox-container-height);left:50%;overflow:hidden;position:absolute;top:50%;transform:translate(-50%,-50%);transform-origin:top left;width:var(--wp--lightbox-container-width);z-index:9999999999}.wp-lightbox-overlay .wp-block-image{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin:0;position:relative;transform-origin:0 0;width:100%;z-index:3000000}.wp-lightbox-overlay .wp-block-image img{height:var(--wp--lightbox-image-height);min-height:var(--wp--lightbox-image-height);min-width:var(--wp--lightbox-image-width);width:var(--wp--lightbox-image-width)}.wp-lightbox-overlay .wp-block-image figcaption{display:none}.wp-lightbox-overlay button{background:none;border:none}.wp-lightbox-overlay .scrim{background-color:#fff;height:100%;opacity:.9;position:absolute;width:100%;z-index:2000000}.wp-lightbox-overlay.active{visibility:visible}@media not (prefers-reduced-motion){.wp-lightbox-overlay.active{animation:turn-on-visibility .25s both}.wp-lightbox-overlay.active img{animation:turn-on-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active){animation:turn-off-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active) img{animation:turn-off-visibility .25s both}.wp-lightbox-overlay.zoom.active{animation:none;opacity:1;visibility:visible}.wp-lightbox-overlay.zoom.active .lightbox-image-container{animation:lightbox-zoom-in .4s}.wp-lightbox-overlay.zoom.active .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.active .scrim{animation:turn-on-visibility .4s forwards}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active){animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container{animation:lightbox-zoom-out .4s}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .scrim{animation:turn-off-visibility .4s forwards}}@keyframes show-content-image{0%{visibility:hidden}99%{visibility:hidden}to{visibility:visible}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale))}to{transform:translate(-50%,-50%) scale(1)}}@keyframes lightbox-zoom-out{0%{transform:translate(-50%,-50%) scale(1);visibility:visible}99%{visibility:visible}to{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale));visibility:hidden}}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/image/style.min.css */
</style>
<style id='wp-block-list-inline-css' type='text/css'>
ol,ul{box-sizing:border-box}:root :where(.wp-block-list.has-background){padding:1.25em 2.375em}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/list/style.min.css */
</style>
<style id='wp-block-paragraph-inline-css' type='text/css'>
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}:root :where(p.has-background){padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/paragraph/style.min.css */
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgb(6,147,227) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgb(252,185,0) 0%,rgb(255,105,0) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgb(255,105,0) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgb(255, 255, 255), 6px 6px rgb(0, 0, 0);--wp--preset--shadow--crisp: 6px 6px 0px rgb(0, 0, 0);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
/*# sourceURL=global-styles-inline-css */
</style>

<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
/*# sourceURL=/wp-includes/css/classic-themes.min.css */
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.9.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.9.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.9.0","is_admin":"0","ajaxurl":"https://www.dmitrymakarov.ru/wp-admin/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
//# sourceURL=urvanov_syntax_highlighter_js-js-extra
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.9.0" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="wp-singular page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-42408 page-child parent-pageid-202 custom-background wp-theme-mcluhan full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
		

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

					<li id="menu-item-36690" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-36690"><a href="../../index.html">Материалы</a></li>

				</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
				<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-36690"><a href="../../index.html">Материалы</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36691"><a href="../../about/index.html">Об авторе</a></li>
					<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-697701d5bfa34">Поиск:</label>
	<input type="search" id="search-form-697701d5bfa34" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-697701d5bfaa2">Поиск:</label>
	<input type="search" id="search-form-697701d5bfaa2" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-42408 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Обучение с подкреплением</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Вводный курс</a></p>



<p>Рассмотрим иной тип задач, в котором у нас нет подготовленного набора данных, но есть действующее лицо или <strong>агент</strong> (agent), а также <strong>среда</strong> (environment), в которой этот агент выполняет определенные <strong>действия</strong> (actions) для достижения <strong>цели</strong> (goal).</p>



<p>В процессе обучения мы поощряем или подкрепляем (reinforce) те действия агента, которые приводят к получению <strong>вознаграждения</strong> (reward) и, как следствие, достижению поставленной цели.</p>



<p>Такой тип обучения называется <strong>обучением с подкреплением</strong> (reinforcement learning, RL).</p>



<h3 class="wp-block-heading">Игра &#171;Замерзшее озеро&#187;</h3>



<p>Поиграем в игру под названием &#171;Замерзшее озеро&#187; (Frozen Lake). В этой игре агент, перемещаясь по льду, должен дойти из стартового положения до цели и не провалиться под лед.</p>



<p>Обучать агента <a href="https://gymnasium.farama.org/environments/toy_text/frozen_lake/" target="_blank" rel="noreferrer noopener">этой игре</a>⧉ мы будем с помощью библиотеки <strong>gymnasium</strong>.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/1JmbRyh74F22u0Smqm5v8-GmrE3W4dr_b?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b751f381368694" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b751f381368694-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b751f381368694-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">gymnasium </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">gym</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<h4 class="wp-block-heading">Создание среды</h4>



<p>Вначале создадим среду с помощью функции <strong>make()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b752a982322804" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b752a982322804-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b752a982322804-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b752a982322804-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b752a982322804-1"><span class="crayon-v">environment</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gym</span><span class="crayon-sy">.</span><span class="crayon-e">make</span><span class="crayon-sy">(</span><span class="crayon-s">'FrozenLake-v1'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b752a982322804-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">is_slippery</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b752a982322804-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">render_mode</span><span class="crayon-o">=</span><span class="crayon-s">'rgb_array'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Параметр render_mode со значением &#8216;rgb_array&#8217; позволяет вывести среду в виде цветного изображения. К рассмотрению параметра is_slippery вернемся чуть позже.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b752d771940367" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b752d771940367-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b752d771940367-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b752d771940367-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b752d771940367-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b752d771940367-1"><span class="crayon-c"># переведем игру в начальное состояние и</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b752d771940367-2"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b752d771940367-3"><span class="crayon-c"># визуализируем среду</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b752d771940367-4"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img fetchpriority="high" decoding="async" width="256" height="256" src="../../wp-content/uploads/2025/09/frozen_lake_initial.png" alt="обучение с подкреплением: игра &quot;Замерзшее озеро&quot;" class="wp-image-42438" srcset="../../wp-content/uploads/2025/09/frozen_lake_initial.png 256w, ../../wp-content/uploads/2025/09/frozen_lake_initial-150x150.png 150w" sizes="(max-width: 256px) 100vw, 256px" /></figure>



<p>В начальном положении агент находится в левом верхнем углу, цель &#8212; в нижнем правом. Игра прекращается, если агент попал под лед (синие кружочки) или дошел до цели.</p>



<p>Каждая попытка преодолеть среду называется <strong>эпизодом</strong> (episode).</p>



<h4 class="wp-block-heading">Действия и состояния</h4>



<p><strong>Пространство действий</strong>. В каждый момент времени (на каждом ходу) агент может двигаться влево (0), вниз (1), вправо (2) или вверх (3).</p>



<p>Вместе эти четыре дискретных действия образуют <strong>пространство действий</strong> (action space).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7530370372825" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7530370372825-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7530370372825-1"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7533718717110" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7533718717110-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7533718717110-1">Discrete(4)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7536420440456" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7536420440456-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7536420440456-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7536420440456-1"><span class="crayon-v">n_actions</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7536420440456-2"><span class="crayon-v">n_actions</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7539165742206" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7539165742206-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7539165742206-1">np.int64(4)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Случайное действие можно выбрать с помощью метода <strong>.sample()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b753b354747552" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b753b354747552-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b753b354747552-1"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b753e986118881" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b753e986118881-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b753e986118881-1">np.int64(1)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В частности, действие 1 означает, что агент сместится вниз.</p>



<p>Примечание. Для наглядности заметим, что одним из правильных путей до цели будет последовательность действий</p>



<p>$$ \big[ \; 2, 2, 1, 1, 1, 2 \; \big] $$</p>



<p><strong>Пространство состояний</strong>. При этом агент может находиться в одной из шестнадцати клеток или дискретных <strong>состояний</strong> (states).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7541776950002" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7541776950002-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7541776950002-1"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7544106816368" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7544106816368-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7544106816368-1">Discrete(16)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7546619365022" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7546619365022-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7546619365022-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7546619365022-1"><span class="crayon-v">n_states</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7546619365022-2"><span class="crayon-v">n_states</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7549441113723" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7549441113723-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7549441113723-1">np.int64(16)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p><strong>Координаты и состояния</strong>. Координаты клеток связаны со значением состояния через формулу</p>



<p>$$ \text{состояние} = \text{строка} \times \text{количество строк} + \text{столбец} $$</p>



<p>при условии, что отсчет ведется с нуля. Например, начальное состояние с координатами $[0,0]$ равно нулю, $0 \times 4 + 0 = 0.$ Состояние цели с координатами $[3,3]$ соответствует $3 \times 4 + 3 = 15.$</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img decoding="async" width="980" height="836" src="../../wp-content/uploads/2025/09/coordinates.jpg" alt="координаты и состояния среды" class="wp-image-42502" style="width:328px;height:auto" srcset="../../wp-content/uploads/2025/09/coordinates.jpg 980w, ../../wp-content/uploads/2025/09/coordinates-300x256.jpg 300w, ../../wp-content/uploads/2025/09/coordinates-768x655.jpg 768w, ../../wp-content/uploads/2025/09/coordinates-600x512.jpg 600w" sizes="(max-width: 980px) 100vw, 980px" /></figure>
</div>


<p><strong>Q-таблица</strong>. Таким образом, если мы хотим однозначно указать агенту, какое из четырех действий ему следует выполнить, находясь в одном из шестнадцати состояний, то должны составить таблицу $16 \times 4,$ где каждая строка &#8212; это состояние, а каждый столбец &#8212; действие.</p>



<p>Такую таблицу принято называть <strong>Q-таблицей</strong> (Q-table), где Q означает quality и подразумевает качество или полезность совершаемого в каждом состоянии действия.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b754c990132652" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754c990132652-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754c990132652-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754c990132652-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754c990132652-1"><span class="crayon-c"># (строки x столбцы) = (состояния x действия) = (16 x 4)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754c990132652-2"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">n_states</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n_actions</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754c990132652-3"><span class="crayon-v">qtable</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b754f673782462" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b754f673782462-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-1">array([[0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b754f673782462-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Например, первая строка такой таблицы (то есть начальное состояние) показывает, в каком из четырех направлений следует двигаться агенту.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7555197097665" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7555197097665-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7555197097665-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7555197097665-1"><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7555197097665-2"><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7558210803406" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7558210803406-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7558210803406-1">array([0., 0., 0., 0.])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Перед началом обучения агент ничего не знает о среде, поэтому значения таблицы заполнены нулями.</p>



<p>Также заметим, что функция <strong>reset()</strong> возвращает значение начального состояния.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b755a087199343" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b755a087199343-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b755a087199343-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b755a087199343-1"><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b755a087199343-2"><span class="crayon-v">state</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b755d376088086" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b755d376088086-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b755d376088086-1">'0'</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p><strong>Q-значение</strong>. Каждое значение таблицы называется парой &#171;состояние-действие&#187; (state-value pair) или Q-значением (Q-value) и обозначается $Q(s,a).$ В нашем случае,</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img decoding="async" width="1024" height="900" src="../../wp-content/uploads/2025/10/qvalues-1024x900.jpg" alt="Q-таблица" class="wp-image-42542" style="width:344px;height:auto" srcset="../../wp-content/uploads/2025/10/qvalues-1024x900.jpg 1024w, ../../wp-content/uploads/2025/10/qvalues-300x264.jpg 300w, ../../wp-content/uploads/2025/10/qvalues-768x675.jpg 768w, ../../wp-content/uploads/2025/10/qvalues-600x527.jpg 600w, ../../wp-content/uploads/2025/10/qvalues.jpg 1108w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Кроме этого, пусть $Q(s_t, a_t)$ указывает на Q-значение на шаге $t.$ Тогда, $Q(s_{t+1})$ будет обозначать те Q-значения, к которым мы перейдем, выполнив действие $a_t$ из состояния $s_t.$</p>



<p>Приведем пример. Пусть на шаге $t$ мы находимся в состоянии $s=1$ и собираемся выполнить действие $a=3.$</p>



<p>Если известно (исходя из описания среды), что такая пара &#171;состояние-действие&#187; приведет нас в состояние $s=3,$ то Q-значения этого состояния и будут обозначаться через $Q(s_{t+1}).$</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="577" src="../../wp-content/uploads/2025/10/qvalues_steps-1024x577.jpg" alt="переход из одного состояния в другое" class="wp-image-42546" style="width:438px;height:auto" srcset="../../wp-content/uploads/2025/10/qvalues_steps-1024x577.jpg 1024w, ../../wp-content/uploads/2025/10/qvalues_steps-300x169.jpg 300w, ../../wp-content/uploads/2025/10/qvalues_steps-768x432.jpg 768w, ../../wp-content/uploads/2025/10/qvalues_steps-1200x676.jpg 1200w, ../../wp-content/uploads/2025/10/qvalues_steps-600x338.jpg 600w, ../../wp-content/uploads/2025/10/qvalues_steps.jpg 1458w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<h4 class="wp-block-heading">Шаги и вознаграждения</h4>



<p><strong>Шаги</strong>. Функция <strong>step()</strong> позволяет делать шаги в созданной среде.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7560623817915" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7560623817915-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7560623817915-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7560623817915-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7560623817915-1"><span class="crayon-c"># сделаем шаг вправо</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7560623817915-2"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7560623817915-3"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="256" height="256" src="../../wp-content/uploads/2025/09/step_right.png" alt="шаги агента" class="wp-image-42475" srcset="../../wp-content/uploads/2025/09/step_right.png 256w, ../../wp-content/uploads/2025/09/step_right-150x150.png 150w" sizes="auto, (max-width: 256px) 100vw, 256px" /></figure>



<p>Более того, эта функция среди прочего возвращает значение нового состояния, вознаграждение, а также логическое значение прекращения игры при достижении цели или попадании под лед.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b756b801044902" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b756b801044902-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-1"><span class="crayon-c"># теперь сделаем шаг вниз</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-2"><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-3"><span class="crayon-c"># нас будут интересовать три возвращаемых значения функции step():</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-4"><span class="crayon-c"># новое состояние, вознаграждение и факт завершения эпизода</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-5"><span class="crayon-c"># другие значения *_ мы в данном случае использовать не будем</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-6"><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b756b801044902-7"><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b756e148258734" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b756e148258734-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b756e148258734-1">(5, 0.0, True)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>После второго шага мы оказываемся в состоянии 5, вознаграждение при переходе в это состояние равно нулю, и кроме того эпизод завершается, поскольку мы проваливаемся под лед.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7570152797626" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7570152797626-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7570152797626-1"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">render</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="256" height="256" src="../../wp-content/uploads/2025/09/step_down.png" alt="окончание эпизода" class="wp-image-42480" srcset="../../wp-content/uploads/2025/09/step_down.png 256w, ../../wp-content/uploads/2025/09/step_down-150x150.png 150w" sizes="auto, (max-width: 256px) 100vw, 256px" /></figure>



<p><strong>Вознаграждение</strong>. В игре &#171;Замерзшее озеро&#187; поле цели имеет вознаграждение $R=1.$ Вознагражение за начальное состояние, а также за переходы на остальные поля равно $R=0.$</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img loading="lazy" decoding="async" width="739" height="633" src="../../wp-content/uploads/2025/09/rewards.jpg" alt="вознаграждение" class="wp-image-42505" style="width:237px;height:auto" srcset="../../wp-content/uploads/2025/09/rewards.jpg 739w, ../../wp-content/uploads/2025/09/rewards-300x257.jpg 300w, ../../wp-content/uploads/2025/09/rewards-600x514.jpg 600w" sizes="auto, (max-width: 739px) 100vw, 739px" /></figure>
</div>


<p>Ключевой вопрос заключается в том, как заполнить таблицу состояний и действий ненулевыми значениями.</p>



<h3 class="wp-block-heading">Q-обучение</h3>



<h4 class="wp-block-heading">Заполнение таблицы</h4>



<p><strong>Обучение эпизодами</strong>. Обучение будет проходить в течение заданного количества эпизодов. В рамках каждого эпизода агент будет совершать действия до тех пор, пока не провалится под лед или не достигнет цели.</p>



<p>Технически мы будем использовать два вложенных цикла:</p>



<ul class="wp-block-list">
<li>внешний цикл for для эпизодов; и </li>



<li>внутренний while для попыток дойти до цели.</li>
</ul>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7573440153626" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7573440153626-27">27</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-1"><span class="crayon-c"># вновь создадим Q-таблицу, заполненную нулями</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-2"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-4"><span class="crayon-c"># агент будет учиться в течение 1000 эпизодов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-5"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-7"><span class="crayon-c"># для каждого эпизода</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># вернем игру в начальное состояние</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># объявим переменную окончания эпизода</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># (по умолчанию, ее значение будет False)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># во внутреннем цикле будем проходить эпизод до тех пор,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># пока не попровалимся под лед или не дойдем до цели</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># т.е. пока переменная terminated не примет значение True </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># на каждой итерации эпизода будем делать шаг action и</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># получать информацию о новом состоянии, вознаграждении и</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># факте завершения эпизода</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># также не забудем обновить текущее состояние</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7573440153626-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new_state</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p>Подробнее про вложенные циклы и цикл while можно прочитать <a href="../../python/if-and-loops/index.html">здесь</a>.</p>



<p><strong>Следующий шаг</strong>. При этом в коде выше совершенно непонятно, откуда агент узнает о том, какое действие ему следует предпринять. Переменная action нигде не объявлена. Исправим это.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7576384444488" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7576384444488-23">23</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-1"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-3"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-5"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># если одно из значений в строке таблицы (состоянии)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># уже заполнено, </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># выберем то действие (тот столбец), </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># в котором это значение наибольшее</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># если такой информации нет (строка состоит из нулей),</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># выберем случайное действие</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7576384444488-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<p>Более формально в случае ненулевых значений состояния $s$ мы выполним действие $a$ с наибольшим Q-значением в этом состоянии</p>



<p>$$ a = \underset{a}{\operatorname{argmax}} Q (s,a) $$</p>



<p><strong>Обновление Q-значений</strong>. Теперь самый важный момент: обновление значений Q-таблицы. На каждом шаге $s_t$ агент выберет действие $a_t.$ На основе этого, ему станет доступна информация о:</p>



<ul class="wp-block-list">
<li>возраграждении от перехода в следующее состояние $R_{t+1};$</li>



<li>следующем состоянии $s_{t+1};$ и, как следствие,</li>



<li>значениях (строке) Q-таблицы в новом состоянии $Q(s_{t+1}).$</li>
</ul>



<p>Эта информация позволит рассчитать пользу от перехода в новое состояние по формуле</p>



<p>$$ Q(s_t,a_t)_{new} \leftarrow R_{t+1} + \max_a Q(s_{t+1},a), $$</p>



<p>где</p>



<ul class="wp-block-list">
<li>$Q(s_t,a_t)_{new}$ &#8212; обновленное значение Q-таблицы;</li>



<li>$R_{t+1} + \max_a Q(s_{t+1},a)$ &#8212; сумма вознаграждения и наибольшего Q-значения в новом состоянии.</li>
</ul>



<p>Можно сказать, что $R_{t+1}$ показывает пользу следующего шага $t+1,$ а $\max_a Q(s_{t+1},a)$ указывает на нашу оценку оптимальной траектории последующих $t+2, t+3, \ldots, T$ шагов.</p>



<p>В самом деле, в силу того, что мы &#171;видим&#187; не дальше одного шага вперед, выбор действия $a$ с наибольшей оценкой $Q(s_{t+1})$ представляется оптимальным (максимизирует последующие вознаграждения).</p>



<p><strong>Как это будет выглядеть на практике?</strong> Вначале агент будет пытаться, выполняя случайные шаги, дойти до цели. Предположим, что на 20-м или 30-м шаге ему это удается.</p>



<p>Таким образом, мы точно знаем, что переход вправо из состояния 14 в состояние 15 приведет нас к цели. Обновим соответствующее Q-значение</p>



<p>$$ Q(14,2) = R_{t+1} + \max_a Q(s_{t+1},a) = 1 + 0 = 1 $$</p>



<p>и заполним таблицу</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="900" src="../../wp-content/uploads/2025/10/q14_2-1024x900.jpg" alt="обновление Q-таблицы" class="wp-image-42598" style="width:371px;height:auto" srcset="../../wp-content/uploads/2025/10/q14_2-1024x900.jpg 1024w, ../../wp-content/uploads/2025/10/q14_2-300x264.jpg 300w, ../../wp-content/uploads/2025/10/q14_2-768x675.jpg 768w, ../../wp-content/uploads/2025/10/q14_2-600x527.jpg 600w, ../../wp-content/uploads/2025/10/q14_2.jpg 1099w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Теперь когда агент в следующий раз доберется (например, еще через 10 эпизодов) до состояния 14, он будет точно знать, куда двигаться дальше.</p>



<p>Более того, на втором успешном эпизоде обновится значение состояний 10 или 13, в зависимости от того, откуда агент попал в состояние 14.</p>



<p>Предположим, что агент пришел из состояния 13, снова двигаясь вправо.</p>



<p>$$ Q(13,2) = R_{t+1} + \max_a Q(s_{t+1},a) = 0 + 1 = 1 $$</p>



<p>Примечание. В данном случае в состоянии 14 вознаграждение будет равно нулю (по условию задачи), а вот наибольшее Q-значение &#8212; единице.</p>



<p>Обновим таблицу.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="898" src="../../wp-content/uploads/2025/10/q13_2-1024x898.jpg" alt="обновление Q-таблицы 2" class="wp-image-42597" style="width:363px;height:auto" srcset="../../wp-content/uploads/2025/10/q13_2-1024x898.jpg 1024w, ../../wp-content/uploads/2025/10/q13_2-300x263.jpg 300w, ../../wp-content/uploads/2025/10/q13_2-768x674.jpg 768w, ../../wp-content/uploads/2025/10/q13_2-600x526.jpg 600w, ../../wp-content/uploads/2025/10/q13_2.jpg 1108w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Действуя таким образом, агент постепенно проложит себе путь до цели.</p>



<p>Пропишем правило для обновления Q-значения в коде.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b757f564432510" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b757f564432510-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b757f564432510-1"><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">new_state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p><strong>Код целиком</strong>. Тогда весь код будет выглядеть следующим образом.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7583969479457" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7583969479457-30">30</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-1"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-3"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-4"><span class="crayon-c"># будем учитывать успешность каждого эпизода</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-5"><span class="crayon-v">success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># по умолчанию, будем считать эпизод неудачным</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">new_state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new</span><span class="crayon-sy">_</span>state</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># если же текущий эпизод закончится получением награды,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># изменим запись о нем с нуля на единицу</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7583969479457-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<p>Исполним код выше и посмотрим, как быстро агент проложит правильный маршрут.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7586647382354" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7586647382354-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7586647382354-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7586647382354-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7586647382354-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7586647382354-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7586647382354-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7586647382354-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7586647382354-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">bar</span><span class="crayon-sy">(</span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">success</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">success</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7586647382354-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Эпизоды'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7586647382354-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">yticks</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7586647382354-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Результат'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7586647382354-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="833" height="371" src="../../wp-content/uploads/2025/10/results1.png" alt="успешные эпизоды обучения" class="wp-image-42604" srcset="../../wp-content/uploads/2025/10/results1.png 833w, ../../wp-content/uploads/2025/10/results1-300x134.png 300w, ../../wp-content/uploads/2025/10/results1-768x342.png 768w, ../../wp-content/uploads/2025/10/results1-600x267.png 600w" sizes="auto, (max-width: 833px) 100vw, 833px" /></figure>



<p>Вертикальные черты указывают на успешные эпизоды.</p>



<p>Мы видим, что первый раз агент дошел до цели примерно с двадцатой попытки, потом ошибался все меньше и где-то после 50-го эпизода всегда получал вознаграждение.</p>



<h4 class="wp-block-heading">Оценка обучения</h4>



<p>Теперь выведем обновленную Q-таблицу.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7589094856152" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7589094856152-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7589094856152-1"><span class="crayon-v">qtable</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b758c581271697" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758c581271697-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-1">array([[0., 1., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 1., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 1., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 1., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 1., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 1., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758c581271697-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Примечание. При повторном исполнении кода положение единиц может отличаться в силу того, что в нашем алгоритме есть элемент случайности</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b758f664818942" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b758f664818942-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b758f664818942-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b758f664818942-1"><span class="crayon-c"># вот он</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b758f664818942-2"><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Проследим движение агента. Из состояния $s=0$ мы перейдем вниз $a=1$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7591293822131" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7591293822131-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7591293822131-1">[0., 1., 0., 0.]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>в состояние $s=4.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7594684186456" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7594684186456-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7594684186456-1">[0., 1., 0., 0.]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Затем снова вниз $a=1$ в состояние $s=8.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7597913559244" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7597913559244-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7597913559244-1">[0., 0., 1., 0.]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>После этого вправо, вниз, вправо, вправо. То есть,</p>



<p>$$ \big[ \; 1, 1, 2, 1, 2, 2 \; \big] $$</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="865" height="859" src="../../wp-content/uploads/2025/10/path.jpg" alt="путь агента" class="wp-image-42550" style="width:259px;height:auto" srcset="../../wp-content/uploads/2025/10/path.jpg 865w, ../../wp-content/uploads/2025/10/path-300x298.jpg 300w, ../../wp-content/uploads/2025/10/path-150x150.jpg 150w, ../../wp-content/uploads/2025/10/path-768x763.jpg 768w, ../../wp-content/uploads/2025/10/path-600x596.jpg 600w" sizes="auto, (max-width: 865px) 100vw, 865px" /></figure>



<p>Проверим с помощью Питона.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b7599832036110" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b7599832036110-23">23</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-1"><span class="crayon-c"># в течение десяти эпизодов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-2"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-3"><span class="crayon-c"># будем учитывать количество успешных попыток</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-4"><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># здесь нет элемента случайности, поскольку мы проверяем</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># правильность значений Q-таблицы и всегда выбираем</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># наибольшее значение</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-20"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-i">reward</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-22"><span class="crayon-c"># выведем отношение успешных попыток к количеству эпизодов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b7599832036110-23"><span class="crayon-v">n_success</span><span class="crayon-o">/</span><span class="crayon-v">episodes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b759c798423289" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759c798423289-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759c798423289-1">1.0</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading">Скорость обучения</h4>



<p>Модифицируем формулу обновления Q-значения таким образом, чтобы учитывать как текущее значение, так и сумму вознаграждения и наибольшего Q-значения на следующем шаге</p>



<p>$$ Q(s_t,a_t)_{new} \leftarrow (1-\alpha) Q(s_t,a_t) + \alpha (R_{t+1} + \max_a Q(s_{t+1},a)), $$</p>



<p>где коэффициент $\alpha$ (&#171;альфа&#187;) определяет долю текущего и нового значения. Так мы можем контролировать степень обновления Q-значений и, как следствие, скорость обучения.</p>



<p>Математически же речь идет об <a href="../time-series/index.html">экспоненциальном сглаживании</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b759f422944171" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b759f422944171-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-1"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-3"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-4"><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># обратная косая черта позволяет перенести код</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># на следующую строку</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-o">-</span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">new_state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b759f422944171-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new_state</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75a2025170767" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a2025170767-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a2025170767-1"><span class="crayon-v">qtable</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75a5722032796" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a5722032796-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-1">array([[0., 0., 1., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 1., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 1., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 1., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 1., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 1., 0.],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a5722032796-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0., 0., 0., 0.]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как мы видим, в данном случае агент проложил иной путь до цели.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="863" height="868" src="../../wp-content/uploads/2025/10/path2.jpg" alt="путь агента 2" class="wp-image-42614" style="width:252px;height:auto" srcset="../../wp-content/uploads/2025/10/path2.jpg 863w, ../../wp-content/uploads/2025/10/path2-298x300.jpg 298w, ../../wp-content/uploads/2025/10/path2-150x150.jpg 150w, ../../wp-content/uploads/2025/10/path2-768x772.jpg 768w, ../../wp-content/uploads/2025/10/path2-600x603.jpg 600w" sizes="auto, (max-width: 863px) 100vw, 863px" /></figure>



<p>Убедимся, что и этот путь нам подходит.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75a8177309809" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75a8177309809-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-1"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-2"><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-15"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75a8177309809-17"><span class="crayon-v">n_success</span><span class="crayon-o">/</span><span class="crayon-v">episodes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75ab184868221" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ab184868221-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ab184868221-1">1.0</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading">Дисконтирование</h4>



<p><strong>Экономика и финансы</strong>. Принято считать, что стоимость денег в будущем меньше стоимости денег в настоящем. Для этого есть несколько причин:</p>



<ul class="wp-block-list">
<li>деньги сегодня можно вложить и получать возврат на инвестиции;</li>



<li>будущие денежные потоки подвержены рискам и поэтому стоят меньше;</li>



<li>деньги обесцениваются вследствие инфляции.</li>
</ul>



<p>Математически это можно выразить через формулу дисконтирования денежных потоков (discount cash flow, DCF)</p>



<p>$$ DCF = \frac{CF_1}{(1+r)^1} + \frac{CF_2}{(1+r)^2} + \ldots + \frac{CF_T}{(1+r)^T} = \sum_{t=1}^T \frac{CF_t}{(1+r)^t}, $$</p>



<p>где</p>



<ul class="wp-block-list">
<li>$CF_t$ &#8212; денежный поток в период $t;$</li>



<li>$r$ &#8212; ставка дисконтирования; и</li>



<li>$T$ &#8212; количество периодов.</li>
</ul>



<p>Например, при ставке дисконтирования $r=0{,}1,$ вместо получения 100 рублей в год в течение трех лет, мы на самом деле получим</p>



<p>$$ \begin{split} DCF &amp;= \frac{100}{(1+0{,}1)^1} + \frac{100}{(1+0{,}1)^2} + \frac{100}{(1+0{,}1)^3} \\[2ex] &amp;\approx 90{,}91 + 82{,}64 + 75{,}13 = 248{,}68 \text{ рублей.} \end{split} $$</p>



<p>Введем параметр $\gamma$ (&#171;гамма&#187;) и положим $ \gamma = \tfrac{1}{1+r}. $ Тогда,</p>



<p>$$ DCF = \gamma^1 CF_1 + \gamma^2 CF_2 + \ldots + \gamma^T CF_T = \sum_{t=1}^T \gamma^t CF_t $$</p>



<p><strong>Обучение с подкреплением</strong>. Применим эту же идею дисконтирования к обучению с подкреплением. Дисконтирование в данном случае отражает наше представление о том, что вознаграждение агента на следующем шаге $t+1$ является более ценным, чем на шаге $t+2$ и т.д.</p>



<p>Выше мы сказали, что $R_{t+1}$ показывает пользу следующего шага $t+1,$ а $\max_a Q(s_{t+1},a)$ указывает на нашу оценку оптимальной траектории последующих $t+2, t+3, \ldots, T$ шагов.</p>



<p>$$ \begin{split} Q(s_t,a_t) &amp;= R_{t+1} + \gamma^1 R_{t+2} + \gamma^2 R_{t+3} + \ldots + \gamma^{T-1} R_{T} \\[1ex] &amp;= R_{t+1} + \sum_{k=1}^{T-1} \gamma^k R_{t+k+1} \\[1ex] &amp;= R_{t+1} + \gamma \max_a Q(s_{t+1},a) \end{split} $$</p>



<p>Подставим этот результат в формулу, которая учитывает скорость обучения.</p>



<p>$$ Q(s_t,a_t)_{new} \leftarrow (1-\alpha) Q(s_t,a_t) + \alpha (R_{t+1} + \gamma \max_a Q(s_{t+1},a)) $$</p>



<p>Эту же формулу можно записать и так</p>



<p>$$ Q(s_t,a_t)_{new} \leftarrow Q(s_t,a_t) + \alpha (R_{t+1} + \gamma \max_a Q(s_{t+1},a)-Q(s_t,a_t)) $$</p>



<p><strong>Пример</strong>. Посмотрим, как это будет работать в игре &#171;Замерзшее озеро&#187;. Положим $\alpha = 0{,}1$ и $\gamma = 0{,}9.$</p>



<p>Применим формулу выше и для наглядности будем записывать значения Q-таблицы каждый раз, когда агент дойдет до цели.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75ae584819649" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ae584819649-29">29</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-1"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-3"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-4"><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c"># коэффициент скорости обучения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-5"><span class="crayon-v">gamma</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c"># коэффициент дисконтирования</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-6"><span class="crayon-v">qtables</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># список для значений Q-таблицы</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-8"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">gamma</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">new_state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">new</span><span class="crayon-sy">_</span>state</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># каждый раз при достижении цели</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># поместим обновленную Q-таблицы в список</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ae584819649-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qtables</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
</div>



<p>Когда агент в первый раз достигнет цели, мы будем обновлять значение $Q(14,2).$</p>



<p>$$ \begin{split} Q(14,2)_{new} &amp;= Q(14,2) + \alpha (R_{t+1} + \gamma \max_a Q(15,a)-Q(14,2)) \\[1ex] &amp;= 0 + 0{,}1 \cdot (1 + 0{,}9 \cdot 0-0) = 0{,}1 \end{split} $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75b2857686427" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b2857686427-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b2857686427-1"><span class="crayon-v">qtables</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75b5964725477" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75b5964725477-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-1">array([[0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0.1, 0. ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75b5964725477-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0. , 0. , 0. , 0. ]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>После второго успешного эпизода значение $Q(14,2)$ вновь обновится.</p>



<p>$$ Q(14,2)_{new} = 0{,}1 + 0{,}1 \cdot (1 + 0{,}9 \cdot 0-0{,}1) = 0{,}19 $$</p>



<p>Одновременно обновится значение $Q(10,1),$ из которого агент пришел в $Q(14,2).$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75b8490847248" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75b8490847248-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75b8490847248-1"><span class="crayon-v">qtables</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75ba328296722" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ba328296722-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-1">array([[0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.009, 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.19 , 0.&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ba328296722-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; , 0.&nbsp;&nbsp; ]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Посмотрим на окончательный результат Q-обучения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75bd746800774" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75bd746800774-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75bd746800774-1"><span class="crayon-v">qtables</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75c0909159361" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c0909159361-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-1">array([[0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.59049, 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.6561 , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.729&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.81&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.9&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 1.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c0909159361-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp; ]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Как мы и хотели, бо́льшую ценность имеют значения, находящиеся ближе к вознаграждению.</p>



<p>Несложно увидеть, что речь идет о последовательности</p>



<p>$$ \big[ \; 1, 1, 2, 2, 1, 2 \; \big] $$</p>



<p><strong>Настройка параметра дисконтирования</strong>. При коэффициенте $\gamma = 0$ агент фокусируется исключительно на ближайшем вознаграждении $R_{t+1}.$ При $\gamma = 1$ все вознаграждения имеют одинаковый вес (дисконтирование отсутствует).</p>



<h4 class="wp-block-heading">Исследование и следование</h4>



<p><strong>Дилемма исследования и следования</strong>. Обратим внимание на следующий момент. В коде выше агент всегда выбирает наибольшие (ненулевые) значения очередного состояния и, как следствие, всегда двигается по прокладываемому пути.</p>



<p>В среде &#171;Замерзшее озеро&#187; такой подход не вызывает сомнений, поскольку кратчайший путь до цели всегда состоит из шести ходов. При этом несложно представить среду, в которой до цели можно добраться за шесть ходов, а можно, например, за восемь.</p>



<p>Если алгоритм в первом успешном эпизоде дойдет до цели за восемь шагов, дальше он, весьма вероятно, будет учитывать только такую траекторию.</p>



<p>В качестве решения мы можем предложить алгоритму:</p>



<ul class="wp-block-list">
<li>в некоторых случаях совершать новые, не соответствующие максимальному значению Q-таблицы действия; а</li>



<li>в некоторых других &#8212; продолжать двигаться по известному маршруту.</li>
</ul>



<p>Технически мы будем генерировать случайное число от нуля до единицы, и, если это число окажется меньше некоторого заданного параметра $\varepsilon$ (&#171;эпсилон&#187;), то выполним случайное действие, если больше или равно &#8212; выберем действие в соответствии с наибольшим Q-значением.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75c3868243979" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c3868243979-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-1"><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># сгенерируем число от 0 до 1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># если это число меньше эпсилон,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># выберем случайное действие</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># в противном случае,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># выберем действие в соответствии с наибольшим Q-значением</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c3868243979-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p class="has-background" style="background-color:#ffe8c4">Такой подход в англоязычной литературе называется <strong>exploration-exploitation dilemma</strong> или trade-off, что не вполне дословно, но точно по смыслу можно перевести как &#171;дилемма исследования и следования&#187;.</p>



<p><strong>Постепенное уменьшение</strong> $\boldsymbol \varepsilon.$ Более того, нам бы хотелось, чтобы в начале обучения агент в большей степени исследовал среду, а в конце обучения, наоборот, полагался на известный маршрут.</p>



<p>Такое поведение можно обеспечить через постепенно уменьшающееся значение $\varepsilon.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75c7122973328" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75c7122973328-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-1"><span class="crayon-c"># зададим начальное значение эпсилон и</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-2"><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-3"><span class="crayon-c"># величину, на которую будем уменьшать этот параметр</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-4"><span class="crayon-v">epsilon_decay</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.001</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># после каждого эпизода уменьшим эпсилон до тех пор,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># пока его значение не станет нулевым</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75c7122973328-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">epsilon_decay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<p><strong>Эпсилон-жадный алгоритм</strong>. Также заметим, что алгоритм, на каждом шаге выбирающий действие в соответствии с наибольшим Q-значением, называется <strong>жадным</strong> (greedy).</p>



<p>При этом если допускается не только следование, но и исследование среды в соответствии со значением $\varepsilon,$ то такой подход принято называть <strong>эпсилон-жадным алгоритмом</strong> ($\varepsilon$-greedy algorithm).</p>



<p><strong>Код целиком</strong>. Обучим эпсилон-жадный алгоритм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75ca788302267" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ca788302267-35">35</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-1"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-3"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-4"><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-5"><span class="crayon-v">gamma</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-6"><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-7"><span class="crayon-v">epsilon_decay</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.001</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-9"><span class="crayon-v">success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-11"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">gamma</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">new_state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-32"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ca788302267-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">epsilon_decay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75cd259603175" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75cd259603175-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75cd259603175-1"><span class="crayon-v">qtable</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75d0577314460" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d0577314460-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-1">array([[0.531441&nbsp;&nbsp;, 0.59049&nbsp;&nbsp; , 0.59049&nbsp;&nbsp; , 0.531441&nbsp;&nbsp;],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.531441&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.6561&nbsp;&nbsp;&nbsp;&nbsp;, 0.59049&nbsp;&nbsp; ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.59049&nbsp;&nbsp; , 0.729&nbsp;&nbsp;&nbsp;&nbsp; , 0.59049&nbsp;&nbsp; , 0.6561&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.6561&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.59047759, 0.59047845],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.59048061, 0.6561&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.53143889],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.6561&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.65605699, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.729&nbsp;&nbsp;&nbsp;&nbsp; , 0.58734952],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.65609742, 0.80963743, 0.81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.729&nbsp;&nbsp;&nbsp;&nbsp; , 0.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.729&nbsp;&nbsp;&nbsp;&nbsp; ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.80784336, 0.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , 0.72885098],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.9&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , 1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.81&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d0577314460-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Примечание. Если значения строки Q-таблицы одинаковы, алгоритм может выбрать любое из действий (в коде функция <strong>np.argmax()</strong> выберет <em>первое</em> из этих значений).</p>



<p>Посмотрим на успешность эпизодов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75d3218484577" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d3218484577-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d3218484577-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d3218484577-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d3218484577-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d3218484577-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d3218484577-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d3218484577-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d3218484577-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">bar</span><span class="crayon-sy">(</span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">success</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">success</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d3218484577-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Эпизоды'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d3218484577-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">yticks</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d3218484577-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Результат'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d3218484577-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="833" height="371" src="../../wp-content/uploads/2025/10/epsilon_greedy_eval.png" alt="исследование и следование: эпсилон-жадный алгоритм" class="wp-image-42689" srcset="../../wp-content/uploads/2025/10/epsilon_greedy_eval.png 833w, ../../wp-content/uploads/2025/10/epsilon_greedy_eval-300x134.png 300w, ../../wp-content/uploads/2025/10/epsilon_greedy_eval-768x342.png 768w, ../../wp-content/uploads/2025/10/epsilon_greedy_eval-600x267.png 600w" sizes="auto, (max-width: 833px) 100vw, 833px" /></figure>



<p>Как мы видим, алгоритму потребовалось больше времени для того, чтобы стабилизироваться и тем не менее, мы нашли оптимальный маршрут до цели.</p>



<p>Оценим качество обучения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75d6745509622" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d6745509622-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-1"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-2"><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-15"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d6745509622-17"><span class="crayon-v">n_success</span><span class="crayon-o">/</span><span class="crayon-v">episodes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75d9995993456" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75d9995993456-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75d9995993456-1">1.0</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Дополнительно отследим путь агента.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75db245525829" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75db245525829-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-1"><span class="crayon-v">sequence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-2"><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-3"><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-5"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">sequence</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75db245525829-11"><span class="crayon-v">sequence</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75de419479391" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75de419479391-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75de419479391-1">[1, 1, 2, 2, 1, 2]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading">Элемент случайности</h4>



<p>Вернемся к параметру is_slippery и изменим его значение на True. Также пропишем параметр success_rate.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75e1153275676" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e1153275676-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e1153275676-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e1153275676-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e1153275676-1"><span class="crayon-v">environment</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gym</span><span class="crayon-sy">.</span><span class="crayon-e">make</span><span class="crayon-sy">(</span><span class="crayon-s">"FrozenLake-v1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e1153275676-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">is_slippery</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e1153275676-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">success_rate</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-o">/</span><span class="crayon-cn">3.0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>В этом случае агент будет двигаться в выбранном нами направлении только в $\tfrac{1}{3}$ случаев. Например,</p>



<ul class="wp-block-list">
<li>если мы хотим двигаться вправо, агент с вероятностью $\tfrac{1}{3}$ пойдет вправо, вверх или вниз;</li>



<li>если мы должны пойти вниз, то с такой же вероятностью можем пойти влево или вправо.</li>
</ul>



<p>Очевидно, это усложняет задачу обучения агента.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75e3306298768" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e3306298768-42">42</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-1"><span class="crayon-v">environment</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">gym</span><span class="crayon-sy">.</span><span class="crayon-e">make</span><span class="crayon-sy">(</span><span class="crayon-s">"FrozenLake-v1"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">is_slippery</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">success_rate</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-o">/</span><span class="crayon-cn">3.0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-5"><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-7"><span class="crayon-v">qtable</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">observation_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-9"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-10"><span class="crayon-c"># будем в большей степени опираться на текущие Q-значения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-11"><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-12"><span class="crayon-v">gamma</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-13"><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-14"><span class="crayon-v">epsilon_decay</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.001</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-16"><span class="crayon-v">success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-18"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-v">action_space</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">reward</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">gamma</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">new_state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">action</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-36">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-38">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-39"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">success</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-41">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e3306298768-42"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">epsilon_decay</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75e6451465574" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e6451465574-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e6451465574-1"><span class="crayon-v">qtable</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75e9866769995" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75e9866769995-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-1"><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">0.05545224</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.03677841</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.03915342</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.04267193</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.01408444</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01109328</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.0106434</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.04214996</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.04175414</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.02151526</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.02009585</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.0170788</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.00498068</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.00663967</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.00152793</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.0048901</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.07153096</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.05727294</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.02714437</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.01819794</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.07551944</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.02793819</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.03410835</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.00998187</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.0575799</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.05620875</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.03792144</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.11604696</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.07399466</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.17387822</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.05853298</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.05810701</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.3696946</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.1491535</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.16194517</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.06549912</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.10063218</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.20805691</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.33407267</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.15467364</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.20573574</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.72246695</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.31836966</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.44145021</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75e9866769995-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75ec647399333" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ec647399333-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ec647399333-1"><span class="crayon-v">qtable</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75ef476253109" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75ef476253109-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-1">array([[0.05545224, 0.03677841, 0.03915342, 0.04267193],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.01408444, 0.01109328, 0.0106434 , 0.04214996],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.04175414, 0.02151526, 0.02009585, 0.0170788 ],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.00498068, 0.00663967, 0.00152793, 0.0048901 ],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.07153096, 0.05727294, 0.02714437, 0.01819794],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.07551944, 0.02793819, 0.03410835, 0.00998187],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.0575799 , 0.05620875, 0.03792144, 0.11604696],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.07399466, 0.17387822, 0.05853298, 0.05810701],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.3696946 , 0.1491535 , 0.16194517, 0.06549912],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-13">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-14">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.10063218, 0.20805691, 0.33407267, 0.15467364],</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-15">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.20573574, 0.72246695, 0.31836966, 0.44145021],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75ef476253109-16">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; [0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;, 0.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75f2089714981" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f2089714981-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f2089714981-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f2089714981-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f2089714981-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f2089714981-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f2089714981-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f2089714981-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-o">=</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f2089714981-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">bar</span><span class="crayon-sy">(</span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">success</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">success</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f2089714981-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Эпизоды'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f2089714981-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">yticks</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f2089714981-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Результат'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f2089714981-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="833" height="371" src="../../wp-content/uploads/2025/10/slippery_true.png" alt="элемент случайности" class="wp-image-42696" srcset="../../wp-content/uploads/2025/10/slippery_true.png 833w, ../../wp-content/uploads/2025/10/slippery_true-300x134.png 300w, ../../wp-content/uploads/2025/10/slippery_true-768x342.png 768w, ../../wp-content/uploads/2025/10/slippery_true-600x267.png 600w" sizes="auto, (max-width: 833px) 100vw, 833px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75f5670937791" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f5670937791-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-1"><span class="crayon-v">episodes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-2"><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-4"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">_</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">episodes</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">reset</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">terminated</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-st">not</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">action</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">qtable</span><span class="crayon-sy">[</span><span class="crayon-v">state</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">new_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">terminated</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">environment</span><span class="crayon-sy">.</span><span class="crayon-e">step</span><span class="crayon-sy">(</span><span class="crayon-v">action</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">new_state</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-15"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n_success</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">reward</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f5670937791-17"><span class="crayon-v">n_success</span><span class="crayon-o">/</span><span class="crayon-v">episodes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701d5b75f8730991813" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701d5b75f8730991813-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701d5b75f8730991813-1">0.8</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Поскальзываясь в процессе обучения, агент реже доходил до цели.</p>



<h3 class="wp-block-heading">Список литературы</h3>



<ul class="wp-block-list">
<li>Sutton R., Barto A., <a href="https://web.stanford.edu/class/psych209/Readings/SuttonBartoIPRLBook2ndEd.pdf" target="_blank" rel="noreferrer noopener">Reinforcement Learning: An Introduction</a>⧉, Second Edition, The MIT Press;</li>



<li>Szepesvári C., <a href="https://sites.ualberta.ca/~szepesva/papers/RLAlgsInMDPs.pdf" target="_blank" rel="noreferrer noopener">Algorithms for Reinforcement Learning</a>⧉, Morgan and Claypool Publishers.</li>
</ul>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2026 <a href="../../index.html" class="site-name"></p>

			</footer> <!-- footer -->

		</main>
		
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(100123342, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/100123342" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

		<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"/*"},{"not":{"href_matches":["/wp-*.php","/wp-admin/*","/wp-content/uploads/*","/wp-content/*","/wp-content/plugins/*","/wp-content/themes/mcluhan/*","/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.9" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https://www.dmitrymakarov.ru/wp-admin/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"intro\\/rl\"}"};
//# sourceURL=mcluhan_global-js-extra
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
<script id="wp-emoji-settings" type="application/json">
{"baseUrl":"https://s.w.org/images/core/emoji/17.0.2/72x72/","ext":".png","svgUrl":"https://s.w.org/images/core/emoji/17.0.2/svg/","svgExt":".svg","source":{"concatemoji":"https://www.dmitrymakarov.ru/wp-includes/js/wp-emoji-release.min.js?ver=6.9"}}
</script>
<script type="module">
/* <![CDATA[ */
/*! This file is auto-generated */
const a=JSON.parse(document.getElementById("wp-emoji-settings").textContent),o=(window._wpemojiSettings=a,"wpEmojiSettingsSupports"),s=["flag","emoji"];function i(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function c(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0);const a=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);return t.every((e,t)=>e===a[t])}function p(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var n=e.getImageData(16,16,1,1);for(let e=0;e<n.data.length;e++)if(0!==n.data[e])return!1;return!0}function u(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\u1fac8")}return!1}function f(e,t,n,a){let r;const o=(r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),s=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(e=>{s[e]=t(o,e,n,a)}),s}function r(e){var t=document.createElement("script");t.src=e,t.defer=!0,document.head.appendChild(t)}a.supports={everything:!0,everythingExceptFlag:!0},new Promise(t=>{let n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),c.toString(),p.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"});const r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=e=>{i(n=e.data),r.terminate(),t(n)})}catch(e){}i(n=f(s,u,c,p))}t(n)}).then(e=>{for(const n in e)a.supports[n]=e[n],a.supports.everything=a.supports.everything&&a.supports[n],"flag"!==n&&(a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&a.supports[n]);var t;a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&!a.supports.flag,a.supports.everything||((t=a.source||{}).concatemoji?r(t.concatemoji):t.wpemoji&&t.twemoji&&(r(t.twemoji),r(t.wpemoji)))});
//# sourceURL=https://www.dmitrymakarov.ru/wp-includes/js/wp-emoji-loader.min.js
/* ]]> */
</script>
			
	</body>
</html>


<!-- Page supported by LiteSpeed Cache 7.7 on 2026-01-26 08:55:33 -->
