<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v26.8 - https://yoast.com/product/yoast-seo-wordpress/ -->
	<title>Теория информации. Часть 2</title>
	<meta name="description" content="Рассмотрим перекретную энтропию, дивергенцию Кульбака-Лейблера, дивергенцию Йенсена-Шеннона, а также принцип максимальной энтропии." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Теория информации. Часть 2" />
	<meta property="og:description" content="Рассмотрим перекретную энтропию, дивергенцию Кульбака-Лейблера, дивергенцию Йенсена-Шеннона, а также принцип максимальной энтропии." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/infotheory-02/" />
	<meta property="og:site_name" content="Дмитрий Макаров" />
	<meta property="article:modified_time" content="2026-01-24T09:49:48+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2025/08/p_q_code.jpg" />
	<meta property="og:image:width" content="1767" />
	<meta property="og:image:height" content="869" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="18 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/infotheory-02/","url":"https://www.dmitrymakarov.ru/infotheory-02/","name":"Теория информации. Часть 2","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/infotheory-02/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/infotheory-02/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/08/p_q_code-1024x504.jpg","datePublished":"2025-08-29T12:15:48+00:00","dateModified":"2026-01-24T09:49:48+00:00","description":"Рассмотрим перекретную энтропию, дивергенцию Кульбака-Лейблера, дивергенцию Йенсена-Шеннона, а также принцип максимальной энтропии.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/infotheory-02/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/infotheory-02/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/infotheory-02/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/08/p_q_code.jpg","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/08/p_q_code.jpg","width":1767,"height":869},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/infotheory-02/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Теория информации. Часть 2"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/17fb646123c8fccd118e1f2da611da3de8d8e72250637fb08b246e33d4c95395?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/17fb646123c8fccd118e1f2da611da3de8d8e72250637fb08b246e33d4c95395?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Дмитрий Макаров &raquo; Лента" href="../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Дмитрий Макаров &raquo; Лента комментариев" href="../comments/feed/index.html" />
<style id='wp-img-auto-sizes-contain-inline-css' type='text/css'>
img:is([sizes=auto i],[sizes^="auto," i]){contain-intrinsic-size:3000px 1500px}
/*# sourceURL=wp-img-auto-sizes-contain-inline-css */
</style>

<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.9.0.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.9.0.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.9.0.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
/*# sourceURL=wp-emoji-styles-inline-css */
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../wp-includes/css/dist/block-library/style.min.css@ver=6.9.css' type='text/css' media='all' />
<style id='wp-block-heading-inline-css' type='text/css'>
h1:where(.wp-block-heading).has-background,h2:where(.wp-block-heading).has-background,h3:where(.wp-block-heading).has-background,h4:where(.wp-block-heading).has-background,h5:where(.wp-block-heading).has-background,h6:where(.wp-block-heading).has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/heading/style.min.css */
</style>
<style id='wp-block-image-inline-css' type='text/css'>
.wp-block-image>a,.wp-block-image>figure>a{display:inline-block}.wp-block-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom}@media not (prefers-reduced-motion){.wp-block-image img.hide{visibility:hidden}.wp-block-image img.show{animation:show-content-image .4s}}.wp-block-image[style*=border-radius] img,.wp-block-image[style*=border-radius]>a{border-radius:inherit}.wp-block-image.has-custom-border img{box-sizing:border-box}.wp-block-image.aligncenter{text-align:center}.wp-block-image.alignfull>a,.wp-block-image.alignwide>a{width:100%}.wp-block-image.alignfull img,.wp-block-image.alignwide img{height:auto;width:100%}.wp-block-image .aligncenter,.wp-block-image .alignleft,.wp-block-image .alignright,.wp-block-image.aligncenter,.wp-block-image.alignleft,.wp-block-image.alignright{display:table}.wp-block-image .aligncenter>figcaption,.wp-block-image .alignleft>figcaption,.wp-block-image .alignright>figcaption,.wp-block-image.aligncenter>figcaption,.wp-block-image.alignleft>figcaption,.wp-block-image.alignright>figcaption{caption-side:bottom;display:table-caption}.wp-block-image .alignleft{float:left;margin:.5em 1em .5em 0}.wp-block-image .alignright{float:right;margin:.5em 0 .5em 1em}.wp-block-image .aligncenter{margin-left:auto;margin-right:auto}.wp-block-image :where(figcaption){margin-bottom:1em;margin-top:.5em}.wp-block-image.is-style-circle-mask img{border-radius:9999px}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}:root :where(.wp-block-image.is-style-rounded img,.wp-block-image .is-style-rounded img){border-radius:9999px}.wp-block-image figure{margin:0}.wp-lightbox-container{display:flex;flex-direction:column;position:relative}.wp-lightbox-container img{cursor:zoom-in}.wp-lightbox-container img:hover+button{opacity:1}.wp-lightbox-container button{align-items:center;backdrop-filter:blur(16px) saturate(180%);background-color:#5a5a5a40;border:none;border-radius:4px;cursor:zoom-in;display:flex;height:20px;justify-content:center;opacity:0;padding:0;position:absolute;right:16px;text-align:center;top:16px;width:20px;z-index:100}@media not (prefers-reduced-motion){.wp-lightbox-container button{transition:opacity .2s ease}}.wp-lightbox-container button:focus-visible{outline:3px auto #5a5a5a40;outline:3px auto -webkit-focus-ring-color;outline-offset:3px}.wp-lightbox-container button:hover{cursor:pointer;opacity:1}.wp-lightbox-container button:focus{opacity:1}.wp-lightbox-container button:focus,.wp-lightbox-container button:hover,.wp-lightbox-container button:not(:hover):not(:active):not(.has-background){background-color:#5a5a5a40;border:none}.wp-lightbox-overlay{box-sizing:border-box;cursor:zoom-out;height:100vh;left:0;overflow:hidden;position:fixed;top:0;visibility:hidden;width:100%;z-index:100000}.wp-lightbox-overlay .close-button{align-items:center;cursor:pointer;display:flex;justify-content:center;min-height:40px;min-width:40px;padding:0;position:absolute;right:calc(env(safe-area-inset-right) + 16px);top:calc(env(safe-area-inset-top) + 16px);z-index:5000000}.wp-lightbox-overlay .close-button:focus,.wp-lightbox-overlay .close-button:hover,.wp-lightbox-overlay .close-button:not(:hover):not(:active):not(.has-background){background:none;border:none}.wp-lightbox-overlay .lightbox-image-container{height:var(--wp--lightbox-container-height);left:50%;overflow:hidden;position:absolute;top:50%;transform:translate(-50%,-50%);transform-origin:top left;width:var(--wp--lightbox-container-width);z-index:9999999999}.wp-lightbox-overlay .wp-block-image{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin:0;position:relative;transform-origin:0 0;width:100%;z-index:3000000}.wp-lightbox-overlay .wp-block-image img{height:var(--wp--lightbox-image-height);min-height:var(--wp--lightbox-image-height);min-width:var(--wp--lightbox-image-width);width:var(--wp--lightbox-image-width)}.wp-lightbox-overlay .wp-block-image figcaption{display:none}.wp-lightbox-overlay button{background:none;border:none}.wp-lightbox-overlay .scrim{background-color:#fff;height:100%;opacity:.9;position:absolute;width:100%;z-index:2000000}.wp-lightbox-overlay.active{visibility:visible}@media not (prefers-reduced-motion){.wp-lightbox-overlay.active{animation:turn-on-visibility .25s both}.wp-lightbox-overlay.active img{animation:turn-on-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active){animation:turn-off-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active) img{animation:turn-off-visibility .25s both}.wp-lightbox-overlay.zoom.active{animation:none;opacity:1;visibility:visible}.wp-lightbox-overlay.zoom.active .lightbox-image-container{animation:lightbox-zoom-in .4s}.wp-lightbox-overlay.zoom.active .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.active .scrim{animation:turn-on-visibility .4s forwards}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active){animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container{animation:lightbox-zoom-out .4s}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .scrim{animation:turn-off-visibility .4s forwards}}@keyframes show-content-image{0%{visibility:hidden}99%{visibility:hidden}to{visibility:visible}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale))}to{transform:translate(-50%,-50%) scale(1)}}@keyframes lightbox-zoom-out{0%{transform:translate(-50%,-50%) scale(1);visibility:visible}99%{visibility:visible}to{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale));visibility:hidden}}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/image/style.min.css */
</style>
<style id='wp-block-list-inline-css' type='text/css'>
ol,ul{box-sizing:border-box}:root :where(.wp-block-list.has-background){padding:1.25em 2.375em}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/list/style.min.css */
</style>
<style id='wp-block-paragraph-inline-css' type='text/css'>
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}:root :where(p.has-background){padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/paragraph/style.min.css */
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgb(6,147,227) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgb(252,185,0) 0%,rgb(255,105,0) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgb(255,105,0) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgb(255, 255, 255), 6px 6px rgb(0, 0, 0);--wp--preset--shadow--crisp: 6px 6px 0px rgb(0, 0, 0);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
/*# sourceURL=global-styles-inline-css */
</style>

<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
/*# sourceURL=/wp-includes/css/classic-themes.min.css */
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.9.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.9.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.9.0","is_admin":"0","ajaxurl":"https://www.dmitrymakarov.ru/wp-admin/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
//# sourceURL=urvanov_syntax_highlighter_js-js-extra
/* ]]> */
</script>
<script type="text/javascript" src="../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.9.0" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="wp-singular page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-41527 custom-background wp-theme-mcluhan full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../index.html" class="site-name">Дмитрий Макаров</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

					<li id="menu-item-36690" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-36690"><a href="../index.html">Материалы</a></li>
<li id="menu-item-36691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36691"><a href="../about/index.html">Об авторе</a></li>
				</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
				<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-36690"><a href="../index.html">Материалы</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36691"><a href="../about/index.html">Об авторе</a></li>
					<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../index.html">
	<label class="screen-reader-text" for="search-form-697701ce120bc">Поиск:</label>
	<input type="search" id="search-form-697701ce120bc" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../index.html">
	<label class="screen-reader-text" for="search-form-697701ce1213d">Поиск:</label>
	<input type="search" id="search-form-697701ce1213d" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-41527 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Теория информации. Часть 2</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../index.html">Материалы</a></p>



<p>Продолжим изучать теорию информации.</p>



<h3 class="wp-block-heading">Перекрестная энтропия</h3>



<h4 class="wp-block-heading">Кодирование распределения</h4>



<p>Вернемся к примеру с двумя языками, только на этот раз обозначим язык 1 как $p(x),$ а язык 2 как $q(x).$ Пусть в каждом из языков будет по три буквы A, B, C со следующими частотами:</p>



<p>$$ p(x): \qquad p(A) = \frac{1}{2}, \qquad p(B) = \frac{1}{4}, \qquad p(C) = \frac{1}{4} $$</p>



<p>$$ q(x): \qquad p(A) = \frac{1}{4}, \qquad p(B) = \frac{1}{2}, \qquad p(C) = \frac{1}{4} $$</p>



<p class="has-text-align-left">Закодируем эти буквы, используя код Хаффмана.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img fetchpriority="high" decoding="async" width="1024" height="504" src="../wp-content/uploads/2025/08/p_q_code-1024x504.jpg" alt="перекрестная энтропия" class="wp-image-41353" style="width:514px;height:auto" srcset="../wp-content/uploads/2025/08/p_q_code-1024x504.jpg 1024w, ../wp-content/uploads/2025/08/p_q_code-300x148.jpg 300w, ../wp-content/uploads/2025/08/p_q_code-768x378.jpg 768w, ../wp-content/uploads/2025/08/p_q_code-1536x755.jpg 1536w, ../wp-content/uploads/2025/08/p_q_code-1200x590.jpg 1200w, ../wp-content/uploads/2025/08/p_q_code-600x295.jpg 600w, ../wp-content/uploads/2025/08/p_q_code.jpg 1767w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Таким образом,</p>



<p>$$ p(x): \qquad A \equiv 0, \qquad B \equiv 10, \qquad C \equiv 11 $$</p>



<p>$$ q(x): \qquad A \equiv 10, \qquad B \equiv 0, \qquad C \equiv 11 $$</p>



<p>Проверим.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/11eErDIq2pkwYtqG-ykoYG3CH1AY51Nrg?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем тот же блокнот</a>⧉</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f38142093082" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f38142093082-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f38142093082-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f38142093082-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f38142093082-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f38142093082-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f38142093082-1"><span class="crayon-v">language_p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-s">'A'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-s">'C'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f38142093082-2"><span class="crayon-v">freq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculate_frequencies</span><span class="crayon-sy">(</span><span class="crayon-v">language_p</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f38142093082-3"><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">huffman_tree</span><span class="crayon-sy">(</span><span class="crayon-v">freq</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f38142093082-4"><span class="crayon-v">encoding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">huffman_code</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f38142093082-5"><span class="crayon-v">encoding</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f49460537945" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f49460537945-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f49460537945-1">[('A', '0'), ('B', '10'), ('C', '11')]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f4c184904395" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f4c184904395-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f4c184904395-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f4c184904395-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f4c184904395-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f4c184904395-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f4c184904395-1"><span class="crayon-v">language_q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-s">'A'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-s">'C'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f4c184904395-2"><span class="crayon-v">freq</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">calculate_frequencies</span><span class="crayon-sy">(</span><span class="crayon-v">language_q</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f4c184904395-3"><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">huffman_tree</span><span class="crayon-sy">(</span><span class="crayon-v">freq</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f4c184904395-4"><span class="crayon-v">encoding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">huffman_code</span><span class="crayon-sy">(</span><span class="crayon-v">tree</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f4c184904395-5"><span class="crayon-v">encoding</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f4f626618890" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f4f626618890-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f4f626618890-1">[('B', '0'), ('A', '10'), ('C', '11')]</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Найдем энтропию каждого из этих языков.</p>



<p>$$ \mathrm{H}(P) = -\left[ \overbrace{\frac{1}{2} \underbrace{\log \frac{1}{2}}_{\rm 1 bit}}^{A} + \overbrace{ \frac{1}{4} \underbrace{\log \frac{1}{4}}_{\rm 2 bits} }^{B} + \overbrace{ \frac{1}{4} \underbrace{\log \frac{1}{4}}_{\rm 2 bits} }^{C} \right] = \frac{3}{2} = 1{,}5 $$</p>



<p>$$ \mathrm{H}(Q) = -\left[ \overbrace{ \frac{1}{4} \underbrace{\log \frac{1}{4}}_{\rm 2 bits}}^{A} + \overbrace{ \frac{1}{2} \underbrace{\log \frac{1}{2}}_{\rm 1 bit}}^{B} + \overbrace{ \frac{1}{4} \underbrace{\log \frac{1}{4}}_{\rm 2 bits}}^{C} \right] = \frac{3}{2} = 1{,}5 $$</p>



<p>Теперь попробуем закодировать язык $p(x)$ с помощью языка $q(x).$ Другими словами, используем частоту букв алфавита $p(x)$ и количество битов языка $q(x).$</p>



<p>$$ H(P,Q) = -\left[ \overbrace{\frac{1}{2} \underbrace{\log \frac{1}{4}}_{\rm 2 bits}}^{A} + \overbrace{\frac{1}{4} \underbrace{\log \frac{1}{2}}_{\rm 1 bit}}^{B} + \overbrace{\frac{1}{4} \underbrace{\log \frac{1}{4}}_{\rm 2 bits}}^{C} \right] = \frac{7}{4} = 1{,}75 $$</p>



<p>Как мы видим, при таком неоптимальном кодировании нам в среднем потребуется $1{,}75$ бита для кодирования одной буквы.</p>



<p>В данном случае мы измерили <strong>перекрестную</strong> или <strong>кросс-энтропию</strong> (cross-entropy) двух распределений $p(x)$ и $q(x).$ Более формально, мы нашли</p>



<p>$$ \mathrm{H}(P,Q) = \mathbb{E}_{p(x)} \left[ \log \frac{1}{q(x)} \right] = \sum_{x \in \mathcal{X}} p(x) \log \frac{1}{q(x)} = -\sum_{x \in \mathcal{X}} p(x) \log q(x) $$</p>



<p>Проверим с помощью Питона.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f52581557058" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f52581557058-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f52581557058-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f52581557058-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f52581557058-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f55387516333" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f55387516333-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f55387516333-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f55387516333-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">cross_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f55387516333-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log2</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f57291277783" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f57291277783-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f57291277783-1"><span class="crayon-e">cross_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f5a390495046" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5a390495046-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5a390495046-1">1.75</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading">Функция потерь</h4>



<p>Зачастую через $p(x)$ обозначается фактическое распределение данных, а $q(x)$ указывает на прогнозное распределение модели. В этом случае перекрестная энтропия используется в качестве функции ошибки в задачах классификации, например, в модели <a href="../learning/logistic/index.html">логистической регрессии</a></p>



<p>$$ \mathcal{L}(\mathbf y,\hat{\mathbf y}) = -\sum^C_{c=1} y_c \log \hat{y}_c, $$</p>



<p>где $C$ &#8212; количество классов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f5c657634072" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f5c657634072-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.8</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-4"><span class="crayon-c"># log_loss использует натуральный логарифм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">log_loss</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-7"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">cross_entropy_loss</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f5c657634072-10"><span class="crayon-e">log_loss</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">cross_entropy_loss</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f5f074904503" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f5f074904503-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f5f074904503-1">(0.2231435513142097, 0.2231435513142097)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Поясним, что в данном случае каждое наблюдение содержит фактическое распределение, например, $[0,1]$ и прогнозное $[0{,}2, 0{,}8].$</p>



<p>Для $N$ наблюдений берется усредненная перекрестная энтропия</p>



<p>$$ \frac{1}{N} \sum^N_{n=1} \mathcal{L}(\mathbf y^n,\hat{\mathbf y}^n) = -\frac{1}{N} \sum^N_{n=1} \sum^C_{c=1} y_c^n \log \hat{y}_c^n, $$</p>



<h4 class="wp-block-heading">Свойства кросс-энтропии</h4>



<p>Интересно, что в общем случае кросс-энтропия не симметрична, $\mathrm{H}(P,Q)\neq\mathrm{H}(Q,P).$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f62996420518" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f62996420518-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f62996420518-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f62996420518-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f62996420518-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f62996420518-1"><span class="crayon-v">a</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f62996420518-2"><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f62996420518-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f62996420518-4"><span class="crayon-e">cross_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">cross_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-v">a</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f65559684393" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f65559684393-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f65559684393-1">(1.6147263520325614, 2.3709505944546683)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Кроме этого, в соответствии с <strong>неравенством Гиббса</strong> (Gibbs&#8217; Inequality)</p>



<p>$$ \mathrm{H}(P) \leq \mathrm{H}(P,Q) $$</p>



<p>В самом деле, в лучшем случае, при использовании оптимального кода $q(x),$ перекрестная энтропия $\mathrm{H}(P,Q)$ будет равна энтропии $p(x).$ В остальных случаях она будет больше.</p>



<h4 class="wp-block-heading">Приближение перекрестной энтропии</h4>



<p>В случае если распределение $p(x)$ неизвестно, и у нас есть лишь набор данных $D$ из этого распределения, мы можем оценить перекрестную энтропию через</p>



<p>$$ \mathrm{H}(P,Q) \sim \mathrm{H}(D,Q) = -\sum^N_{i=1} \frac{1}{N} \log q(x_i), $$</p>



<p>где $N$ &#8212; количество объектов в выборке из $p(x)$ и $q(x_i)$ &#8212; вероятность распределения $q(x)$ наблюдения $x_i$ из выборки $D.$ Проиллюстрируем на примере.</p>



<p>Воспользуемся библиотекой вероятностного программирования TensorFlow Probability.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f67899344754" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f67899344754-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f67899344754-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f67899344754-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">tensorflow </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">tf</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f67899344754-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">tensorflow_probability </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Возьмем два распределения Бернулли и вначале аналитически рассчитаем перекретную энтропию в натах.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f6a760295656" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f6a760295656-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f6a760295656-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f6a760295656-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f6a760295656-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f6a760295656-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f6a760295656-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f6a760295656-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f6a760295656-4"><span class="crayon-e">cross_entropy_loss</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f70715500192" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f70715500192-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f70715500192-1">1.1192430182872157</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Теперь сделаем вид, что распределение $p(x)$ нам неизвестно, но у нас есть выборка из этого распределения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f73243570205" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f73243570205-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f73243570205-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f73243570205-1"><span class="crayon-v">px</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Bernoulli</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f73243570205-2"><span class="crayon-v">px_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">px</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-cn">100000</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Распределение $q(x)$ &#8212; это та модель, с помощью которой мы аппроксимируем распределение $p(x).$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f75452605551" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f75452605551-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f75452605551-1"><span class="crayon-v">qx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Bernoulli</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-cn">0.7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Оценим перекрестную энтропию.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f78253300780" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f78253300780-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f78253300780-1"><span class="crayon-o">-</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">reduce_mean</span><span class="crayon-sy">(</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">qx</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f7a937773108" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f7a937773108-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f7a937773108-1">&lt;tf.Tensor: shape=(), dtype=float32, numpy=1.1194144487380981&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Еще раз скажем, что 
			<span id="urvanov-syntax-highlighter-697701ce06f7d373889385" class="urvanov-syntax-highlighter-syntax urvanov-syntax-highlighter-syntax-inline  crayon-theme-familiar-my-copy crayon-theme-familiar-my-copy-inline urvanov-syntax-highlighter-font-consolas" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important;"><span class="crayon-pre urvanov-syntax-highlighter-code" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">qx</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span></span></span> возвращает вероятности значений выборки $D$ с точки зрения распределения $q(x).$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f7f302186092" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f7f302186092-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f7f302186092-1"><span class="crayon-v">qx</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">10</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f82006964878" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f82006964878-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f82006964878-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f82006964878-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f82006964878-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f82006964878-1">&lt;tf.Tensor: shape=(10,), dtype=float32, numpy=</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f82006964878-2">array([0.29999998, 0.29999998, 0.29999998, 0.29999998, 0.29999998,</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f82006964878-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.29999998, 0.29999998, 0.29999998, 0.7&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , 0.29999998],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f82006964878-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;dtype=float32)&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading">Метод максимального правдоподобия</h4>



<p>Продемонстрируем связь перекрестной энтропии и метода максимального правдоподобия. MLE-оценка предполагает</p>



<p>$$ \hat{\theta}_{MLE} = \underset{\theta}{\operatorname{argmax}} q(X;\theta) $$</p>



<p>Другими словами, нас интересуют такие параметры $\theta,$ которые максимизируют правдоподобие модели $q$ с учетом выборки $X$ из неизвестного распределения $p(x).$ Тогда,</p>



<p>$$ \begin{split} \hat{\theta}_{MLE} =&amp; \; \underset{\theta}{\operatorname{argmax}} q(X;\theta) \\ =&amp; \; \underset{\theta}{\operatorname{argmax}} \prod_{i=1}^N q(x_i;\theta) \\ =&amp; \; \underset{\theta}{\operatorname{argmax}} \sum_{i=1}^N \log q(x_i;\theta) \\ =&amp; \; \underset{\theta}{\operatorname{argmax}} \sum_{i=1}^N \frac{1}{N} \log q(x_i;\theta) \\ =&amp; \; \underset{\theta}{\operatorname{argmax}} \mathbb{E}_{p(x)} \bigg[ \log q(x;\theta) \bigg] \end{split} $$</p>



<p>Положив $q(x,\theta)=q(x),$</p>



<p>$$ \begin{split} \hat{\theta}_{MLE} =&amp; \; \underset{\theta}{\operatorname{argmax}} \mathbb{E}_{p(x)} \bigg[ \log q(x) \bigg] \\ =&amp; \; \underset{\theta}{\operatorname{argmin}} -\mathbb{E}_{p(x)} \bigg[ \log q(x) \bigg] \\ =&amp; \; \underset{\theta}{\operatorname{argmin}} \mathbb{E}_{p(x)} \bigg[ \frac{1}{\log q(x)} \bigg], \end{split} $$</p>



<p>мы придем к задаче поиска таких параметров, которые минимизируют перекрестную энтропию.</p>



<h3 class="wp-block-heading">Дивергенция Кульбака-Лейблера</h3>



<h4 class="wp-block-heading">Взгляд с разных сторон</h4>



<p><strong>Дивергенция Кульбака-Лейблера</strong> (Kullback–Leibler&nbsp;/laɪblər/ divergence, KL-divergence), $D_{\rm KL} (P \:\Vert\: Q),$ также называемая <strong>относительной энтропией</strong>, показывает, насколько увеличится длина кода при неоптимальном кодировнии языка $p(x)$ с помощью кода языка $q(x).$</p>



<p>В частности, в примере выше код каждого символа будет длиннее на</p>



<p>$$ D_{\rm KL} (P \:\Vert\: Q) = \mathrm{H}(P, Q)-\mathrm{H}(P) = \frac{7}{4}-\frac{3}{2} = \frac{1}{4} \text{ бита} $$</p>



<p>На $ D_{\rm KL} (P \:\Vert\: Q) $ можно взглянуть и так: перекрестная энтропия измеряет неопределенность, связанную с распределением $p(x),$ закодированным средствами $q(x);$ кроме этого отдельно измеряется неопределенность (энтропия) $p(x).$ Дивергенция позволяет изолировать дополнительную неопределенность, вносимую $q(x).$</p>



<p>Дивергенция Кульбака-Лейблера также определяется как математическое ожидание отклонения $p(x)$ от $q(x).$</p>



<p>$$ \begin{split} D_{\rm KL} (P \:\Vert\: Q) &amp;= \mathbb{E}_{p(x)} \left[ \log \frac{p(x)}{q(x)} \right] = \sum_{x \in \mathcal{X}} p(x) \log\frac{p(x)}{q(x)} \\ &amp;= \frac{1}{2} \log \frac{\tfrac{1}{2}}{\tfrac{1}{4}} + \frac{1}{4} \log \frac{\tfrac{1}{4}}{\tfrac{1}{2}} + \frac{1}{4} \log \frac{\tfrac{1}{4}}{\tfrac{1}{4}} = \frac{1}{2}-\frac{1}{4} + 0 = \frac{1}{4} \end{split} $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f85508869318" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f85508869318-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f85508869318-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f85508869318-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f85508869318-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f85508869318-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f85508869318-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f85508869318-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f85508869318-4"><span class="crayon-e">entropy</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">base</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f89403687732" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f89403687732-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f89403687732-1">0.25</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Кроме этого, $ D_{\rm KL} $ несложно вывести через отношение правдоподобия (likelihood ratio). Рассмотрим две монеты (C1 и C2) с вероятностями решки (H) и орла (T)</p>



<p>$$ \rm C1 = \begin{cases} p_1 \quad H \\ p_2 \quad T \end{cases} \qquad \rm C2 = \begin{cases} q_1 \quad H \\ q_2 \quad T \end{cases} $$</p>



<p>и соответствующими распределениями $P$ и $Q.$</p>



<p>Будем подбрасывать монеты и запишем результат $D.$ Предположим, что количество выпавших решек $N_H$ и орлов $N_T$ для обеих монет однаковое. Тогда,</p>



<p>$$ D_{C1} = p_1^{N_H} p_2^{N_T}, \qquad D_{C2} = q_1^{N_H} q_2^{N_T} $$</p>



<p>Найдем отношение правдоподобия двух монет.</p>



<p>$$ \frac{P (D_{C1} \mid C1)}{P (D_{C2} \mid C2)} = \frac{p_1^{N_H} p_2^{N_T}}{q_1^{N_H} q_2^{N_T}} $$</p>



<p>Возведем в степень $\tfrac{1}{N},$ где $N$ &#8212; общее количество наблюдений, возьмем логарифм и упростим выражение.</p>



<p>$$ \begin{split} \frac{P (D_{C1} \mid C1)}{P (D_{C2} \mid C2)} &amp;= \log \left( \frac{p_1^{N_H} p_2^{N_T}}{q_1^{N_H} q_2^{N_T}} \right)^\frac{1}{N} = \frac{1}{N}\log \left( \frac{p_1^{N_H} p_2^{N_T}}{q_1^{N_H} q_2^{N_T}} \right) \\[1ex] &amp;= \frac{1}{N} \log p_1^{N_H} + \frac{1}{N} \log p_2^{N_T}-\frac{1}{N} \log q_1^{N_H}-\frac{1}{N} \log q_2^{N_T} \\[1ex] &amp;= \frac{N_H}{N} \log p_1 + \frac{N_T}{N} \log p_2-\frac{N_H}{N} \log q_1-\frac{N_T}{N} \log q_2 \end{split} $$</p>



<p>По мере увеличения числа испытаний, т.е. при $N \rightarrow \infty$</p>



<p>$$ \begin{split} =&amp; \; p_1 \log p_1 + p_2 \log p_2-p_1 \log q_1-p_2 \log q_2 \\[1ex] =&amp; \; p_1 \log p_1-p_1 \log q_1 + p_2 \log p_2-p_2 \log q_2 \\ =&amp; \; p_1 \log \frac{p_1}{q_1} + p_2 \log \frac{p_2}{q_2} = \sum^2_{i=2} p_i \log \frac{p_i}{q_i} = D_{\rm KL} (P \:\Vert\: Q) \end{split} $$</p>



<p>Другими словами, через нормализованный логарифм отношения правдоподобия мы измеряем, насколько правдоподобно или близко к $P$ распределение $Q$ смогло бы генерировать наблюдения из распределения $P.$</p>



<h4 class="wp-block-heading">Непрерывные распределения</h4>



<p>В случае двух непрерывных распределений дивергенция рассчитывается через</p>



<p>$$ D_{\rm KL} (P \:\Vert\: Q) = \int_{\mathcal{X}} p(x) \log \frac{p(x)}{q(x)} \, \mathrm{d}x $$</p>



<h4 class="wp-block-heading">Функция ошибки</h4>



<p>Заметим, что при минимизации функции ошибки мы хотели бы оценить отклонение фактического распределения $p(x)$ от предполагаемого $q(x),$ то есть по сути найти</p>



<p>$$ D_{\rm KL} (P \:\Vert\: Q) = \mathrm{H}(P, Q)-\mathrm{H}(P), $$</p>



<p>однако поскольку в данной формуле $\mathrm{H}(P)$ является константой, нам достаточно минимизировать $\mathrm{H}(P, Q),$ то есть перекрестную энтропию.</p>



<h4 class="wp-block-heading">Взаимная информация как дивергенция</h4>



<p>Несложно увидеть, что взаимная информация является дивергенцией Кульбака-Лейблера между $p(x,y)$ и $p(x)p(y),$</p>



<p>$$ \begin{split} \mathrm{I}(X,Y) &amp;= D_{\rm KL} (p(x,y) \:\Vert\: p(x)p(y)) \\ &amp;= \sum_{x \in \mathcal{X}} \sum_{y \in \mathcal{Y}} p(x,y) \log \frac{p(x,y)}{p(x)p(y)}. \end{split} $$</p>



<p>Если $\mathrm{I}(X,Y)=0$ и расстояние между распределениями равно нулю, то $p(x,y)=p(x)p(y),$ и $X$ и $Y$ не зависят друг от друга. Одновременно, чем больше $\mathrm{I}(X,Y)$ и, соответственно, дивергенция Кульбака-Лейблера, тем сильнее зависимость.</p>



<h4 class="wp-block-heading">Свойства</h4>



<p>Как и перекрестная энтропия, дивергенция Кульбака-Лейблера не симметрична.</p>



<p>$$ D_{\rm KL} (P \:\Vert\: Q) \neq D_{\rm KL} (Q \:\Vert\: P) $$</p>



<p>При этом по неравенству Гиббса, $ D_{\rm KL} (P \:\Vert\: Q) \geq 0 $ и $ D_{\rm KL} (P \:\Vert\: Q) = 0 \iff P = Q.$</p>



<h4 class="wp-block-heading">Оценка дивергенции</h4>



<p>Приблизить дивергенцию Кульбака-Лейблера можно через</p>



<p>$$ D_{\rm KL} (P \:\Vert\: Q) \sim \frac{1}{N}\sum_{i=1}^N \log\left( \frac{p(x_i)}{q(x_i)} \right) $$</p>



<p>В библиотеке TensorFlow Probability для этого можно воспользоваться <strong>функцией kl_divergence()</strong>. Возьмем два распределения Бернулли и рассчитаем аналитическое значение дивергенции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f8c728215396" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f8c728215396-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f8c728215396-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f8c728215396-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f8c728215396-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f8c728215396-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.9</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f8c728215396-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f8c728215396-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f8c728215396-4"><span class="crayon-e">entropy</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f90449912103" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f90449912103-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f90449912103-1">0.7941600448957675</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Оценим $ D_{\rm KL}. $</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f92423355266" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f92423355266-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f92423355266-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f92423355266-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f92423355266-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f92423355266-1"><span class="crayon-v">px</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Bernoulli</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f92423355266-2"><span class="crayon-v">qx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Bernoulli</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-cn">0.7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f92423355266-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f92423355266-4"><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">kl_divergence</span><span class="crayon-sy">(</span><span class="crayon-v">px</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">qx</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f95750463790" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f95750463790-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f95750463790-1">&lt;tf.Tensor: shape=(), dtype=float32, numpy=0.794160008430481&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Полный перечень распределений, для которых можно рассчитать приближенное значение дивергенции Кульбака-Лейблера можно найти в документации.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f98734884262" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f98734884262-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f98734884262-1"><span class="crayon-k ">help</span><span class="crayon-sy">(</span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-v">kl_divergence</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>В случае если необходимая пара распределений отсутствует, можно воспользоваться одним из приведенных ниже способов.</p>



<p>Например, возьмем два категориальных (categorical) распределения или, что то же самое, два мультиномиальных распределения (multinomial) с одним испытанием.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f9b433420432" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f9b433420432-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f9b433420432-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f9b433420432-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06f9b433420432-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f9b433420432-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f9b433420432-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f9b433420432-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06f9b433420432-4"><span class="crayon-e">entropy</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06f9d058208535" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06f9d058208535-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06f9d058208535-1">0.17328679513998632</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fa0184576730" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fa0184576730-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fa0184576730-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fa0184576730-1"><span class="crayon-v">px</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Categorical</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fa0184576730-2"><span class="crayon-v">qx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Categorical</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>или</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fa2008936606" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fa2008936606-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fa2008936606-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fa2008936606-1"><span class="crayon-v">px</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Multinomial</span><span class="crayon-sy">(</span><span class="crayon-v">total_count</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-v">p</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fa2008936606-2"><span class="crayon-v">qx</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">distributions</span><span class="crayon-sy">.</span><span class="crayon-e">Multinomial</span><span class="crayon-sy">(</span><span class="crayon-v">total_count</span><span class="crayon-o">=</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">probs</span><span class="crayon-o">=</span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Создадим выборку из $p(x).$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fa5939186255" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fa5939186255-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fa5939186255-1"><span class="crayon-v">px_sample</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">px</span><span class="crayon-sy">.</span><span class="crayon-e">sample</span><span class="crayon-sy">(</span><span class="crayon-cn">200000</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Найдем приближенное значение дивергенции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fa7933936483" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fa7933936483-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fa7933936483-1"><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">reduce_mean</span><span class="crayon-sy">(</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">px</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">qx</span><span class="crayon-sy">.</span><span class="crayon-e">prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06faa940202791" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06faa940202791-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06faa940202791-1">&lt;tf.Tensor: shape=(), dtype=float32, numpy=0.17702987790107727&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fac096497948" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fac096497948-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fac096497948-1"><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-e">reduce_mean</span><span class="crayon-sy">(</span><span class="crayon-v">px</span><span class="crayon-sy">.</span><span class="crayon-e">log_prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">qx</span><span class="crayon-sy">.</span><span class="crayon-e">log_prob</span><span class="crayon-sy">(</span><span class="crayon-v">px_sample</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06faf444412834" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06faf444412834-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06faf444412834-1">&lt;tf.Tensor: shape=(), dtype=float32, numpy=0.17702987790107727&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Можно также воспользоваться модулем Variational Inference (VI).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fb2787385701" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb2787385701-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb2787385701-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb2787385701-1"><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">vi</span><span class="crayon-sy">.</span><span class="crayon-e">monte_carlo_variational_loss</span><span class="crayon-sy">(</span><span class="crayon-v">qx</span><span class="crayon-sy">.</span><span class="crayon-v">log_prob</span><span class="crayon-sy">,</span><span class="crayon-v">px</span><span class="crayon-sy">,</span><span class="crayon-cn">200000</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb2787385701-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">gradient_estimator</span><span class="crayon-o">=</span><span class="crayon-v">tfp</span><span class="crayon-sy">.</span><span class="crayon-v">vi</span><span class="crayon-sy">.</span><span class="crayon-v">GradientEstimators</span><span class="crayon-sy">.</span><span class="crayon-v">SCORE_FUNCTION</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fb4351163005" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb4351163005-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb4351163005-1">&lt;tf.Tensor: shape=(), dtype=float32, numpy=0.1717168390750885&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading">Дивергенция Йенсена-Шеннона</h3>



<p><strong>Дивергенция Йенсена-Шеннона</strong> (Jensen–Shannon divergence) $ D_{\rm JSD} $ или <strong>информационный радиус</strong> (IRad) представляет собой среднее $ D_{\rm KL} $ отклонение распределений $P$ и $Q$ от распределения $M$</p>



<p>$$ D_{\rm JSD} (P \:\Vert\: Q) = \frac{1}{2} D_{\rm KL} (P \:\Vert\: M) + \frac{1}{2} D_{\rm KL} (Q \:\Vert\: M), $$</p>



<p>где $ M = \tfrac{1}{2} (P + Q) $ &#8212; смесь вероятностных распределений (mixture distribution) $ f(x) = \sum_{k=1}^K w_i p_i(x) $ с весами $w_i$ равными $\tfrac{1}{2}.$</p>



<p>Благодаря такому подходу дивергенция Йенсена-Шеннона симметрична</p>



<p>$$ D_{\rm JSD} (P \:\Vert\: Q) = D_{\rm JSD} (Q \:\Vert\: P) $$</p>



<p>и ограничена (при использовании двоичного логарифма) диапазоном</p>



<p>$$ 0 \leq D_{\rm JSD} (P \:\Vert\: Q) \leq 1 $$</p>



<p>Приведем пример.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fb7099182691" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb7099182691-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">jensen_shannon_divergence</span><span class="crayon-sy">(</span><span class="crayon-v">P</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">Q</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">P</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">P</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">asarray</span><span class="crayon-sy">(</span><span class="crayon-v">Q</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-5"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">M</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">P</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">Q</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-7"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">kl_pm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">entropy</span><span class="crayon-sy">(</span><span class="crayon-v">P</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">base</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">kl_qm</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">entropy</span><span class="crayon-sy">(</span><span class="crayon-v">Q</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">M</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">base</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-10"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb7099182691-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">kl_pm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">kl_qm</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fb9068643132" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fb9068643132-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fb9068643132-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fb9068643132-1"><span class="crayon-v">p</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fb9068643132-2"><span class="crayon-v">q</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fbc442874798" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fbc442874798-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fbc442874798-1"><span class="crayon-e">jensen_shannon_divergence</span><span class="crayon-sy">(</span><span class="crayon-v">p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">q</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fbe624357366" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fbe624357366-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fbe624357366-1">0.14773092211916086</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading">Принцип максимальной энтропии</h3>



<h4 class="wp-block-heading">Ожидание такси</h4>



<p>Попробуем оценить (создать распределение) времени ожидания такси $X$ с момента вызова автомобиля. Для простоты предположим, что $X$ может составить 1, 2 или 3 минуты.</p>



<p>Пусть известно среднее время ожидания $\overline{x} = 2.$ При этом знание $\overline{x}$ не позволяет зафиксировать вероятности такого распределения. В самом деле, вероятности</p>



<p>$$ (p_1,p_2,p_3) = \left( \frac{1-p_2}{2}, p_2, \frac{1-p_2}{2} \right) $$</p>



<p>всегда будут удовлятворять этому ограничению. Например, $(0, 1, 0),$ $\left( \tfrac{1}{2}, 0, \tfrac{1}{2} \right) $ или $\left( \tfrac{1}{3}, \tfrac{1}{3}, \tfrac{1}{3} \right).$ Какое же распределение выбрать?</p>



<p>В соответствии с <strong>принципом максимальной энтропии</strong> (maximum entropy principle) наилучшим будет тот вариант, который максимизирует информационную энтропию с учетом имеющихся ограничений.</p>



<p>Другими словами, оптимальным будет такое распределение, которое позволяет нам оставаться в наибольшем неведении относительно того, какой исход наиболее вероятен.</p>



<p>Таким образом, нам нужно найти максимум функции энтропии $\mathrm{H}(p_1,p_2,p_3)$ с двумя ограничениями</p>



<p>$$ \begin{align} 1p_1 + 2p_2 + 3p_3=&amp; \; \overline{x} \quad \implies \quad \sum^3_{i=1} ip_i=\overline{x} \\ p_1+p_2+p_3=&amp; \; 1 \quad \implies \quad \sum^3_{i=1}p_i=1 \end{align} $$</p>



<p>Воспользуемся методом множителей Лагранжа,</p>



<p>$$ \begin{align} \frac{\partial \mathcal{L}}{\partial p_i} =&amp; \; \frac{\partial}{\partial p_i} \left[ \mathrm{H}[p_1,p_2,p_3]-\lambda \left( \sum^3_{i=1}ip_i-\overline{x} \right)-\mu\left(\sum^3_{i=1}-1\right) \right] \\ =&amp; \; \frac{\partial}{\partial p_i} \left[ -\sum^3_{i=1} p_i \log p_i-\lambda\sum^3_{i=1}ip_i-\mu\sum^3_{i=1}p_i\right] \\ =&amp; \; \sum^3_{i=1} \Bigl\{ -\log p_i-1-\lambda i-\mu \Bigr\} \partial p_i=0 \end{align} $$</p>



<p>Заметим, что поскольку каждая частная производная должна быть равна нулю, то</p>



<p>$$ -\log p_i-1-\lambda i-\mu=0, \qquad i = 1,2,3 $$</p>



<p>Положим $\lambda_0=\mu+1,$ тогда</p>



<p>$$ p_i=e^{-\lambda_0-\lambda i}. $$</p>



<p>Подставим полученное значение во второе ограничение.</p>



<p>$$ 1 = \sum^3_{i=1} p_i = e^{-\lambda_0} \sum^3_{i=1} e^{-\lambda i} \quad \implies \quad e^{-\lambda_0} = \frac{1}{e^{-\lambda}+e^{-2\lambda}+e^{-3\lambda}} $$</p>



<p>Откуда,</p>



<p>$$ p_i = \frac{e^{-\lambda i}}{e^{-\lambda}+e^{-2\lambda}+e^{-3\lambda}} = \frac{e^{\lambda(1-i)}}{1+e^{-\lambda}+e^{-2\lambda}} $$</p>



<p>Тогда первое ограничение,</p>



<p>$$ \overline{x} = \sum^3_{i=1} i p_i = \frac{1+2e^{-\lambda} + 3e^{-2\lambda}}{1+e^{-\lambda}+e^{-2\lambda}} \tag{1}$$</p>



<p>Решим уравнение относительно $e^{-\lambda}.$</p>



<p>$$ (\overline{x}-3)(e^{-\lambda})^2 + (\overline{x}-2) e^{-\lambda} + \overline{x}-1 = 0 $$</p>



<p>$$ \begin{align} e^{-\lambda} =&amp; \; \frac{-(\overline{x}-2) \pm \sqrt{(\overline{x}-2)^2-4(\overline{x}-3)(\overline{x}-1)}}{2(\overline{x}-2)} \\ =&amp; \; \frac{2-\overline{x} \pm \sqrt{4-3(\overline{x}-2)^2} }{ 2(\overline{x}-3) } \end{align} $$</p>



<p>Перепишем $(1).$</p>



<p>$$ \overline{x} = \frac{e^\lambda+2+3e^{-\lambda}}{e^{\lambda}+1+e^{-\lambda}} = 1 + \frac{1+2e^{-\lambda}}{e^{\lambda}+1+e^{-\lambda}} $$</p>



<p>Тогда для $p_2$ получим,</p>



<p>$$ \begin{align} p_2 =&amp; \; \frac{1}{e^{-\lambda}+1+e^{\lambda}} = \frac{\overline{x}-1}{1+2e^{-\lambda}} = \frac{\overline{x}-1}{1+\tfrac{1}{\overline{x}-3} \big( 2-\overline{x} \pm \sqrt{4-3(\overline{x}-2)^2} \big)} \\[1ex] =&amp; \; \frac{(\overline{x}-1)(\overline{x}-3)}{-1\pm \sqrt{4-3(\overline{x}-2)^2}} = \frac{(\overline{x}-1)(\overline{x}-3)(-1\pm\sqrt{4-3(\overline{x}-2)^2})}{1-(4-3(\overline{x}-2)^2)} \\[1ex] =&amp; \; \frac{-1\pm\sqrt{4-3(\overline{x}-2)^2}}{3}\end{align} $$</p>



<p>Неотрицательное решение $p_2$ дает только корень со знаком $+.$</p>



<p>$$ p_2 = \frac{-1+\sqrt{4-3(\overline{x}-2)^2}}{3} $$</p>



<p>Наконец,</p>



<p>$$ p_1 = \frac{3-\overline{x}-p_2}{2}, \qquad p_3 = \frac{\overline{x}-1-p_2}{2} $$</p>



<p>При $\overline{x}=2, $</p>



<p>$$ (p_1,p_2,p_3) = \left( \frac{1}{3}, \frac{1}{3}, \frac{1}{3} \right), $$</p>



<p>что отражает тот факт, что даже зная среднее время ожидания, мы не можем игнорировать вероятность других исходов.</p>



<p>Нулевая вероятность получается только в случае, когда исход невозможен.</p>



<p>$$ \begin{align} \overline{x}=1 \quad \implies \quad (p_1,p_2,p_3) = (1, 0, 0) \\ \overline{x}=3 \quad \implies \quad (p_1,p_2,p_3) = (0, 0, 1) \end{align} $$</p>



<h4 class="wp-block-heading">Дискретное равномерное распределение</h4>



<p>В целом же, если единственным ограничением распределения с носителем $\{ 1, \ldots, N \}$ будет $\sum_{i=1}^N p_i =1,$ то распределением с максимальной энтропией всегда будет равномерное распределение.</p>



<p>Докажем это. Рассмотрим функцию Лагранжа</p>



<p>$$ \begin{align} \mathcal{L}(p_i, \lambda_0) =&amp; \; \mathrm{H}[p_i]-\lambda_0 \left( \sum_{i=1}^N p_i-1\right) \\ =&amp; \; -\sum_{i=1}^N p_i \ln p_i-\lambda_0 \left( \sum_{i=1}^N p_i-1 \right) \end{align} $$</p>



<p>Найдем частные производные и приравняем их к нулю.</p>



<p>$$ \begin{align} \frac{\partial \mathcal{L}}{\partial p_i} =&amp; \; -\ln p_i-p_i \frac{1}{p_i}-\lambda_0 \\ =&amp; \; -\ln p_i-1-\lambda_0 = 0 \end{align}$$</p>



<p>Отсюда $ p_i = e^{-1-\lambda_0}. $ Обратим внимание, что значение $p_i$ не зависит от $i,$ а значит,</p>



<p>$$ \sum_{i=1}^N p_i = N \cdot e^{-1-\lambda_0} = 1 \quad \implies \quad e^{-1-\lambda_0} = p_i = \frac{1}{N}. $$</p>



<p>Таким образом, речь идет о равномерном распределении.</p>



<p>Дополнительно убедимся, что мы нашли локальный максимум. В частности, покажем, что матрица Гессе отрицательно определена.</p>



<p>$$ \frac{\partial^2 \mathcal{L}}{\partial p_i \partial p_j} = -\frac{1}{p_i} \delta_{ij} = \begin{cases} -\frac{1}{p_i}, &amp; i=j \\ 0 &amp; i \neq j \end{cases} $$</p>



<p>Теперь докажем, что дискретное равномерное распределение обладает наибольшей энтропией на конечном носителе.</p>



<p>Рассмотрим дивергенцию Кульбака-Лейблера</p>



<p>$$ \begin{align} 0 \leq D_{\rm KL} (f \:\Vert\: g) &amp;= \sum_{x \in \mathcal{X}} f(x) \log \frac{f(x)}{g(x)} \\[1ex] &amp;= \sum_{x \in \mathcal{X}} f(x) \log f(x)-\sum_{x \in \mathcal{X}} f(x) \log g(x) \\[1ex] &amp;= -\mathrm{H}[f(x)]-\sum_{x \in \mathcal{X}} f(x) \log g(x) \tag{2} \end{align}  $$</p>



<p>Пусть $g(x)$ &#8212; равномерное распределение $\mathcal{U}(1,N).$ Тогда,</p>



<p>$$ \begin{split} \sum_{x \in \mathcal{X}} f(x) \log g(x) &amp;= \sum_{i=1}^{N} f(x) \log \frac{1}{n-1+1} \\[1ex] &amp;= \log \frac{1}{N} \sum_{i=1}^{N} f(x) \\[1ex] &amp;= -\log(N), \end{split} $$</p>



<p>что является отрицательной энтропией равномерного распределения. Таким образом,</p>



<p>$$ \sum_{x \in \mathcal{X}} f(x) \log g(x) = -\mathrm{H}[\mathcal{U}(1,n)] = -\mathrm{H}[g(x)] \tag{3} $$</p>



<p>Объединим $(2)$ и $(3).$</p>



<p>$$ \begin{split} 0 &amp;\leq D_{\rm KL} (f \:\Vert\: g) \\[1ex] 0 &amp;\leq -\mathrm{H}[f(x)]-\left( -\mathrm{H}[g(x)] \right) \\[1ex] \mathrm{H}[g(x)] &amp;\geq \mathrm{H}[f(x)] \end{split} $$</p>



<h4 class="wp-block-heading">Другое время ожидания</h4>



<p>Используем другую аналогию и вместо ожидания такси будем бросать нечестную игральную кость, матожидание значений которой равно не 3,5, а 4,5. Найдем максимум функции Лагранжа.</p>



<p>$$ \mathcal{L}(p_1, \ldots, p_6, \lambda_0, \lambda_1) = -\sum_{i=1}^{6} p_i\ln p_i-\lambda_0 \left(\sum_{i=1}^{6} p_i-1\right)-\lambda_1\left(\sum_{i=1}^{6} i p_i-\overline{x}\right) $$</p>



<p>$$ \begin{align} \frac{\partial \mathcal{L}}{\partial p_i} &amp;= -\ln p_i-1-\lambda_0-i \lambda_1 = 0 \\ \ln p_i &amp;=-1-\lambda_0-i\lambda_1 \\ p_i &amp;= e^{-1-\lambda_0-i \lambda_1} \tag{4} \end{align} $$</p>



<p>Выпишем ограничения.</p>



<p>$$ \begin{align} \sum_{i=1}^{6} p_i &amp;= 1 \tag{5} \\ \sum_{i=1}^{6} i p_i &amp;= \overline{x} \tag{6} \end{align} $$</p>



<p>Подставим $(4)$ в $(5).$</p>



<p>$$ Z(\lambda_1) = e^{-1-\lambda_0} = \frac{1}{\sum_{i=1}^6 e^{-i \lambda_1}} \tag{7} $$</p>



<p>Теперь подставим $(4)$ в $(5)$ и $(6),$ и разделим $(6)$ на $(5).$</p>



<p>$$ \begin{align} &amp; \frac{\sum_{i=1}^{6} i e^{-1-\lambda_0-i \lambda_1}}{\sum_{i=1}^{6} e^{-1-\lambda_0-i \lambda_1}} = \overline{x} \\ \quad \implies \quad &amp; f(\lambda_1) = \frac{\sum_{i=1}^{6} i e^{-i \lambda_1}}{\sum_{i=1}^{6} e^{-i \lambda_1}}-\overline{x} = \frac{\sum_{i=1}^{6} i e^{-i \lambda_1}}{Z(\lambda_1)}-\overline{x} \tag{8} \end{align} $$</p>



<p>Выразим $(4)$ через $(7).$</p>



<p>$$ p_i = \frac{1}{Z(\lambda_1)}e^{- i \lambda_1} \tag{9} $$</p>



<p>Воспользуемся методом Ньютона-Рафсона для поиска оптимального значения $\lambda_1$ из $(8).$ После этого рассчитаем вероятности через $(9).$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fc3751059862" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc3751059862-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">scipy</span><span class="crayon-sy">.</span><span class="crayon-e">optimize </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">newton</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-3"><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x_bar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-5"><span class="crayon-c"># (7)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">z</span><span class="crayon-sy">(</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">1.</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-o">*</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-9"><span class="crayon-c"># (8)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-10"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-o">*</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">z</span><span class="crayon-sy">(</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">_</span>bar</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-14"><span class="crayon-c"># (9)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-15"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">p</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc3751059862-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">z</span><span class="crayon-sy">(</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fc7391455778" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc7391455778-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fc7391455778-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fc7391455778-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc7391455778-1"><span class="crayon-v">lambda_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">newton</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fc7391455778-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fc7391455778-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"p_%d = %.4f"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">p</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fca158068685" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fca158068685-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fca158068685-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fca158068685-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fca158068685-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fca158068685-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fca158068685-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fca158068685-1">p_1 = 0.0544</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fca158068685-2">p_2 = 0.0788</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fca158068685-3">p_3 = 0.1142</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fca158068685-4">p_4 = 0.1654</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fca158068685-5">p_5 = 0.2398</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fca158068685-6">p_6 = 0.3475</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В случае честной игральной кости вероятности ожидаемо будут одинаковыми. </p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fcd236233915" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fcd236233915-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fcd236233915-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fcd236233915-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fcd236233915-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fcd236233915-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fcd236233915-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fcd236233915-1"><span class="crayon-v">x_bar</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fcd236233915-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fcd236233915-3"><span class="crayon-c"># (8)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fcd236233915-4"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fcd236233915-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-o">*</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fcd236233915-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">z</span><span class="crayon-sy">(</span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x_bar</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fcf666538672" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fcf666538672-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fcf666538672-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fcf666538672-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fcf666538672-1"><span class="crayon-v">lambda_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">newton</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x0</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fcf666538672-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">a</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fcf666538672-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"p_%d = %.4f"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">p</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lambda_</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697701ce06fd2619752049" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fd2619752049-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fd2619752049-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fd2619752049-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fd2619752049-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697701ce06fd2619752049-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697701ce06fd2619752049-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fd2619752049-1">p_1 = 0.1667</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fd2619752049-2">p_2 = 0.1667</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fd2619752049-3">p_3 = 0.1667</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fd2619752049-4">p_4 = 0.1667</div><div class="crayon-line" id="urvanov-syntax-highlighter-697701ce06fd2619752049-5">p_5 = 0.1667</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697701ce06fd2619752049-6">p_6 = 0.1667</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading">Энтропия по Валлису</h4>



<p>Поставим задачу создать дискретное распределение ${\bf p} = [p_1, \ldots, p_m]$ c $m$ возможными исходами, соответствующее некоторому ограничению (например, матожиданию). Для этого,</p>



<ol class="wp-block-list">
<li>будем <em>случайно</em> и <em>равномерно</em> присваивать по одному из $N$ наблюдений одному из исходов так, чтобы каждому $m_i$ исходу соответствовало $\frac{n_i}{N},$ $ \sum_{i=1}^m n_i = N$ объектов;</li>



<li>если получившееся распределение удовлетворяет заданному ограничению, то задачу можно считать выполенной и $p_i = \frac{n_i}{N};$ если нет, повторим шаг 1.</li>
</ol>



<p>Покажем, что по мере увеличения $N,$ наиболее подходящим распределением с учетом заданных ограничений будет распределение, максимизирующее энтропию.</p>



<p>Вероятность такого распределения $\bf q$ следует мультиномиальному закону</p>



<p>$$ P({\bf q}) = \frac{N!}{n_1! \ldots n_m!} q_1^{n_1} q_2^{n_2} \ldots q_m^{n_m}. $$</p>



<p>При этом по условию каждый из $m$ исходов равновероятен $q_i=\frac{1}{m}$ и $ \sum_{i=1}^m n_i = N, $ а значит</p>



<p>$$ P({\bf q}) = \frac{N!}{n_1!\ldots n_m!}m^{-N}. $$</p>



<p>Заметим, что $m$ &#8212; константа, поэтому достаточно максимизировать</p>



<p>$$ W = \frac{N!}{n_1!\ldots n_m!} $$</p>



<p>или, что то же самое, $ \frac{1}{N}\log W $</p>



<p>$$ \begin{align} \frac{1}{N} \log W &amp;= \frac{1}{N} \log \frac{N!}{n_1!n_2!\ldots n_m!} \\[1ex] &amp;= \frac{1}{N} \log \frac{N!}{(N\cdot p_1)!(N\cdot p_2)!\ldots (N\cdot p_3)!} \\[1ex] &amp;= \frac{1}{N} \Big( \log N!-\sum_{i=1}^m \log((N\cdot p_i)!) \Big) \end{align} $$</p>



<p>Используя формулу Стирлинга,</p>



<p>$$ \log(n!) = n\log n -n + \mathcal{O}(\log n), $$</p>



<p>вычислим предел $ \frac{1}{N}\log W $ при $N \to \infty$ и упростим выражение</p>



<p>$$ \begin{align} \lim_{N\to\infty} \frac{1}{N} \log W &amp;= \lim_{N\to\infty} \frac{1}{N} \Big( \log N!-\sum_{i=1}^m \log((N\cdot p_i)!) \Big) \\ &amp;= \lim_{N\to\infty} \frac{1}{N} \Big( N\log N-n + \mathcal{O}(\log N) \\ &amp;\hspace{1em}-\sum_{i=1}^m (N\cdot p_i)\log(N\cdot p_i)-(N\cdot p_i) + \mathcal{O}(\log (N\cdot p_i)) \Big) \\ &amp;= \lim_{N\to\infty} \frac{1}{N} \Big( N\log N-\sum_{i=1}^m (N\cdot p_i)\log(N\cdot p_i) \Big) \\ &amp;= \lim_{N\to\infty} \log N-\sum_{i=1}^m p_i\log(N\cdot p_i) \\ &amp;= \lim_{N\to\infty} \log N-\log N \sum_{i=1}^m p_i-\sum_{i=1}^m p_i\log p_i \\ &amp;= \lim_{N\to\infty} \log N-\log N-\sum_{i=1}^m p_i\log p_i \\ &amp;= \lim_{N\to\infty}-\sum_{i=1}^m p_i\log p_i \\ &amp;= -\sum_{i=1}^m p_i\log p_i \\[1ex] &amp;= \mathrm{H}({\bf p}). \end{align} $$</p>



<h4 class="wp-block-heading">Непрерывное равномерное распределение</h4>



<p>Как и в дискретном случае, непрерывное равномерное распределение естественным образом следует из ограничения $\int_a^b p(x)dx=1.$</p>



<p>$$ \mathcal{L}(p(x), \lambda_0) =-\int_{a}^{b}p(x) \ln p(x) dx-\lambda_0 \left(\int_{a}^{b}p(x)dx-1 \right) $$</p>



<p>Откуда,</p>



<p>$$ \frac{\partial \mathcal{L}}{\partial p(x)} = -1-\ln p(x)-\lambda_0=0 $$</p>



<p>$$ p(x)=e^{(-1-\lambda_0)}, \tag{10}$$</p>



<p>с ограничением</p>



<p>$$ \int_{a}^{b} p(x)dx = \int_{a}^{b} e^{-1-\lambda_0} dx=1. \tag{11} $$</p>



<p>При этом опять же матрица Гессе отрицательно определена,</p>



<p>$$ \frac{\partial^2 \mathcal{L}}{\partial p(x)^2 dx} = -\frac{1}{p(x)}. $$</p>



<p>Решив $(11)$ относительно $\lambda_0,$ получим</p>



<p>$$ \begin{align} \int_a^b e^{(-1-\lambda_0)} dx &amp;= 1 \\[1ex] e^{(-1-\lambda_0)} \int_a^b dx &amp;= 1 \\[1ex] e^{(-1-\lambda_0)} (b-a)&amp;=1 \\[1ex] e^{(-1-\lambda_0)} &amp;= \frac{1}{b-a} \\[1ex] -1-\lambda_0 &amp;= \ln \frac{1}{b-a} \\[1ex] \lambda_0 &amp;= -1-\ln \frac{1}{b-a} \end{align} $$</p>



<p>Подставив в $(10),$</p>



<p>$$ p(x) = e^{(-1-\lambda_0)} = e^{\left(-1-\left(-1-\ln \frac{1}{b-a} \right)\right)} = \frac{1}{b-a} $$</p>



<h4 class="wp-block-heading">Нормальное распределение</h4>



<p>Если же нам известна дисперсия $\sigma^2$ (а значит и $\mu$), то максимальной энтропией будет обладать нормальное распределение. </p>



<p>$$ \begin{align} \mathcal{L}(p(x), \lambda_0, \lambda_1) =&amp; -\int_{-\infty}^{\infty} p(x) \ln p(x)dx+\lambda_0 \left(\int_{-\infty}^{\infty} p(x)dx-1 \right) \\ &amp; +\lambda_1\left(\int_{-\infty}^{\infty}(x-\mu)^2 p(x) dx-\sigma^2 \right) \end{align} $$</p>



<p>Откуда,</p>



<p>$$ \frac{\partial \mathcal{L}}{\partial p(x)} = -(1+\ln p(x))+\lambda_0+\lambda_1 (x-\mu)^2 = 0 $$</p>



<p>$$ p(x)=e^{\lambda_0+\lambda_1 (x-\mu)^2-1}=e^{\lambda_0-1}e^{\lambda_1 (x-\mu)^2} \tag{12} $$</p>



<p>с ограничениями</p>



<p>$$ \int_{-\infty}^{\infty} p(x) dx = \int_{-\infty}^{\infty} e^{\lambda_0+\lambda_1 (x-\mu)^2-1} dx = 1 $$</p>



<p>$$ \int_{-\infty}^{\infty} p(x)(x-\mu)^{2}dx = \int_{-\infty}^{\infty}(x-\mu)^2 e^{\lambda_0+\lambda_1 (x-\mu)^2-1} dx = \sigma^2 $$</p>



<p>Из первого ограничения получим</p>



<p>$$ e^{\lambda_0-1} \sqrt{-\frac{\pi}{\lambda_1}} = 1. $$</p>



<p>Из второго</p>



<p>$$ e^{\lambda_0-1} = \sqrt{\frac{1}{2\pi}} \frac{1}{\sigma} $$</p>



<p>Тогда,</p>



<p>$$ \lambda_1=\frac{-1}{2\sigma^2} $$</p>



<p>Подставив результаты для $e^{\lambda_0-1}$ и $\lambda_1$ в $(12),$ найдем, что</p>



<p>$$ p(x)= \sqrt{\frac{1}{2\pi}} \frac{1}{\sigma} e^{\frac{-1}{2\sigma^2}(x-\mu)^2} = \frac{1}{\sigma\sqrt{2\pi}}\exp{\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)} $$</p>



<p>является функцией плотности нормального распределения.</p>



<p>Теперь докажем, что нормальное равномерное распределение обладает наибольшей энтропией при известной дисперсии.</p>



<p>Рассмотрим дивергенцию Кульбака-Лейблера</p>



<p>$$ \begin{align} 0 \leq D_{\rm KL} (f \:\Vert\: g) &amp;= \int_{\mathcal{X}} f(x) \log \frac{f(x)}{g(x)} \, \mathrm{d}x \\ &amp;= \int_{\mathcal{X}} f(x) \log f(x) \; \mathrm{d}x-\int_{\mathcal{X}} f(x) \log g(x) \, \mathrm{d}x \\ &amp;= -\mathrm{H}[f(x)]-\int_{\mathcal{X}} f(x) \log g(x) \, \mathrm{d}x \tag{13} \end{align}  $$</p>



<p>Подставим во второе слагаемое функцию плотности нормального распределения.</p>



<p>$$ \begin{split} \int_{\mathcal{X}} f(x) \log g(x) \, \mathrm{d}x &amp;= \int_{\mathcal{X}} f(x) \log \left( \frac{1}{\sqrt{2 \pi} \sigma} \cdot \exp \left[ -\frac{1}{2} \left( \frac{x-\mu}{\sigma} \right)^2 \right] \right) \, \mathrm{d}x \\ &amp;= \int_{\mathcal{X}} f(x) \log \left( \frac{1}{\sqrt{2 \pi \sigma^2}} \right) \, \mathrm{d}x \\ &amp; \quad \; + \int_{\mathcal{X}} f(x) \log \left( \exp \left[ -\frac{(x-\mu)^2}{2 \sigma^2} \right] \right) \, \mathrm{d}x \\ &amp;= -\frac{1}{2} \log \left( 2 \pi \sigma^2 \right) \int_{\mathcal{X}} f(x) \, \mathrm{d}x-\frac{\log(e)}{2 \sigma^2} \int_{\mathcal{X}} f(x) (x-\mu)^2 \, \mathrm{d}x \end{split} $$</p>



<p>Поскольку $\int_{\mathcal{X}} f(x) \, \mathrm{d}x=1,$ а второй центральный момент $ \int_{\mathcal{X}} f(x) (x-\mu)^2 \, \mathrm{d}x$ &#8212; это дисперсия $\sigma^2,$ то</p>



<p>$$ \begin{split} \int_{\mathcal{X}} f(x) \log g(x) \, \mathrm{d}x &amp;= -\frac{1}{2} \log \left( 2 \pi \sigma^2 \right)-\frac{\log(e) \sigma^2}{2 \sigma^2} \\ &amp;= -\frac{1}{2} \left[ \log \left( 2 \pi \sigma^2 \right) + \log(e) \right] \\ &amp;= -\frac{1}{2} \log \left( 2 \pi \sigma^2 e \right), \end{split} $$</p>



<p>что представляет собой отрицательную энтропию нормального распределения. Таким образом,</p>



<p>$$ \int_{\mathcal{X}} f(x) \log g(x) \, \mathrm{d}x = -\mathrm{H}[\mathcal{N}(\mu,\sigma^2)] = -\mathrm{H}[g(x)] \tag{14} $$</p>



<p>Объединим $(13)$ и $(14).$</p>



<p>$$ \begin{split} 0 &amp;\leq D_{\rm KL} (f \:\Vert\: g) \\[1ex] 0 &amp;\leq -\mathrm{H}[f(x)]-\left( -\mathrm{H}[g(x)] \right) \\[1ex] \mathrm{H}[g(x)] &amp;\geq \mathrm{H}[f(x)] \end{split} $$</p>



<h3 class="wp-block-heading">Список литературы</h3>



<ul class="wp-block-list">
<li>Shannon C.E., <a href="https://people.math.harvard.edu/~ctm/home/text/others/shannon/entropy/entropy.pdf" target="_blank" rel="noreferrer noopener">A Mathematical Theory of Communication</a>⧉, Bell Syst. Tech. J., 1948</li>



<li>Cover T.A., Thomas J.A., Elements of Information Theory, Wiley, 2006</li>



<li>MacKay D., Information Theory, Inference, and Learning Algorithms, Cambridge University Press, 2003</li>



<li>Jaynes E. T., Probability Theory: The Logic of Science, Cambridge University Press, 2003</li>



<li><a href="https://favtutor.com/blogs/huffman-coding" target="_blank" rel="noreferrer noopener">Huffman Coding with Python Implementation</a>⧉</li>



<li>Statistical Mechanics of Complex Systems, <a href="https://warwick.ac.uk/fac/cross_fac/complexity/study/msc_and_phd/co904/co904online/lecture-3-4.pdf" target="_blank" rel="noreferrer noopener">Lecture 3-4</a>⧉, University of Warwick, 2011</li>



<li>van Enk S. J., <a href="https://arxiv.org/pdf/1408.6803" target="_blank" rel="noreferrer noopener">The Brandeis Dice Problem and Statistical Mechanics</a>⧉, University of Oregon, 2014</li>



<li>Finlayson S., <a href="https://sgfin.github.io/2017/03/16/Deriving-probability-distributions-using-the-Principle-of-Maximum-Entropy/" target="_blank" rel="noreferrer noopener">Deriving probability distributions using the Principle of Maximum Entropy</a>⧉</li>
</ul>



<p></p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2026 <a href="../index.html" class="site-name"><!--Дмитрий Макаров-->Дмитрий Макаров</a></p>

			</footer> <!-- footer -->

		</main>
		
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(100123342, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/100123342" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

		<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"/*"},{"not":{"href_matches":["/wp-*.php","/wp-admin/*","/wp-content/uploads/*","/wp-content/*","/wp-content/plugins/*","/wp-content/themes/mcluhan/*","/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.9" id="mathjax-js"></script>
<script type="text/javascript" src="../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https://www.dmitrymakarov.ru/wp-admin/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"infotheory-02\"}"};
//# sourceURL=mcluhan_global-js-extra
/* ]]> */
</script>
<script type="text/javascript" src="../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
<script id="wp-emoji-settings" type="application/json">
{"baseUrl":"https://s.w.org/images/core/emoji/17.0.2/72x72/","ext":".png","svgUrl":"https://s.w.org/images/core/emoji/17.0.2/svg/","svgExt":".svg","source":{"concatemoji":"https://www.dmitrymakarov.ru/wp-includes/js/wp-emoji-release.min.js?ver=6.9"}}
</script>
<script type="module">
/* <![CDATA[ */
/*! This file is auto-generated */
const a=JSON.parse(document.getElementById("wp-emoji-settings").textContent),o=(window._wpemojiSettings=a,"wpEmojiSettingsSupports"),s=["flag","emoji"];function i(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function c(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0);const a=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);return t.every((e,t)=>e===a[t])}function p(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var n=e.getImageData(16,16,1,1);for(let e=0;e<n.data.length;e++)if(0!==n.data[e])return!1;return!0}function u(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\u1fac8")}return!1}function f(e,t,n,a){let r;const o=(r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),s=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(e=>{s[e]=t(o,e,n,a)}),s}function r(e){var t=document.createElement("script");t.src=e,t.defer=!0,document.head.appendChild(t)}a.supports={everything:!0,everythingExceptFlag:!0},new Promise(t=>{let n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),c.toString(),p.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"});const r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=e=>{i(n=e.data),r.terminate(),t(n)})}catch(e){}i(n=f(s,u,c,p))}t(n)}).then(e=>{for(const n in e)a.supports[n]=e[n],a.supports.everything=a.supports.everything&&a.supports[n],"flag"!==n&&(a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&a.supports[n]);var t;a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&!a.supports.flag,a.supports.everything||((t=a.source||{}).concatemoji?r(t.concatemoji):t.wpemoji&&t.twemoji&&(r(t.twemoji),r(t.wpemoji)))});
//# sourceURL=https://www.dmitrymakarov.ru/wp-includes/js/wp-emoji-loader.min.js
/* ]]> */
</script>
			
	</body>
</html>


<!-- Page supported by LiteSpeed Cache 7.7 on 2026-01-26 08:55:26 -->