<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Преобразование датафреймов | Анализ и обработка данных</title>
	<meta name="description" content="Продолжим изучать библиотеку Pandas и ее основной объект: датафрейм. В частности, сегодня мы поговорим про преобразование датафреймов." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Преобразование датафреймов | Анализ и обработка данных" />
	<meta property="og:description" content="Продолжим изучать библиотеку Pandas и ее основной объект: датафрейм. В частности, сегодня мы поговорим про преобразование датафреймов." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/data/dataframe/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2025-01-01T05:21:59+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2022/07/copy_method_pandas.jpg" />
	<meta property="og:image:width" content="688" />
	<meta property="og:image:height" content="419" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="13 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/data/dataframe/","url":"https://www.dmitrymakarov.ru/data/dataframe/","name":"Преобразование датафреймов | Анализ и обработка данных","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/data/dataframe/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/data/dataframe/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/07/copy_method_pandas.jpg","datePublished":"2022-08-25T08:16:43+00:00","dateModified":"2025-01-01T05:21:59+00:00","description":"Продолжим изучать библиотеку Pandas и ее основной объект: датафрейм. В частности, сегодня мы поговорим про преобразование датафреймов.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/data/dataframe/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/data/dataframe/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/data/dataframe/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/07/copy_method_pandas.jpg","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/07/copy_method_pandas.jpg","width":688,"height":419},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/data/dataframe/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Анализ и обработка данных","item":"https://www.dmitrymakarov.ru/data/"},{"@type":"ListItem","position":3,"name":"Преобразование датафреймов"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-14849 page-child parent-pageid-1408 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa62563753c">Поиск:</label>
	<input type="search" id="search-form-67aa62563753c" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa6256375e2">Поиск:</label>
	<input type="search" id="search-form-67aa6256375e2" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-14849 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Преобразование датафреймов</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Анализ и обработка данных</a></p>



<p>Продолжим работу по изучению <a href="../pandas/index.html">библиотеки Pandas</a>. Сегодня мы поговорим про возможности изменения и соединения датафреймов, а также про способы группировки данных.</p>



<p class="has-background" style="background-color:#ffe8c4">Хотя сами по себе эти навыки являются скорее вспомогательными, овладеть ими совершенно необходимо, если вы хотите быстро и эффективно строить модели ML.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/1bArmlfuCfXxgRNhM_2AsG-kuDgFmzTi0?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<h2 class="wp-block-heading" id="0-izmenenie-datafreyma">Изменение датафрейма</h2>



<p>Вернемся к тому датафрейму, с которым мы работали на прошлом занятии.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6bb428028644" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6bb428028644-24">24</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-1"><span class="crayon-c"># создадим несколько списков и массивов Numpy с информацией о семи странах мира</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-2"><span class="crayon-v">country</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'China'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Vietnam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'United Kingdom'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Russia'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Argentina'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Bolivia'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'South Africa'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-3"><span class="crayon-v">capital</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Beijing'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Hanoi'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'London'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Moscow'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Buenos Aires'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Sucre'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Pretoria'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-4"><span class="crayon-v">population</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1400</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">97</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">67</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">144</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">59</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-c"># млн. человек</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-5"><span class="crayon-v">area</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">9.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.2</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-c"># млн. кв. км.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-6"><span class="crayon-v">sea</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-c"># выход к морю (в этом списке его нет только у Боливии)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-8"><span class="crayon-c"># кроме того создадим список кодов стран, которые станут индексом датафрейма</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-9"><span class="crayon-v">custom_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'CN'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'VN'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GB'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'RU'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AR'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'BO'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ZA'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-11"><span class="crayon-c"># создадим пустой словарь</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-12"><span class="crayon-v">countries_dict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-14"><span class="crayon-c"># превратим эти списки в значения словаря,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-15"><span class="crayon-c"># одновременно снабдив необходимыми ключами</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-16"><span class="crayon-v">countries_dict</span><span class="crayon-sy">[</span><span class="crayon-s">'country'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">country</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-17"><span class="crayon-v">countries_dict</span><span class="crayon-sy">[</span><span class="crayon-s">'capital'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">capital</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-18"><span class="crayon-v">countries_dict</span><span class="crayon-sy">[</span><span class="crayon-s">'population'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">population</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-19"><span class="crayon-v">countries_dict</span><span class="crayon-sy">[</span><span class="crayon-s">'area'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">area</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-20"><span class="crayon-v">countries_dict</span><span class="crayon-sy">[</span><span class="crayon-s">'sea'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">sea</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-22"><span class="crayon-c"># создадим датафрейм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-23"><span class="crayon-v">countries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">countries_dict</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">custom_index</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6bb428028644-24"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img fetchpriority="high" decoding="async" width="688" height="419" src="../../wp-content/uploads/2022/07/copy_method_pandas.jpg" alt="датафрейм библиотеки Pandas" class="wp-image-14293" style="width:472px;height:287px" srcset="../../wp-content/uploads/2022/07/copy_method_pandas.jpg 688w, ../../wp-content/uploads/2022/07/copy_method_pandas-300x183.jpg 300w, ../../wp-content/uploads/2022/07/copy_method_pandas-600x365.jpg 600w" sizes="(max-width: 688px) 100vw, 688px" /></figure>



<p>Посмотрим, как мы можем преобразовать этот датафрейм.</p>



<h3 class="wp-block-heading" id="1-kopirovanie-datafreyma">Копирование датафрейма</h3>



<h4 class="wp-block-heading" id="2-metod-copy">Метод .copy()</h4>



<p>В первую очередь поговорим про важную особенность при копировании датафрейма. Вначале создадим копию датафрейма с помощью простого присвоения этого объекта новой переменной.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6dd657405095" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6dd657405095-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6dd657405095-1"><span class="crayon-v">countries_new</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Теперь удалим строку с данными про Аргентину, а после этого выведем исходный датафрейм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e0410176355" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e0410176355-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e0410176355-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e0410176355-1"><span class="crayon-v">countries_new</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'AR'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e0410176355-2"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img decoding="async" width="642" height="365" src="../../wp-content/uploads/2022/07/copy_through_assignment.jpg" alt="копирование датафрейма через запись в переменную" class="wp-image-14292" style="width:475px;height:270px" srcset="../../wp-content/uploads/2022/07/copy_through_assignment.jpg 642w, ../../wp-content/uploads/2022/07/copy_through_assignment-300x171.jpg 300w, ../../wp-content/uploads/2022/07/copy_through_assignment-600x341.jpg 600w" sizes="(max-width: 642px) 100vw, 642px" /></figure>



<p>Как вы видите, изменения коснулись и его. По этой причине для создания полноценной копии лучше использовать <strong>метод .copy()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e1440900929" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e1440900929-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-1"><span class="crayon-c"># в первую очередь вернем Аргентину в исходный датафрейм countries</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-2"><span class="crayon-v">countries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">countries_dict</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">custom_index</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-4"><span class="crayon-c"># создадим копию, на этот раз с помощью метода .copy()</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-5"><span class="crayon-v">countries_new</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-7"><span class="crayon-c"># вновь удалим запись про Аргентину</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-8"><span class="crayon-v">countries_new</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'AR'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-10"><span class="crayon-c"># выведем исходный датафрейм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e1440900929-11"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img decoding="async" width="688" height="419" src="../../wp-content/uploads/2022/07/copy_method_pandas.jpg" alt="метод .copy() библиотеки Pandas" class="wp-image-14293" style="width:472px;height:287px" srcset="../../wp-content/uploads/2022/07/copy_method_pandas.jpg 688w, ../../wp-content/uploads/2022/07/copy_method_pandas-300x183.jpg 300w, ../../wp-content/uploads/2022/07/copy_method_pandas-600x365.jpg 600w" sizes="(max-width: 688px) 100vw, 688px" /></figure>



<p>Такой тип копирования (без изменения исходного датафрейма) может быть полезен, например, когда мы хотим взять датафрейм, протестировать какие-то гипотезы, построить одну или несколько моделей, но при этом не трогать исходные данные.</p>



<h4 class="wp-block-heading" id="3-pro-parametr-inplace">Про параметр inplace</h4>



<p>Создадим несложный датафрейм из вложенных списков.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e2822245651" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e2822245651-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e2822245651-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e2822245651-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e2822245651-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e2822245651-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e2822245651-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e2822245651-1"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e2822245651-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e2822245651-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e2822245651-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'C'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e2822245651-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e2822245651-6"><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="149" height="203" src="../../wp-content/uploads/2022/07/inplace_parameter.jpg" alt="простой датафрейм из списка списков" class="wp-image-14305" style="width:103px;height:140px"/></figure>



<p>Как понять, сохраняется ли изменение после применение определенного метода или нет? Если метод выдает датафрейм, изменение не сохраняется.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e4704306866" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e4704306866-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e4704306866-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e4704306866-1"><span class="crayon-c"># попробуем удалить столбец A</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e4704306866-2"><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'A'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="111" height="203" src="../../wp-content/uploads/2022/07/drop_column.jpg" alt="удаление столбца с помощью метода .drop()" class="wp-image-14306" style="width:74px;height:135px"/></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e5339499632" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e5339499632-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e5339499632-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e5339499632-1"><span class="crayon-c"># проверим, сохранилось ли изменение</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e5339499632-2"><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="151" height="211" src="../../wp-content/uploads/2022/07/drop_column_res.jpg" alt="выведем датафрейм" class="wp-image-14307" style="width:101px;height:141px"/></figure>



<p>При этом если метод выдает None, изменение постоянно.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e7884160959" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e7884160959-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e7884160959-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e7884160959-1"><span class="crayon-c"># изменим параметр inplace на True</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e7884160959-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'A'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e8690898442" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e8690898442-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e8690898442-1">None</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6e9872938094" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6e9872938094-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6e9872938094-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6e9872938094-1"><span class="crayon-c"># проверим</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6e9872938094-2"><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="111" height="203" src="../../wp-content/uploads/2022/07/drop_column-1.jpg" alt="удалим столбец с помощью метода .drop() и параметра inplace = True" class="wp-image-14308" style="width:83px;height:152px"/></figure>



<p>По этой причине нельзя использовать inplace = True и записывать результат в переменную одновременно.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6ea950516719" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ea950516719-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6ea950516719-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ea950516719-1"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'B'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6ea950516719-2"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6ec199232522" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ec199232522-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ec199232522-1">None</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В этом случае мы записываем None в переменную df.</p>



<h3 class="wp-block-heading" id="4-stolbtsy-datafreyma">Столбцы датафрейма</h3>



<h4 class="wp-block-heading" id="5-imenovanie-stolbtsov-pri-sozdanii-datafreyma">Именование столбцов при создании датафрейма</h4>



<p>Создадим список с названиями столбцов на кириллице и <a href="../../python/npmath/index.html">транспонированный массив Numpy</a> с данными о странах.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6ed790226664" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ed790226664-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6ed790226664-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ed790226664-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ed790226664-1"><span class="crayon-v">custom_columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'страна'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'столица'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'население'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'площадь'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'море'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6ed790226664-2"><span class="crayon-v">arr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">country</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">capital</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">population</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">area</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sea</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">T</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ed790226664-3"><span class="crayon-v">arr</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6ee127753135" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ee127753135-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-1">array([['China', 'Beijing', '1400', '9.6', '1'],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['Vietnam', 'Hanoi', '97', '0.3', '1'],</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['United Kingdom', 'London', '67', '0.2', '1'],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['Russia', 'Moscow', '144', '17.1', '1'],</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['Argentina', 'Buenos Aires', '45', '2.8', '1'],</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['Bolivia', 'Sucre', '12', '1.1', '0'],</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ee127753135-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ['South Africa', 'Pretoria', '59', '1.2', '1']], dtype='&lt;U32')</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>После этого создадим датафрейм с помощью функции <strong>pd.DataFrame()</strong> с параметром columns, в который передадим названия столбцов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f0916635350" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f0916635350-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f0916635350-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f0916635350-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f0916635350-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f0916635350-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f0916635350-1"><span class="crayon-v">countries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">arr</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f0916635350-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">custom_index</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f0916635350-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">custom_columns</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f0916635350-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f0916635350-5"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="728" height="419" src="../../wp-content/uploads/2022/07/cyrillic_column_names.jpg" alt="датафрейм библиотеки Pandas с названиями столбцов на кириллице" class="wp-image-14310" style="width:509px;height:293px" srcset="../../wp-content/uploads/2022/07/cyrillic_column_names.jpg 728w, ../../wp-content/uploads/2022/07/cyrillic_column_names-300x173.jpg 300w, ../../wp-content/uploads/2022/07/cyrillic_column_names-600x345.jpg 600w" sizes="auto, (max-width: 728px) 100vw, 728px" /></figure>



<p>Вернем прежние названия столбцов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f1349298075" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f1349298075-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f1349298075-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'country'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'capital'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'population'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'area'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sea'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<h4 class="wp-block-heading" id="6-pereimenovanie-stolbtsov">Переименование столбцов</h4>



<p>Для того чтобы переименовать отдельные столбцы, можно воспользоваться <strong>методом .rename()</strong>. Внутри этого метода в параметр columns мы передаем словарь, где ключами будут текущие названия столбцов, а значениями соответствующие им новые названия.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f2414497277" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f2414497277-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f2414497277-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f2414497277-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f2414497277-1"><span class="crayon-c"># переименуем столбец capital на city</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f2414497277-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">rename</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'capital'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'city'</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f2414497277-3"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="691" height="418" src="../../wp-content/uploads/2022/07/rename_column_pandas.jpg" alt="метод .rename() в библиотеке Pandas" class="wp-image-14343" style="width:488px;height:295px" srcset="../../wp-content/uploads/2022/07/rename_column_pandas.jpg 691w, ../../wp-content/uploads/2022/07/rename_column_pandas-300x181.jpg 300w, ../../wp-content/uploads/2022/07/rename_column_pandas-600x363.jpg 600w" sizes="auto, (max-width: 691px) 100vw, 691px" /></figure>



<h3 class="wp-block-heading" id="7-tip-dannykh-v-stolbtse">Тип данных в столбце</h3>



<p>Все значения одного столбца датафрейма всегда имеют один и тот же тип данных. Посмотреть тип данных каждого из столбцов можно с помощью <strong>атрубута .dtypes</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f3053757458" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f3053757458-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f3053757458-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">dtypes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f5779473107" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f5779473107-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f5779473107-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f5779473107-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f5779473107-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f5779473107-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f5779473107-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f5779473107-1">country&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f5779473107-2">city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f5779473107-3">population&nbsp;&nbsp;&nbsp;&nbsp;object</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f5779473107-4">area&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f5779473107-5">sea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f5779473107-6">dtype: object</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<h4 class="wp-block-heading" id="8-izmenenie-tipa-dannykh">Изменение типа данных</h4>



<p>Преобразовать тип данных столбца можно с помощью <strong>метода .astype()</strong>. Этот метод можно применить к конкретному столбцу.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f6531612251" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f6531612251-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f6531612251-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f6531612251-1"><span class="crayon-c"># преобразуем тип данных столбца population в int</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f6531612251-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">population</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">population</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">'int'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Кроме того, мы можем пробразовать тип данных сразу в нескольких столбцах. Для этого применим метод <strong>.astype()</strong> ко всему датафрейму. Самому методу мы передадим словарь, где ключами будут названия столбцов, а значениями &#8212; соответсвующий им желаемый тип данных.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f7017389653" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f7017389653-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6f7017389653-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f7017389653-1"><span class="crayon-c"># изменим тип данных в столбцах area и sea</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6f7017389653-2"><span class="crayon-v">countries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'area'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'float'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sea'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'category'</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Посмотрим на результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6f9723148149" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6f9723148149-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6f9723148149-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">dtypes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6fa216171817" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fa216171817-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fa216171817-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fa216171817-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fa216171817-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fa216171817-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fa216171817-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fa216171817-1">country&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; object</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fa216171817-2">city&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;object</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fa216171817-3">population&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int64</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fa216171817-4">area&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; float64</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fa216171817-5">sea&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; category</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fa216171817-6">dtype: object</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<h4 class="wp-block-heading" id="9-tip-dannykh-category">Тип данных category</h4>



<p>Обратите внимание на новый для нас тип данных category. Во многом он похож на <a href="../../python/jupyter-notebook-02/index.html">факторную переменную</a> в R.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6fb439994101" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fb439994101-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fb439994101-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fb439994101-1"><span class="crayon-c"># в category содержится информация об имеющихся в столбце категориях</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fb439994101-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">sea</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6fc976104595" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fc976104595-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-1">CN&nbsp;&nbsp;&nbsp;&nbsp;1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-2">VN&nbsp;&nbsp;&nbsp;&nbsp;1</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-3">GB&nbsp;&nbsp;&nbsp;&nbsp;1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-4">RU&nbsp;&nbsp;&nbsp;&nbsp;1</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-5">AR&nbsp;&nbsp;&nbsp;&nbsp;1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-6">BO&nbsp;&nbsp;&nbsp;&nbsp;0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-7">ZA&nbsp;&nbsp;&nbsp;&nbsp;1</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-8">Name: sea, dtype: category</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fc976104595-9">Categories (2, object): ['0', '1']</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Тип category мы рассмотрим более подробно на занятии по <a href="../encoding/index.html">кодированию категориальных переменных</a>.</p>



<p>Помимо упомянутых типов данных, нам также знаком <a href="../../python/datetime/index.html">объект datetime</a>, который используется для работы с <a href="../../intro/time-series/index.html">временными рядами</a>. Мы снова обратимся к нему на занятии по <a href="../errors/index.html">очистке данных</a>.</p>



<h4 class="wp-block-heading" id="10-filtr-stolbtsov-po-tipu-dannykh">Фильтр столбцов по типу данных</h4>



<p>Выбрать столбцы в зависимости от типа содержащихся в них данных можно с помощью <strong>метода .select_dtypes()</strong>. Включить определенные типы данных можно с помощью параметра <em>include</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6fe942728259" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6fe942728259-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6fe942728259-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6fe942728259-1"><span class="crayon-c"># выберем только типы данных int и float</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6fe942728259-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">select_dtypes</span><span class="crayon-sy">(</span><span class="crayon-v">include</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'int64'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'float64'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="282" height="421" src="../../wp-content/uploads/2022/07/select_dtypes_include.jpg" alt="метод .select_dtypes() с параметром include" class="wp-image-14351" style="width:195px;height:291px" srcset="../../wp-content/uploads/2022/07/select_dtypes_include.jpg 282w, ../../wp-content/uploads/2022/07/select_dtypes_include-201x300.jpg 201w" sizes="auto, (max-width: 282px) 100vw, 282px" /></figure>



<p>Исключить определенные типы данных можно через <em>exclude</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c6ff935592190" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c6ff935592190-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c6ff935592190-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c6ff935592190-1"><span class="crayon-c"># выберем все типы данных, кроме object и category</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c6ff935592190-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">select_dtypes</span><span class="crayon-sy">(</span><span class="crayon-v">exclude</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'object'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'category'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="281" height="418" src="../../wp-content/uploads/2022/07/select_dtypes_exclude.jpg" alt="метод .select_dtypes() с параметром exclude" class="wp-image-14352" style="width:194px;height:288px" srcset="../../wp-content/uploads/2022/07/select_dtypes_exclude.jpg 281w, ../../wp-content/uploads/2022/07/select_dtypes_exclude-202x300.jpg 202w" sizes="auto, (max-width: 281px) 100vw, 281px" /></figure>



<h3 class="wp-block-heading" id="11-dobavlenie-strok-i-stolbtsov">Добавление строк и столбцов</h3>



<h4 class="wp-block-heading" id="12-dobavlenie-strok">Добавление строк</h4>



<h5 class="wp-block-heading" id="13-metod-_append-slovar">Метод ._append() + словарь</h5>



<p>Для добавления строк в первую очередь используется <strong>метод .append()</strong>. С его помощью строку можно добавить из <a href="../../python/dict/index.html">питоновского словаря</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c700092563249" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c700092563249-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c700092563249-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c700092563249-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c700092563249-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c700092563249-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c700092563249-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c700092563249-1"><span class="crayon-c"># создадим словарь с данными Канады и добавим его в датафрейм</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c700092563249-2"><span class="crayon-v">dict_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'country'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Canada'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'city'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Ottawa'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'population'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">38</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'area'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sea'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'1'</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c700092563249-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c700092563249-4"><span class="crayon-c"># словарь можно добавлять только если ignore_index = True</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c700092563249-5"><span class="crayon-v">countries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">_append</span><span class="crayon-sy">(</span><span class="crayon-v">dict_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ignore_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c700092563249-6"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="510" height="354" src="../../wp-content/uploads/2022/07/append_row_dict.png" alt="добавление строк: метод .append() + словарь" class="wp-image-14415" style="width:496px;height:344px" srcset="../../wp-content/uploads/2022/07/append_row_dict.png 510w, ../../wp-content/uploads/2022/07/append_row_dict-300x208.png 300w" sizes="auto, (max-width: 510px) 100vw, 510px" /></figure>



<h5 class="wp-block-heading" id="14-metod-_append-series">Метод ._append() + Series</h5>



<p>Мы также можем добавить строки в виде <a href="../pandas/index.html">объекта Series</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c702970005765" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c702970005765-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-1"><span class="crayon-c"># причем, если передать список из Series, можно добавить сразу несколько строк</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-2"><span class="crayon-v">list_of_series</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Spain'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Madrid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">47</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">Series</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Netherlands'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Amsterdam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.04</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-5"><span class="crayon-c"># нам по-прежнему необходим параметр ignore_index = True</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-6"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">_append</span><span class="crayon-sy">(</span><span class="crayon-v">list_of_series</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ignore_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c702970005765-7"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="517" height="438" src="../../wp-content/uploads/2022/07/append_row_series.png" alt="добавление строк: метод .append() + Series" class="wp-image-14416" style="width:482px;height:408px" srcset="../../wp-content/uploads/2022/07/append_row_series.png 517w, ../../wp-content/uploads/2022/07/append_row_series-300x254.png 300w" sizes="auto, (max-width: 517px) 100vw, 517px" /></figure>



<h5 class="wp-block-heading" id="15-metod-_append-drugoy-datafreym">Метод ._append() + другой датафрейм</h5>



<p>Новая строка может также содержаться в другом датафрейме.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c703761716784" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c703761716784-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-1"><span class="crayon-c"># новая строка может также содержаться в другом датафрейме</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-2"><span class="crayon-c"># обратите внимание, что числовые значения мы помещаем в списки</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-3"><span class="crayon-v">peru</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'country'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Peru'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'city'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'Lima'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'population'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">33</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'area'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1.3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'sea'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c703761716784-8"><span class="crayon-v">peru</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="385" height="86" src="../../wp-content/uploads/2022/07/append_row_df.png" alt="датафрейм для добавления в качестве строки" class="wp-image-14417" style="width:340px;height:76px" srcset="../../wp-content/uploads/2022/07/append_row_df.png 385w, ../../wp-content/uploads/2022/07/append_row_df-300x67.png 300w" sizes="auto, (max-width: 385px) 100vw, 385px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c705840983903" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c705840983903-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c705840983903-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c705840983903-1"><span class="crayon-c"># перед добавлением выберем первую строку с помощью метода .iloc[]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c705840983903-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">_append</span><span class="crayon-sy">(</span><span class="crayon-v">peru</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ignore_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="511" height="393" src="../../wp-content/uploads/2022/07/append_row_df_append.png" alt="добавление строк: метод .append() + датафрейм" class="wp-image-14418" style="width:490px;height:377px" srcset="../../wp-content/uploads/2022/07/append_row_df_append.png 511w, ../../wp-content/uploads/2022/07/append_row_df_append-300x231.png 300w" sizes="auto, (max-width: 511px) 100vw, 511px" /></figure>



<h5 class="wp-block-heading" id="16-ispolzovanie-iloc">Использование .iloc[]</h5>



<p>Если вновь вывести наш датафрейм countries, мы увидим, что данные об Испании, Нидерландах и Перу не сохранились.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c706234838497" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c706234838497-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c706234838497-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c706234838497-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c706234838497-1"><span class="crayon-c"># для этого нам надо было либо перезаписать результат метода ._append() в переменную countries,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c706234838497-2"><span class="crayon-c"># либо использовать параметр inplace = True.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c706234838497-3"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="508" height="353" src="../../wp-content/uploads/2022/07/append_row_not_saved.png" alt="метод .append(): без записи в переменную или inplace = True изменения не сохранятся" class="wp-image-14419" style="width:491px;height:341px" srcset="../../wp-content/uploads/2022/07/append_row_not_saved.png 508w, ../../wp-content/uploads/2022/07/append_row_not_saved-300x208.png 300w" sizes="auto, (max-width: 508px) 100vw, 508px" /></figure>



<p>Добавим данные об этих странах на постоянной основе с помощью <strong>метода .iloc[]</strong> и посмотрим на результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c707432307677" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c707432307677-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c707432307677-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c707432307677-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c707432307677-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c707432307677-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c707432307677-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">iloc</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Spain'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Madrid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">47</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c707432307677-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-s">'Netherlands'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Amsterdam'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.04</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c707432307677-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-s">'Peru'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Lima'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c707432307677-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c707432307677-5"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="514" height="354" src="../../wp-content/uploads/2022/07/append_row_iloc.png" alt="использование метода .iloc[] для добавления строк" class="wp-image-14420" style="width:494px;height:340px" srcset="../../wp-content/uploads/2022/07/append_row_iloc.png 514w, ../../wp-content/uploads/2022/07/append_row_iloc-300x207.png 300w" sizes="auto, (max-width: 514px) 100vw, 514px" /></figure>



<p>Обратите внимание, что строки добавились строго на те индексы, которые были указаны в методе <strong>.iloc[]</strong> (т.е. 5, 6 и 7) и заменили данные, ранее находившиеся на этих индексах (Боливия, Южная Африка и Канада).</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p>В версии Pandas 2.0.0, которая была опубликована 3 апреля 2023 года, метод <strong>.append()</strong> был удален, и применение нижнего подчеркивания, хотя и позволяет выполнить присоединение строк, не является удачным решением.</p>



<p class="has-background" style="background-color:#ffe8c4">Разработчики рекомендуют использовать <strong>метод .concat()</strong>. О нем мы поговорим ниже.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<h4 class="wp-block-heading" id="17-dobavlenie-stolbtsov">Добавление столбцов</h4>



<h5 class="wp-block-heading" id="18-obyavlenie-novogo-stolbtsa">Объявление нового столбца</h5>



<p>Новый столбец датафрейма можно просто объявить и сразу добавить в него необходимые данные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c709239585672" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c709239585672-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c709239585672-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c709239585672-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c709239585672-1"><span class="crayon-c"># например, добавим данные о плотности населения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c709239585672-2"><span class="crayon-v">countries</span><span class="crayon-sy">[</span><span class="crayon-s">'pop_density'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">153</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">49</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">281</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">94</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">508</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">26</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c709239585672-3"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="639" height="354" src="../../wp-content/uploads/2022/07/pop_density.png" alt="создание нового столбца датафрейма через его объявление" class="wp-image-14421" style="width:608px;height:337px" srcset="../../wp-content/uploads/2022/07/pop_density.png 639w, ../../wp-content/uploads/2022/07/pop_density-300x166.png 300w, ../../wp-content/uploads/2022/07/pop_density-600x332.png 600w" sizes="auto, (max-width: 639px) 100vw, 639px" /></figure>



<h5 class="wp-block-heading" id="19-metod-insert">Метод .insert()</h5>



<p>Добавим столбец с кодами стран с помощью <strong>метода .insert()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c70a242485412" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c70a242485412-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c70a242485412-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c70a242485412-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c70a242485412-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">insert</span><span class="crayon-sy">(</span><span class="crayon-v">loc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># это будет второй по счету столбец</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c70a242485412-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">column</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'code'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># название столбца</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c70a242485412-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">value</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'CN'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'VN'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GB'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'RU'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AR'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ES'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'NL'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'PE'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># значения столбца</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Обратите внимание, метод <strong>.insert()</strong> по умолчанию (без перезаписи в переменную или параметра inplace = True) сохраняет результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c70c570416597" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c70c570416597-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c70c570416597-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c70c570416597-1"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c70c570416597-2"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="695" height="352" src="../../wp-content/uploads/2022/07/insert_column.png" alt="метод .insert() для добавления нового столбца" class="wp-image-14422" style="width:628px;height:318px" srcset="../../wp-content/uploads/2022/07/insert_column.png 695w, ../../wp-content/uploads/2022/07/insert_column-300x152.png 300w, ../../wp-content/uploads/2022/07/insert_column-600x304.png 600w" sizes="auto, (max-width: 695px) 100vw, 695px" /></figure>



<p>Теперь рассмотрим несколько способов добавления столбца с рассчитанным значением.</p>



<h5 class="wp-block-heading" id="20-metod-assign">Метод .assign()</h5>



<p>Создадим столбец area_miles, в который поместим площадь в милях. Вначале используем <strong>метод .assign()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c70d082126607" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c70d082126607-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c70d082126607-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c70d082126607-1"><span class="crayon-v">countries</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">assign</span><span class="crayon-sy">(</span><span class="crayon-v">area_miles</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">area</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.59</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c70d082126607-2"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="808" height="355" src="../../wp-content/uploads/2022/08/assign_method_pandas.png" alt="метод .assign() для добавления нового столбца" class="wp-image-14424" style="width:753px;height:331px" srcset="../../wp-content/uploads/2022/08/assign_method_pandas.png 808w, ../../wp-content/uploads/2022/08/assign_method_pandas-300x132.png 300w, ../../wp-content/uploads/2022/08/assign_method_pandas-768x337.png 768w, ../../wp-content/uploads/2022/08/assign_method_pandas-600x264.png 600w" sizes="auto, (max-width: 808px) 100vw, 808px" /></figure>



<p>Удалим этот столбец, чтобы рассмотреть другие методы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c70e112245933" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c70e112245933-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c70e112245933-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h5 class="wp-block-heading" id="21-mozhno-slozhnee">Можно сложнее</h5>



<p>Мы можем усложнить код и добиться такого же результата, применив <strong>методы .iterrows()</strong> и <strong>.iloc[]</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c710100331996" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c710100331996-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-1"><span class="crayon-c"># выведем индекс и содержание строк</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">row </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">iterrows</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># запишем для каждой строки (index) в новый столбец area_miles</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># округленное значение площади row.area в милях</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">loc</span><span class="crayon-sy">[</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">.</span><span class="crayon-v">area</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.59</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-7"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c710100331996-8"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="812" height="356" src="../../wp-content/uploads/2022/08/new_column_iterrows_iloc.png" alt="методы .iterrows() и .iloc[] для добавления нового столбца" class="wp-image-14425" style="width:728px;height:319px" srcset="../../wp-content/uploads/2022/08/new_column_iterrows_iloc.png 812w, ../../wp-content/uploads/2022/08/new_column_iterrows_iloc-300x132.png 300w, ../../wp-content/uploads/2022/08/new_column_iterrows_iloc-768x337.png 768w, ../../wp-content/uploads/2022/08/new_column_iterrows_iloc-600x263.png 600w" sizes="auto, (max-width: 812px) 100vw, 812px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c711478701876" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c711478701876-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c711478701876-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c711478701876-1"><span class="crayon-c"># снова удалим этот столбец</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c711478701876-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h5 class="wp-block-heading" id="22-mozhno-proshche">Можно проще</h5>



<p>При этом конечно есть гораздо более простой способ добавления нового столбца.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c712952646504" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c712952646504-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c712952646504-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c712952646504-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c712952646504-1"><span class="crayon-c"># мы можем объявить столбец и присвоить ему нужно нам значение</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c712952646504-2"><span class="crayon-v">countries</span><span class="crayon-sy">[</span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">area</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2.59</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c712952646504-3"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="804" height="350" src="../../wp-content/uploads/2022/08/new_column_new_var.png" alt="расчет значений одного столбца и добавление результата в новый столбец" class="wp-image-14426" style="width:712px;height:310px" srcset="../../wp-content/uploads/2022/08/new_column_new_var.png 804w, ../../wp-content/uploads/2022/08/new_column_new_var-300x131.png 300w, ../../wp-content/uploads/2022/08/new_column_new_var-768x334.png 768w, ../../wp-content/uploads/2022/08/new_column_new_var-600x261.png 600w" sizes="auto, (max-width: 804px) 100vw, 804px" /></figure>



<h3 class="wp-block-heading" id="23-udalenie-strok-i-stolbtsov">Удаление строк и столбцов</h3>



<h4 class="wp-block-heading" id="24-udalenie-strok">Удаление строк</h4>



<p>Для удаления строк можно использовать <strong>метод .drop()</strong> с параметрами <em>label</em>s (индекс удаляемых строк) и <em>axis = 0</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c713452218108" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c713452218108-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c713452218108-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c713452218108-1"><span class="crayon-c"># удалим строки с индексом 0 и 1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c713452218108-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="806" height="273" src="../../wp-content/uploads/2022/08/drop_row_label.png" alt="удаление строк методом .drop() с параметрами labels и axis = 0" class="wp-image-14428" style="width:753px;height:255px" srcset="../../wp-content/uploads/2022/08/drop_row_label.png 806w, ../../wp-content/uploads/2022/08/drop_row_label-300x102.png 300w, ../../wp-content/uploads/2022/08/drop_row_label-768x260.png 768w, ../../wp-content/uploads/2022/08/drop_row_label-600x203.png 600w" sizes="auto, (max-width: 806px) 100vw, 806px" /></figure>



<p>Кроме того, можно использовать метод <strong>.drop()</strong> с единственным параметром <em>index</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c715841984446" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c715841984446-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c715841984446-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c715841984446-1"><span class="crayon-c"># удалим строки с индексом 5 и 7</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c715841984446-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="801" height="277" src="../../wp-content/uploads/2022/08/drop_row_index.png" alt="удаление строк методом .drop() с параметром index" class="wp-image-14429" style="width:744px;height:257px" srcset="../../wp-content/uploads/2022/08/drop_row_index.png 801w, ../../wp-content/uploads/2022/08/drop_row_index-300x104.png 300w, ../../wp-content/uploads/2022/08/drop_row_index-768x266.png 768w, ../../wp-content/uploads/2022/08/drop_row_index-600x207.png 600w" sizes="auto, (max-width: 801px) 100vw, 801px" /></figure>



<p>Мы также можем в параметр <em>index</em> передать индекс датафрейма через атрибут <strong>index</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c716628147391" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c716628147391-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c716628147391-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c716628147391-1"><span class="crayon-c"># удалим четвертую строку</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c716628147391-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="796" height="317" src="../../wp-content/uploads/2022/08/drop_row_df_index.png" alt="удаление строк методом .drop() с параметром index и атрибутом датафрейма index" class="wp-image-14430" style="width:766px;height:305px" srcset="../../wp-content/uploads/2022/08/drop_row_df_index.png 796w, ../../wp-content/uploads/2022/08/drop_row_df_index-300x119.png 300w, ../../wp-content/uploads/2022/08/drop_row_df_index-768x306.png 768w, ../../wp-content/uploads/2022/08/drop_row_df_index-600x239.png 600w" sizes="auto, (max-width: 796px) 100vw, 796px" /></figure>



<p>С атрибутом датафрейма <strong>index</strong> мы можем делать срезы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c717764692767" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c717764692767-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c717764692767-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c717764692767-1"><span class="crayon-c"># удалим каждую вторую строку, начиная с четвертой с конца</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c717764692767-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-o">::</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="762" height="273" src="../../wp-content/uploads/2022/08/drop_row_slice.png" alt="удаление строк методом .drop() с параметром index и атрибутом датафрейма index (срез)" class="wp-image-14431" style="width:715px;height:256px" srcset="../../wp-content/uploads/2022/08/drop_row_slice.png 762w, ../../wp-content/uploads/2022/08/drop_row_slice-300x107.png 300w, ../../wp-content/uploads/2022/08/drop_row_slice-600x215.png 600w" sizes="auto, (max-width: 762px) 100vw, 762px" /></figure>



<h4 class="wp-block-heading" id="25-udalenie-stolbtsov">Удаление столбцов</h4>



<p>Параметры <em>labels</em> (номера столбцов) и <em>axis = 1</em> метода <strong>.drop()</strong> позволяют удалять столбцы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c719003676204" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c719003676204-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c719003676204-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c719003676204-1"><span class="crayon-c"># удалим столбцы area_miles и code</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c719003676204-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'code'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="636" height="353" src="../../wp-content/uploads/2022/08/drop_columns_pandas.png" alt="удаление столбцов методом .drop() с параметрами labels и axis = 1" class="wp-image-14432" style="width:622px;height:345px" srcset="../../wp-content/uploads/2022/08/drop_columns_pandas.png 636w, ../../wp-content/uploads/2022/08/drop_columns_pandas-300x167.png 300w, ../../wp-content/uploads/2022/08/drop_columns_pandas-600x333.png 600w" sizes="auto, (max-width: 636px) 100vw, 636px" /></figure>



<p>Такой же результат можно получить, передав список удаляемых столбцов в <em>параметр columns</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c71a583651102" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71a583651102-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71a583651102-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71a583651102-1"><span class="crayon-c"># снова удалим столбцы area_miles и code</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71a583651102-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'code'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="636" height="353" src="../../wp-content/uploads/2022/08/drop_columns_pandas.png" alt="удаление строк методом .drop() с параметром columns" class="wp-image-14432" style="width:622px;height:345px" srcset="../../wp-content/uploads/2022/08/drop_columns_pandas.png 636w, ../../wp-content/uploads/2022/08/drop_columns_pandas-300x167.png 300w, ../../wp-content/uploads/2022/08/drop_columns_pandas-600x333.png 600w" sizes="auto, (max-width: 636px) 100vw, 636px" /></figure>



<p>Через атрибут датафрейма <strong>columns</strong> мы можем передать номера удаляемых столбцов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c71b648211754" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71b648211754-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71b648211754-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71b648211754-1"><span class="crayon-c"># удалим последний столбец (area_miles)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71b648211754-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="694" height="354" src="../../wp-content/uploads/2022/08/drop_columns_df_columns.png" alt="удаление столбцов методом .drop() с параметром columns и атрибутом датафрейма columns" class="wp-image-14433" style="width:676px;height:345px" srcset="../../wp-content/uploads/2022/08/drop_columns_df_columns.png 694w, ../../wp-content/uploads/2022/08/drop_columns_df_columns-300x153.png 300w, ../../wp-content/uploads/2022/08/drop_columns_df_columns-600x306.png 600w" sizes="auto, (max-width: 694px) 100vw, 694px" /></figure>



<p>Наконец удалим пятую строку и несколько столбцов разобранными выше способами и сохраним изменения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c71c060026827" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71c060026827-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71c060026827-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71c060026827-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71c060026827-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71c060026827-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'code'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'pop_density'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'area_miles'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71c060026827-3"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="498" height="316" src="../../wp-content/uploads/2022/08/drop_rows_columns.png" alt="библиотека Pandas: удаление строк и столбцов датафрейма" class="wp-image-14434" style="width:470px;height:298px" srcset="../../wp-content/uploads/2022/08/drop_rows_columns.png 498w, ../../wp-content/uploads/2022/08/drop_rows_columns-300x190.png 300w" sizes="auto, (max-width: 498px) 100vw, 498px" /></figure>



<h4 class="wp-block-heading" id="26-udalenie-po-mnogourovnemu-indeksu">Удаление по многоуровнему индексу</h4>



<p>Давайте посмотрим, как удалять строки и столбцы в датафрейме с многоуровневым (иерархическим) индексом. Вначале вновь создадим соответствующий датафрейм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c71e129497256" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71e129497256-27">27</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-1"><span class="crayon-c"># подготовим данные для многоуровневого индекса строк</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-2"><span class="crayon-v">rows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'Asia'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'CN'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'Asia'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'VN'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'Europe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GB'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'Europe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'RU'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'Europe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ES'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'Europe'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'NL'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'S. America'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'PE'</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-10"><span class="crayon-c"># и столбцов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-11"><span class="crayon-v">cols</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'names'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'country'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'names'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'city'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'data'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'population'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'data'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'area'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-s">'data'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'sea'</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-17"><span class="crayon-c"># создадим многоуровневый (иерархический) индекс</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-18"><span class="crayon-c"># для индекса строк добавим названия столбцов индекса через параметр names</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-19"><span class="crayon-v">custom_multindex</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-v">MultiIndex</span><span class="crayon-sy">.</span><span class="crayon-e">from_tuples</span><span class="crayon-sy">(</span><span class="crayon-v">rows</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'region'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'code'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-20"><span class="crayon-v">custom_multicols</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-v">MultiIndex</span><span class="crayon-sy">.</span><span class="crayon-e">from_tuples</span><span class="crayon-sy">(</span><span class="crayon-v">cols</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-22"><span class="crayon-c"># поместим индексы в атрибуты index и columns датафрейма</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-23"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">custom_multindex</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-24"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">custom</span><span class="crayon-sy">_</span>multicols</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-26"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71e129497256-27"><span class="crayon-v">countries</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="635" height="397" src="../../wp-content/uploads/2022/08/drop_MultiIndex.png" alt="библиотека Pandas: датафрейм с многоуровневым (иерархическим) индексом" class="wp-image-14443" style="width:557px;height:348px" srcset="../../wp-content/uploads/2022/08/drop_MultiIndex.png 635w, ../../wp-content/uploads/2022/08/drop_MultiIndex-300x188.png 300w, ../../wp-content/uploads/2022/08/drop_MultiIndex-600x375.png 600w" sizes="auto, (max-width: 635px) 100vw, 635px" /></figure>



<h5 class="wp-block-heading" id="27-udalenie-strok">Удаление строк</h5>



<p>Вначале обратимся к строкам и удалим азиатский регион. Для этого воспользуемся методом <strong>.drop()</strong>, которому передадим параметр <em>labels = &#8216;Asia&#8217;</em>. Кроме того, укажем, что удаляем именно строки (<em>axis = 0</em>) и что Азия находится в индексе под названием region (т.е. <em>level = 0</em>).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c71f953352472" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c71f953352472-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c71f953352472-1"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Asia'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="637" height="319" src="../../wp-content/uploads/2022/08/drop_MultiIndex_rows.png" alt="удаление строк по многоуровневому индексу через параметры labels, level, axis = 0" class="wp-image-14444" style="width:577px;height:289px" srcset="../../wp-content/uploads/2022/08/drop_MultiIndex_rows.png 637w, ../../wp-content/uploads/2022/08/drop_MultiIndex_rows-300x150.png 300w, ../../wp-content/uploads/2022/08/drop_MultiIndex_rows-600x300.png 600w" sizes="auto, (max-width: 637px) 100vw, 637px" /></figure>



<p>Кроме того, строки можно удалять с помощью параметра <em>index</em> и указанием через <em>level</em>, по какому столбцу индекса мы будем искать удаляемую строку.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c721873295434" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c721873295434-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c721873295434-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c721873295434-1"><span class="crayon-c"># удалим запись о России по ее индексу в столбце code (т.е. level = 1)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c721873295434-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'RU'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="632" height="350" src="../../wp-content/uploads/2022/08/drop_MultiIndex_rows_index.png" alt="удаление строк по многоуровневому индексу через параметры index и level" class="wp-image-14445" style="width:572px;height:317px" srcset="../../wp-content/uploads/2022/08/drop_MultiIndex_rows_index.png 632w, ../../wp-content/uploads/2022/08/drop_MultiIndex_rows_index-300x166.png 300w, ../../wp-content/uploads/2022/08/drop_MultiIndex_rows_index-600x332.png 600w" sizes="auto, (max-width: 632px) 100vw, 632px" /></figure>



<h5 class="wp-block-heading" id="28-udalenie-stolbtsov">Удаление столбцов</h5>



<p>Удаление столбцов датафрейма с многоуровневым индексом происходит аналогично строкам. Передадим методу <strong>.drop()</strong> параметры <em>labels</em>, <em>level</em> и <em>axis = 1</em> для удаления столбца по его наименованию (<em>labels</em>) на нужном нам уровне (<em>level</em>) индекса.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c722005064198" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c722005064198-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c722005064198-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c722005064198-1"><span class="crayon-c"># удалим все столбцы в разделе names на нулевом уровне индекса столбцов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c722005064198-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'names'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="388" height="393" src="../../wp-content/uploads/2022/08/drop_MultiIndex_columns.png" alt="удаление столбцов по многоуровневому индексу через параметры labels, level, axis = 1" class="wp-image-14446" style="width:346px;height:350px" srcset="../../wp-content/uploads/2022/08/drop_MultiIndex_columns.png 388w, ../../wp-content/uploads/2022/08/drop_MultiIndex_columns-296x300.png 296w" sizes="auto, (max-width: 388px) 100vw, 388px" /></figure>



<p>Для удаления&nbsp;столбцов&nbsp;можно&nbsp;использовать&nbsp;параметр&nbsp;<em>columns</em> с указанием соответствующего уровня индекса (<em>level</em>) столбцов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c723124509687" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c723124509687-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c723124509687-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c723124509687-1"><span class="crayon-c"># например, удалим столбцы city и area на втором уровне (level = 1) индекса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c723124509687-2"><span class="crayon-v">countries</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'city'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'area'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">level</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="469" height="398" src="../../wp-content/uploads/2022/08/drop_MultiIndex_columns_columns.png" alt="удаление столбцов по многоуровневому индексу через параметры columns и level" class="wp-image-14447" style="width:410px;height:348px" srcset="../../wp-content/uploads/2022/08/drop_MultiIndex_columns_columns.png 469w, ../../wp-content/uploads/2022/08/drop_MultiIndex_columns_columns-300x255.png 300w" sizes="auto, (max-width: 469px) 100vw, 469px" /></figure>



<p>Обратите внимание, что удалению столбцов не помешал тот факт, что они находятся в разных индексах первого (<em>level = 0</em>) уровня, а именно city находится в names, а population &#8212; в data.</p>



<h3 class="wp-block-heading" id="29-primenenie-funktsiy">Применение функций</h3>



<p>Библиотека Pandas позволяет использовать функции для изменения данных в датафрейме.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c725164915818" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c725164915818-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-1"><span class="crayon-c"># создадим новый датафрейм с данными нескольких человек</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-2"><span class="crayon-v">people</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'name'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Алексей'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Иван'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Анна'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Ольга'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Николай'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'gender'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'age'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'height'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">180.46</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">182.26</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">165.12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">168.04</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">178.68</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'weight'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">73.61</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75.34</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50.22</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52.14</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">69.72</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c725164915818-9"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="389" height="239" src="../../wp-content/uploads/2022/08/pandas_dataframe_functions.png" alt="применение функций к датафрейму библиотеки Pandas" class="wp-image-14449" style="width:353px;height:217px" srcset="../../wp-content/uploads/2022/08/pandas_dataframe_functions.png 389w, ../../wp-content/uploads/2022/08/pandas_dataframe_functions-300x184.png 300w" sizes="auto, (max-width: 389px) 100vw, 389px" /></figure>



<h4 class="wp-block-heading" id="30-metod-map">Метод .map()</h4>



<p>Предположим, что мы хотим явно прописать мужской (male) и женский (female) пол в наших данных. В этому случае можно воспользоваться <strong>методом .map()</strong>. Вначале создадим карту (map) того, как преобразовать существующие значения в новые.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c726725974550" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c726725974550-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c726725974550-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c726725974550-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c726725974550-1"><span class="crayon-c"># такая карта представляет собой питоновский словарь,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c726725974550-2"><span class="crayon-c"># где ключи - это старые данные, а значения - новые</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c726725974550-3"><span class="crayon-v">gender_map</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'female'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'male'</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Применим эту карту к нужному нам столбцу датафрейма.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c727111677136" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c727111677136-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c727111677136-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c727111677136-1"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'gender'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'gender'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-v">gender_map</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c727111677136-2"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="388" height="238" src="../../wp-content/uploads/2022/08/map_pandas.png" alt="метод .map() библиотеки Pandas + словарь" class="wp-image-14464" style="width:357px;height:219px" srcset="../../wp-content/uploads/2022/08/map_pandas.png 388w, ../../wp-content/uploads/2022/08/map_pandas-300x184.png 300w" sizes="auto, (max-width: 388px) 100vw, 388px" /></figure>



<p>Те значения, которые в карте не указаны (в четвертой строке была ошибка, пол был помечен цифрой два), превращаются в NaN (not a number), пропущенное значение.</p>



<p class="has-background" style="background-color:#ffe8c4">Обратите внимание, что словарь, в данном случае, по сути является функцией, которую мы применяем к значениям определенного столбца.</p>



<p>Кроме того замечу, что в большинстве случаев мы будем проводить обратное преобразование, превращая строковые категориальные значения в числовые.</p>



<p>В метод <strong>.map()</strong> мы можем передать и <a href="../../python/functions/index.html">lambda-функцию</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c729434676997" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c729434676997-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c729434676997-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c729434676997-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c729434676997-1"><span class="crayon-c"># например, для того, чтобы выявить совершеннолетних и несовершеннолетних людей</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c729434676997-2"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age_group'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">'adult'</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-s">'minor'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c729434676997-3"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="494" height="240" src="../../wp-content/uploads/2022/08/map_pandas_lambda.png" alt="метод .map() библиотеки Pandas + lambda-функция" class="wp-image-14465" style="width:455px;height:221px" srcset="../../wp-content/uploads/2022/08/map_pandas_lambda.png 494w, ../../wp-content/uploads/2022/08/map_pandas_lambda-300x146.png 300w" sizes="auto, (max-width: 494px) 100vw, 494px" /></figure>



<p>Удалим только что созданный столбец age_group.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c72a310025947" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72a310025947-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72a310025947-1"><span class="crayon-v">people</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'age_group'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Вместо lambda-функции, например, для более сложных преобразований, можно испольвовать обычную собственную функцию.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c72b848850434" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72b848850434-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-1"><span class="crayon-c"># обратите внимание, такая функция не допускает дополнительных параметров,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-2"><span class="crayon-c"># только те данные, которые нужно преобразовать (age)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-3"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_age_group</span><span class="crayon-sy">(</span><span class="crayon-v">age</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># например, мы не можем сделать threshold произвольным параметром</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">threshold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">age_group</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'adult'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">age_group</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'minor'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72b848850434-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">age_group</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Применим эту функцию к столбцу age.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c72d776115054" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72d776115054-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72d776115054-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72d776115054-1"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age_group'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-v">get_age_group</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72d776115054-2"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="496" height="240" src="../../wp-content/uploads/2022/08/map_pandas_own_function.png" alt="метод .map() библиотеки Pandas + собственная функция" class="wp-image-14466" style="width:463px;height:224px" srcset="../../wp-content/uploads/2022/08/map_pandas_own_function.png 496w, ../../wp-content/uploads/2022/08/map_pandas_own_function-300x145.png 300w" sizes="auto, (max-width: 496px) 100vw, 496px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c72e304735950" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72e304735950-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72e304735950-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72e304735950-1"><span class="crayon-c"># снова удалим созданный столбец</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72e304735950-2"><span class="crayon-v">people</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'age_group'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h4 class="wp-block-heading" id="31-funktsiya-npwhere">Функция np.where()</h4>



<p>Точно такой же результат мы можем получить, применив <a href="../../python/npmath/index.html">функцию <strong>np.where()</strong></a> библиотеки Numpy к нужному нам столбцу.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c72f209889102" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72f209889102-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72f209889102-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c72f209889102-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c72f209889102-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72f209889102-1"><span class="crayon-c"># внутри функции np.where() три параметра: (1) условие,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72f209889102-2"><span class="crayon-c"># (2) значение, если условие выдает True, (3) и значение, если условие выдает False</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c72f209889102-3"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age_group'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">where</span><span class="crayon-sy">(</span><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'adult'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'minor'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c72f209889102-4"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="490" height="239" src="../../wp-content/uploads/2022/08/map_pandas_npwhere.png" alt="применение функции np.where() к датафрейму библиотеки Pandas" class="wp-image-14470" style="width:437px;height:213px" srcset="../../wp-content/uploads/2022/08/map_pandas_npwhere.png 490w, ../../wp-content/uploads/2022/08/map_pandas_npwhere-300x146.png 300w" sizes="auto, (max-width: 490px) 100vw, 490px" /></figure>



<p>Замечу, что такой способ превращения количественных данных в категориальные называется <strong>binning</strong> или <strong>bucketing</strong>. О нем мы подробно поговорим на занятии по преобразованию данных.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c730840746339" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c730840746339-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c730840746339-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c730840746339-1"><span class="crayon-c"># удалим созданный столбец</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c730840746339-2"><span class="crayon-v">people</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'age_group'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h4 class="wp-block-heading" id="32-metod-where">Метод .where()</h4>



<p><strong>Метод .where()</strong> библиотеки Pandas действует немного иначе. В нем мы прописываем условие, которое хотим применить к отдельному столбцу или всему датафрейму:</p>



<ul class="wp-block-list">
<li>если условие выполняется (т.е. оценивается как True), мы сохраняем текущее значение датафрейма;</li>



<li>если условие не выполняется (False), то значение заменяется на новое, указанное в методе <strong>.where()</strong>.</li>
</ul>



<p>Рассмотрим применение этого метода на примерах.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c732663003052" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c732663003052-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c732663003052-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c732663003052-1"><span class="crayon-c"># заменим возраст тех, кому меньше 18, на NaN</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c732663003052-2"><span class="crayon-v">people</span><span class="crayon-sy">.</span><span class="crayon-v">age</span><span class="crayon-sy">.</span><span class="crayon-e">where</span><span class="crayon-sy">(</span><span class="crayon-v">people</span><span class="crayon-sy">.</span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">other</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">nan</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c733081685524" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c733081685524-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c733081685524-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c733081685524-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c733081685524-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c733081685524-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c733081685524-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c733081685524-1">0&nbsp;&nbsp;&nbsp;&nbsp;35.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c733081685524-2">1&nbsp;&nbsp;&nbsp;&nbsp;20.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c733081685524-3">2&nbsp;&nbsp;&nbsp;&nbsp; NaN</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c733081685524-4">3&nbsp;&nbsp;&nbsp;&nbsp;28.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c733081685524-5">4&nbsp;&nbsp;&nbsp;&nbsp; NaN</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c733081685524-6">Name: age, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В примере выше возраст тех, кто не моложе 18 (True), остался без изменений. Для остальных (False) значение изменилось на пропущенное (параметр <em>other</em>). Обратите внимание, что тип данных этого столбца превратился во float. Это связано с тем, что в столбце появились пропущенные значения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c734429051607" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c734429051607-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-1"><span class="crayon-c"># создадим матрицу из вложенных списков</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-2"><span class="crayon-v">nums_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-6"><span class="crayon-c"># преобразуем в датафрейм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-7"><span class="crayon-c"># (матрица не обязательно должна быть массивом Numpy (!))</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-8"><span class="crayon-v">nums</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">nums_matrix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c734429051607-9"><span class="crayon-v">nums</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="142" height="164" src="../../wp-content/uploads/2022/08/lists_to_dataframe.png" alt="библиотека Pandas: датафрейм из чисел" class="wp-image-14492" style="width:130px;height:151px"/></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c735292669364" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c735292669364-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c735292669364-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c735292669364-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c735292669364-1"><span class="crayon-c"># если число положительное (nums &lt; 0 == True), оставим его без изменений</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c735292669364-2"><span class="crayon-c"># если отрицательное (False), заменим на обратное (т.е. сделаем положительным)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c735292669364-3"><span class="crayon-v">nums</span><span class="crayon-sy">.</span><span class="crayon-e">where</span><span class="crayon-sy">(</span><span class="crayon-v">nums</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">other</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">nums</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="133" height="160" src="../../wp-content/uploads/2022/08/where_pandas.png" alt="применение метода .where() библиотеки Pandas" class="wp-image-14493" style="width:128px;height:153px"/></figure>



<p>Здесь можно отметить два интересных момента:</p>



<ul class="wp-block-list">
<li>мы применили метод <strong>.where()</strong> ко всему датафрейму;</li>



<li>в качестве значения, на которое нужно заменить текущее при False, мы использовали сами значения датафрейма, но со знаком минус (
			<span id="urvanov-syntax-highlighter-67aa62562c737711498562" class="urvanov-syntax-highlighter-syntax urvanov-syntax-highlighter-syntax-inline  crayon-theme-familiar-my-copy crayon-theme-familiar-my-copy-inline urvanov-syntax-highlighter-font-consolas" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important;"><span class="crayon-pre urvanov-syntax-highlighter-code" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">-</span><span class="crayon-v">nums</span></span></span>).</li>
</ul>



<p>Перейдем к методу <strong>.apply()</strong>.</p>



<h4 class="wp-block-heading" id="33-metod-apply">Метод .apply()</h4>



<h5 class="wp-block-heading" id="34-primenenie-funktsii-s-argumentami">Применение функции с аргументами</h5>



<p>В отличие от <strong>.map()</strong>, <strong>метод .apply()</strong> позволяет передавать <a href="../../python/functions/index.html">именованные аргументы</a> в применяемую функцию.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c738019554859" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c738019554859-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-1"><span class="crayon-c"># объявим функцию, которой можно передать не только значение возраста, но и порог,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-2"><span class="crayon-c"># при котором мы будем считать человека совершеннолетним</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-3"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_age_group</span><span class="crayon-sy">(</span><span class="crayon-v">age</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">age</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-v">threshold</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">age_group</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'adult'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">age_group</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'minor'</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c738019554859-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">age_group</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c739307621153" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c739307621153-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c739307621153-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c739307621153-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c739307621153-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c739307621153-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c739307621153-1"><span class="crayon-c"># применим эту функцию к столбцу age, выбрав в качестве порогового значения 21 год</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c739307621153-2"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age_group'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'age'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">apply</span><span class="crayon-sy">(</span><span class="crayon-v">get_age_group</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">threshold</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">21</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c739307621153-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c739307621153-4"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c739307621153-5"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="493" height="240" src="../../wp-content/uploads/2022/08/apply_pandas.png" alt="метод .apply(), применение функции с именованными аргументами" class="wp-image-14494" style="width:466px;height:227px" srcset="../../wp-content/uploads/2022/08/apply_pandas.png 493w, ../../wp-content/uploads/2022/08/apply_pandas-300x146.png 300w" sizes="auto, (max-width: 493px) 100vw, 493px" /></figure>



<h5 class="wp-block-heading" id="35-primenenie-k-stolbtsam">Применение к столбцам</h5>



<p>В метод <strong>.apply()</strong> можно передать уже имеющуюся в Питоне функцию, например, из библиотеки Numpy.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c73b296073856" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73b296073856-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73b296073856-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73b296073856-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73b296073856-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73b296073856-1"><span class="crayon-c"># заменим значения в столбцах height и weight на медиану по столбцам</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73b296073856-2"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'height'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weight'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'height'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'weight'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">apply</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">median</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73b296073856-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73b296073856-4"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="493" src="../../wp-content/uploads/2022/08/apply_columns-1024x493.jpg" alt="метода .apply(): применение функции к столбцам" class="wp-image-14498" style="width:449px;height:216px" srcset="../../wp-content/uploads/2022/08/apply_columns-1024x493.jpg 1024w, ../../wp-content/uploads/2022/08/apply_columns-300x144.jpg 300w, ../../wp-content/uploads/2022/08/apply_columns-768x370.jpg 768w, ../../wp-content/uploads/2022/08/apply_columns-1200x577.jpg 1200w, ../../wp-content/uploads/2022/08/apply_columns-600x289.jpg 600w, ../../wp-content/uploads/2022/08/apply_columns.jpg 1303w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<h5 class="wp-block-heading" id="36-primenenie-k-strokam">Применение к строкам</h5>



<p>Теперь поработаем со строками. Создадим функцию, которая считает индекс массы тела (body mass index, BMI) на основе веса и роста человека.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c73c938272052" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73c938272052-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73c938272052-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73c938272052-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73c938272052-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73c938272052-1"><span class="crayon-c"># внутри функции разделим вес на квадрат роста</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73c938272052-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">get_bmi</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73c938272052-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bmi</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-s">'weight'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-s">'height'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73c938272052-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">bmi</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Теперь применим эту функцию к каждой строке и сохраним результат в новом столбце.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c73d826205030" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73d826205030-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73d826205030-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73d826205030-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73d826205030-1"><span class="crayon-c"># для применения функции к строке используется параметр axis = 1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73d826205030-2"><span class="crayon-v">people</span><span class="crayon-sy">[</span><span class="crayon-s">'bmi'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">people</span><span class="crayon-sy">.</span><span class="crayon-k ">apply</span><span class="crayon-sy">(</span><span class="crayon-v">get_bmi</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73d826205030-3"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="434" src="../../wp-content/uploads/2022/08/apply_rows-1024x434.jpg" alt="метод .apply(): применение функции к строкам" class="wp-image-14499" style="width:512px;height:217px" srcset="../../wp-content/uploads/2022/08/apply_rows-1024x434.jpg 1024w, ../../wp-content/uploads/2022/08/apply_rows-300x127.jpg 300w, ../../wp-content/uploads/2022/08/apply_rows-768x326.jpg 768w, ../../wp-content/uploads/2022/08/apply_rows-1200x509.jpg 1200w, ../../wp-content/uploads/2022/08/apply_rows-600x254.jpg 600w, ../../wp-content/uploads/2022/08/apply_rows.jpg 1465w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<h4 class="wp-block-heading" id="37-metod-applymap">Метод .applymap()</h4>



<p><strong>Метод .applymap()</strong> позволяет применять функции с именованными аргументами <em>ко всему датафрейму</em> (метод <strong>.apply()</strong> применяется только к строкам или столбцам). Рассмотрим несложный пример.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c73f219005166" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c73f219005166-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-1"><span class="crayon-c"># создадим датафрейм из чисел</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-2"><span class="crayon-v">nums_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-6"><span class="crayon-v">nums</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">nums_matrix</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c73f219005166-7"><span class="crayon-v">nums</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="348" height="421" src="../../wp-content/uploads/2022/08/simple_dataframe.jpg" alt="простой числовой датафрейм библиотеки Pandas" class="wp-image-14500" style="width:135px;height:164px" srcset="../../wp-content/uploads/2022/08/simple_dataframe.jpg 348w, ../../wp-content/uploads/2022/08/simple_dataframe-248x300.jpg 248w" sizes="auto, (max-width: 348px) 100vw, 348px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c740589702561" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c740589702561-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c740589702561-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c740589702561-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c740589702561-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c740589702561-1"><span class="crayon-c"># объявим функцию, которая на входе принимает число x и</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c740589702561-2"><span class="crayon-c"># прибавляет к нему другое число, указанное в параметре number</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c740589702561-3"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">add_number</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">number</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c740589702561-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">number</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c741186159239" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c741186159239-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c741186159239-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c741186159239-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c741186159239-1"><span class="crayon-c"># передадим методу .applymap() функцию add_number и </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c741186159239-2"><span class="crayon-c"># прибавим единицу к каждому элементу датафрейма</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c741186159239-3"><span class="crayon-v">nums</span><span class="crayon-sy">.</span><span class="crayon-e">applymap</span><span class="crayon-sy">(</span><span class="crayon-v">add_number</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">number</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="348" height="424" src="../../wp-content/uploads/2022/08/applymap_pandas.jpg" alt="метод .applymap(): применение функции ко всему датафрейму" class="wp-image-14501" style="width:134px;height:162px" srcset="../../wp-content/uploads/2022/08/applymap_pandas.jpg 348w, ../../wp-content/uploads/2022/08/applymap_pandas-246x300.jpg 246w" sizes="auto, (max-width: 348px) 100vw, 348px" /></figure>



<h4 class="wp-block-heading" id="38-metod-pipe">Метод .pipe()</h4>



<p><strong>Метод .pipe()</strong>, как следует из его названия, позволяет создать pipeline и последовательно применить несколько функций к датафрейму. Вновь создадим исходный датафрейм с параметрами нескольких людей.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c742064494200" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c742064494200-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-1"><span class="crayon-v">people</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-s">'name'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Алексей'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Иван'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Анна'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Ольга'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Николай'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'gender'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'age'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">35</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'height'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">180.46</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">182.26</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">165.12</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">168.04</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">178.68</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-s">'weight'</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">73.61</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">75.34</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">50.22</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52.14</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">69.72</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c742064494200-8"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="385" height="241" src="../../wp-content/uploads/2022/08/dataframe_before_pipe.png" alt="датафрейм перед применением метода .pipe()" class="wp-image-14503" style="width:367px;height:230px" srcset="../../wp-content/uploads/2022/08/dataframe_before_pipe.png 385w, ../../wp-content/uploads/2022/08/dataframe_before_pipe-300x188.png 300w" sizes="auto, (max-width: 385px) 100vw, 385px" /></figure>



<p>Объявим несколько функций, которые мы могли бы применить к датафрейму.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c744904955930" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c744904955930-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-1"><span class="crayon-c"># в первую очередь скопируем датафрейм</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">copy_df</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-3"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-5"><span class="crayon-c"># заменим значения столбца на новые с помощью метода .map() </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">map_column</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">column</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">labels_map</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">label1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">label2</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">column</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">map</span><span class="crayon-sy">(</span><span class="crayon-v">labels_map</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">df</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-11"><span class="crayon-c"># кроме этого, создадим функцию для превращения количественной переменной</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-12"><span class="crayon-c"># в бинарную категориальную</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-13"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">newcol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">condcol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thres</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cat1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cat2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">newcol</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">where</span><span class="crayon-sy">(</span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">condcol</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-v">thres</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cat1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cat2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c744904955930-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<p>Последовательно применим эти функции с помощью нескольких методов <strong>.pipe()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c745197025246" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c745197025246-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c745197025246-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c745197025246-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c745197025246-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c745197025246-1"><span class="crayon-v">people_processed</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">people</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c745197025246-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pipe</span><span class="crayon-sy">(</span><span class="crayon-v">copy_df</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-c"># copy_df() применится ко всему датафрейму</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c745197025246-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pipe</span><span class="crayon-sy">(</span><span class="crayon-v">map_column</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'gender'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'female'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'male'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-c"># map_column() к столбцу gender</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c745197025246-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">pipe</span><span class="crayon-sy">(</span><span class="crayon-v">to_categorical</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age_group'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'adult'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'minor'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># to_categorical() к age_group</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Посмотрим на результат и кроме того убедимся, что исходный датафрейм не изменился.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c747403993502" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c747403993502-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c747403993502-1"><span class="crayon-v">people_processed</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="490" height="239" src="../../wp-content/uploads/2022/08/dataframe_after_pipe.png" alt="датафрейм после применения метода .pipe()" class="wp-image-14504" style="width:433px;height:211px" srcset="../../wp-content/uploads/2022/08/dataframe_after_pipe.png 490w, ../../wp-content/uploads/2022/08/dataframe_after_pipe-300x146.png 300w" sizes="auto, (max-width: 490px) 100vw, 490px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c748189021969" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c748189021969-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c748189021969-1"><span class="crayon-v">people</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="387" height="236" src="../../wp-content/uploads/2022/08/dataframe_source.png" alt="исходный датафрейм" class="wp-image-14505" style="width:361px;height:220px" srcset="../../wp-content/uploads/2022/08/dataframe_source.png 387w, ../../wp-content/uploads/2022/08/dataframe_source-300x183.png 300w" sizes="auto, (max-width: 387px) 100vw, 387px" /></figure>



<p>Перейдем к следующему разделу, который посвящен соединению датафреймов.</p>



<h2 class="wp-block-heading" id="39-soedinenie-datafreymov">Соединение датафреймов</h2>



<p>Рассмотрим, как мы можем соединить два датафрейма с помощью функций/методов <strong>pd.concat()</strong>, <strong>pd.merge()</strong> и <strong>.join()</strong>. Начнем с функции <strong>pd.concat()</strong>.</p>



<h3 class="wp-block-heading" id="40-pdconcat">pd.concat()</h3>



<p>В качестве примера возьмем информацию о стоимости канцелярских товаров в двух магазинах.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c749302278974" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c749302278974-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-1"><span class="crayon-v">s1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'item'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'карандаш'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ручка'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'папка'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'степлер'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'price'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">220</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">340</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-4"><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-6"><span class="crayon-v">s2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'item'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'клей'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'корректор'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'скрепка'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'бумага'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'price'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">200</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">240</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c749302278974-9"><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p>Выведем результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c74a454123786" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74a454123786-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74a454123786-1"><span class="crayon-v">s1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="192" height="194" src="../../wp-content/uploads/2022/08/s1.png" alt="датафрейм с информацией о стоимости товаров в первом магазине" class="wp-image-14506" style="width:173px;height:175px"/></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c74c123798444" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74c123798444-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74c123798444-1"><span class="crayon-v">s2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="193" height="194" src="../../wp-content/uploads/2022/08/s2.png" alt="датафрейм с информацией о стоимости товаров во втором магазине" class="wp-image-14507" style="width:170px;height:171px" srcset="../../wp-content/uploads/2022/08/s2.png 193w, ../../wp-content/uploads/2022/08/s2-150x150.png 150w" sizes="auto, (max-width: 193px) 100vw, 193px" /></figure>



<h4 class="wp-block-heading" id="41-soedinenie-odin-na-drugoy">Соединение &#171;один на другой&#187;</h4>



<p>В первую очередь мы можем совместить два датафрейма, поставив их &#171;один на другой&#187;.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c74d503142292" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74d503142292-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c74d503142292-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74d503142292-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74d503142292-1"><span class="crayon-c"># передадим в функцию pd.concat() список из соединяемых датафреймов,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c74d503142292-2"><span class="crayon-c"># укажем параметр axis = 0 (значение по умолчанию)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74d503142292-3"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="197" height="348" src="../../wp-content/uploads/2022/08/pandas_concat_axis0.png" alt="pd.concat(), axis = 0" class="wp-image-14515" style="width:169px;height:298px" srcset="../../wp-content/uploads/2022/08/pandas_concat_axis0.png 197w, ../../wp-content/uploads/2022/08/pandas_concat_axis0-170x300.png 170w" sizes="auto, (max-width: 197px) 100vw, 197px" /></figure>



<p>Как вы видите, индекс не обновился.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c74e387143084" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74e387143084-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c74e387143084-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74e387143084-1"><span class="crayon-c"># обновим индекс через параметр ignore_index = True</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c74e387143084-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ignore_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="194" height="352" src="../../wp-content/uploads/2022/08/pandas_concat_axis0_ignore_index.png" alt="pd.concat(), axis = 0, ignore_index = True" class="wp-image-14516" style="width:170px;height:309px" srcset="../../wp-content/uploads/2022/08/pandas_concat_axis0_ignore_index.png 194w, ../../wp-content/uploads/2022/08/pandas_concat_axis0_ignore_index-165x300.png 165w" sizes="auto, (max-width: 194px) 100vw, 194px" /></figure>



<p class="has-background" style="background-color:#ffe8c4">Именно таким способом предлагается добавлять новые строки вместо удаленного из библиотеки метода <strong>.append()</strong>. При этом здесь есть нюанс, в функцию <strong>pd.concat()</strong> нельзя передать словарь, только объекты Series и DataFrame.</p>



<p>При соединении датафреймов мы можем создать многоуровневый (иерархический) индекс. Например, создадим отдельную группу для товаров первого магазина (s1) и товаров второго (s2).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c74f333088074" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74f333088074-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c74f333088074-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c74f333088074-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c74f333088074-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74f333088074-1"><span class="crayon-c"># передадим в параметр keys названия групп индекса,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c74f333088074-2"><span class="crayon-c"># параметр names получим названия уровней индекса</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c74f333088074-3"><span class="crayon-v">by_shop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keys</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'s1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'s2'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'s'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'id'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c74f333088074-4"><span class="crayon-v">by_shop</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="240" height="395" src="../../wp-content/uploads/2022/08/pandas_concat_axis0_multi.png" alt="pd.concat(), axis = 0, многоуровневый индекс строк" class="wp-image-14517" style="width:200px;height:329px" srcset="../../wp-content/uploads/2022/08/pandas_concat_axis0_multi.png 240w, ../../wp-content/uploads/2022/08/pandas_concat_axis0_multi-182x300.png 182w" sizes="auto, (max-width: 240px) 100vw, 240px" /></figure>



<p>Посмотрим на созданный индекс.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c751581005977" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c751581005977-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c751581005977-1"><span class="crayon-v">by_shop</span><span class="crayon-sy">.</span><span class="crayon-v">index</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c752507403029" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c752507403029-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-1">MultiIndex([('s1', 0),</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-2">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s1', 1),</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s1', 2),</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s1', 3),</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s2', 0),</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s2', 1),</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s2', 2),</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;('s2', 3)],</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c752507403029-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; names=['s', 'id'])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Выведем первую запись в первой группе.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c753852516911" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c753852516911-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c753852516911-1"><span class="crayon-v">by_shop</span><span class="crayon-sy">.</span><span class="crayon-v">loc</span><span class="crayon-sy">[</span><span class="crayon-sy">(</span><span class="crayon-s">'s1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c754246174861" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c754246174861-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c754246174861-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c754246174861-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c754246174861-1">item&nbsp;&nbsp;&nbsp;&nbsp; карандаш</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c754246174861-2">price&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 220</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c754246174861-3">Name: (s1, 0), dtype: object</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="42-soedinenie-ryadom-drug-s-drugom">Соединение &#171;рядом друг с другом&#187;</h4>



<p>Датафреймы можно расположить &#171;рядом друг с другом&#187;.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c756091361612" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c756091361612-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c756091361612-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c756091361612-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c756091361612-1"><span class="crayon-c"># для этого сразу используем параметр axis = 1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c756091361612-2"><span class="crayon-c"># одновременно сразу создадим группы для многоуровневого индекса столбцов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c756091361612-3"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keys</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'s1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'s2'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="355" height="234" src="../../wp-content/uploads/2022/08/pandas_concat_axis1.png" alt="pd.concat(), axis = 1, многоуровневый индекс столбцов" class="wp-image-14518" style="width:320px;height:211px" srcset="../../wp-content/uploads/2022/08/pandas_concat_axis1.png 355w, ../../wp-content/uploads/2022/08/pandas_concat_axis1-300x198.png 300w" sizes="auto, (max-width: 355px) 100vw, 355px" /></figure>



<p>Выберем вторую группу (второй магазин) с помощью метода <strong>.iloc[]</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c757590377938" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c757590377938-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c757590377938-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keys</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'s1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'s2'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">loc</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-s">'s2'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="191" height="195" src="../../wp-content/uploads/2022/08/pandas_concat_axis1_iloc.png" alt="pd.concat() + .iloc[]" class="wp-image-14519" style="width:165px;height:168px"/></figure>



<p>Полученный через соединение результат&nbsp;и&nbsp;в&nbsp;целом&nbsp;любой&nbsp;датафрейм&nbsp;можно&nbsp;транспонировать.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c758846231967" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c758846231967-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c758846231967-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c758846231967-1"><span class="crayon-c"># для транспонирования датафрейма используется метод .T или .transpose()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c758846231967-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">s1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keys</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'s1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'s2'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">T</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="458" height="200" src="../../wp-content/uploads/2022/08/pandas_concat_axis1_T.png" alt="библиотека Pandas, транспонирование датафрейма" class="wp-image-14520" style="width:387px;height:169px" srcset="../../wp-content/uploads/2022/08/pandas_concat_axis1_T.png 458w, ../../wp-content/uploads/2022/08/pandas_concat_axis1_T-300x131.png 300w" sizes="auto, (max-width: 458px) 100vw, 458px" /></figure>



<p>Итак, <strong>pd.concat()</strong> выполняет простое &#171;склеивание&#187; датафреймов по вертикали или по горизонтали. Теперь посмотрим, что делать, если датафреймы нужно соединить по определенному столбцу.</p>



<h3 class="wp-block-heading" id="43-pdmerge-i-join">pd.merge() и .join()</h3>



<p>Возьмем три несложных датафрейма.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c75a760982211" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75a760982211-18">18</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-1"><span class="crayon-v">math_dict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Андрей'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Елена'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Антон'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Татьяна'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'math_score'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-5"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-7"><span class="crayon-v">math_degree_dict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'degree'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'M'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'M'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-11"><span class="crayon-v">cs_dict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'name'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Андрей'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Ольга'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Евгений'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Татьяна'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'cs_score'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">87</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">82</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">77</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">81</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-14"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-16"><span class="crayon-k ">math</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">math_dict</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-17"><span class="crayon-v">cs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">cs_dict</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75a760982211-18"><span class="crayon-v">math_degree</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">math_degree_dict</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<p>В первом содержатся оценки студентов ВУЗа по математике (по 100-бальной шкале).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c75b164878175" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75b164878175-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75b164878175-1"><span class="crayon-k ">math</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="225" height="196" src="../../wp-content/uploads/2022/08/math.png" alt="оценки студентов по математике" class="wp-image-14522" style="width:195px;height:170px"/></figure>



<p>Во втором указано, по какой программе (бакалавр или магистр) учатся студенты.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c75c263855801" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75c263855801-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75c263855801-1"><span class="crayon-v">math_degree</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="105" height="194" src="../../wp-content/uploads/2022/08/math_degree.png" alt="учебные программы" class="wp-image-14523" style="width:86px;height:159px"/></figure>



<p>В третьем содержатся данные об оценках по информатике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c75d133848234" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75d133848234-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75d133848234-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75d133848234-1"><span class="crayon-c"># имена некоторых студентов повторяются, других - нет</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75d133848234-2"><span class="crayon-v">cs</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="206" height="195" src="../../wp-content/uploads/2022/08/cs.png" alt="оценки студентов по информатике" class="wp-image-14524" style="width:181px;height:171px"/></figure>



<h4 class="wp-block-heading" id="44-left-join">Left join</h4>



<p>Предположим, что мы хотим объединить данные об оценках студентов по математике с информацией о том, по какой программе они учатся. Для этого можно воспользоваться <em>соединением слева</em> (left join) через <strong>функцию pd.merge()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c75f850717816" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75f850717816-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c75f850717816-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c75f850717816-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75f850717816-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">math_degree</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># выполним соединение двух датафреймов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c75f850717816-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># способом left join</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c75f850717816-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">left_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># по индексам левого и правого датафрейма</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="298" height="200" src="../../wp-content/uploads/2022/08/merge_left_join.png" alt="библиотека Pandas, left join" class="wp-image-14527" style="width:261px;height:175px"/></figure>



<p>Точно такой же результат можно получить, применив <strong>метод .join()</strong>. По умолчанию, он как раз выполняет соединение слева (left join) по индексу (index-on-index).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c760099999641" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c760099999641-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c760099999641-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c760099999641-1"><span class="crayon-c"># можно сказать, что .join() "заточен" под left join по индексу</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c760099999641-2"><span class="crayon-k ">math</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-v">math_degree</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="298" height="195" src="../../wp-content/uploads/2022/08/join_pandas.png" alt="метод .join() библиотеки Pandas" class="wp-image-14528" style="width:247px;height:162px"/></figure>



<p class="has-background" style="background-color:#ffe8c4">Здесь важно отметить, что <em>главным является датафрейм слева</em>. Другими словами, если в столбцах, по которым мы соединяем датафреймы есть расхождения, библиотека Pandas <em>сохранит нетронутым левый датафрейм</em>, а в правом &#8212; либо заполнит недостающие значения пропусками, либо удалит лишние строки.</p>



<p>Например, соединим датафреймы math и cs по столбцу name для того, чтобы увидеть оценки студентов и по математике, и по информатике. В группе по математике не учатся Ольга и Евгений (они изучают только информатику), а в группе по информатике не учатся Елена и Антон (им ближе математика). Посмотрим, что произойдет после left join.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c761108144680" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c761108144680-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c761108144680-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c761108144680-1"><span class="crayon-c"># выполним left join по столбцу name</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c761108144680-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="319" height="199" src="../../wp-content/uploads/2022/08/left_join_pandas.png" alt="left join: главным является датафрейм слева" class="wp-image-14529" style="width:295px;height:184px" srcset="../../wp-content/uploads/2022/08/left_join_pandas.png 319w, ../../wp-content/uploads/2022/08/left_join_pandas-300x187.png 300w" sizes="auto, (max-width: 319px) 100vw, 319px" /></figure>



<p>Как вы видите, Pandas сохранил всех математиков (левый датафрейм), поставив NaN для тех из них, кто не изучается информатику. В правом датафрейме (информатика) сохранились только те студенты, которые также изучают и математику.</p>



<p>Концепцию соединения по определенному столбцу можно также объяснить через <a href="../../python/list-tuple-set/index.html">теорию множеств</a>. На диаграмме Эйлера left join будет выглядеть следующим образом.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="478" height="280" src="../../wp-content/uploads/2022/08/left_join.png" alt="left join на диаграмме Эйлера" class="wp-image-14555" style="width:361px;height:211px" srcset="../../wp-content/uploads/2022/08/left_join.png 478w, ../../wp-content/uploads/2022/08/left_join-300x176.png 300w" sizes="auto, (max-width: 478px) 100vw, 478px" /></figure>



<p>Опять же мы включаем в финальный датасет всех математиков и при этом оставляем только тех студентов информатики, которых также интересуют математические дисциплины.</p>



<h4 class="wp-block-heading" id="45-left-excluding-join">Left excluding join</h4>



<p><em>Левое исключающее соединение</em> (left excluding join, left anti-join) предполагает, что мы оставляем только те наблюдения, которые есть в левом датафрейме и исключаем записи только правого датафрейма, а также записи, которые содержатся в обоих.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="481" height="296" src="../../wp-content/uploads/2022/08/left_excluding_join.png" alt="left excluding join: сохраняем наблюдения только левого датафрейма" class="wp-image-14556" style="width:368px;height:227px" srcset="../../wp-content/uploads/2022/08/left_excluding_join.png 481w, ../../wp-content/uploads/2022/08/left_excluding_join-300x185.png 300w" sizes="auto, (max-width: 481px) 100vw, 481px" /></figure>



<p>На Питоне вначале выполним левое соединение и с помощью параметра <em>indicator = True</em> создадим служебный столбец _merge, в котором указано, в каком из датафреймов присутствует каждая строка.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c763012675457" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c763012675457-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c763012675457-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">indicator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="401" height="202" src="../../wp-content/uploads/2022/08/left_join_indicator_true.png" alt="left excluding join: служебный столбец _merge" class="wp-image-14562" style="width:367px;height:185px" srcset="../../wp-content/uploads/2022/08/left_join_indicator_true.png 401w, ../../wp-content/uploads/2022/08/left_join_indicator_true-300x151.png 300w" sizes="auto, (max-width: 401px) 100vw, 401px" /></figure>



<p>Как мы видим, Елена и Антон присутствуют только в левом датафрейме, Андрей и Татьяна &#8212; в обоих. Теперь с помощью метода <strong>.query()</strong> выберем только записи из левого датафрейма и удалим столбец _merge.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c764917055804" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c764917055804-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c764917055804-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c764917055804-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c764917055804-1"><span class="crayon-c"># все это можно сделать, применив несколько методов подряд</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c764917055804-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">indicator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c764917055804-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'_merge == "left_only"'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'_merge'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="299" height="117" src="../../wp-content/uploads/2022/08/left_excluding_join_result.png" alt="left excluding join: результат с .query() и без _merge" class="wp-image-14563" style="width:279px;height:109px"/></figure>



<p>Ожидаемо, в столбце cs_score появились NaN (у тех, кто учит только математику, не может быть оценок по информатике).</p>



<p class="has-background" style="background-color:#ffe8c4">Также обратите внимание на <strong>обратный слэш</strong> (\), который позволяет <em>перенести код на следующую строку</em>.</p>



<h4 class="wp-block-heading" id="46-right-join">Right join</h4>



<p><em>Правое соединение</em> (right join) &#8212; зеркальная операция по отношению к левому соединению. Мы выбираем те записи, которые содержатся только в правом или в обоих датафреймах. </p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="510" height="301" src="../../wp-content/uploads/2022/08/right_join.png" alt="right join: записи, которые есть только в правом или в обоих датафреймах" class="wp-image-14557" style="width:382px;height:225px" srcset="../../wp-content/uploads/2022/08/right_join.png 510w, ../../wp-content/uploads/2022/08/right_join-300x177.png 300w" sizes="auto, (max-width: 510px) 100vw, 510px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c766239016250" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c766239016250-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c766239016250-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="321" height="198" src="../../wp-content/uploads/2022/08/right_join_result.png" alt="right join: результат" class="wp-image-14564" style="width:274px;height:169px" srcset="../../wp-content/uploads/2022/08/right_join_result.png 321w, ../../wp-content/uploads/2022/08/right_join_result-300x185.png 300w" sizes="auto, (max-width: 321px) 100vw, 321px" /></figure>



<p>В результате остались те, кто учит информатику, а также одновременно и математику и информатику. </p>



<h4 class="wp-block-heading" id="47-right-excluding-join">Right excluding join</h4>



<p><em>Правое исключающее соединение</em> (right excluding join, right anti-join) соответственно зеркально операции с левой стороны. Мы берем наблюдения, которые есть только в правом датафрейме.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="502" height="315" src="../../wp-content/uploads/2022/08/right_excluding_join.png" alt="right excluding join: сохраняем наблюдения только правого датафрейма" class="wp-image-14558" style="width:368px;height:231px" srcset="../../wp-content/uploads/2022/08/right_excluding_join.png 502w, ../../wp-content/uploads/2022/08/right_excluding_join-300x188.png 300w" sizes="auto, (max-width: 502px) 100vw, 502px" /></figure>



<p>На Питоне мы вначале выполним правое соединение с параметром <em>indicator = True</em> и посмотрим, в каком из датафреймов содержится каждое наблюдение.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c767073066537" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c767073066537-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c767073066537-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">indicator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="413" height="200" src="../../wp-content/uploads/2022/08/right_join_indicator_true.png" alt="right excluding join: служебный столбец _merge" class="wp-image-14565" style="width:343px;height:166px" srcset="../../wp-content/uploads/2022/08/right_join_indicator_true.png 413w, ../../wp-content/uploads/2022/08/right_join_indicator_true-300x145.png 300w" sizes="auto, (max-width: 413px) 100vw, 413px" /></figure>



<p>Теперь воспользуемся методом <strong>.query()</strong> и оставим записи, которые есть только в правом датафрейме. После этого удалим столбец _merge.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c769213905185" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c769213905185-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c769213905185-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c769213905185-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">indicator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c769213905185-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'_merge == "right_only"'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'_merge'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="320" height="117" src="../../wp-content/uploads/2022/08/right_excluding_join_result.png" alt="right excluding join: результат с .query() и без _merge" class="wp-image-14566" style="width:293px;height:107px" srcset="../../wp-content/uploads/2022/08/right_excluding_join_result.png 320w, ../../wp-content/uploads/2022/08/right_excluding_join_result-300x110.png 300w" sizes="auto, (max-width: 320px) 100vw, 320px" /></figure>



<h4 class="wp-block-heading" id="48-outer-join">Outer join</h4>



<p><em>Внешнее соединение</em> (outer join) сохраняет все строки обоих датафреймов.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="452" height="282" src="../../wp-content/uploads/2022/08/outer_join.png" alt="outer join: сохраняем все строки обоих датафреймов" class="wp-image-14559" style="width:324px;height:202px" srcset="../../wp-content/uploads/2022/08/outer_join.png 452w, ../../wp-content/uploads/2022/08/outer_join-300x187.png 300w" sizes="auto, (max-width: 452px) 100vw, 452px" /></figure>



<p>Сразу посмотрим на код на Питоне.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c76a595975123" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c76a595975123-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c76a595975123-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'outer'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="322" height="275" src="../../wp-content/uploads/2022/08/outer_join_result.png" alt="outer join: результат соединения датафреймов" class="wp-image-14567" style="width:282px;height:241px" srcset="../../wp-content/uploads/2022/08/outer_join_result.png 322w, ../../wp-content/uploads/2022/08/outer_join_result-300x256.png 300w" sizes="auto, (max-width: 322px) 100vw, 322px" /></figure>



<p>Как мы видим, при таком соединении мы получили данные по всем студентам по обоим предметам. Одновременно, ожидаемо, для студентов только математики или только информатики не изучаемый ими предмет заполнен пропусками.</p>



<h4 class="wp-block-heading" id="49-full-excluding-join">Full excluding join</h4>



<p><em>Полное исключающее соединение</em> (full excluding join, full anti-join) сохраняет только те наблюдения, которые есть в левом либо правом датасетах, но не в обоих.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="450" height="287" src="../../wp-content/uploads/2022/08/full_excluding_join.png" alt="full excluding join: наблюдения либо левого, либо правого датасетов" class="wp-image-14572" style="width:317px;height:202px" srcset="../../wp-content/uploads/2022/08/full_excluding_join.png 450w, ../../wp-content/uploads/2022/08/full_excluding_join-300x191.png 300w" sizes="auto, (max-width: 450px) 100vw, 450px" /></figure>



<p>Воспользуемся параметрами <em>how = &#8216;outer&#8217;</em> и <em>indicator = True</em>. Так мы найдем те строки, которые есть только в левом датафрейме (left_only), только в правом датафрейме (right_only) и в обоих (both).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c76b393045592" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c76b393045592-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c76b393045592-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'outer'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">indicator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="414" height="284" src="../../wp-content/uploads/2022/08/full_excluding_join-1.png" alt="full excluding join: служебный столбец _merge" class="wp-image-14587" style="width:363px;height:249px" srcset="../../wp-content/uploads/2022/08/full_excluding_join-1.png 414w, ../../wp-content/uploads/2022/08/full_excluding_join-1-300x206.png 300w" sizes="auto, (max-width: 414px) 100vw, 414px" /></figure>



<p>Оставим только те записи, которых нет в обоих датафреймах.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c76d597523980" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c76d597523980-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c76d597523980-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c76d597523980-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c76d597523980-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'outer'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">indicator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c76d597523980-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'_merge != "both"'</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c76d597523980-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'_merge'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="321" height="206" src="../../wp-content/uploads/2022/08/full_excluding_join_result.png" alt="full excluding join: результат соединения датафреймов" class="wp-image-14588" style="width:287px;height:184px" srcset="../../wp-content/uploads/2022/08/full_excluding_join_result.png 321w, ../../wp-content/uploads/2022/08/full_excluding_join_result-300x193.png 300w" sizes="auto, (max-width: 321px) 100vw, 321px" /></figure>



<h4 class="wp-block-heading" id="50-inner-join">Inner join</h4>



<p><em>Внутреннее соединение</em> (inner join) сохраняет только те наблюдения, которые есть в обоих датафреймах.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="490" height="315" src="../../wp-content/uploads/2022/08/inner_join.png" alt="inner join: наблюдения одновременно обоих датафреймов" class="wp-image-14560" style="width:333px;height:214px" srcset="../../wp-content/uploads/2022/08/inner_join.png 490w, ../../wp-content/uploads/2022/08/inner_join-300x193.png 300w" sizes="auto, (max-width: 490px) 100vw, 490px" /></figure>



<p>В нашем случае это те студенты, которые учатся и на курсе по математике, и на курсе по информатике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c76e551951504" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c76e551951504-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c76e551951504-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c76e551951504-1"><span class="crayon-c"># для внутреннего соединения используется параметр how = 'inner'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c76e551951504-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'inner'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'name'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="319" height="116" src="../../wp-content/uploads/2022/08/inner_join_result.png" alt="inner join через pd.merge() с указанием параметра how = 'inner'" class="wp-image-14568" style="width:286px;height:104px" srcset="../../wp-content/uploads/2022/08/inner_join_result.png 319w, ../../wp-content/uploads/2022/08/inner_join_result-300x109.png 300w" sizes="auto, (max-width: 319px) 100vw, 319px" /></figure>



<p>Обращу ваше внимание на то, что по умолчанию <strong>pd.merge()</strong> выполняет именно внутренне соединение.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c76f496768619" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c76f496768619-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c76f496768619-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-k ">math</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cs</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="319" height="116" src="../../wp-content/uploads/2022/08/inner_join_result-1.png" alt="inner join через pd.merge() с параметрами по умолчанию" class="wp-image-14569" style="width:281px;height:102px" srcset="../../wp-content/uploads/2022/08/inner_join_result-1.png 319w, ../../wp-content/uploads/2022/08/inner_join_result-1-300x109.png 300w" sizes="auto, (max-width: 319px) 100vw, 319px" /></figure>



<p>Здесь нужно быть аккуратным, потому что если левый датафрейм был главным (его записи должны быть сохранены в обязательном порядке), использование <strong>pd.merge()</strong> с параметром по умолчанию (how = &#8216;inner&#8217;) вызовет потерю данных (лучше использовать left join).</p>



<h4 class="wp-block-heading" id="51-soedinenie-datafreymov-i-dublikaty">Соединение датафреймов и дубликаты</h4>



<p>Также замечу, что если в ваших данных есть дубликаты (повторяющиеся значения), нужно быть особенно внимательным при выборе типа соединения.</p>



<h5 class="wp-block-heading" id="52-pervyy-primer">Первый пример</h5>



<p>Создадим два датайфрейма: один с наименованием товара, другой &#8212; с ценой.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c770367355046" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c770367355046-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c770367355046-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c770367355046-1"><span class="crayon-v">product_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'холодильник'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'телевизор'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'code'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'product'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c770367355046-2"><span class="crayon-v">price_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40000</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">60000</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'code'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c772962575092" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c772962575092-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c772962575092-1"><span class="crayon-v">product_data</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="206" height="117" src="../../wp-content/uploads/2022/08/product.png" alt="датафрейм с наименованием товара" class="wp-image-14530" style="width:181px;height:103px"/></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c773315531763" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c773315531763-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c773315531763-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c773315531763-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c773315531763-1"><span class="crayon-c"># в этом датафрейме есть две цены для холодильника (код 1)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c773315531763-2"><span class="crayon-c"># и ни одной цены телевизора</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c773315531763-3"><span class="crayon-v">price_data</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="147" height="117" src="../../wp-content/uploads/2022/08/price.png" alt="датафрейм с ценой товара" class="wp-image-14532" style="width:133px;height:106px"/></figure>



<p>Выполним left join по столбцу code (код товара).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c774670464114" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c774670464114-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c774670464114-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">product_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">price_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'left'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'code'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="291" height="164" src="../../wp-content/uploads/2022/08/left_join_duplicates.png" alt="left join данных с повторяющимися значениями" class="wp-image-14533" style="width:259px;height:146px"/></figure>



<p>В результате мы получили данные о наименовании и цене товаров и так как у нас есть две цены для холодильника (и мы не знаем какая из них верная), оба этих значения вошли в финальный датафрейм. Вместо цены телевизора ожидаемо появился NaN.</p>



<p class="has-background" style="background-color:#ffe8c4">Нам лишь останется разобраться с повторяющимся значением, однако этим мы займемся на занятии по очистке данных.</p>



<p>Если бы мы выбрали, например, правое соединение, то часть данных была бы потеряна.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c776604135150" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c776604135150-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c776604135150-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">product_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">price_data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'code'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="270" height="122" src="../../wp-content/uploads/2022/08/product_price_right_join.png" alt="right join данных с повторяющимися значениями" class="wp-image-14602" style="width:250px;height:113px"/></figure>



<h5 class="wp-block-heading" id="53-vtoroy-primer">Второй пример</h5>



<p>Теперь возьмем случай, когда повтор встречается в левом, а не правом датафрейме.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c777295803623" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c777295803623-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-1"><span class="crayon-c"># создадим два датафрейма</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-2"><span class="crayon-v">exams_dict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'professor'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Погорельцев'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Преображенский'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Архенгельский'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Дятлов'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Иванов'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'student'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">101</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">102</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">103</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">104</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">101</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'score'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">83</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">84</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">78</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">80</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">82</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-6"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-8"><span class="crayon-v">students_dict</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'student_id'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">101</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">102</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">103</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">104</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-s">'student'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Андрей'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Елена'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Антон'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Татьяна'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-12"><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-14"><span class="crayon-v">exams</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">exams_dict</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c777295803623-15"><span class="crayon-v">students</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">students_dict</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<p>В первом датафрейме содержится информация о результатах экзамена с фамилией экзаменатора, идентификатором студента и оценкой.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c778263226746" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c778263226746-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c778263226746-1"><span class="crayon-v">exams</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="337" height="241" src="../../wp-content/uploads/2022/08/exams_df.png" alt="преподаватели и оценки за экзамен" class="wp-image-14589" style="width:294px;height:210px" srcset="../../wp-content/uploads/2022/08/exams_df.png 337w, ../../wp-content/uploads/2022/08/exams_df-300x215.png 300w" sizes="auto, (max-width: 337px) 100vw, 337px" /></figure>



<p>Во втором, идентификатор студента и его или ее имя.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c77a102058158" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77a102058158-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77a102058158-1"><span class="crayon-v">students</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="228" height="202" src="../../wp-content/uploads/2022/08/students_df.png" alt="идентификаторы и имена студентов" class="wp-image-14590" style="width:205px;height:182px"/></figure>



<p>Как вы видите, студент с идентификатором 101 (Андрей) сдавал экзамен двум преподавателям, Погорельцеву и Иванову. В данном случае дубликат сохранится при любом типе соединения left join, right join, outer join, inner join.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c77b219411318" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77b219411318-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c77b219411318-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77b219411318-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77b219411318-1"><span class="crayon-c"># применим параметр по умолчанию how = 'inner join'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c77b219411318-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">exams</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">students</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77b219411318-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">left_on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'student'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right_on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'student_id'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="573" height="240" src="../../wp-content/uploads/2022/08/exams_students_df.png" alt="соединение данных с дубликатами в левом датафрейме" class="wp-image-14591" style="width:494px;height:207px" srcset="../../wp-content/uploads/2022/08/exams_students_df.png 573w, ../../wp-content/uploads/2022/08/exams_students_df-300x126.png 300w" sizes="auto, (max-width: 573px) 100vw, 573px" /></figure>



<p>Вы можете самостоятельно убедиться, что другие типы соединения дадут такой же результат.</p>



<p>Кроме того замечу, что маркеры _x и _y, которые автоматически выставляются, если в датафреймах есть столбцы с одинаковыми названиями, можно изменить с помощью параметра 
			<span id="urvanov-syntax-highlighter-67aa62562c77c967607859" class="urvanov-syntax-highlighter-syntax urvanov-syntax-highlighter-syntax-inline  crayon-theme-familiar-my-copy crayon-theme-familiar-my-copy-inline urvanov-syntax-highlighter-font-consolas" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important;"><span class="crayon-pre urvanov-syntax-highlighter-code" style="font-size: 16px !important; line-height: 22px !important;font-size: 16px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">suffixes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'_x'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'_y'</span><span class="crayon-sy">)</span></span></span>.</p>



<h4 class="wp-block-heading" id="54-cross-join">Cross join</h4>



<p>Перекрестное соединение (cross join) по своей сути представляет собой <a href="../../python/random-04/index.html">декартово произведение</a>. В этом случае каждому элементу первого датафрейма ставится в соответствие каждый элемент второго.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c77d675031097" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77d675031097-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c77d675031097-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77d675031097-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77d675031097-1"><span class="crayon-c"># создадим датафрейм со столбцом xy и двумя значениями (x и y)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c77d675031097-2"><span class="crayon-v">df_xy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-s">'xy'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'x'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'y'</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77d675031097-3"><span class="crayon-v">df_xy</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="68" height="125" src="../../wp-content/uploads/2022/08/df_xy.png" alt="cross join: датафрейм с символами" class="wp-image-14592" style="width:65px;height:119px"/></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c77f739973704" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77f739973704-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c77f739973704-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c77f739973704-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77f739973704-1"><span class="crayon-c"># создадим еще один датафрейм со столбцом 123 и тремя значениями (1, 2 и 3)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c77f739973704-2"><span class="crayon-v">df_123</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span><span class="crayon-h"> </span><span class="crayon-s">'123'</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c77f739973704-3"><span class="crayon-v">df_123</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="73" height="164" src="../../wp-content/uploads/2022/08/df_123.png" alt="cross join: датафрейм с числами" class="wp-image-14593" style="width:70px;height:157px"/></figure>



<p>С помощью параметра <em>how = &#8216;cross&#8217;</em> мы можем поставить как значению x, так и значению y первого датафрейма каждый из элементов второго.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c780498479496" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c780498479496-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c780498479496-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">df_xy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_123</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'cross'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="112" height="281" src="../../wp-content/uploads/2022/08/cross_join.png" alt="cross join: декартово произведение" class="wp-image-14594" style="width:102px;height:257px"/></figure>



<p>Для сравнения соединим датафреймы с помощью right join.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c781439565702" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c781439565702-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c781439565702-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c781439565702-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge</span><span class="crayon-sy">(</span><span class="crayon-v">df_xy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">df_123</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c781439565702-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">how</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'right'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">left_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">right_index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="128" height="163" src="../../wp-content/uploads/2022/08/cross_right_join_compare.png" alt="сравнение cross join и right join" class="wp-image-14595" style="width:118px;height:150px"/></figure>



<h4 class="wp-block-heading" id="55-pdmerge_asof">pd.merge_asof()</h4>



<p>В некоторых случаях бывает нужно соединить датафреймы не по точному значению столбцов, а по ближайшему. Для этого существует <strong>функция pd.merge_asof()</strong>. Рассмотрим пример, который приведен в <a href="https://pandas.pydata.org/docs/reference/api/pandas.merge_asof.html" target="_blank" rel="noreferrer noopener">документации</a>⧉ к этой функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c782356095618" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c782356095618-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-1"><span class="crayon-c"># создадим два датафрейма</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-2"><span class="crayon-v">trades</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'time'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">to_datetime</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'20160525 13:30:00.023'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.038'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.048'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.048'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.048'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'ticker'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'MSFT'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'MSFT'</span><span class="crayon-sy">,</span><span class="crayon-s">'GOOG'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GOOG'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AAPL'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'price'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">51.95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51.95</span><span class="crayon-sy">,</span><span class="crayon-cn">720.77</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">720.92</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98.00</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'quantity'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">155</span><span class="crayon-sy">,</span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'time'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ticker'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'quantity'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-13"><span class="crayon-v">quotes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'time'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">to_datetime</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'20160525 13:30:00.023'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.023'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.030'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.041'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.048'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.049'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.072'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'20160525 13:30:00.075'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'ticker'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'GOOG'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'MSFT'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'MSFT'</span><span class="crayon-sy">,</span><span class="crayon-s">'MSFT'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GOOG'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'AAPL'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'GOOG'</span><span class="crayon-sy">,</span><span class="crayon-s">'MSFT'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'bid'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">720.50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51.95</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51.97</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51.99</span><span class="crayon-sy">,</span><span class="crayon-cn">720.50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">97.99</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">720.50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52.01</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'ask'</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">720.93</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51.96</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">51.98</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52.00</span><span class="crayon-sy">,</span><span class="crayon-cn">720.93</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">98.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">720.88</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">52.03</span><span class="crayon-sy">]</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c782356095618-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'time'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ticker'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'bid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ask'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
</div>



<p>В первом будет содержаться информация о сделках, совершенных с ценными бумагами.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c784304909647" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c784304909647-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c784304909647-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c784304909647-1"><span class="crayon-c"># время сделки, тикер эмитента, цена и количество бумаг</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c784304909647-2"><span class="crayon-v">trades</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="484" height="236" src="../../wp-content/uploads/2022/08/trades_df.png" alt="информация о сделках" class="wp-image-14597" style="width:451px;height:220px" srcset="../../wp-content/uploads/2022/08/trades_df.png 484w, ../../wp-content/uploads/2022/08/trades_df-300x146.png 300w" sizes="auto, (max-width: 484px) 100vw, 484px" /></figure>



<p>Во втором, котировки ценных бумаг в определенный момент времени.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c785106608446" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c785106608446-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c785106608446-1"><span class="crayon-v">quotes</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="458" height="352" src="../../wp-content/uploads/2022/08/quotes_df.png" alt="котировки ценных бумаг" class="wp-image-14598" style="width:441px;height:339px" srcset="../../wp-content/uploads/2022/08/quotes_df.png 458w, ../../wp-content/uploads/2022/08/quotes_df-300x231.png 300w" sizes="auto, (max-width: 458px) 100vw, 458px" /></figure>



<p>Функция <strong>pd.merge_asof()</strong> выполняет левое соединение, а это значит, что мы будем ориентироваться на левый датафрейм trades. Вначале посмотрим на код.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c786830604432" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c786830604432-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-1"><span class="crayon-c"># выполним левое соединение merge_asof</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge_asof</span><span class="crayon-sy">(</span><span class="crayon-v">trades</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">quotes</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># по столбцу времени</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'time'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># но так, чтобы совпадало значение столбца ticker</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ticker'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># совпадение по времени должно составлять менее 10 миллисекунд</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c786830604432-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tolerance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">Timedelta</span><span class="crayon-sy">(</span><span class="crayon-s">'10ms'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="627" height="239" src="../../wp-content/uploads/2022/08/merge_asof.png" alt="функция pd.merge_asof()" class="wp-image-14599" style="width:556px;height:212px" srcset="../../wp-content/uploads/2022/08/merge_asof.png 627w, ../../wp-content/uploads/2022/08/merge_asof-300x114.png 300w, ../../wp-content/uploads/2022/08/merge_asof-600x229.png 600w" sizes="auto, (max-width: 627px) 100vw, 627px" /></figure>



<p>Разберем приведенный код более подробно:</p>



<ul class="wp-block-list">
<li>строкам 0 и 1 левого датафрейма trades (тикер MSFT, Microsoft) мы можем поставить в соответствие строки 1 и 2 датафрейма quotes: в первом случае, у нас будет полное совпадение по времени (30 миллисекунд), во втором, разница будет находится в пределах допустимого интервала в 10 миллисекунд (38 &#8212; 30 = 8 миллисекунд);</li>



<li>хотя время в строке 3 датафрейма quotes ближе к строке 1 в trades (41 и 38 миллисекунд соответственно), алгоритм соединения по умолчанию ищет совпадения в предыдущих, а не будущих наблюдениях;</li>



<li>строкам 2 и 3 левого датафрейма соответствует строка 4 правого (полное совпадение);</li>



<li>строке 4 левого датафрейма не нашлось совпадения в правом датафрейме (хотя тикер AAPL, Apple, в нем есть и время отличается всего на одну миллисекунду) опять же, потому что алгоритм искал совпадения в предыдущих, а не будущих периодах.</li>
</ul>



<p>Изменим некоторые параметры фунции <strong>pd.merge_asof()</strong>:</p>



<ul class="wp-block-list">
<li>во-первых, уменьшим интервал до пяти миллисекунд;</li>



<li>во-вторых, разрешим алгоритму искать совпадения как в предыдущих, так и в будущих периодах.</li>
</ul>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c788820374493" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c788820374493-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-1"><span class="crayon-c"># еще раз выполним соединение merge_asof</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">merge_asof</span><span class="crayon-sy">(</span><span class="crayon-v">trades</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">quotes</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">on</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'time'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'ticker'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># уменьшим интервал до пяти миллисекунд</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">tolerance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">Timedelta</span><span class="crayon-sy">(</span><span class="crayon-s">'10ms'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># разрешив искать в предыдущих и будущих периодах</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c788820374493-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">direction</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'nearest'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="625" height="242" src="../../wp-content/uploads/2022/08/merge_asof_nearest.png" alt="функция pd.merge_asof() с измененными параметрами" class="wp-image-14600" style="width:591px;height:229px" srcset="../../wp-content/uploads/2022/08/merge_asof_nearest.png 625w, ../../wp-content/uploads/2022/08/merge_asof_nearest-300x116.png 300w, ../../wp-content/uploads/2022/08/merge_asof_nearest-600x232.png 600w" sizes="auto, (max-width: 625px) 100vw, 625px" /></figure>



<p>Что изменилось?</p>



<ul class="wp-block-list">
<li>строке 1 левого датафрейма теперь соответствует строка 3 правого (она ближе по времени);</li>



<li>для тикера AAPL (строка 4 левого датафрейма) теперь нашлось соответствие (строка 5 правого).</li>
</ul>



<p>Перейдем к разделу, посвященному группировке показателей.</p>



<h2 class="wp-block-heading" id="56-gruppirovka">Группировка</h2>



<p>В библиотеке Pandas можно группировать данные, а затем, например, рассчитывать какие-либо статистические показатели внутри каждой группы.</p>



<h3 class="wp-block-heading" id="57-metod-groupby">Метод .groupby()</h3>



<p>Вначале рассмотрим <strong>метод .groupby()</strong>, который используется для группировки данных. Вновь в качестве примера используем датасет &#171;Титаник&#187;.</p>



<div class="wp-block-file"><a id="wp-block-file--media-b60e08ed-fcc2-414f-96d7-97cc79023394" href="../../wp-content/uploads/2021/11/train.csv">train.csv</a><a href="../../wp-content/uploads/2021/11/train.csv" class="wp-block-file__button wp-element-button" download aria-describedby="wp-block-file--media-b60e08ed-fcc2-414f-96d7-97cc79023394">Скачать</a></div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c789056454272" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c789056454272-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-1"><span class="crayon-c"># подгрузим данные из файла train.csv</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-2"><span class="crayon-v">titanic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/train.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-4"><span class="crayon-c"># оставим только столбцы PassengerId, Name, Ticket и Cabin</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-5"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'PassengerId'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Name'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Ticket'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Cabin'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-8"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c789056454272-9"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="830" height="318" src="../../wp-content/uploads/2022/08/titanic_some_columns.jpg" alt="датасет &quot;Титаник&quot;: метод .groupby()" class="wp-image-14657" style="width:543px;height:208px" srcset="../../wp-content/uploads/2022/08/titanic_some_columns.jpg 830w, ../../wp-content/uploads/2022/08/titanic_some_columns-300x115.jpg 300w, ../../wp-content/uploads/2022/08/titanic_some_columns-768x294.jpg 768w, ../../wp-content/uploads/2022/08/titanic_some_columns-600x230.jpg 600w" sizes="auto, (max-width: 830px) 100vw, 830px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c78b315585299" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c78b315585299-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c78b315585299-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c78b315585299-1"><span class="crayon-c"># посмотрим на размерность</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c78b315585299-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c78c757992716" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c78c757992716-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c78c757992716-1">(891, 8)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Сам по себе метод <strong>.groupby()</strong> создает объект DataFrameGroupBy.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c78d156646273" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c78d156646273-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c78d156646273-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c78d156646273-1"><span class="crayon-c"># выполним группировку по столбцу Sex</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c78d156646273-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c78e867798539" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c78e867798539-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c78e867798539-1">&lt;pandas.core.groupby.generic.DataFrameGroupBy object at 0x7fec3ffbb850&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как и у любого <a href="../../python/oop/index.html">объекта в Питоне</a>, в DataFrameGroupBy есть <em>атрибуты и методы</em>. Например, воспользуемтся атрибутом <strong>ngroups</strong>, чтобы узнать на сколько групп были разбиты данные по столбцу Sex.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c790930668765" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c790930668765-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c790930668765-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">ngroups</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c791499023067" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c791499023067-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c791499023067-1">2</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Атрибут <strong>groups</strong> выдает питоновский словарь, в котором ключами будут названия групп, а значениями &#8212; индексы наблюдений, входящих в соответствующую группу.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c792081160643" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c792081160643-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c792081160643-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c792081160643-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c792081160643-1"><span class="crayon-c"># выберем группу female (по ключу словаря) и </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c792081160643-2"><span class="crayon-c"># выведем первые пять индексов (через срез списка), относящихся к этой группе</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c792081160643-3"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">groups</span><span class="crayon-sy">[</span><span class="crayon-s">'female'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c793303859641" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c793303859641-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c793303859641-1">Int64Index([1, 2, 3, 8, 9], dtype='int64')</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Метод <strong>.size()</strong> выдает количество элементов в каждой группе.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c795386920602" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c795386920602-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c795386920602-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">size</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c796279127425" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c796279127425-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c796279127425-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c796279127425-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c796279127425-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c796279127425-1">Sex</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c796279127425-2">female&nbsp;&nbsp;&nbsp;&nbsp;314</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c796279127425-3">male&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;577</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c796279127425-4">dtype: int64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Метод <strong>.first()</strong> выдает первые встречающиеся наблюдения в каждой из групп.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c797591219112" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c797591219112-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c797591219112-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c797591219112-1"><span class="crayon-c"># можно использовать .last() для получения последних записей</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c797591219112-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">first</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="604" height="160" src="../../wp-content/uploads/2022/08/groupby_first.png" alt="датасет &quot;Титаник&quot;: метод .groupby() и метод .first()" class="wp-image-14761" style="width:521px;height:138px" srcset="../../wp-content/uploads/2022/08/groupby_first.png 604w, ../../wp-content/uploads/2022/08/groupby_first-300x79.png 300w, ../../wp-content/uploads/2022/08/groupby_first-600x159.png 600w" sizes="auto, (max-width: 604px) 100vw, 604px" /></figure>



<p>Обратите внимание, результатом этого метода будет уже датафрейм. Использование метода <strong>.get_group()</strong> позволяет выбрать наблюдения только одной группы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c798508108556" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c798508108556-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c798508108556-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c798508108556-1"><span class="crayon-c"># выберем наблюдения группы male и выведем первые пять строк датафрейма</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c798508108556-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">get_group</span><span class="crayon-sy">(</span><span class="crayon-s">'male'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="617" height="241" src="../../wp-content/uploads/2022/08/groupby_get_group.png" alt="датасет &quot;Титаник&quot;: метод .get_group()" class="wp-image-14762" style="width:574px;height:224px" srcset="../../wp-content/uploads/2022/08/groupby_get_group.png 617w, ../../wp-content/uploads/2022/08/groupby_get_group-300x117.png 300w, ../../wp-content/uploads/2022/08/groupby_get_group-600x234.png 600w" sizes="auto, (max-width: 617px) 100vw, 617px" /></figure>



<h3 class="wp-block-heading" id="58-agregirovanie-dannykh">Агрегирование данных</h3>



<p>Ценность группировки или агрегирования данных заключается конечно в том, что мы можем выполнить определенные действия не со всем датафреймом, а с каждой группой наблюдений по отдельности.</p>



<h4 class="wp-block-heading" id="59-statistika-po-stolbtsam">Статистика по столбцам</h4>



<p>Например, мы можем рассчитать <a href="../../intro/stats/index.html">статистические показатели</a> для <em>каждой группы</em> по <em>каждому столбцу</em>. Рассмотрим на примерах.</p>



<p>Вначале выведем статистику <strong>по одному столбцу</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c799967439588" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c799967439588-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c799967439588-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c799967439588-1"><span class="crayon-c"># посчитаем медианный возраст мужчин и женщин</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c799967439588-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">median</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c79b590393262" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79b590393262-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c79b590393262-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79b590393262-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c79b590393262-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79b590393262-1">Sex</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c79b590393262-2">female&nbsp;&nbsp;&nbsp;&nbsp;27.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79b590393262-3">male&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;29.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c79b590393262-4">Name: Age, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В данном случае мы последовательно применили несколько методов: сформировали объект DataFrameGroupBy, выбрали столбец Age, нашли медиану в <em>каждой группе</em> по <em>этому столбцу</em> и округлили результат. Рассчитаем статистику <strong>по нескольким столбцам</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c79c160399524" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79c160399524-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c79c160399524-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79c160399524-1"><span class="crayon-c"># рассчитаем среднее арифметическое по столбцам Age и Fare для каждого из классов</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c79c160399524-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Fare'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="186" height="197" src="../../wp-content/uploads/2022/08/groupby_multiple_columns.png" alt="датасет &quot;Титаник&quot;: агрегирование данных (два столбца)" class="wp-image-14763" style="width:169px;height:179px"/></figure>



<p>Если не указывать конкретные столбцы, статистический показатель будет рассчитан <strong>для всего датафрейма</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c79d816388784" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79d816388784-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c79d816388784-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79d816388784-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79d816388784-1"><span class="crayon-c"># при этом среднее арифметическое не получится рассчитать для категориальных признаков,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c79d816388784-2"><span class="crayon-c"># их придется удалить</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79d816388784-3"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="414" height="201" src="../../wp-content/uploads/2022/08/groupby_all_columns.png" alt="датасет &quot;Титаник&quot;: агрегирование данных (все столбцы)" class="wp-image-14764" style="width:381px;height:185px" srcset="../../wp-content/uploads/2022/08/groupby_all_columns.png 414w, ../../wp-content/uploads/2022/08/groupby_all_columns-300x146.png 300w" sizes="auto, (max-width: 414px) 100vw, 414px" /></figure>



<p>Мы также можем <strong>группировать по нескольким признакам</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c79e705587289" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79e705587289-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c79e705587289-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c79e705587289-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79e705587289-1"><span class="crayon-c"># выполним группировку по двум признакам (Pclass и Sex) </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c79e705587289-2"><span class="crayon-c"># с расчетом количества наблюдений в каждой подгруппе по каждому столбцу</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c79e705587289-3"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Sex'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">count</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="574" height="318" src="../../wp-content/uploads/2022/08/groupby_multiple_features.png" alt="датасет &quot;Титаник&quot;: группировка по нескольким признакам" class="wp-image-14766" style="width:516px;height:286px" srcset="../../wp-content/uploads/2022/08/groupby_multiple_features.png 574w, ../../wp-content/uploads/2022/08/groupby_multiple_features-300x166.png 300w" sizes="auto, (max-width: 574px) 100vw, 574px" /></figure>



<p class="has-background" style="background-color:#ffe8c4">Обратите внимание, что количество наблюдений в столбце Age меньше, чем в остальных столбцах. Это пропущенные значения, которые, как правило, игнорируются при расчете статистистических показателей.</p>



<p>Значение атрибута <strong>ngroups</strong> библиотека Pandas считает по подгруппам.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c7a0591596849" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c7a0591596849-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c7a0591596849-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Sex'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">ngroups</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c7a1396130603" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c7a1396130603-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c7a1396130603-1">6</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="60-metod-agg">Метод .agg()</h4>



<p><strong>Метод .agg()</strong> позволяет рассчитать сразу <em>несколько статистических показателей</em>. Применим этот метод <em>к одному столбцу</em> (Sex) и найдем максимальное и минимальное значения, количество наблюдений, а также среднее арифметическое и медиану.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c7a2598668716" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c7a2598668716-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c7a2598668716-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">agg</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'max'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'min'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'count'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mean'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="371" height="161" src="../../wp-content/uploads/2022/08/groupby_agg.png" alt="метод .agg()" class="wp-image-14767" style="width:341px;height:148px" srcset="../../wp-content/uploads/2022/08/groupby_agg.png 371w, ../../wp-content/uploads/2022/08/groupby_agg-300x130.png 300w" sizes="auto, (max-width: 371px) 100vw, 371px" /></figure>



<p>Для удобства при группировке и расчете показателей столбцы можно <em>переименовать</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c7a4634680666" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c7a4634680666-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c7a4634680666-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">agg</span><span class="crayon-sy">(</span><span class="crayon-v">sex_max</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'max'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">sex_min</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-s">'min'</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="245" height="160" src="../../wp-content/uploads/2022/08/groupby_agg_rename.png" alt="переименование столбцов при группировке" class="wp-image-14768" style="width:229px;height:149px"/></figure>



<p>Метод <strong>.agg()</strong> можно применить <em>к нескольким столбцам</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c84f276237233" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c84f276237233-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c84f276237233-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c84f276237233-1"><span class="crayon-c"># рассчитаем среднее арифметическое и медиану для столбцов Age и Fare</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c84f276237233-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Fare'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">agg</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'mean'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="338" height="195" src="../../wp-content/uploads/2022/08/groupby_agg_multiple_columns.png" alt="метод .agg(): несколько столбцов" class="wp-image-14769" style="width:328px;height:189px" srcset="../../wp-content/uploads/2022/08/groupby_agg_multiple_columns.png 338w, ../../wp-content/uploads/2022/08/groupby_agg_multiple_columns-300x173.png 300w" sizes="auto, (max-width: 338px) 100vw, 338px" /></figure>



<p>Кроме того, мы можем применить метод <strong>.agg()</strong> <em>ко всем столбцам</em> одновременно.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c851092534834" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c851092534834-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c851092534834-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c851092534834-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c851092534834-1"><span class="crayon-c"># для каждого рассчитаем среднее арифметическое и медиану</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c851092534834-2"><span class="crayon-c"># категориальную переменную опять же придется удалить</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c851092534834-3"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">agg</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'mean'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="861" height="192" src="../../wp-content/uploads/2024/05/image-14.png" alt="применение метода .agg() ко всем столбцам одновременно" class="wp-image-27171" srcset="../../wp-content/uploads/2024/05/image-14.png 861w, ../../wp-content/uploads/2024/05/image-14-300x67.png 300w, ../../wp-content/uploads/2024/05/image-14-768x171.png 768w, ../../wp-content/uploads/2024/05/image-14-600x134.png 600w" sizes="auto, (max-width: 861px) 100vw, 861px" /></figure>



<p>В качестве параметра метод <strong>.agg()</strong> можем принимать и объявленную нами функцию.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c852919524278" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c852919524278-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-1"><span class="crayon-c"># объявим функцию, которая выдаст True, если средний возраст меньше 29 лет</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-2"><span class="crayon-c"># и False в остальных случаях</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-3"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">below29</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">m</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">29</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-t">False</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-7"><span class="crayon-c"># применим эту функцию к группам female и male через метод .agg()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c852919524278-8"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">agg</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-s">'max'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mean'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">below29</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="314" height="160" src="../../wp-content/uploads/2022/08/groupby_agg_own_function.png" alt="метод .agg() и собственная функция" class="wp-image-14770" style="width:287px;height:146px" srcset="../../wp-content/uploads/2022/08/groupby_agg_own_function.png 314w, ../../wp-content/uploads/2022/08/groupby_agg_own_function-300x153.png 300w" sizes="auto, (max-width: 314px) 100vw, 314px" /></figure>



<h3 class="wp-block-heading" id="61-preobrazovanie-dannykh">Преобразование данных</h3>



<p>Мы уже научились применять функции для преобразования данных в датафрейме. Агрегирование позволяет выполнять такие преобразования отдельно внутри каждой группы. Вначале объявим несложную lambda-функцию, которая стандартизирует данные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c853397902820" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c853397902820-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c853397902820-1"><span class="crayon-v">standartize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p class="has-background" style="background-color:#ffe8c4">При <strong>стандартизации</strong> (standartization) из каждого значения мы вычитаем среднее арифметическое и делим на среднее квадратическое отклонение. В результате среднее значение становится равно нулю, а СКО &#8212; единице.</p>



<p>Воспользуемся методом <strong>.apply()</strong> для применения lambda-функции к сгруппированному столбцу Age.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c857040396201" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c857040396201-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c857040396201-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c857040396201-1"><span class="crayon-c"># сгруппируем данные о возрасте по полу пассажиров и применим функцию стандартизации</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c857040396201-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Sex'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-k ">apply</span><span class="crayon-sy">(</span><span class="crayon-v">standartize</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c858990438042" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c858990438042-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-1">Sex&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-2">female&nbsp;&nbsp;1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.714684</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;&nbsp; -0.135768</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.502071</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8&nbsp;&nbsp;&nbsp;&nbsp; -0.064897</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;9&nbsp;&nbsp;&nbsp;&nbsp; -0.986220</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-7">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ...&nbsp;&nbsp; </div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-8">male&nbsp;&nbsp;&nbsp;&nbsp;883&nbsp;&nbsp; -0.185761</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;884&nbsp;&nbsp; -0.390146</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;886&nbsp;&nbsp; -0.253890</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;889&nbsp;&nbsp; -0.322018</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-12">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;890&nbsp;&nbsp;&nbsp;&nbsp;0.086751</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c858990438042-13">Name: Age, Length: 891, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Мы также можем найти <em>агрегированную статистику по группе</em> (например, среднее арифметическое).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c859040292594" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c859040292594-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c859040292594-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c859040292594-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c859040292594-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c859040292594-1"><span class="crayon-c"># сгруппируем данные по Pclass и найдем среднее в столбцах Age и Fare</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c859040292594-2"><span class="crayon-c"># метод .apply() выдаст только агрегированные данные</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c859040292594-3"><span class="crayon-c"># для применения функции к столбцам укажем axis = 0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c859040292594-4"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Fare'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">apply</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="189" height="201" src="../../wp-content/uploads/2022/08/pandas_apply_mean.png" alt="агрегированная статистика по группе, параметр axis = 0" class="wp-image-14797" style="width:171px;height:182px"/></figure>



<p>Примечание. Обратим внимание, что для расчета среднего арифметического по столбцам нужно указывать именно axis = 0. В других методах, например, в методе <strong>.drop()</strong> такое значение аргумента подразумевает работу со строками.</p>



<p>Логика разработчиков в данном случае заключается в том, что при axis = 0 мы применяем <strong>np.mean()</strong> вдоль индекса (т.е. по всему столбцу), а это нулевая ось. Если же мы хотим применить к строке, то нужно идти вдоль столбца, axis = 1.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c85a368801199" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c85a368801199-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c85a368801199-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c85a368801199-1"><span class="crayon-c"># убедимся в этом, заменив axis = 0 на axis = 'index'</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c85a368801199-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Fare'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">apply</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">mean</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'index'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="189" height="201" src="../../wp-content/uploads/2022/08/pandas_apply_mean.png" alt="агрегированная статистика по группе, параметр axis = 'index'" class="wp-image-14797" style="width:171px;height:182px"/></figure>



<h3 class="wp-block-heading" id="62-filtratsiya">Фильтрация</h3>



<p>Сгруппированные данные можно фильтровать. Например, найдем среднее арифметическое возраста внутри каждого из классов каюты.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c85d158438780" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c85d158438780-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c85d158438780-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="471" height="525" src="../../wp-content/uploads/2022/08/mean_age_each_class.jpg" alt="фильтрация сгруппированных данных" class="wp-image-14811" style="width:158px;height:175px" srcset="../../wp-content/uploads/2022/08/mean_age_each_class.jpg 471w, ../../wp-content/uploads/2022/08/mean_age_each_class-269x300.jpg 269w" sizes="auto, (max-width: 471px) 100vw, 471px" /></figure>



<p>Теперь предположим, что мы хотим оставить только те классы кают, в которых средний возраст пассажиров составляет не менее 26 лет (то есть первый и второй классы). Для этого выполним следующие действия:</p>



<ul class="wp-block-list">
<li>применим метод <strong>.filter()</strong> к сгруппированным по классу данным;</li>



<li>этому методу передадим lambda-функцию, которая отберет те строки, в которых <em>среднегрупповое значение</em> возраста составляет не менее 26 лет.</li>
</ul>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c85f437127104" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c85f437127104-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c85f437127104-1"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">filter</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">26</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="381" src="../../wp-content/uploads/2022/08/group_filter-1024x381.jpg" alt="примение метода .filter() к сгруппированным данным" class="wp-image-14812" style="width:591px;height:220px" srcset="../../wp-content/uploads/2022/08/group_filter-1024x381.jpg 1024w, ../../wp-content/uploads/2022/08/group_filter-300x112.jpg 300w, ../../wp-content/uploads/2022/08/group_filter-768x286.jpg 768w, ../../wp-content/uploads/2022/08/group_filter-1536x572.jpg 1536w, ../../wp-content/uploads/2022/08/group_filter-1200x447.jpg 1200w, ../../wp-content/uploads/2022/08/group_filter-600x223.jpg 600w, ../../wp-content/uploads/2022/08/group_filter.jpg 1686w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Убедимся, что у нас действительно осталось только два класса.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c862074748537" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c862074748537-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c862074748537-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c862074748537-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c862074748537-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c862074748537-1"><span class="crayon-c"># для этого из предыдущего результата</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c862074748537-2"><span class="crayon-c"># возьмем столбец Pclass и применим метод .unique()</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c862074748537-3"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-s">'Pclass'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">filter</span><span class="crayon-sy">(</span><span class="crayon-r">lambda</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">26</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c862074748537-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">.</span><span class="crayon-v">Pclass</span><span class="crayon-sy">.</span><span class="crayon-e">unique</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c863342415441" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c863342415441-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c863342415441-1">array([1, 2])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="63-svodnye-tablitsy">Сводные таблицы</h3>



<p><strong>Сводные таблицы</strong> (pivot tables) &#8212; это еще один способ группировки данных. Принцип сводных таблиц проще всего продемонстрировать на примере.</p>



<h4 class="wp-block-heading" id="64-podgotovka-dannykh">Подготовка данных</h4>



<p>Скачаем и подгрузим в <a href="../../python/files/index.html">сессионное хранилище</a> необходимые данные.</p>



<div class="wp-block-file"><a id="wp-block-file--media-9ec8af15-1ec9-48c6-9b71-bdec2267e812" href="../../wp-content/uploads/2022/05/cars.csv">cars.csv</a><a href="../../wp-content/uploads/2022/05/cars.csv" class="wp-block-file__button wp-element-button" download aria-describedby="wp-block-file--media-9ec8af15-1ec9-48c6-9b71-bdec2267e812">Скачать</a></div>



<p>Взглянем на содержание датасета.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c864510403498" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c864510403498-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-1"><span class="crayon-c"># импортируем данные</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-2"><span class="crayon-v">cars</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/cars.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-4"><span class="crayon-c"># удалим столбцы, которые нам не понадобятся</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-5"><span class="crayon-v">cars</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'Unnamed: 0'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'vin'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'lot'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'condition'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-7"><span class="crayon-c"># и посмотрим на результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c864510403498-8"><span class="crayon-v">cars</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="313" src="../../wp-content/uploads/2022/08/cars-1024x313.jpg" alt="датасет cars" class="wp-image-14842" style="width:699px;height:213px" srcset="../../wp-content/uploads/2022/08/cars-1024x313.jpg 1024w, ../../wp-content/uploads/2022/08/cars-300x92.jpg 300w, ../../wp-content/uploads/2022/08/cars-768x235.jpg 768w, ../../wp-content/uploads/2022/08/cars-600x183.jpg 600w, ../../wp-content/uploads/2022/08/cars.jpg 1038w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>В этом разделе мы будем использовать данные о предлагаемых к продаже автомобилях в США и Канаде. Для каждого автомобиля мы можем посмотреть цену (price), марку (brand), модель (model), год выпуска (year), требует ли автомобиль ремонта (title_status), пробег (mileage), цвет кузова (color), штат (state) и страну (country) продажи.</p>



<h4 class="wp-block-heading" id="65-gruppirovka-po-strokam">Группировка по строкам</h4>



<p>Теперь предположим, что нас интересуют не отдельные автомобили, а статистика по маркам. Воспользуемся <strong>функцией pd.pivot_table()</strong>.</p>



<p>В индексе (строках) мы разместим названия марок (параметр index), а в столбцах будем рассчитывать агрегированные показатели количественных признаков (параметр values).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c865951049880" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c865951049880-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c865951049880-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c865951049880-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c865951049880-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c865951049880-1"><span class="crayon-c"># по умолчанию будет рассчитано среднее арифметическое внутри каждой из групп</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c865951049880-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c865951049880-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c865951049880-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'mileage'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'year'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="483" height="623" src="../../wp-content/uploads/2022/08/cars_pivot_brand.jpg" alt="функция pd.pivot_table()" class="wp-image-14843" style="width:328px;height:423px" srcset="../../wp-content/uploads/2022/08/cars_pivot_brand.jpg 483w, ../../wp-content/uploads/2022/08/cars_pivot_brand-233x300.jpg 233w" sizes="auto, (max-width: 483px) 100vw, 483px" /></figure>



<p>Добавим параметр aggfunc и укажем, какую функцию использовать при агрегации.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c869524272608" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c869524272608-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c"># сгруппируем по марке</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c"># считать статистику будем по цене и пробегу</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'mileage'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c"># для каждой группы найдем медиану и выведем первые 10 марок</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c869524272608-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="267" height="468" src="../../wp-content/uploads/2022/08/pivot_table_values_aggfunc.png" alt="функция pd.pivot_table() с параметрами values и aggfunc" class="wp-image-14861" style="width:240px;height:421px" srcset="../../wp-content/uploads/2022/08/pivot_table_values_aggfunc.png 267w, ../../wp-content/uploads/2022/08/pivot_table_values_aggfunc-171x300.png 171w" sizes="auto, (max-width: 267px) 100vw, 267px" /></figure>



<p>Для каждого столбца (например, цены) можно рассчитать несколько статистических показателей. Кроме того, мы можем использовать не только готовые, но и собственные функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c86a296648938" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86a296648938-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c86a296648938-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86a296648938-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86a296648938-1"><span class="crayon-c"># в качестве несложного примера пропишем функцию, которая возвращает среднее арифметическое</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c86a296648938-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">custom_mean</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86a296648938-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c86c706139364" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86c706139364-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c86c706139364-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86c706139364-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c86c706139364-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86c706139364-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86c706139364-1"><span class="crayon-c"># применим как встроенную, так и собственную функцию к столбцу price</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c86c706139364-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86c706139364-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c86c706139364-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86c706139364-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'mean'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">custom_mean</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="310" height="511" src="../../wp-content/uploads/2022/08/pivot_table_custom_aggfunc.png" alt="функция pd.pivot_table() с применением встроенных и собственных функций" class="wp-image-14862" style="width:291px;height:479px" srcset="../../wp-content/uploads/2022/08/pivot_table_custom_aggfunc.png 310w, ../../wp-content/uploads/2022/08/pivot_table_custom_aggfunc-182x300.png 182w" sizes="auto, (max-width: 310px) 100vw, 310px" /></figure>



<p>Возможна группировка по нескольким признакам.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c86f757481721" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86f757481721-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c86f757481721-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86f757481721-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c86f757481721-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c86f757481721-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c86f757481721-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86f757481721-1"><span class="crayon-c"># сгруппируем данные по марке, а затем по цвету кузова</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c86f757481721-2"><span class="crayon-c"># для каждой подгруппы рассчитаем медиану и количество наблюдений (count)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86f757481721-3"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c86f757481721-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'color'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c86f757481721-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c86f757481721-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'median'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'count'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">11</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="308" height="555" src="../../wp-content/uploads/2022/08/pivot_table_multiple_groups.png" alt="функция pd.pivot_table(): группировка по нескольким признакам" class="wp-image-14863" style="width:278px;height:501px" srcset="../../wp-content/uploads/2022/08/pivot_table_multiple_groups.png 308w, ../../wp-content/uploads/2022/08/pivot_table_multiple_groups-166x300.png 166w" sizes="auto, (max-width: 308px) 100vw, 308px" /></figure>



<h4 class="wp-block-heading" id="66-gruppirovka-po-strokam-i-stolbtsam">Группировка по строкам и столбцам</h4>



<p>В отличие от метода <strong>.groupby()</strong> сводные таблицы позволяют выполнять группировку по двум измерениям. Часть признаков группируется по строкам, часть &#8212; по столбцам.</p>



<p>Например, предположим, что мы хотим рассчитать медианную цену автомобиля в разрезе марки и категории title_status. В таком случае,</p>



<ul class="wp-block-list">
<li>в параметр index мы передадим значение brand;</li>



<li>в columns &#8212; title_status;</li>



<li>нам также нужно указать, откуда мы будем брать значения (values) для заполнения таблицы, в нашем случае это цена (price);</li>



<li>в качестве функции при агрегации (aggfunc) используем медиану (median).</li>
</ul>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c870612709993" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c870612709993-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c870612709993-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c870612709993-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c870612709993-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c870612709993-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c870612709993-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c870612709993-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c870612709993-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'title_status'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c870612709993-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c870612709993-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="458" height="281" src="../../wp-content/uploads/2022/08/pivot_table_rows_cols.png" alt="функция pd.pivot_table(): группировка по строкам и столбцам" class="wp-image-14888" style="width:394px;height:242px" srcset="../../wp-content/uploads/2022/08/pivot_table_rows_cols.png 458w, ../../wp-content/uploads/2022/08/pivot_table_rows_cols-300x184.png 300w" sizes="auto, (max-width: 458px) 100vw, 458px" /></figure>



<p><em>Про title_status</em>. Говоря упрощенно, если автомобиль относится к категории clean vehicle, он не был в серьеных ДТП и его можно застраховать. Если же это salvage vehicle, то автомобиль поврежден настолько, что его нельзя эксплуатировать на дорогах общего пользования и на него нельзя купить страховку.</p>



<p>При желании мы можем добавить еще один показатель и транспонировать датафрейм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c871209617005" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c871209617005-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-1"><span class="crayon-c"># добавим метрику count для подсчета количества наблюдений и </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-2"><span class="crayon-c"># применим метод .transpose(), чтобы поменять строки и столбцы местами</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-3"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'title_status'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c871209617005-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'median'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'count'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">transpose</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="670" height="240" src="../../wp-content/uploads/2022/08/pivot_table_rows_cols_transpose.png" alt="функция pd.pivot_table(): группировка по строкам и столбцам, несколько метрик и транспонирование датафрейма" class="wp-image-14889" style="width:597px;height:214px" srcset="../../wp-content/uploads/2022/08/pivot_table_rows_cols_transpose.png 670w, ../../wp-content/uploads/2022/08/pivot_table_rows_cols_transpose-300x107.png 300w, ../../wp-content/uploads/2022/08/pivot_table_rows_cols_transpose-600x215.png 600w" sizes="auto, (max-width: 670px) 100vw, 670px" /></figure>



<p>Рассмотрим некоторые дополнительные возможности.</p>



<h4 class="wp-block-heading" id="67-dopolnitelnye-vozmozhnosti">Дополнительные возможности</h4>



<p>Используя <strong>метод .style.background_gradient()</strong>, мы можем маркировать данные с помощью цвета.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c875380074407" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c875380074407-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c875380074407-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c875380074407-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c875380074407-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c875380074407-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c875380074407-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'color'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c875380074407-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c875380074407-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'median'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'count'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">style</span><span class="crayon-sy">.</span><span class="crayon-e">background_gradient</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="355" height="554" src="../../wp-content/uploads/2022/08/pivot_table_gradient.png" alt="метод .style.background_gradient()" class="wp-image-14864" style="width:310px;height:484px" srcset="../../wp-content/uploads/2022/08/pivot_table_gradient.png 355w, ../../wp-content/uploads/2022/08/pivot_table_gradient-192x300.png 192w" sizes="auto, (max-width: 355px) 100vw, 355px" /></figure>



<p>В частности, мы видим, что наиболее высокая медианная цена и наибольшее количество наблюдений в группе маркируются более темными оттенками, более низкие показатели &#8212; светлыми.</p>



<p>Если же в получившейся сводной таблице имеются пропущенные значения, мы также можем выделить их с помощью, например, желтого цвета через <strong>метод .style.highlight_null()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c876422646301" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c876422646301-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c876422646301-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c876422646301-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c876422646301-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c876422646301-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c876422646301-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c876422646301-1"><span class="crayon-c"># цвет выбирается через параметр null_color</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c876422646301-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c876422646301-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c876422646301-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'title_status'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c876422646301-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c876422646301-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">11</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">style</span><span class="crayon-sy">.</span><span class="crayon-e">highlight_null</span><span class="crayon-sy">(</span><span class="crayon-v">null_color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'yellow'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="478" height="514" src="../../wp-content/uploads/2022/08/pivot_table_nan_highlight.png" alt="метод .style.highlight_null()" class="wp-image-14890" style="width:408px;height:439px" srcset="../../wp-content/uploads/2022/08/pivot_table_nan_highlight.png 478w, ../../wp-content/uploads/2022/08/pivot_table_nan_highlight-279x300.png 279w" sizes="auto, (max-width: 478px) 100vw, 478px" /></figure>



<p>Данные сводных таблиц можно выводить не только с помощью чисел, но и графически. Например, посчитаем количество автомобилей (aggfunc = &#8216;count&#8217;) со статусом clean и salvage (columns = &#8216;title_status&#8217;), сгруппированных по маркам (index = &#8216;brand&#8217;). Затем выведем первые три марки и применим метод <strong>.plot.barh()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c879498795121" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c879498795121-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c879498795121-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c879498795121-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c879498795121-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c879498795121-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c879498795121-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c879498795121-1"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c879498795121-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c879498795121-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'title_status'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c879498795121-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c879498795121-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'count'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">plot</span><span class="crayon-sy">.</span><span class="crayon-e">barh</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c879498795121-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">title</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Clean vs. Salvage Counts'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="621" height="427" src="../../wp-content/uploads/2022/08/pivot_table_barh.png" alt="метод .plot.barh()" class="wp-image-14931" style="width:556px;height:382px" srcset="../../wp-content/uploads/2022/08/pivot_table_barh.png 621w, ../../wp-content/uploads/2022/08/pivot_table_barh-300x206.png 300w, ../../wp-content/uploads/2022/08/pivot_table_barh-600x413.png 600w" sizes="auto, (max-width: 621px) 100vw, 621px" /></figure>



<p class="has-background" style="background-color:#ffe8c4">Подробнее про построение графиков мы поговорим уже в следующем разделе, посвященном исследовательскому анализу данных.</p>



<p>Если применить к сводной таблице <strong>метод .unstack()</strong>, то мы как бы лишаем ее второго измерения, группировки по столбцам. Остается только группировка по строкам (как в методе <strong>.groupby</strong>).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c87a176606244" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87a176606244-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87a176606244-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87a176606244-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87a176606244-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87a176606244-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87a176606244-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87a176606244-1"><span class="crayon-c"># сравните результат исполнения этого кода с позапрошлым примером</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87a176606244-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">cars</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87a176606244-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87a176606244-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'title_status'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87a176606244-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87a176606244-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">unstack</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c87b393553806" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87b393553806-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-1">title_status&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; brand&nbsp;&nbsp; </div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-2">clean vehicle&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;acura&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 10400.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; audi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;27950.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bmw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 31600.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-5">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buick&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 20802.5</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-6">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cadillac&nbsp;&nbsp;&nbsp;&nbsp;24500.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-7">salvage insurance&nbsp;&nbsp;acura&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1000.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-8">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; audi&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 12.5</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; bmw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1825.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-10">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; buick&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 0.0</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cadillac&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87b393553806-12">dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Для последующих примеров выберем исключительно автомобили марки &#171;БМВ&#187;.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c87e708232402" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87e708232402-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-1"><span class="crayon-c"># создадим маску для автомобилей "БМВ" и сделаем копию датафрейма</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-2"><span class="crayon-v">bmw</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cars</span><span class="crayon-sy">[</span><span class="crayon-v">cars</span><span class="crayon-sy">[</span><span class="crayon-s">'brand'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'bmw'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-3"><span class="crayon-c"># установим новый индекс, удалив при этом старый</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-4"><span class="crayon-v">bmw</span><span class="crayon-sy">.</span><span class="crayon-e">reset_index</span><span class="crayon-sy">(</span><span class="crayon-v">drop</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-5"><span class="crayon-c"># удалим столбец brand, так как у нас осталась только одна марка</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-6"><span class="crayon-v">bmw</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'brand'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-7"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87e708232402-8"><span class="crayon-v">bmw</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="684" height="241" src="../../wp-content/uploads/2022/08/bmw.png" alt="датасет cars, только автомобили &quot;БМВ&quot;" class="wp-image-14932" style="width:582px;height:205px" srcset="../../wp-content/uploads/2022/08/bmw.png 684w, ../../wp-content/uploads/2022/08/bmw-300x106.png 300w, ../../wp-content/uploads/2022/08/bmw-600x211.png 600w" sizes="auto, (max-width: 684px) 100vw, 684px" /></figure>



<p>Сгруппируем данные по двум признакам, но только по строкам.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c87f299482090" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87f299482090-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87f299482090-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87f299482090-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87f299482090-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c87f299482090-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c87f299482090-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87f299482090-1"><span class="crayon-c"># сгруппируем данные по штату и году выпуска, передав их в параметр index</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87f299482090-2"><span class="crayon-c"># и найдем медианну цену</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87f299482090-3"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">bmw</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87f299482090-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'state'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'year'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c87f299482090-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c87f299482090-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="232" height="588" src="../../wp-content/uploads/2022/08/pivot_state_year.png" alt="группировка по двум признакам, но только по строкам" class="wp-image-14933" style="width:206px;height:522px" srcset="../../wp-content/uploads/2022/08/pivot_state_year.png 232w, ../../wp-content/uploads/2022/08/pivot_state_year-118x300.png 118w" sizes="auto, (max-width: 232px) 100vw, 232px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c880075054315" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c880075054315-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c880075054315-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c880075054315-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c880075054315-1"><span class="crayon-c"># когда группировка выполняется только по строкам,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c880075054315-2"><span class="crayon-c"># мы можем получить аналогичный результат с помощью метода .groupby()</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c880075054315-3"><span class="crayon-v">bmw</span><span class="crayon-sy">.</span><span class="crayon-e">groupby</span><span class="crayon-sy">(</span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'state'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'year'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'price'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">agg</span><span class="crayon-sy">(</span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="245" height="591" src="../../wp-content/uploads/2022/08/groupby_state_year.png" alt="когда группировка выполняется только по строкам, мы можем получить аналогичный результат с помощью метода .groupby()" class="wp-image-14934" style="width:222px;height:537px" srcset="../../wp-content/uploads/2022/08/groupby_state_year.png 245w, ../../wp-content/uploads/2022/08/groupby_state_year-124x300.png 124w" sizes="auto, (max-width: 245px) 100vw, 245px" /></figure>



<p><a href="../pandas/index.html">Метод <strong>.query()</strong></a> позволяет отфильтровать данные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c882065400582" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c882065400582-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c882065400582-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c882065400582-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c882065400582-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c882065400582-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c882065400582-1"><span class="crayon-c"># выберем те штаты и годы выпуска, в которых медианная цена была выше 20000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c882065400582-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">bmw</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c882065400582-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'state'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'year'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c882065400582-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c882065400582-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">query</span><span class="crayon-sy">(</span><span class="crayon-s">'price &gt; 20000'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="229" height="353" src="../../wp-content/uploads/2022/08/pivot_state_year_query.png" alt="функция pd.pivot_table() и метод .query()" class="wp-image-14935" style="width:200px;height:308px" srcset="../../wp-content/uploads/2022/08/pivot_state_year_query.png 229w, ../../wp-content/uploads/2022/08/pivot_state_year_query-195x300.png 195w" sizes="auto, (max-width: 229px) 100vw, 229px" /></figure>



<p>Наконец, применим <strong>метод .style.bar()</strong> и создадим встроенную горизонтальную диаграмму.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62562c885490821373" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c885490821373-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c885490821373-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c885490821373-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62562c885490821373-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62562c885490821373-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c885490821373-1"><span class="crayon-c"># цвет в параметр color можно, в частности, передавать в hex-формате</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c885490821373-2"><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">pivot_table</span><span class="crayon-sy">(</span><span class="crayon-v">bmw</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c885490821373-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">index</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'state'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'year'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62562c885490821373-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'price'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62562c885490821373-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">aggfunc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">style</span><span class="crayon-sy">.</span><span class="crayon-e">bar</span><span class="crayon-sy">(</span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'#d65f5f'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="358" height="590" src="../../wp-content/uploads/2022/08/pivot_table_style_bar.png" alt="метод .style.bar()" class="wp-image-14936" style="width:317px;height:523px" srcset="../../wp-content/uploads/2022/08/pivot_table_style_bar.png 358w, ../../wp-content/uploads/2022/08/pivot_table_style_bar-182x300.png 182w" sizes="auto, (max-width: 358px) 100vw, 358px" /></figure>



<h2 class="wp-block-heading" id="68-podvedem-itog">Подведем итог</h2>



<p>На сегодняшнем занятии мы в деталях изучили способы преобразования и соединения датафреймов, а также способы группировки данных.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"data\\\/dataframe\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
