<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Пропущенные значения. Часть 2 | Анализ и обработка данных</title>
	<meta name="description" content="Рассмотрим, как можно заполнять пропуски в данных с помощью многомерных методов, то есть на основе данных других признаков." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Пропущенные значения. Часть 2 | Анализ и обработка данных" />
	<meta property="og:description" content="Рассмотрим, как можно заполнять пропуски в данных с помощью многомерных методов, то есть на основе данных других признаков." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/data/missing-02/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2025-01-01T05:32:52+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2022/11/multivariate_imputation.jpg" />
	<meta property="og:image:width" content="936" />
	<meta property="og:image:height" content="774" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="5 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/data/missing-02/","url":"https://www.dmitrymakarov.ru/data/missing-02/","name":"Пропущенные значения. Часть 2 | Анализ и обработка данных","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/data/missing-02/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/data/missing-02/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/11/multivariate_imputation.jpg","datePublished":"2023-01-05T16:16:53+00:00","dateModified":"2025-01-01T05:32:52+00:00","description":"Рассмотрим, как можно заполнять пропуски в данных с помощью многомерных методов, то есть на основе данных других признаков.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/data/missing-02/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/data/missing-02/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/data/missing-02/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/11/multivariate_imputation.jpg","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/11/multivariate_imputation.jpg","width":936,"height":774},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/data/missing-02/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Анализ и обработка данных","item":"https://www.dmitrymakarov.ru/data/"},{"@type":"ListItem","position":3,"name":"Пропущенные значения. Часть 2"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-17356 page-child parent-pageid-1408 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa625b4f156">Поиск:</label>
	<input type="search" id="search-form-67aa625b4f156" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa625b4f20f">Поиск:</label>
	<input type="search" id="search-form-67aa625b4f20f" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-17356 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Пропущенные значения. Часть 2</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Анализ и обработка данных</a></p>



<p>Перейдем к многомерным методам заполнения пропусков.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/1QfHXhwQpGYL74nBT1WKrWW8nfjuJCPtK?usp=sharing" target="_blank" rel="noreferrer noopener">Продолжим работу в том же блокноте</a>⧉</p>



<h2 class="wp-block-heading" id="0-pro-mnogomernye-metody">Про многомерные методы</h2>



<p><strong>Многомерные методы</strong> (multivariate imputation) предполагают заполнение пропусков одной переменной на основе данных других признаков. Другими словами, мы строим модель машинного обучения для заполнения пропусков.</p>



<figure class="wp-block-image size-full is-resized"><img fetchpriority="high" decoding="async" width="936" height="774" src="../../wp-content/uploads/2022/11/multivariate_imputation.jpg" alt="многомерные методы заполнения пропущенных значений" class="wp-image-15658" style="width:655px;height:541px" srcset="../../wp-content/uploads/2022/11/multivariate_imputation.jpg 936w, ../../wp-content/uploads/2022/11/multivariate_imputation-300x248.jpg 300w, ../../wp-content/uploads/2022/11/multivariate_imputation-768x635.jpg 768w, ../../wp-content/uploads/2022/11/multivariate_imputation-600x496.jpg 600w" sizes="(max-width: 936px) 100vw, 936px" /></figure>



<p>Такой моделью может быть линейная регрессия для количественных признаков или логистическая &#8212; для категориальных.</p>



<p class="has-background" style="background-color:#ffe8c4">Обратите внимание, что хотя технически мы могли бы использовать исходную целевую переменную в качестве одного из признаков для заполнения пропусков, делать этого не стоит, потому что в этом случае мы создадим между ними взаимосвязь, которой изначально могло не быть.</p>



<p>Рассмотрим пример линейной регрессии и сразу два подхода к ее реализации, детерминированный и стохастический.</p>



<h2 class="wp-block-heading" id="1-lineynaya-regressiya">Линейная регрессия</h2>



<h3 class="wp-block-heading" id="2-determinirovannyy-podkhod">Детерминированный подход</h3>



<p><strong>Детерминированный подход</strong> (deterministic approach) предполагает, что мы заполняем пропуски строго теми значениями, которые будут предсказаны линейной регрессией.</p>



<h4 class="wp-block-heading" id="3-podgotovka-dannykh">Подготовка данных</h4>



<p>Теперь давайте подготовим данные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476a4623300028" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476a4623300028-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-1"><span class="crayon-c"># сделаем копию датасета</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-2"><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-4"><span class="crayon-c"># импортируем класс StandardScaler модуля Preprocessing библиотеки sklearn</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">StandardScaler</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-7"><span class="crayon-c"># создаем объект этого класса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-8"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-10"><span class="crayon-c"># применяем метод .fit_transform() и сразу помещаем результат в датафрейм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-11"><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-13"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476a4623300028-14"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img decoding="async" width="797" height="205" src="../../wp-content/uploads/2022/11/lr_scaled.jpg" alt="стандартизация данных для заполнения пропусков с помощью модели линейной регрессии" class="wp-image-15660" style="width:552px;height:142px" srcset="../../wp-content/uploads/2022/11/lr_scaled.jpg 797w, ../../wp-content/uploads/2022/11/lr_scaled-300x77.jpg 300w, ../../wp-content/uploads/2022/11/lr_scaled-768x198.jpg 768w, ../../wp-content/uploads/2022/11/lr_scaled-600x154.jpg 600w" sizes="(max-width: 797px) 100vw, 797px" /></figure>



<p>В тестовую выборку мы поместим те наблюдения, в которых в столбце Age есть пропуски.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476aa572876782" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476aa572876782-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476aa572876782-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476aa572876782-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476aa572876782-1"><span class="crayon-c"># создадим маску из пустых значений в столбце Age с помощью метода .isnull()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476aa572876782-2"><span class="crayon-k ">test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">[</span><span class="crayon-v">lr</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">isnull</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476aa572876782-3"><span class="crayon-k ">test</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img decoding="async" width="750" height="210" src="../../wp-content/uploads/2022/11/lr_test.jpg" alt="тестовая выборка (с пропусками)" class="wp-image-15661" style="width:514px;height:144px" srcset="../../wp-content/uploads/2022/11/lr_test.jpg 750w, ../../wp-content/uploads/2022/11/lr_test-300x84.jpg 300w, ../../wp-content/uploads/2022/11/lr_test-600x168.jpg 600w" sizes="(max-width: 750px) 100vw, 750px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ac693762955" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ac693762955-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ac693762955-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ac693762955-1"><span class="crayon-c"># посмотрим на количество таких строк</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ac693762955-2"><span class="crayon-k ">test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ad075729668" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ad075729668-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ad075729668-1">(177, 7)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В обучающей выборке напротив окажутся те строки, где в Age пропусков нет.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ae035010435" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ae035010435-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ae035010435-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ae035010435-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ae035010435-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ae035010435-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ae035010435-1"><span class="crayon-c"># используем метод .dropna(), чтобы избавиться от пропусков</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ae035010435-2"><span class="crayon-v">train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">dropna</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ae035010435-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ae035010435-4"><span class="crayon-c"># оценим количество строк без пропусков</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ae035010435-5"><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476af778234852" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476af778234852-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476af778234852-1">(714, 7)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Вместе обучающая и тестовая выборки должны дать 891 наблюдение.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b0731225222" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b0731225222-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b0731225222-1"><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-k ">test</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b1553145888" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b1553145888-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b1553145888-1">891</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Из датафрейма train выделим столбец Age. Это будет наша целевая переменная.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b2943869838" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b2943869838-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-1"><span class="crayon-c"># целевая переменная может быть в формате Series</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-2"><span class="crayon-v">y_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-4"><span class="crayon-c"># также не забудем удалить столбец Age из датафрейма признаков</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-5"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-7"><span class="crayon-c"># в test столбец Age не нужен в принципе</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b2943869838-8"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Оценим результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b4690698829" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b4690698829-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b4690698829-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b4690698829-1"><span class="crayon-c"># на этих признаках мы будем учить нашу модель</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b4690698829-2"><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="670" height="209" src="../../wp-content/uploads/2022/11/lr_X_train.jpg" alt="признаки для обучения модели линейной регрессии" class="wp-image-15662" style="width:443px;height:138px" srcset="../../wp-content/uploads/2022/11/lr_X_train.jpg 670w, ../../wp-content/uploads/2022/11/lr_X_train-300x94.jpg 300w, ../../wp-content/uploads/2022/11/lr_X_train-600x187.jpg 600w" sizes="auto, (max-width: 670px) 100vw, 670px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b5592648633" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b5592648633-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b5592648633-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b5592648633-1"><span class="crayon-c"># это будет нашей целевой переменной</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b5592648633-2"><span class="crayon-v">y_train</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b6567092556" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b6567092556-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b6567092556-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b6567092556-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b6567092556-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b6567092556-1">0&nbsp;&nbsp; -0.530377</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b6567092556-2">1&nbsp;&nbsp;&nbsp;&nbsp;0.571831</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b6567092556-3">2&nbsp;&nbsp; -0.254825</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b6567092556-4">Name: Age, dtype: float64</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b7202869231" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b7202869231-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b7202869231-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b7202869231-1"><span class="crayon-c"># на этих данных мы будем строить прогноз (заполнять пропуски)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b7202869231-2"><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="685" height="207" src="../../wp-content/uploads/2022/11/lr_X_test.jpg" alt="тестовая выборка, в которой мы будем заполнять пропущенные значения" class="wp-image-15663" style="width:434px;height:131px" srcset="../../wp-content/uploads/2022/11/lr_X_test.jpg 685w, ../../wp-content/uploads/2022/11/lr_X_test-300x91.jpg 300w, ../../wp-content/uploads/2022/11/lr_X_test-600x181.jpg 600w" sizes="auto, (max-width: 685px) 100vw, 685px" /></figure>



<p>Мы готовы к обучению модели и заполнению пропусков.</p>



<h4 class="wp-block-heading" id="4-obuchenie-modeli-i-zapolnenie-propuskov">Обучение модели и заполнение пропусков</h4>



<p>Обучать модель линейной регрессии и строить прогноз мы уже умеем.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b8801285233" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476b8801285233-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-1"><span class="crayon-c"># импортируем класс LinearRegression</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">LinearRegression</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-4"><span class="crayon-c"># создадим объект этого класса</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-5"><span class="crayon-v">lr_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-7"><span class="crayon-c"># обучим модель</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-8"><span class="crayon-v">lr_model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-10"><span class="crayon-c"># применим обученную модель к данным, в которых были пропуски в столбце Age</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-11"><span class="crayon-v">y_pred</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-13"><span class="crayon-c"># посмотрим на первые три прогнозных значения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476b8801285233-14"><span class="crayon-v">y_pred</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476b9220536686" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476b9220536686-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476b9220536686-1">array([-0.09740093,&nbsp;&nbsp;0.37999257, -0.31925429])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Пропущенные значения заполнены. Остается &#171;собрать&#187; датафрейм обратно.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ba418229663" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ba418229663-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ba418229663-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ba418229663-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ba418229663-1"><span class="crayon-c"># присоединим прогнозные значения возраста к датафрейму test</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ba418229663-2"><span class="crayon-k ">test</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">y_pred</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ba418229663-3"><span class="crayon-k ">test</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="806" height="213" src="../../wp-content/uploads/2022/11/lr_y_pred.jpg" alt="тестовые данные + заполненные пропуски" class="wp-image-15664" style="width:518px;height:137px" srcset="../../wp-content/uploads/2022/11/lr_y_pred.jpg 806w, ../../wp-content/uploads/2022/11/lr_y_pred-300x79.jpg 300w, ../../wp-content/uploads/2022/11/lr_y_pred-768x203.jpg 768w, ../../wp-content/uploads/2022/11/lr_y_pred-600x159.jpg 600w" sizes="auto, (max-width: 806px) 100vw, 806px" /></figure>



<p>Теперь у нас есть два датафрейма train и test со столбцом Age с заполненными пропусками.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476bb163471203" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bb163471203-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476bb163471203-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bb163471203-1"><span class="crayon-c"># еще раз взглянем на датафрейм train</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476bb163471203-2"><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="796" height="207" src="../../wp-content/uploads/2022/11/train_repeat.jpg" alt="повторно взглянем на обучающую выборку" class="wp-image-15665" style="width:515px;height:134px" srcset="../../wp-content/uploads/2022/11/train_repeat.jpg 796w, ../../wp-content/uploads/2022/11/train_repeat-300x78.jpg 300w, ../../wp-content/uploads/2022/11/train_repeat-768x200.jpg 768w, ../../wp-content/uploads/2022/11/train_repeat-600x156.jpg 600w" sizes="auto, (max-width: 796px) 100vw, 796px" /></figure>



<p>Соединим их методом &#171;один на другой&#187; с помощью <strong>функции pd.concat()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476bc055195437" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bc055195437-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476bc055195437-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bc055195437-1"><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476bc055195437-2"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="793" height="412" src="../../wp-content/uploads/2022/11/lr_concat.jpg" alt="соединим обучающую и тестовую выборки с помощью pd.concat()" class="wp-image-15666" style="width:508px;height:264px" srcset="../../wp-content/uploads/2022/11/lr_concat.jpg 793w, ../../wp-content/uploads/2022/11/lr_concat-300x156.jpg 300w, ../../wp-content/uploads/2022/11/lr_concat-768x399.jpg 768w, ../../wp-content/uploads/2022/11/lr_concat-600x312.jpg 600w" sizes="auto, (max-width: 793px) 100vw, 793px" /></figure>



<p>Как вы видите, по сравнению с изначальным датафреймом порядок строк нарушился. После четвертого индекса сразу идет шестой, а строка с пятым индексом оказалась где-то в середине датафрейма.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476bd867655788" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bd867655788-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476bd867655788-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bd867655788-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bd867655788-1"><span class="crayon-c"># восстановим изначальный порядок строк, отсортировав их по индексу</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476bd867655788-2"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">sort_index</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bd867655788-3"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="793" height="413" src="../../wp-content/uploads/2022/11/lr_sort_index.jpg" alt="датасет с обновленным индексом" class="wp-image-15667" style="width:499px;height:260px" srcset="../../wp-content/uploads/2022/11/lr_sort_index.jpg 793w, ../../wp-content/uploads/2022/11/lr_sort_index-300x156.jpg 300w, ../../wp-content/uploads/2022/11/lr_sort_index-768x400.jpg 768w, ../../wp-content/uploads/2022/11/lr_sort_index-600x312.jpg 600w" sizes="auto, (max-width: 793px) 100vw, 793px" /></figure>



<p>Остается вернуть исходный масштаб.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476bf327586589" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bf327586589-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476bf327586589-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bf327586589-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476bf327586589-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476bf327586589-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476bf327586589-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bf327586589-1"><span class="crayon-c"># вернем исходный масштаб с помощью метода .inverse_transform()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476bf327586589-2"><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bf327586589-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476bf327586589-4"><span class="crayon-c"># округлим столбец Age и выведем результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476bf327586589-5"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476bf327586589-6"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="546" height="413" src="../../wp-content/uploads/2022/11/lr_inverse_transform.jpg" alt="результат заполнения пропусков с помощью линейной регрессии" class="wp-image-15671" style="width:375px;height:284px" srcset="../../wp-content/uploads/2022/11/lr_inverse_transform.jpg 546w, ../../wp-content/uploads/2022/11/lr_inverse_transform-300x227.jpg 300w" sizes="auto, (max-width: 546px) 100vw, 546px" /></figure>



<p>В данном случае, если <strong>метод .fit_transform()</strong> класса StandardScaler вычитает из каждого значения среднее и делит на СКО,</p>



<p>$$ z = \frac{x-\overline{x}}{\sigma} $$</p>



<p>то <strong>метод .inverse_transform()</strong> в обратном порядке умножает каждое число на СКО и прибавляет среднее арифметическое.</p>



<p>$$ x = z \cdot \sigma + \overline{x} $$</p>



<p>Проверим на наших данных. Подставим в формулу выше отмасштабированное значение возраста первого наблюдения (индекс 0).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c0703456019" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c0703456019-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c0703456019-1"><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">0.530377</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c1467295827" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c1467295827-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c1467295827-1">22.0</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Убедимся в отсутствии пропусков и посмотрим на размеры получившегося датафрейма.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c2097388371" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c2097388371-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c2097388371-1"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">isna</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c3141952881" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c3141952881-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c3141952881-1">(0, (891, 6))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="5-otsenka-rezultata">Оценка результата</h4>



<p>Вначале построим гистограмму.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c4895997618" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c4895997618-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c4895997618-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c4895997618-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c4895997618-1"><span class="crayon-c"># посмотрим на распределение возраста после заполнения пропусков</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c4895997618-2"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">histplot</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c4895997618-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Распределение Age после заполнения с помощью линейной регрессии (дет.)'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="619" height="393" src="../../wp-content/uploads/2022/11/lr_hist.png" alt="распределение Age после заполнения с помощью линейной регрессии (детерминированный подход)" class="wp-image-15668" style="width:594px;height:377px" srcset="../../wp-content/uploads/2022/11/lr_hist.png 619w, ../../wp-content/uploads/2022/11/lr_hist-300x190.png 300w, ../../wp-content/uploads/2022/11/lr_hist-600x381.png 600w" sizes="auto, (max-width: 619px) 100vw, 619px" /></figure>



<p>Как мы видим, распределение чуть больше похоже на нормальное, чем при заполнении медианой.</p>



<p>Впрочем возникла одна проблема. Линейная регрессия предсказала нам отрицательные значения возраста, который разумеется должен быть только положительным. Как поступить? Просто удалить строки с неположительными значениями нам бы не хотелось, чтобы не терять с таким трудом восстановленные данные.</p>



<p>Воспользуемся <strong>методом .clip()</strong>, который установит минимальную границу значений столбца.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c5223660922" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c5223660922-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c5223660922-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c5223660922-1"><span class="crayon-c"># установим минимальное значение на уровне 0,5 (полгода)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c5223660922-2"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-v">lower</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Остается посмотреть на новые средние показатели.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c6868751538" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c6868751538-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c6868751538-1"><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">median</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c7635124273" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c7635124273-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c7635124273-1">(29.3, 28.3)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Среднее арифметическое и медиана практически не изменились.</p>



<h4 class="wp-block-heading" id="6-osobennost-determinirovannogo-podkhoda">Особенность детерминированного подхода</h4>



<p>В детерминированном подходе сохраняется та же особенность, которую мы наблюдали при заполнении пропусков медианой, а именно доминирование одного значения (в случае медианы) или узкого диапазона (в случае линейной регрессии).</p>



<p>Для того чтобы лучше это увидеть, во-первых, пометим изначальные (назовем их actual) и заполненные (imputed) значения столбца Age.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476c8115063493" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476c8115063493-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-1"><span class="crayon-c"># сделаем копию датафрейма, которую используем для визуализации</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-2"><span class="crayon-v">lr_viz</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-4"><span class="crayon-c"># создадим столбец Age_type, в который запишем значение actual, если индекс наблюдения есть в train,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-5"><span class="crayon-c"># и imputed, если нет (т.е. он есть в test)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-6"><span class="crayon-v">lr_viz</span><span class="crayon-sy">[</span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">where</span><span class="crayon-sy">(</span><span class="crayon-v">lr</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">.</span><span class="crayon-e">isin</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'actual'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'imputed'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-8"><span class="crayon-c"># вновь "обрежем" нулевые значения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-9"><span class="crayon-v">lr_viz</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-v">lower</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-11"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476c8115063493-12"><span class="crayon-v">lr_viz</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="672" height="413" src="../../wp-content/uploads/2022/11/lr_actual_imputed.jpg" alt="датасет с размеченными исходными и заполненными значениями" class="wp-image-15669" style="width:450px;height:277px" srcset="../../wp-content/uploads/2022/11/lr_actual_imputed.jpg 672w, ../../wp-content/uploads/2022/11/lr_actual_imputed-300x184.jpg 300w, ../../wp-content/uploads/2022/11/lr_actual_imputed-600x369.jpg 600w" sizes="auto, (max-width: 672px) 100vw, 672px" /></figure>



<p>Во-вторых, создадим точечную диаграмму, где по оси x будет индекс датафрейма, по оси y &#8212; возраст, а цветом мы обозначим изначальное это значение, или заполненное.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ca219106519" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ca219106519-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ca219106519-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ca219106519-1"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">scatterplot</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_viz</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_viz</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ca219106519-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Распределение изначальных и заполненных значений (лин. регрессия, дет. подход)'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="612" height="376" src="../../wp-content/uploads/2022/11/lr_scatter.png" alt="распределение изначальных и заполненных значений (линейная регрессия, детерминированный подход)" class="wp-image-15670" style="width:596px;height:366px" srcset="../../wp-content/uploads/2022/11/lr_scatter.png 612w, ../../wp-content/uploads/2022/11/lr_scatter-300x184.png 300w, ../../wp-content/uploads/2022/11/lr_scatter-600x369.png 600w" sizes="auto, (max-width: 612px) 100vw, 612px" /></figure>



<p>На графике видно, что заполненные значения гораздо ближе к среднему значению (а зачастую просто равны ему), чем исходные данные. Аналогичную картину мы увидим, если рассчитаем соответствующие СКО.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476cb129862492" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cb129862492-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cb129862492-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cb129862492-1"><span class="crayon-v">lr_viz</span><span class="crayon-sy">[</span><span class="crayon-v">lr_viz</span><span class="crayon-sy">[</span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'actual'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cb129862492-2"><span class="crayon-v">lr_viz</span><span class="crayon-sy">[</span><span class="crayon-v">lr_viz</span><span class="crayon-sy">[</span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'imputed'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476cc351307296" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cc351307296-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cc351307296-1">(14.53, 8.33)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p class="has-background" style="background-color:#ffe8c4">Можно предположить, что детерминированный подход переоценивает корреляцию между признаками, и, как следствие, преувеличивает точность прогноза пропущенных значений.</p>



<p>Попробуем преодолеть этот недостаток через внесение в заполняемые данные элемента случайности (дополнительных колебаний).</p>



<h3 class="wp-block-heading" id="7-stokhasticheskiy-podkhod">Стохастический подход</h3>



<p>При применении <strong>стохастического подхода</strong> (stochastic regression imputation) мы будем использовать гауссовский шум (Gaussian noise), то есть такой шум (элемент случайности), который следует нормальному распределению. Объявим соответствующую функцию.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476cd111565162" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476cd111565162-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-1"><span class="crayon-c"># объявим функцию для создания гауссовского шума</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-2"><span class="crayon-c"># на входе эта функция будет принимать некоторый массив значений x,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-3"><span class="crayon-c"># среднее значение mu, СКО std и точку отсчета для воспроизводимости результата</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-4"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gaussian_noise</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mu</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># вначале создадим объект, который позволит получать воспроизводимые результаты</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">rs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">RandomState</span><span class="crayon-sy">(</span><span class="crayon-v">random_state</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># применим метод .normal() к этому объекту для создания гауссовского шума</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">noise</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rs</span><span class="crayon-sy">.</span><span class="crayon-e">normal</span><span class="crayon-sy">(</span><span class="crayon-v">mu</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">std</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># добавим шум к исходному массиву</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476cd111565162-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">noise</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p class="has-background" style="background-color:#ffe8c4"><strong>Среднее значение шума</strong>, равное нулю, мы взяли потому, что не хотим искажать колебания в ту или иную сторону. <strong>СКО</strong> равное, по умолчанию, единице указано исходя из того, что в линейной регрессии мы стремимся к работе со стандартизированными данными, отклонение которых как раз равно этой величине.</p>



<p>Заменим заполненные значения теми же значениями, но с добавлением шума.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ce995575039" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ce995575039-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ce995575039-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ce995575039-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ce995575039-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ce995575039-1"><span class="crayon-k ">test</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gaussian_noise</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ce995575039-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ce995575039-3"><span class="crayon-c"># посмотрим, как изменились заполненные значения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ce995575039-4"><span class="crayon-k ">test</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="800" height="206" src="../../wp-content/uploads/2022/11/lrs_test.jpg" alt="добавление гауссовского шума в данные" class="wp-image-15676" style="width:559px;height:144px" srcset="../../wp-content/uploads/2022/11/lrs_test.jpg 800w, ../../wp-content/uploads/2022/11/lrs_test-300x77.jpg 300w, ../../wp-content/uploads/2022/11/lrs_test-768x198.jpg 768w, ../../wp-content/uploads/2022/11/lrs_test-600x155.jpg 600w" sizes="auto, (max-width: 800px) 100vw, 800px" /></figure>



<p>Теперь соединим два датасета исходных и заполненных значений и оценим результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d0934691159" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d0934691159-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-1"><span class="crayon-c"># соединим датасеты и обновим индекс</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-2"><span class="crayon-v">lr_stochastic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">concat</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">test</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-3"><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-e">sort_index</span><span class="crayon-sy">(</span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-5"><span class="crayon-c"># вернем исходный масштаб с помощью метода .inverse_transform()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-6"><span class="crayon-v">lr_stochastic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-8"><span class="crayon-c"># округлим столбец Age и выведем результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-9"><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d0934691159-10"><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="544" height="414" src="../../wp-content/uploads/2022/11/lrs_final.jpg" alt="результат заполнения пропусков с помощью стохастической линейной регрессии" class="wp-image-15677" style="width:399px;height:304px" srcset="../../wp-content/uploads/2022/11/lrs_final.jpg 544w, ../../wp-content/uploads/2022/11/lrs_final-300x228.jpg 300w" sizes="auto, (max-width: 544px) 100vw, 544px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d1047473590" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d1047473590-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d1047473590-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d1047473590-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d1047473590-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d1047473590-1"><span class="crayon-c"># посмотрим на распределение возраста</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d1047473590-2"><span class="crayon-c"># после заполнения пропусков с помощью стохастического подхода</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d1047473590-3"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">histplot</span><span class="crayon-sy">(</span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d1047473590-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Распределение Age после заполнения с помощью линейной регрессии (стох.)'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="619" height="393" src="../../wp-content/uploads/2022/11/lrs_hist.png" alt="распределение Age после заполнения с помощью линейной регрессии (стохастический подход)" class="wp-image-15679" srcset="../../wp-content/uploads/2022/11/lrs_hist.png 619w, ../../wp-content/uploads/2022/11/lrs_hist-300x190.png 300w, ../../wp-content/uploads/2022/11/lrs_hist-600x381.png 600w" sizes="auto, (max-width: 619px) 100vw, 619px" /></figure>



<p>Как мы видим, распределение еще больше похоже на нормальное.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d2103702004" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d2103702004-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d2103702004-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d2103702004-1"><span class="crayon-c"># обрежем нулевые и отрицательные значения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d2103702004-2"><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-v">lower</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Оценим среднее арифметическое и медиану.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d3260180707" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d3260180707-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d3260180707-1"><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">median</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d4369674793" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d4369674793-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d4369674793-1">(29.3, 28.0)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Медиана при стохастическом подходе вернулась к значению изначального распределения. Теперь с помощью точечной диаграммы оценим, как изменился разброс заполненных значений.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d5908171218" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d5908171218-14">14</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-1"><span class="crayon-c"># сделаем копию датафрейма, которую используем для визуализации</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-2"><span class="crayon-v">lr_st_viz</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-4"><span class="crayon-c"># создадим столбец Age_type, в который запишем actual, если индекс наблюдения есть в train,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-5"><span class="crayon-c"># и imputed, если нет (т.е. он есть в test)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-6"><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">[</span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">where</span><span class="crayon-sy">(</span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">.</span><span class="crayon-e">isin</span><span class="crayon-sy">(</span><span class="crayon-v">train</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'actual'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'imputed'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-8"><span class="crayon-c"># вновь "обрежем" нулевые значения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-9"><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-v">lower</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-11"><span class="crayon-c"># создадим график, где по оси x будет индекс датафрейма, </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-12"><span class="crayon-c"># по оси y - возраст, а цветом мы обозначим изначальное это значение, или заполненное</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-13"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">scatterplot</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">.</span><span class="crayon-v">index</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Age'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hue</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d5908171218-14"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Распределение изначальных и заполненных значений (лин. регрессия, стох. подход)'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="612" height="376" src="../../wp-content/uploads/2022/11/lrs_scatter.png" alt="распределение изначальных и заполненных значений (линейная регрессия, стохастический подход)" class="wp-image-15680" srcset="../../wp-content/uploads/2022/11/lrs_scatter.png 612w, ../../wp-content/uploads/2022/11/lrs_scatter-300x184.png 300w, ../../wp-content/uploads/2022/11/lrs_scatter-600x369.png 600w" sizes="auto, (max-width: 612px) 100vw, 612px" /></figure>



<p>Как мы видим разброс заполненных значений существенно приблизился к разбросу изначальных данных. Сравним СКО.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d6195118325" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d6195118325-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d6195118325-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d6195118325-1"><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">[</span><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">[</span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'actual'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d6195118325-2"><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">[</span><span class="crayon-v">lr_st_viz</span><span class="crayon-sy">[</span><span class="crayon-s">'Age_type'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'imputed'</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d8679614721" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d8679614721-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d8679614721-1">(14.53, 14.34)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Забегая вперед скажу, что хотя у нас были основания для разработки стохастического подхода, детерминированный подход будет существенно более точно предсказывать пропуски, поскольку случайные колебания могут как улучшить, так и ухудшить качество заполненных пропусков.</p>



<p>Также замечу, что модель логистической регрессии для заполнения пропусков в категориальных данных строится аналогичным образом.</p>



<h2 class="wp-block-heading" id="8-mice-iterativeimputer">MICE / IterativeImputer</h2>



<p>Описанный выше алгоритм регрессии используется в алгоритме <strong>MICE</strong> или <strong>IterativeImputer</strong>. MICE расшифровывается как Multiple Imputation by Chained Equations, <em>многомерный способ заполнения пропущенных данных с помощью цепных уравнений</em>.</p>



<h3 class="wp-block-heading" id="9-printsip-algoritma-mice">Принцип алгоритма MICE</h3>



<p>Рассмотрим MICE на несложном <a href="https://www.numpyninja.com/post/mice-algorithm-to-impute-missing-values-in-a-dataset" target="_blank" rel="noreferrer noopener">примере</a>⧉. Предположим, что у нас есть данные о заемщиках, а именно их возраст, стаж и уровень заработной платы, а также факт возвращения или невозвращения кредита. В этих данных есть пропущенные значения.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="535" height="382" src="../../wp-content/uploads/2022/10/mice_data_empty.png" alt="данные о заемщиках: пропущенные значения" class="wp-image-15356" style="width:398px;height:284px" srcset="../../wp-content/uploads/2022/10/mice_data_empty.png 535w, ../../wp-content/uploads/2022/10/mice_data_empty-300x214.png 300w" sizes="auto, (max-width: 535px) 100vw, 535px" /></figure>



<p>Кроме того, для целей оценки качества результата предположим, что нам известны истинные значения пропусков.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="535" height="382" src="../../wp-content/uploads/2022/10/mice_data_true.png" alt="данные о заемщиках: истинные значения пропусков" class="wp-image-15357" style="width:401px;height:286px" srcset="../../wp-content/uploads/2022/10/mice_data_true.png 535w, ../../wp-content/uploads/2022/10/mice_data_true-300x214.png 300w" sizes="auto, (max-width: 535px) 100vw, 535px" /></figure>



<p>Теперь перейдем непостредственно к алгоритму MICE. Это итерационный алгоритм, другими словами, мы будем раз за разом повторять определенный набор действий до тех пор, пока не придем к нужному результату.</p>



<p><strong>Шаг 1</strong>. Заполняем данные с помощью среднего арифметического (целевую переменную мы отбросим). Это наша отправная точка.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="405" height="382" src="../../wp-content/uploads/2022/10/mice_data_mean.png" alt="данные о заемщиках: шаг 1" class="wp-image-15358" style="width:304px;height:287px" srcset="../../wp-content/uploads/2022/10/mice_data_mean.png 405w, ../../wp-content/uploads/2022/10/mice_data_mean-300x283.png 300w" sizes="auto, (max-width: 405px) 100vw, 405px" /></figure>



<p>Эти значения очевидно далеко не оптимальны и еще раз демонстрируют ограниченность одномерных методов. В 25 лет сложно иметь семилетний стаж, три года стажа вряд ли обеспечат уровень заработной платы в 90 тысяч рублей (исходя из имеющихся данных), а человеку с 11 годами опыта скорее всего будет больше 29 лет.</p>



<p>Попробуем улучшить этот результат.</p>



<p><strong>Шаг 2</strong>. Уберем заполненное только что значение возраста. Остальные заполненные значения трогать не будем.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="402" height="382" src="../../wp-content/uploads/2022/11/age_step_2_mice.png" alt="данные о заемщиках: шаг 2" class="wp-image-15418" style="width:290px;height:276px" srcset="../../wp-content/uploads/2022/11/age_step_2_mice.png 402w, ../../wp-content/uploads/2022/11/age_step_2_mice-300x285.png 300w" sizes="auto, (max-width: 402px) 100vw, 402px" /></figure>



<p><strong>Шаг 3</strong>. Заполним пропуск с помощью линейной регрессии так, как мы это делали выше.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="377" src="../../wp-content/uploads/2022/11/age_step_3_mice-1024x377.png" alt="данные о заемщиках: шаг 3" class="wp-image-15419" style="width:775px;height:285px" srcset="../../wp-content/uploads/2022/11/age_step_3_mice-1024x377.png 1024w, ../../wp-content/uploads/2022/11/age_step_3_mice-300x110.png 300w, ../../wp-content/uploads/2022/11/age_step_3_mice-768x283.png 768w, ../../wp-content/uploads/2022/11/age_step_3_mice-600x221.png 600w, ../../wp-content/uploads/2022/11/age_step_3_mice.png 1081w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>В данном случае &#171;Опыт&#187; и &#171;ЗП&#187; (кроме последней строки) будут признаками обучающей выборки (X_train), возраст (кроме последней строки) &#8212; целевой переменной обучающей выборки (y_train), &#171;Опыт&#187; и &#171;ЗП&#187; последней строки &#8212; признаками тестовой выборки (X_test), а возраст последней строки &#8212; прогнозируемым значением (y_pred).</p>



<p><strong>Шаги 4 и 5</strong>. Сделаем то же самое для двух других пропущенных значений.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="373" src="../../wp-content/uploads/2022/11/age_step_4_mice-1024x373.png" alt="данные о заемщиках: шаг 4" class="wp-image-15420" style="width:782px;height:284px" srcset="../../wp-content/uploads/2022/11/age_step_4_mice-1024x373.png 1024w, ../../wp-content/uploads/2022/11/age_step_4_mice-300x109.png 300w, ../../wp-content/uploads/2022/11/age_step_4_mice-768x280.png 768w, ../../wp-content/uploads/2022/11/age_step_4_mice-600x219.png 600w, ../../wp-content/uploads/2022/11/age_step_4_mice.png 1086w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="367" src="../../wp-content/uploads/2022/11/age_step_5_mice-1-1024x367.png" alt="данные о заемщиках: шаг 5" class="wp-image-15423" style="width:781px;height:280px" srcset="../../wp-content/uploads/2022/11/age_step_5_mice-1-1024x367.png 1024w, ../../wp-content/uploads/2022/11/age_step_5_mice-1-300x107.png 300w, ../../wp-content/uploads/2022/11/age_step_5_mice-1-768x275.png 768w, ../../wp-content/uploads/2022/11/age_step_5_mice-1-600x215.png 600w, ../../wp-content/uploads/2022/11/age_step_5_mice-1.png 1084w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Итак, мы завершили <strong>первую итерацию</strong> (цикл) работы алгоритма.</p>



<p><strong>Шаг 6</strong>. Теперь давайте вычтем заполненные после первого цикла значения из исходного датасета, в котором пропуски представляют собой среднее арифметическое по столбцам.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="339" src="../../wp-content/uploads/2022/11/age_step_6_mice-1024x339.png" alt="данные о заемщиках: шаг 6" class="wp-image-15422" srcset="../../wp-content/uploads/2022/11/age_step_6_mice-1024x339.png 1024w, ../../wp-content/uploads/2022/11/age_step_6_mice-300x99.png 300w, ../../wp-content/uploads/2022/11/age_step_6_mice-768x254.png 768w, ../../wp-content/uploads/2022/11/age_step_6_mice-600x199.png 600w, ../../wp-content/uploads/2022/11/age_step_6_mice.png 1171w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Получившиеся разницы $-5{,}99, 6{,}02$ и $20$ &#8212; это критерий качества работы алгоритма.</p>



<p class="has-background" style="background-color:#ffe8c4">Наша задача повторять шаги с 3 по 5 (каждый раз используя новые заполненные значения в качестве отправной точки) до тех пор, пока разницы между двумя последними пропущенными значениями не будут близки к нулю.</p>



<p>Например, уже на второй итерации мы получим следующий результат.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="342" src="../../wp-content/uploads/2022/11/iter_2_mice-1024x342.png" alt="результат после второй итерации" class="wp-image-15424" style="width:840px;height:280px" srcset="../../wp-content/uploads/2022/11/iter_2_mice-1024x342.png 1024w, ../../wp-content/uploads/2022/11/iter_2_mice-300x100.png 300w, ../../wp-content/uploads/2022/11/iter_2_mice-768x256.png 768w, ../../wp-content/uploads/2022/11/iter_2_mice-600x200.png 600w, ../../wp-content/uploads/2022/11/iter_2_mice.png 1181w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Перейдем к практике.</p>



<h3 class="wp-block-heading" id="10-realizatsiya-na-pitone-cherez-klass-iterativeimputer">Реализация на Питоне через класс IterativeImputer</h3>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476d9137916490" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476d9137916490-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476d9137916490-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476d9137916490-1"><span class="crayon-c"># сделаем копию датасета для работы с методом MICE</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476d9137916490-2"><span class="crayon-v">mice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Изначально алгоритм MICE был создан на <a href="https://www.jstatsoft.org/article/view/v045i03" target="_blank" rel="noreferrer noopener">языке R</a>⧉, но сегодня доступен в качестве экспериментального класса <strong><a href="https://scikit-learn.org/stable/modules/generated/sklearn.impute.IterativeImputer.html" target="_blank" rel="noreferrer noopener">IterativeImputer</a></strong>⧉ в библиотеке sklearn.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476dc034867007" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476dc034867007-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476dc034867007-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476dc034867007-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476dc034867007-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476dc034867007-1"><span class="crayon-c"># предварительно нам нужно "включить" класс IterativeImputer,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476dc034867007-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">experimental </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">enable_iterative</span><span class="crayon-sy">_</span>imputer</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476dc034867007-3"><span class="crayon-c"># затем импортировать его</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476dc034867007-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">impute </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">IterativeImputer</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Теперь импортируем классы моделей, которые мы можем использовать внутри алгоритма MICE.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476dd778671318" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476dd778671318-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476dd778671318-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476dd778671318-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476dd778671318-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476dd778671318-1"><span class="crayon-c"># в сегодняшнем примере ограничимся использованием линейной регрессии</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476dd778671318-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476dd778671318-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">BayesianRidge</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476dd778671318-4"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">RandomForestRegressor</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Так как в конечном счете мы снова имеем дело с линейной регрессией, будет разумно стандартизировать данные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476de421327639" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476de421327639-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476de421327639-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476de421327639-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476de421327639-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476de421327639-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476de421327639-1"><span class="crayon-c"># создадим объект класса StandardScaler</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476de421327639-2"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476de421327639-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476de421327639-4"><span class="crayon-c"># стандартизируем данные и сразу поместим их в датафрейм</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476de421327639-5"><span class="crayon-v">mice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">mice</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Создадим объект класса IterativeImputer и заполним пропуски.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476df822927442" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476df822927442-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-1"><span class="crayon-c"># создадим объект класса IterativeImputer и укажем необходимые параметры</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-2"><span class="crayon-v">mice_imputer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">IterativeImputer</span><span class="crayon-sy">(</span><span class="crayon-v">initial_strategy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'mean'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># вначале заполним пропуски средним значением</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># в качестве модели используем линейную регрессию</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-h"> </span><span class="crayon-c"># добавим точку отсчета</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-7"><span class="crayon-c"># используем метод .fit_transform() для заполнения пропусков в датасете mice</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-8"><span class="crayon-v">mice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mice_imputer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">mice</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-10"><span class="crayon-c"># вернем данные к исходному масштабу и округлим столбец Age</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-11"><span class="crayon-v">mice</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">mice</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-12"><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476df822927442-13"><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="773" src="../../wp-content/uploads/2022/11/mice_final-1-1024x773.jpg" alt="результат заполнения пропущенных значений с помощью алгоритма MICE" class="wp-image-15884" style="aspect-ratio:1.325077399380805;width:413px;height:auto" srcset="../../wp-content/uploads/2022/11/mice_final-1-1024x773.jpg 1024w, ../../wp-content/uploads/2022/11/mice_final-1-300x226.jpg 300w, ../../wp-content/uploads/2022/11/mice_final-1-768x580.jpg 768w, ../../wp-content/uploads/2022/11/mice_final-1-600x453.jpg 600w, ../../wp-content/uploads/2022/11/mice_final-1.jpg 1096w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e0972361719" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e0972361719-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e0972361719-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e0972361719-1"><span class="crayon-c"># убедимся, что пропусков не осталось</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e0972361719-2"><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">isna</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e1869606278" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e1869606278-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e1869606278-1">(0, (891, 6))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Оценим качество получившегося распределения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e2736840224" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e2736840224-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e2736840224-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e2736840224-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e2736840224-1"><span class="crayon-c"># посмотрим на гистограмму возраста после заполнения пропусков</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e2736840224-2"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">histplot</span><span class="crayon-sy">(</span><span class="crayon-v">mice</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e2736840224-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Распределение Age после заполнения с помощью MICE'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="619" height="393" src="../../wp-content/uploads/2022/11/mice_hist-1.png" alt="распределение Age после заполнения с помощью MICE" class="wp-image-15885" srcset="../../wp-content/uploads/2022/11/mice_hist-1.png 619w, ../../wp-content/uploads/2022/11/mice_hist-1-300x190.png 300w, ../../wp-content/uploads/2022/11/mice_hist-1-600x381.png 600w" sizes="auto, (max-width: 619px) 100vw, 619px" /></figure>



<p>Так как мы заполняли пропуски линейной регрессией, у нас снова появились отрицательные значения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e3444205674" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e3444205674-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e3444205674-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e3444205674-1"><span class="crayon-c"># обрежем нулевые и отрицательные значения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e3444205674-2"><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">clip</span><span class="crayon-sy">(</span><span class="crayon-v">lower</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">inplace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Количественно оценим получившееся распределение.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e4209747947" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e4209747947-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e4209747947-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e4209747947-1"><span class="crayon-c"># оценим среднее арифметическое и медиану</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e4209747947-2"><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">median</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e5536765341" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e5536765341-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e5536765341-1">(29.3, 28.3)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e6920392961" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e6920392961-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e6920392961-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e6920392961-1"><span class="crayon-c"># сравним СКО исходного датасета и данных после алгоритма MICE</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e6920392961-2"><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mice</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e7320859298" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e7320859298-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e7320859298-1">(14.53, 13.54)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Рассмотрим принципиально другой алгоритм для заполнения пропусков, а именно метод ближайших соседей.</p>



<h2 class="wp-block-heading" id="11-metod-k-blizhayshikh-sosedey">Метод k-ближайших соседей</h2>



<p>Мы уже использовали <strong>алгоритм k-ближайших соседей</strong> (k-nearest neighbors algorithm, k-NN) для создания <a href="../../intro/recommender/index.html">рекомендательной системы</a>. Еще раз рассмотрим работу этого алгоритма на примере <em>задачи классификации</em>.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img loading="lazy" decoding="async" width="1024" height="925" src="../../wp-content/uploads/2022/11/knn_algorithm.png" alt="алгоритм k-ближайших соседей для заполнения пропусков" class="wp-image-15426" style="width:459px;height:414px" srcset="../../wp-content/uploads/2022/11/knn_algorithm.png 1024w, ../../wp-content/uploads/2022/11/knn_algorithm-300x271.png 300w, ../../wp-content/uploads/2022/11/knn_algorithm-768x694.png 768w, ../../wp-content/uploads/2022/11/knn_algorithm-600x542.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption"><em>Источник: <a href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm#/media/File:KnnClassification.svg" target="_blank" rel="noreferrer noopener">Википедия</a>⧉</em></figcaption></figure></div>


<p>На рисунке выше мы рассчитали расстояние от зеленой точки (<a href="../../intro/vectors/index.html">наблюдение или вектор</a>, класс которого мы хотим предсказать) до ближайших соседей.</p>



<ul class="wp-block-list">
<li>если мы возьмем k равное трем, то в число соседей войдут точки внутри меньшей окружности (сплошная линия);</li>



<li>если пяти &#8212; внутри большей окружности (прерывистая линия).</li>
</ul>



<p>При $k = 3$ бо́льшая часть соседей &#8212; красные треугольники. Именно к этой категории мы и отнесем зеленую точку. Если взять $k = 5$, зеленая точка будет классифицирована как синий квадрат.</p>



<p>Для <em>количественной целевой переменной</em> мы можем найти, например, среднее арифметическое k-ближайших соседей.</p>



<p>В <em>задаче заполнения пропусков</em> мы сначала найдем соседей наблюдения с пропущенным значением (например, других пассажиров &#171;Титаника&#187;), а затем заполним пропуск (в частности, возраст) средним арифметическим значений этого столбца наблюдений соседей (т.е. средним возрастом других пассажиров).</p>



<p class="has-background" style="background-color:#ffe8c4">Также не будем забывать, что так как речь идет об алгоритме, учитывающем расстояние, нам обязательно нужно <a href="../../intro/clustering/index.html">масштабировать данные</a>.</p>



<p>Перейдем к практике.</p>



<h3 class="wp-block-heading" id="12-sklearn-knnimputer">Sklearn KNNImputer</h3>



<p>Рассмотрим реализацию этого алгоритма в библиотеке Sklearn. Скопируем и масштабируем данные.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476e8413274665" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476e8413274665-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-1"><span class="crayon-c"># сделаем копию датафрейма</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-2"><span class="crayon-v">knn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">titanic</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-4"><span class="crayon-c"># создадим объект класса StandardScaler</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-5"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-7"><span class="crayon-c"># масштабируем данные и сразу преобразуем их обратно в датафрейм</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476e8413274665-8"><span class="crayon-v">knn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">knn</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Теперь воспользуемся классом KNNImputer для заполнения пропусков.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ea002221412" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ea002221412-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-1"><span class="crayon-c"># импортируем класс KNNImputer</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">impute </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">KNNImputer</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-4"><span class="crayon-c"># создадим объект этого класса с параметрами:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-5"><span class="crayon-c"># пять соседей и однаковым весом каждого из них</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-6"><span class="crayon-v">knn_imputer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">KNNImputer</span><span class="crayon-sy">(</span><span class="crayon-v">n_neighbors</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">weights</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'uniform'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-8"><span class="crayon-c"># заполним пропуски в столбце Age</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-9"><span class="crayon-v">knn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">knn_imputer</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">knn</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-11"><span class="crayon-c"># проверим отсутствие пропусков и размеры получившегося датафрейма</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ea002221412-12"><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-e">isna</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476eb610130654" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476eb610130654-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476eb610130654-1">(0, (891, 6))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Вернем исходный масштаб данных.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ec025780954" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ec025780954-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-1"><span class="crayon-v">knn</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">inverse_transform</span><span class="crayon-sy">(</span><span class="crayon-v">knn</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">columns</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-3"><span class="crayon-c"># округлим значение возраста</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-4"><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-v">Age</span><span class="crayon-sy">.</span><span class="crayon-k ">round</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-6"><span class="crayon-c"># посмотрим на результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ec025780954-7"><span class="crayon-v">knn</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="544" height="409" src="../../wp-content/uploads/2022/11/knn_final.jpg" alt="результат заполнения пропусков с помощью KNNImputer" class="wp-image-15684" style="width:370px;height:278px" srcset="../../wp-content/uploads/2022/11/knn_final.jpg 544w, ../../wp-content/uploads/2022/11/knn_final-300x226.jpg 300w" sizes="auto, (max-width: 544px) 100vw, 544px" /></figure>



<p>Осталось взглянуть на получившееся распределение.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ed595429605" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ed595429605-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ed595429605-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ed595429605-1"><span class="crayon-v">sns</span><span class="crayon-sy">.</span><span class="crayon-e">histplot</span><span class="crayon-sy">(</span><span class="crayon-v">knn</span><span class="crayon-sy">[</span><span class="crayon-s">'Age'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bins</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ed595429605-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Распределение Age после заполнения с помощью KNNImputer'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="619" height="393" src="../../wp-content/uploads/2022/11/knn_hist.png" alt="распределение Age после заполнения с помощью KNNImputer" class="wp-image-15685" srcset="../../wp-content/uploads/2022/11/knn_hist.png 619w, ../../wp-content/uploads/2022/11/knn_hist-300x190.png 300w, ../../wp-content/uploads/2022/11/knn_hist-600x381.png 600w" sizes="auto, (max-width: 619px) 100vw, 619px" /></figure>



<p>Распределение близко к нормальному.</p>



<h3 class="wp-block-heading" id="13-osobennosti-metoda-blizhayshikh-sosedey">Особенности метода ближайших соседей</h3>



<p>Метод ближайших соседей прост и в то же время эффективен.</p>



<p class="has-background" style="background-color:#ffe8c4">При этом в базовом варианте его реализации у него есть один недостаток &#8212; долгое время работы или, как правильнее сказать, высокая <strong>временная сложность</strong> (time complexity) алгоритма.</p>



<p>Давайте рассмотрим механику этого метода чуть подробнее. В первую очередь, для лучшего понимания, введем несколько неформальных терминов:</p>



<ul class="wp-block-list">
<li>назовем <strong>вектором запроса</strong> (query vector) то новое наблюдение, для которого мы хотим найти ближайшие к нему векторы (зеленая точка на изображении выше);</li>



<li><strong>вектором сравнения</strong> (reference vector) будет то наблюдение, которое уже содержит разметку (класс или числовое значение) или в котором отсутствует пропуск (все остальные точки).</li>
</ul>



<p>Алгоритм k-ближайших соседей потребует двух циклов:</p>



<ol class="wp-block-list">
<li>в <em>первом</em> цикле мы будем поочередно брать по одному вектору запроса;</li>



<li>во <em>втором</em> вложенном в него цикле мы будем для каждого вектора запроса находить расстояние до всех векторов сравнения;</li>



<li>наконец, найдя и отсортировав векторы сравнения по расстоянию, выберем для каждого вектора запроса k-ближайших соседей;</li>



<li>далее приступим к решению задачи классификации, регрессии (хотя термин регрессия здесь не вполне корректно применять) или заполнению пропуска.</li>
</ol>



<p>При большом количестве наблюдений (как векторов запроса, так и векторов сравнения) исполнение кода может занять очень много времени. Такой вариант реализации алгоритма, его еще называют <strong>методом перебора</strong> или методом опробования (brute force method), является возможным, но не единственным решением поставленной задачи.</p>



<p>Другим возможным решением является преобразование векторов сравнения в такую <strong>структуру данных</strong>, по которой поиск соседей будет происходить быстрее (то есть мы оптимизируем второй, вложенный цикл, с первым мы сделать ничего не можем, нам в любом случае нужно перебрать все векторы запроса).</p>



<p>Подобной структурой данных может быть, в частности, <strong>k-мерное дерево</strong> или <strong>k-d-дерево</strong> (k-diminsional tree, k-d tree).</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img loading="lazy" decoding="async" width="873" height="554" src="../../wp-content/uploads/2022/11/knn_types.png" alt="как устроен метод k-ближайших соседей" class="wp-image-15446" style="width:619px;height:393px" srcset="../../wp-content/uploads/2022/11/knn_types.png 873w, ../../wp-content/uploads/2022/11/knn_types-300x190.png 300w, ../../wp-content/uploads/2022/11/knn_types-768x487.png 768w, ../../wp-content/uploads/2022/11/knn_types-600x381.png 600w" sizes="auto, (max-width: 873px) 100vw, 873px" /></figure></div>


<p>Во многом сказанное выше перекликается с различиями между алгоритмами <a href="../../python/script/index.html">линейного и бинарного</a> поиска, которые мы рассмотрели ранее. В дополнительных материалах к сегодняшнему занятию мы отдельно поговорим про временную сложность алгоритмов.</p>



<h2 class="wp-block-heading" id="14-sravnenie-metodov">Сравнение методов</h2>



<p>Пришло время оценить качество алгоритмов заполнения пропусков. Для сравнения рассмотренных выше методов сделаем следующее:</p>



<ol class="wp-block-list">
<li>возьмем получившиеся в результате применения каждого из методов <em>одинаковые</em> датасеты (различаются только значения, которыми были заполнены пропуски);</li>



<li>используем модель логистической регрессии для построения прогноза выживания пассажиров; тот метод заполнения пропусков, с которым модель логистической регрессии покажется наилучший результат и будет считаться победителем.</li>
</ol>



<p>Вначале создадим два списка:</p>



<ul class="wp-block-list">
<li>в первый поместим все датасеты с заполненным столбцом Age;</li>



<li>во второй, соответствующие названия методов.</li>
</ul>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476ee592342795" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476ee592342795-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476ee592342795-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476ee592342795-1"><span class="crayon-v">datasets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-v">const_imputer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">median_imputer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr_stochastic</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">mice</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">knn</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476ee592342795-2"><span class="crayon-v">methods</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'constant'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'median'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'linear regression'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'stochastic linear regression'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'MICE'</span><span class="crayon-sy">,</span><span class="crayon-s">'KNNImputer'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Возьмем целевую переменную из исходного файла, так как мы не использовали ее при заполнении пропусков.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476f1027112091" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f1027112091-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f1027112091-1"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/train.csv'</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-s">'Survived'</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Импортируем класс <strong>LogisticRegression</strong> и функцию <strong>accuracy_score()</strong> для <a href="../../intro/classification/index.html">оценки качества модели</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476f2798996180" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f2798996180-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f2798996180-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f2798996180-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f2798996180-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">accuracy_score</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Теперь в цикле обучим модель на каждом из датасетов, сделаем прогноз, оценим и выведем результат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476f3210984685" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f3210984685-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-1"><span class="crayon-c"># в цикле пройдемся по датасетам с заполненными пропусками</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-2"><span class="crayon-c"># и списком названий соответствующих методов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-3"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">method </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">datasets</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">methods</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># масштабируем признаки</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># для каждого датасета построим и обучим модель логистической регрессии</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LogisticRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># сделаем прогноз</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">y_pred</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># выведем название использованного метода и достигнутую точность</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f3210984685-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-s">'Method: {method}, accuracy: {np.round(accuracy_score(y, y_pred), 3)}'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476f4252431521" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f4252431521-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-1">Method: constant, accuracy: 0.79</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-2">Method: median, accuracy: 0.795</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-3">Method: binned median, accuracy: 0.808</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-4">Method: linear regression, accuracy: 0.808</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-5">Method: stochastic linear regression, accuracy: 0.796</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-6">Method: MICE, accuracy: 0.808</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f4252431521-7">Method: KNNImputer, accuracy: 0.802</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Мы видим, что, используя более сложные методы заполнения пропусков, мы в среднем добились более высокой точности финальной модели.</p>



<p>Отдельно обратите внимание на хорошие результаты заполнения пропусков внутригрупповой медианой (binned median) и наоборот невысокую точность алгоритма стохастической линейной регрессии. Во втором случае, снижение точности объясняется как раз тем, что мы чаще не угадывали куда должна двигаться вариативность, нежели оказывались правы.</p>



<hr class="wp-block-separator has-css-opacity"/>



<p><strong>Уточнение</strong>. Хотя в классификации выше метод заполнения внутригрупповым показателем отнесен к одномерным методам, де факто это метод многомерный, поскольку среднее или медиана столбца с пропусками рассчитываются на основе группировки по другим столбцам датасета.</p>



<p><strong>Дополнение</strong>. Еще одним способом работы с пропусками является создание <em>переменной-индикатора</em> (indicator method), которая принимает значение 1, если пропуск присутствует, и 0, если отсутствует.</p>



<hr class="wp-block-separator has-css-opacity"/>



<p>На отдельной странице приведены <a href="../missing-add/index.html">дополнительные материалы</a> к этому занятию.</p>



<h2 class="wp-block-heading" id="15-podvedem-itog">Подведем итог</h2>



<p>Сегодня мы рассмотрели теоретические основы, а также практические способы заполнения пропусков в перекрестных данных.</p>



<p>В частности мы узнали, что пропуски можно заполнить, используя одномерные или многомерные методы. Сравнение этих методов показало, что многомерные методы в среднем показывают более высокие результаты.</p>



<h3 class="wp-block-heading" id="17-otvety-na-voprosy">Ответы на вопросы</h3>



<p><strong>Вопрос</strong>. Что такое hot-deck imputation?</p>



<p><strong>Ответ</strong>. <em>Hot-deck imputation</em> или <strong>метод горячей колоды</strong> предполагает, что мы используем данные того же датасета для заполнения пропусков. Внутри hot-deck imputation есть несколько различных способов заполнения пропусков:</p>



<ul class="wp-block-list">
<li>в простейшем варианте мы случайным образом берем непропущенное наблюдение и используем его для заполнения пропуска;</li>



<li>кроме этого, мы можем отсортировать данные по имеющимся признакам и заполнить пропуски предыдущим значением (last observation carried forward, LOCF); читается, что таким образом мы заполняем пропуски наиболее близкими значениями;</li>



<li>подход LOCF можно модифицировать и предварительно разбить данные на подгруппы.</li>
</ul>



<p>Помимо этого существует и <em>cold-deck imputation</em> или <strong>метод холодной колоды</strong>, когда данные для заполнения пропусков берутся из другого датасета.</p>



<p>Терминологически &#171;колодой&#187; (deck of cards) называли <a href="https://en.wikipedia.org/wiki/File:Punched_card_program_deck.agr.jpg" target="_blank" rel="noreferrer noopener">стопку</a>⧉ <em>перфокарт</em> (punched cards), на которые записывались данные или программа. При этом горячей называлась используемая сейчас &#171;колода&#187;, холодной &#8212; та, которая была отложена.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Что делать, если пропуски заполнены каким-либо символом, а не NaN? Например, знаком вопроса.</p>



<p><strong>Ответ</strong>. Вначале нужно превратить этот или эти символы в NaN, а дальше работать как со стандартными пропусками.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476f5557590806" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f5557590806-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f5557590806-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f5557590806-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f5557590806-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f5557590806-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f5557590806-1"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f5557590806-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-s">'?'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f5557590806-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">[</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'?'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f5557590806-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f5557590806-5"><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="294" height="423" src="../../wp-content/uploads/2022/11/nan_question.jpg" alt="пропуски в виде знаков вопроса" class="wp-image-15986" style="width:117px;height:169px" srcset="../../wp-content/uploads/2022/11/nan_question.jpg 294w, ../../wp-content/uploads/2022/11/nan_question-209x300.jpg 209w" sizes="auto, (max-width: 294px) 100vw, 294px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa625b476f7349993770" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa625b476f7349993770-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa625b476f7349993770-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa625b476f7349993770-1"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">'?'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">nan</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa625b476f7349993770-2"><span class="crayon-v">df</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="421" height="419" src="../../wp-content/uploads/2022/11/nan_answer.jpg" alt="преобразование вопросительных знаков в NAN" class="wp-image-15987" style="width:161px;height:160px" srcset="../../wp-content/uploads/2022/11/nan_answer.jpg 421w, ../../wp-content/uploads/2022/11/nan_answer-300x300.jpg 300w, ../../wp-content/uploads/2022/11/nan_answer-150x150.jpg 150w" sizes="auto, (max-width: 421px) 100vw, 421px" /></figure>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Чем метод <strong>.isnull()</strong> отличается от метода <strong>.isna()</strong>?</p>



<p><strong>Ответ</strong>. Это одно и то же.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Некоторые авторы указывают, что пропуски типа MNAR зависят только от отсутствующих значений. Другими словами,</p>



<p class="has-text-align-center">Р (П | Н, О) = $f$(O)</p>



<p><strong>Ответ</strong>. Да, действительно, встречаются разные определения. Здесь важно, что пропуски типа MNAR в любом случае в какой-то степени зависят именно от отсутствующих значений, о которых мы по определению ничего не знаем, а значит не знаем как предсказывать такие пропуски.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Какие библиотеки для заполнения пропусков существуют на R?</p>



<p><strong>Ответ</strong>. Посмотрите <a href="https://steffenmoritz.github.io/imputeTS/index.html" target="_blank" rel="noreferrer noopener">imputeTS</a>⧉.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"data\\\/missing-02\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
