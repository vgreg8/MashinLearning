<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Проверка градиента | Обучение модели</title>
	<meta name="description" content="Проверка градиента нейросети позволяет оценить правильность частных производных относительно каждого из параметров модели." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Проверка градиента | Обучение модели" />
	<meta property="og:description" content="Проверка градиента нейросети позволяет оценить правильность частных производных относительно каждого из параметров модели." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/learning/gradcheck/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2025-02-02T14:15:15+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2024/10/one-sided.png" />
	<meta property="og:image:width" content="1219" />
	<meta property="og:image:height" content="892" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="9 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/learning/gradcheck/","url":"https://www.dmitrymakarov.ru/learning/gradcheck/","name":"Проверка градиента | Обучение модели","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/learning/gradcheck/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/learning/gradcheck/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2024/10/one-sided-1024x749.png","datePublished":"2024-10-15T10:04:59+00:00","dateModified":"2025-02-02T14:15:15+00:00","description":"Проверка градиента нейросети позволяет оценить правильность частных производных относительно каждого из параметров модели.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/learning/gradcheck/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/learning/gradcheck/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/learning/gradcheck/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2024/10/one-sided.png","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2024/10/one-sided.png","width":1219,"height":892},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/learning/gradcheck/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Обучение модели","item":"https://www.dmitrymakarov.ru/learning/"},{"@type":"ListItem","position":3,"name":"Проверка градиента"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-32240 page-child parent-pageid-5658 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa621c61e8e">Поиск:</label>
	<input type="search" id="search-form-67aa621c61e8e" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa621c61f0d">Поиск:</label>
	<input type="search" id="search-form-67aa621c61f0d" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-32240 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Проверка градиента</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Обучение модели</a></p>



<p>При <a href="../neural/index.html">нахождении частных производных</a> нейросети несложно допустить ошибку. Одновременно, в силу сложности алгоритма, даже в этом случае модель может по-прежнему выдавать достаточно хороший результат.</p>



<p>Оценить правильность расчета частных производных можно с помощью метода <strong>проверки градиента</strong> (gradient checking).</p>



<h2 class="wp-block-heading" id="0-osnovnaya-ideya">Основная идея</h2>



<p>Основная идея заключается в том, что $(1)$ значение градиента, рассчитанное нейросетью в процессе обратного распространения ошибки при некоторых весах $\theta,$ должно примерно соответствовать $(2)$ его численной оценке в этой точке.</p>



<p>$$ \nabla J (\theta) \approx \frac{J(\theta + \varepsilon)-J(\theta-\varepsilon)}{2 \varepsilon} $$</p>



<p>Начнем разбирать это выражение.</p>



<h3 class="wp-block-heading" id="1-znachenie-gradienta">Значение градиента</h3>



<p>Первый компонент, значение градиента, найти не сложно:</p>



<ul class="wp-block-list">
<li>необходимо задать некоторые веса $\theta;$</li>



<li>рассчитать уровень ошибки через прямое распространение; и</li>



<li>найти производные относительно каждого $\theta$ всех слоев нейросети.</li>
</ul>



<p>Другими словами выполнить одну эпоху обучения нейросети, но только не обновлять веса $\theta,$ а ограничиться расчетом градиента.</p>



<p>$$ \theta_j := \theta_j-\alpha {\color{Orange} \nabla J (\theta) } $$</p>



<h3 class="wp-block-heading" id="2-chislennaya-otsenka-gradienta">Численная оценка градиента</h3>



<p>Второй компонент, численная оценка градиента, есть не что иное, как значение градиента, рассчитанное через <a href="../derivative/index.html">отношение приращений</a>.</p>



<figure class="wp-block-image size-large is-resized"><img fetchpriority="high" decoding="async" width="1024" height="749" src="../../wp-content/uploads/2024/10/one-sided-1024x749.png" alt="проверка градиента: односторонняя оценка производной" class="wp-image-32471" style="width:487px;height:auto" srcset="../../wp-content/uploads/2024/10/one-sided-1024x749.png 1024w, ../../wp-content/uploads/2024/10/one-sided-300x220.png 300w, ../../wp-content/uploads/2024/10/one-sided-768x562.png 768w, ../../wp-content/uploads/2024/10/one-sided-1200x878.png 1200w, ../../wp-content/uploads/2024/10/one-sided-600x439.png 600w, ../../wp-content/uploads/2024/10/one-sided.png 1219w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Вспомним, что при стремлении $\Delta w$ к нулю, мы получим точное значение производной в точке $w.$ </p>



<p>$$ f'(w) = \lim\limits_{\Delta w \to 0} \frac {f(w+\Delta w)-f(w)}{\Delta w} $$</p>



<p>Конечно, компьютер не позволит нам бесконечно уменьшать значение $\Delta w$, однако мы можем положить это значение очень малым, и тогда численная (то есть найденная с помощью компьютера) оценка должна быть примерно равна значению производной.</p>



<p>$$ f'(w) \approx \frac {f(w+\Delta w)-f(w)}{\Delta w} $$</p>



<p>Заменим $\Delta w$ на $\varepsilon$, а $w$ на $\theta$ для сохранения предложенной выше нотации. Кроме того, будем брать точку для расчета секущей линии не с одной стороны (one-sided) от параметра, а с двух (two-sided) на расстоянии $\pm \varepsilon$ от $\theta.$</p>



<figure class="wp-block-image size-large is-resized"><img decoding="async" width="1024" height="792" src="../../wp-content/uploads/2024/10/two-sided-1024x792.png" alt="проверка градиента: двухсторонняя оценка производной" class="wp-image-32474" style="width:485px;height:auto" srcset="../../wp-content/uploads/2024/10/two-sided-1024x792.png 1024w, ../../wp-content/uploads/2024/10/two-sided-300x232.png 300w, ../../wp-content/uploads/2024/10/two-sided-768x594.png 768w, ../../wp-content/uploads/2024/10/two-sided-600x464.png 600w, ../../wp-content/uploads/2024/10/two-sided.png 1176w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Так мы получим,</p>



<p>$$ f'(\theta) \approx \frac{f(\theta + \varepsilon)-f(\theta-\varepsilon)}{2 \varepsilon} $$</p>



<p>Если выданное нейросетью значение градиента совпадет в пределах некоторого небольшого порога с его численной оценкой, значит обратное распространение работает правильно.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/12m8W_S30YKxlIIAs_8c4A2pkSaGeKpaV?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<h2 class="wp-block-heading" id="3-prostye-primery">Простые примеры</h2>



<h3 class="wp-block-heading" id="4-odin-parametr">Один параметр</h3>



<p>Вначале приведем простой пример с одним параметром. Рассмотрим следующую функцию потерь.</p>



<p>$$ f(\theta) = \theta^2 $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af49914841157" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af49914841157-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af49914841157-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af49914841157-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af49914841157-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<p>Производная этой функции равна $ f'(\theta) = 2 \theta .$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af52371060142" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af52371060142-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af52371060142-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af52371060142-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">derivative</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af52371060142-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">theta</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Положим $ \theta = 3 $ и найдем значение производной в этой точке.</p>



<p>$$ f'(3) = 2 \cdot 3 = 6 $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af53862565457" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af53862565457-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af53862565457-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af53862565457-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af53862565457-1"><span class="crayon-v">theta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af53862565457-2"><span class="crayon-v">deriv</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">derivative</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af53862565457-3"><span class="crayon-v">deriv</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af54637019449" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af54637019449-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af54637019449-1">6</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Это первый компонент. Теперь выполним численную оценку производной в этой же точке, положив $\varepsilon = 1\mathrm{e}{-7}.$</p>



<p>$$ f&#8217;_{\text{numeric}} = \frac{f(\theta + \varepsilon)-f(\theta-\varepsilon)}{2 \varepsilon} = $$</p>



<p>$$ \frac{f(3 + 1\mathrm{e}{-7})-f(3-1\mathrm{e}{-7})}{2 \cdot 1\mathrm{e}{-7}} \approx 5{,}999999 $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af56370931106" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af56370931106-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af56370931106-1"><span class="crayon-v">eps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af57242947981" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af57242947981-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af57242947981-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af57242947981-1"><span class="crayon-v">derivNumeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af57242947981-2"><span class="crayon-v">derivNumeric</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af58241496285" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af58241496285-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af58241496285-1">5.999999990180527</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Если разница между значением производной и ее численной оценкой меньше, чем $ \varepsilon,$ то можно считать, что производная взята верно.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af59165848150" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af59165848150-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af59165848150-1"><span class="crayon-v">deriv</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">derivNumeric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">deriv</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">derivNumeric</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">eps</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af5a457242618" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5a457242618-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5a457242618-1">(9.819473234529141e-09, True)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="5-dva-parametra">Два параметра</h3>



<p>Рассмотрим функцию потерь с двумя параметрами</p>



<p>$$ f(\theta_1, \theta_2) = \theta_1^2 + \theta_2^2 $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af5b998390651" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5b998390651-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af5b998390651-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5b998390651-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af5b998390651-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">theta1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>и соответствующими частными производными</p>



<p>$$ \frac{ \partial }{ \partial \theta_1 } f( \theta_1, \theta_2 ) = 2 \theta_1, \quad \frac{ \partial }{ \partial \theta_2 } f( \theta_1, \theta_2 ) = 2 \theta_2 $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af5c356303132" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5c356303132-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af5c356303132-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5c356303132-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">partial1</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af5c356303132-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">theta1</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af5d901062152" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5d901062152-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af5d901062152-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5d901062152-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">partial2</span><span class="crayon-sy">(</span><span class="crayon-v">theta2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af5d901062152-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Найдем значение градиента в точке $(3, 4).$</p>



<p>$$ \nabla f( 3, 4 ) = \begin{bmatrix}&nbsp; \frac{ \partial }{ \partial \theta_1 } \\&nbsp; \frac{ \partial }{ \partial \theta_1 } &nbsp;\end{bmatrix} f( 3, 4 ) = \begin{bmatrix}&nbsp; 2 \cdot 3 \\&nbsp; 2 \cdot 4 &nbsp;\end{bmatrix} = \begin{bmatrix}&nbsp; 6 \\&nbsp; 8 &nbsp;\end{bmatrix} $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af5e334490455" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5e334490455-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af5e334490455-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5e334490455-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5e334490455-1"><span class="crayon-v">theta1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af5e334490455-2"><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-e">partial2</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">partial2</span><span class="crayon-sy">(</span><span class="crayon-v">theta2</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5e334490455-3"><span class="crayon-v">grad</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af5f604324608" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af5f604324608-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af5f604324608-1">array([6, 8])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Численную оценку при этом будем проводить, находя отношение приращений отдельно по каждому измерению</p>



<p>$$ \frac{ \partial }{ \partial \theta_1 } f( \theta_1, \theta_2 ) \approx \frac{ f( \theta_1 + \varepsilon, \theta_2 )-(\theta_1-\varepsilon, \theta_2) }{ 2\varepsilon } $$</p>



<p>$$ \frac{ \partial }{ \partial \theta_2 } f( \theta_1, \theta_2 ) \approx \frac{ f( \theta_1, \theta_2 + \varepsilon )-(\theta_1, \theta_2-\varepsilon ) }{ 2\varepsilon } $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af60261157806" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af60261157806-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af60261157806-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af60261157806-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af60261157806-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af60261157806-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af60261157806-1"><span class="crayon-v">partial1Numeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af60261157806-2"><span class="crayon-v">partial2Numeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">theta1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">eps</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af60261157806-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af60261157806-4"><span class="crayon-v">gradNumeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">partial1Numeric</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">partial1Numeric</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af60261157806-5"><span class="crayon-v">gradNumeric</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af61960422963" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af61960422963-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af61960422963-1">array([5.99999998, 8.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Оценим разницу между значением градиента и его численной оценкой по формуле</p>



<p>$$ \text{difference} = \frac{ || \nabla f(\theta)_{\text{numeric}}-\nabla f(\theta) ||_2 }{ || \nabla f(\theta)_{\text{numeric}} ||_2+|| \nabla f(\theta) ||_2} $$</p>



<p>В числителе мы находим евклидово расстояние разницы между фактическим градиентом и его численной оценкой, а в знаменателе нормализуем эту разницу на сумму длин соответствующих векторов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af62669292676" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af62669292676-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af62669292676-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af62669292676-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af62669292676-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af62669292676-1"><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af62669292676-2"><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af62669292676-3"><span class="crayon-v">difference</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">denominator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af62669292676-4"><span class="crayon-v">difference</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">difference</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">eps</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af79694902789" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af79694902789-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af79694902789-1">(9.637876920383396e-10, True)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Перейдем к проверке частных производных нейросети.</p>



<h2 class="wp-block-heading" id="6-proverka-gradienta-neyroseti">Проверка градиента нейросети</h2>



<p>Для проверки градиента нейросети необходимо сравнить фактическое значение частной производной каждого из $\theta_j$ параметров с соответствующей численной оценкой.</p>



<p>$$ \begin{array}{cc} \frac{ \partial }{ \partial \theta_1 } J(\theta) &amp; \approx &amp; \frac{ J( \theta_1 + \varepsilon, \theta_2, \theta_3, \ldots, \theta_j )-J(\theta_1-\varepsilon, \theta_2, \theta_3, \ldots, \theta_j ) }{ 2\varepsilon } \\ \frac{ \partial }{ \partial \theta_2 } J(\theta) &amp; \approx &amp; \frac{ J( \theta_1, \theta_2 + \varepsilon, \theta_3, \ldots, \theta_j )-J(\theta_1, \theta_2-\varepsilon, \theta_3, \ldots, \theta_j ) }{ 2\varepsilon } \\ \frac{ \partial }{ \partial \theta_3 } J(\theta) &amp; \approx &amp; \frac{ J( \theta_1, \theta_2, \theta_3 + \varepsilon, \ldots, \theta_j )-J(\theta_1, \theta_2, \theta_3-\varepsilon, \ldots, \theta_j ) }{ 2\varepsilon } \\ \ldots &amp; &amp; \ldots \\ \frac{ \partial }{ \partial \theta_j } J(\theta) &amp; \approx &amp; \frac{ J( \theta_1, \theta_2, \theta_3, \ldots, \theta_j + \varepsilon )-J(\theta_1, \theta_2, \theta_3, \ldots, \theta_j-\varepsilon ) }{ 2 \varepsilon } \end{array} $$</p>



<p>Технически нам нужно будет сформировать два вектора, $ \nabla J(\theta) $ и $ \nabla_{\text{numeric}} J(\theta) $ и сравнить их через нормализованное евклидово расстояние.</p>



<h3 class="wp-block-heading" id="7-podgotovka-dannykh">Подготовка данных</h3>



<p>В первую очередь подготовим данные. Возьмем небольшой датасет о вине из библиотеки sklearn, поскольку проверка градиета является вычислительно затратной операцией и, например, на данных MNIST будет выполняться очень долго.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af7b521857904" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7b521857904-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-1"><span class="crayon-c"># возьмем функцию для one-hot encoding</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">ohe</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">unique</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">zeros_matrix</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">examples</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">features</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">row</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">digit</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">zeros_matrix</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">zeros_matrix</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-v">digit</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7b521857904-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">zeros_matrix</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af7c742844592" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7c742844592-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-1"><span class="crayon-c"># подгрузим данные</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">load_wine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-4"><span class="crayon-c"># сформируем две матрицы Numpy, в которых наблюдения будут столбцами</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-5"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">feature_names</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-6"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-v">values</span><span class="crayon-sy">.</span><span class="crayon-i">T</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-7"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">target</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-8"><span class="crayon-v">y_enc</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ohe</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">T</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7c742844592-10"><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">.</span><span class="crayon-v">shap</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af7d842949987" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7d842949987-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7d842949987-1">((13, 178), (3, 178))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как мы видим, у нас будет 13 признаков, 178 наблюдений и 3 класса целевой переменной.</p>



<h3 class="wp-block-heading" id="8-arkhitektura-seti">Архитектура сети</h3>



<p>Проверим градиент нейросети, которую мы <a href="../neural/index.html">создали</a> в конце основного занятия с тем отличием, что</p>



<ul class="wp-block-list">
<li>мы уменьшим количество нейронов входного слоя до 13-ти (вместо 784 пикселей картинок MNIST); </li>



<li>выходной слой будет состоять из трех нейронов по числу классов целевой переменной;</li>



<li>два скрытых слоя будут содержать не 64, а 16 нейронов.</li>
</ul>



<p>При этом функции активации (сигмоиду и softmax), а также функция потерь (категориальная кросс-энтропия) сохранятся и в текущей архитектуре. Кроме этого, сохраним смещение.</p>



<figure class="wp-block-image size-large"><img decoding="async" width="1024" height="522" src="../../wp-content/uploads/2024/10/image-4-1024x522.png" alt="архитектура нейросети с проверкой градиента" class="wp-image-32511" srcset="../../wp-content/uploads/2024/10/image-4-1024x522.png 1024w, ../../wp-content/uploads/2024/10/image-4-300x153.png 300w, ../../wp-content/uploads/2024/10/image-4-768x391.png 768w, ../../wp-content/uploads/2024/10/image-4-1536x783.png 1536w, ../../wp-content/uploads/2024/10/image-4-1200x612.png 1200w, ../../wp-content/uploads/2024/10/image-4-600x306.png 600w, ../../wp-content/uploads/2024/10/image-4.png 1717w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Примечание. Обратите внимание, по сравнению с предыдущими архитектурами, мы перестали называть входящий слой (данные) $A^{(1)}$ и просто сохраним обозначение X (подобную замену мы делали для единообразия нотации и наглядности).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af7f628031461" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af7f628031461-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af7f628031461-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af7f628031461-1"><span class="crayon-c"># в частности в коде исчезла вот эта строчка</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af7f628031461-2"><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Таким образом, индексы активационных слоев сместятся на один вперед.</p>



<p>В результате предложенных изменений частные производные останутся прежними. Сократится лишь количество весов. Если в архитектуре нейросети для MNIST у нас было</p>



<p>$$ \underbrace { 64 \cdot 784 }_{W^{(1)}} + \underbrace { 64 \cdot 1 }_{b^{(1)}} + \underbrace { 64 \cdot 64 }_{W^{(2)}} + \underbrace { 64 \cdot 1 }_{b^{(2)}} + \underbrace { 10 \cdot 64 }_{W^{(3)}} + \underbrace { 10 \cdot 1 }_{b^{(3)}} = 55050 $$</p>



<p>параметров, то благодаря предложенным изменениям их останется только</p>



<p>$$ 16 \cdot 13 + 16 \cdot 1 + 16 \cdot 16 + 16 \cdot 1 + 3 \cdot 16 + 3 \cdot 1 = 547 $$</p>



<p>Это существенно ускорит выполнение кода.</p>



<h3 class="wp-block-heading" id="9-neobkhodimye-funktsii">Необходимые функции</h3>



<p>Объявим необходимые для данной архитектуры функции.</p>



<h4 class="wp-block-heading" id="10-sluzhebnye-funktsii">Служебные функции</h4>



<p>Начнем с функций активации, а также целевой функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af80027100373" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af80027100373-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-5"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">softmax</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">numerator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">softmax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">denominator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-10"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">softmax</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-12"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">cross_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">probs</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">ce</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">y_enc</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">probs</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af80027100373-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">ce</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
</div>



<p>Кроме этого, поместим в отдельные функции код</p>



<ul class="wp-block-list">
<li>инициализации параметров;</li>



<li>прямого; и</li>



<li>обратного распространения.</li>
</ul>



<h4 class="wp-block-heading" id="11-initsializatsiya-parametrov">Инициализация параметров</h4>



<p>Функция инициализации параметров на вход примет данные и точку отсчета для повторимости результата, а на выходе выдаст словарь из весов $W^{(1)}, W^{(2)}, W^{(3)}$ и смещений $b^{(1)}, b^{(2)}, b^{(3)}.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af82994049613" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af82994049613-16">16</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-v">random_state</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af82994049613-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
</div>



<h4 class="wp-block-heading" id="12-pryamoe-i-obratnoe-rasprostranenie">Прямое и обратное распространение</h4>



<p>После этого,</p>



<ul class="wp-block-list">
<li>функция прямого распространения один раз получит случайные начальные параметры от функции инициализации; а затем</li>



<li>в цикле:
<ul class="wp-block-list">
<li>будет взаимодействовать с функцией обратного распространения через кортеж параметров и значений активационных функций cache;</li>



<li>функция же обратного распространения будет выдавать словарь обновленных параметров, которые станут новыми входными данными прямого распространения на следующей эпохе.</li>
</ul>
</li>
</ul>



<p>Дополнительно, функция прямого распространения будет выдавать уровень ошибки, а обратного &#8212; словарь со значениями текущих частных производных $\frac{ \partial J}{ \partial W^{(1)} }, \frac{ \partial J}{ \partial W^{(2)} }, \frac{ \partial J}{ \partial W^{(3)} }$ и $\frac{ \partial J}{ \partial b^{(1)} }, \frac{ \partial J}{ \partial b^{(2)} }, \frac{ \partial J}{ \partial b^{(3)} }.$ Они понадобятся для выполнения проверки градиента.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="391" src="../../wp-content/uploads/2024/10/image-5-1024x391.png" alt="схема обучения нейронной сети" class="wp-image-32536" style="width:720px;height:auto" srcset="../../wp-content/uploads/2024/10/image-5-1024x391.png 1024w, ../../wp-content/uploads/2024/10/image-5-300x115.png 300w, ../../wp-content/uploads/2024/10/image-5-768x293.png 768w, ../../wp-content/uploads/2024/10/image-5-1536x586.png 1536w, ../../wp-content/uploads/2024/10/image-5-2048x782.png 2048w, ../../wp-content/uploads/2024/10/image-5-1200x458.png 1200w, ../../wp-content/uploads/2024/10/image-5-600x229.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af84379758873" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af84379758873-25">25</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W1'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b1'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W2'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b2'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W3'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b3'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-13"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-16"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-19"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">softmax</span><span class="crayon-sy">(</span><span class="crayon-v">Z3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">cross_entropy</span><span class="crayon-sy">(</span><span class="crayon-v">A3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">cache</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">A1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af84379758873-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af86460748553" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af86460748553-38">38</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">backward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-v">A1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-i">cache</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W3_delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">A3</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2_delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W3</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W3_delta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W1_delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W2_delta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W3_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W3_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b3_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W3_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b2_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W2_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W1_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W1_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b1_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W1_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-22"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">W3</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">W3_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-23"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b3</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">b3_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-24"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">W2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">W2_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-25"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">b2_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-26"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">W1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">W1_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-27"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">b1_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-29"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-30">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-s">'dW3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">W3_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-32"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-s">'db3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">b3_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-33"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-s">'dW2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">W2_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-34"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-s">'db2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">b2_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-35"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-s">'dW1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">W1_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-36"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-s">'db1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">b1_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af86460748553-38"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradients</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0025 seconds] -->
</div>



<h3 class="wp-block-heading" id="13-obuchenie-i-prognoz">Обучение и прогноз</h3>



<p>Обучим модель, сделаем прогноз (пока без проверки градиента) и оценим его качество.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af87613661706" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af87613661706-23">23</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">fit_nn</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># функция backward() выдает два словаря: parameters и gradients</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># словарь gradients пока не нужен, и мы оставляем _</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">backward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Эпоха:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Ошибка:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'-----------------------'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss_history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Итоговая ошибка'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Нейросеть успешно обучена'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af87613661706-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss_history</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af89661071452" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af89661071452-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">predict_nn</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W1'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b1'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W2'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b2'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W3'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b3'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-11"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-13"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b3</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-15"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">softmax</span><span class="crayon-sy">(</span><span class="crayon-v">Z3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af89661071452-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">A3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af8a337747667" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8a337747667-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8a337747667-1"><span class="crayon-v">params</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">fit_nn</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af8b379438289" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8b379438289-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-1">Эпоха: 0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-2">Ошибка: 2.688947392020406</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-3">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-4">Эпоха: 400</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-5">Ошибка: 0.12260412116100283</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-6">-----------------------</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-7">Эпоха: 800</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-8">Ошибка: 0.06027754882884962</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-9">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-10">Эпоха: 1200</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-11">Ошибка: 0.03802885456674395</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-12">-----------------------</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-13">Эпоха: 1600</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-14">Ошибка: 0.02675376526940447</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-15">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-16">Итоговая ошибка 0.020180935722946634</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8b379438289-17">Нейросеть успешно обучена</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af8c675538155" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8c675538155-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8c675538155-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8c675538155-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8c675538155-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8c675538155-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">l_history</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8c675538155-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Loss history'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8c675538155-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'loss'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8c675538155-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'iterations'</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="567" height="455" src="../../wp-content/uploads/2024/10/l_history.png" alt="график изменения функции потерь" class="wp-image-32539" srcset="../../wp-content/uploads/2024/10/l_history.png 567w, ../../wp-content/uploads/2024/10/l_history-300x241.png 300w" sizes="auto, (max-width: 567px) 100vw, 567px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af8d960863744" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8d960863744-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af8d960863744-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8d960863744-1"><span class="crayon-v">y_pred</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">predict_nn</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">params</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af8d960863744-2"><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af8e213428268" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af8e213428268-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af8e213428268-1">1.0</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Перейдем к проверке градиента этой нейросети.</p>



<h3 class="wp-block-heading" id="14-proverka-gradienta-posle-initsializatsii">Проверка градиента после инициализации</h3>



<p>Вначале сравним фактические градиенты с их численной оценкой сразу после инициализации параметров. Для этого сделаем следующее:</p>



<ol class="wp-block-list">
<li>инициализируем параметры и поместим их в словарь;</li>



<li>найдем фактические значения градиентов при этих параметрах,
<ul class="wp-block-list">
<li>получив их из функции обратного распространения; и</li>



<li>преобразовав словарь в длинный вектор из 547 градиентов;</li>
</ul>
</li>



<li>выполним численную оценку градиента для каждого из параметров, для чего
<ul class="wp-block-list">
<li>сформируем вектор из 547 параметров;</li>



<li>в цикле пройдемся по каждому из этих параметров и численно оценим соответствующую частную производную через $ \frac{ J( \theta_j + \varepsilon )-J(\theta_j-\varepsilon ) }{ 2 \varepsilon } ;$ и</li>



<li>сформируем вектор из 547 численных оценок градиентов; наконец</li>
</ul>
</li>



<li>сравним фактические градиенты с их численной оценкой через нормализованное евклидово расстояние.</li>
</ol>



<h4 class="wp-block-heading" id="15-perekhod-ot-slovarya-k-vektoru-i-obratno">Переход от словаря к вектору и обратно</h4>



<h5 class="wp-block-heading" id="16-slovar-gradientov-v-vektor">Словарь градиентов в вектор</h5>



<p>Во втором пункте приведенной выше последовательности шагов нам нужно преобразовать словарь с ключами dW1, db1, dW2, db2, dW3, db3 в вектор размерностью (547, 1).</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="305" src="../../wp-content/uploads/2024/10/image-6-1024x305.png" alt="преобразование словаря градиентов в вектор" class="wp-image-32550" srcset="../../wp-content/uploads/2024/10/image-6-1024x305.png 1024w, ../../wp-content/uploads/2024/10/image-6-300x89.png 300w, ../../wp-content/uploads/2024/10/image-6-768x229.png 768w, ../../wp-content/uploads/2024/10/image-6-1536x458.png 1536w, ../../wp-content/uploads/2024/10/image-6-1200x358.png 1200w, ../../wp-content/uploads/2024/10/image-6-600x179.png 600w, ../../wp-content/uploads/2024/10/image-6.png 1987w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Для этого, в цикле пройдемся по ключам словаря градиентов, &#171;<a href="../../intro/cv/index.html">вытянем</a>&#187; соответствующие матрицы значений и соединим их через <strong>функцию np.concatenate()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af90894324976" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af90894324976-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af90894324976-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af90894324976-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af90894324976-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af90894324976-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af90894324976-1"><span class="crayon-c"># на вход функция примет словарь градиентов и</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af90894324976-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradients_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">gradients</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af90894324976-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af90894324976-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># создаст массив из "вытянутых" значений словаря</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af90894324976-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">gradients</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">key </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'dW1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'dW2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'dW3'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'db3'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<h5 class="wp-block-heading" id="17-slovar-parametrov-v-vektor">Словарь параметров в вектор</h5>



<p>Третий пункт предполагает, что мы аналогичным образом преобразуем словарь параметров в вектор.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="134" src="../../wp-content/uploads/2024/10/image-7-1024x134.png" alt="преобразование словаря параметров в вектор" class="wp-image-32557" srcset="../../wp-content/uploads/2024/10/image-7-1024x134.png 1024w, ../../wp-content/uploads/2024/10/image-7-300x39.png 300w, ../../wp-content/uploads/2024/10/image-7-768x100.png 768w, ../../wp-content/uploads/2024/10/image-7-1536x201.png 1536w, ../../wp-content/uploads/2024/10/image-7-2048x268.png 2048w, ../../wp-content/uploads/2024/10/image-7-1200x157.png 1200w, ../../wp-content/uploads/2024/10/image-7-600x78.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af92128268645" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af92128268645-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af92128268645-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af92128268645-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">dictionary_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af92128268645-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">concatenate</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-v">key</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">key </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'W1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'b1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'W2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'b2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'W3'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'b3'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<h5 class="wp-block-heading" id="18-vektor-parametrov-v-slovar">Вектор параметров в словарь</h5>



<p>Наконец в том же третьем пункте для того, чтобы рассчитать $ J( \theta_j + \varepsilon ) $ и $ J(\theta_j-\varepsilon ) $ нам необходимо поместить в словарь векторы $\theta_j + \varepsilon$ и $\theta_j + \varepsilon$ размерностью (547, 1) перед их &#171;отправкой&#187; в функцию прямого распространения.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="134" src="../../wp-content/uploads/2024/10/image-8-1024x134.png" alt="преобразование вектора параметров в словарь" class="wp-image-32559" srcset="../../wp-content/uploads/2024/10/image-8-1024x134.png 1024w, ../../wp-content/uploads/2024/10/image-8-300x39.png 300w, ../../wp-content/uploads/2024/10/image-8-768x101.png 768w, ../../wp-content/uploads/2024/10/image-8-1536x202.png 1536w, ../../wp-content/uploads/2024/10/image-8-2048x269.png 2048w, ../../wp-content/uploads/2024/10/image-8-1200x158.png 1200w, ../../wp-content/uploads/2024/10/image-8-600x79.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af93127655139" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af93127655139-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">vector_to_dictionary</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">208</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">13</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b1'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-cn">208</span><span class="crayon-o">:</span><span class="crayon-cn">224</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-cn">224</span><span class="crayon-o">:</span><span class="crayon-cn">480</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b2'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-cn">480</span><span class="crayon-o">:</span><span class="crayon-cn">496</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'W3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-cn">496</span><span class="crayon-o">:</span><span class="crayon-cn">544</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">16</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">[</span><span class="crayon-s">'b3'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-cn">544</span><span class="crayon-o">:</span><span class="crayon-cn">547</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af93127655139-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<p>Примечание. Мы могли бы автоматизировать расчет индексов, однако в учебных целях пропишем индексы каждого из параметров вручную.</p>



<p>Перейдем непосредственно к проверке градиента.</p>



<h4 class="wp-block-heading" id="19-initsializatsiya-parametrov">Инициализация параметров</h4>



<p>Выполним инициализацию параметров.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af94792373230" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af94792373230-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af94792373230-1"><span class="crayon-v">parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h4 class="wp-block-heading" id="20-znachenie-gradienta">Значение градиента</h4>



<p>Найдем фактические значения градиентов при инициализированных параметрах и поместим их в вектор.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af96083164888" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af96083164888-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af96083164888-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af96083164888-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af96083164888-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af96083164888-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af96083164888-1"><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af96083164888-2"><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradients</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">backward</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af96083164888-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af96083164888-4"><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradients_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">gradients</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af96083164888-5"><span class="crayon-v">grad</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af97472156306" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af97472156306-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af97472156306-1">(547, 1)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="21-chislennaya-otsenka-gradienta">Численная оценка градиента</h4>



<p>Выполним численную оценку градиентов. Преобразуем словарь параметров в вектор.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af99831077492" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af99831077492-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af99831077492-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af99831077492-1"><span class="crayon-v">parameters_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dictionary_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af99831077492-2"><span class="crayon-v">parameters_values</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af9a234771031" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9a234771031-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9a234771031-1">(547, 1)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Сохраним количество параметров, а также создадим нулевые векторы для $ J( \theta_j + \varepsilon ), $ $ J(\theta_j-\varepsilon ) $ и $\nabla_{\text{numeric}} J(\theta).$ Не забудем про константу $\varepsilon.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af9b142093863" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9b142093863-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-1"><span class="crayon-v">num_parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters_values</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-3"><span class="crayon-v">J_plus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-4"><span class="crayon-v">J_minus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-6"><span class="crayon-v">gradNumeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9b142093863-8"><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<p>В цикле пройдем по каждому из 547 параметров и для каждого найдем численную оценку производной.</p>



<p>$$ \begin{array}{cc} \frac{ J( \theta_1 + \varepsilon, \theta_2, \theta_3, \ldots, \theta_{547} )-J(\theta_1-\varepsilon, \theta_2, \theta_3, \ldots, \theta_{547} ) }{ 2\varepsilon } \\ \frac{ J( \theta_1, \theta_2 + \varepsilon, \theta_3, \ldots, \theta_{547} )-J(\theta_1, \theta_2-\varepsilon, \theta_3, \ldots, \theta_{547} ) }{ 2\varepsilon } \\ \frac{ J( \theta_1, \theta_2, \theta_3 + \varepsilon, \ldots, \theta_{547} )-J(\theta_1, \theta_2, \theta_3-\varepsilon, \ldots, \theta_{547} ) }{ 2\varepsilon } \\ \ldots &amp; \\ \frac{ J( \theta_1, \theta_2, \theta_3, \ldots, \theta_{547} + \varepsilon )-J(\theta_1, \theta_2, \theta_3, \ldots, \theta_{547}-\varepsilon ) }{ 2 \varepsilon } \end{array} $$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af9c219960612" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9c219960612-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-1"><span class="crayon-c"># будем брать по одному параметру j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">thetaplus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-v">parameters_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># добавим epsilon к параметру j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">thetaplus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">thetaplus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">epsilon</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># найдем значение целевой функции J(theta) с учетом theta_j + epsilon</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">J_plus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">vector_to_dictionary</span><span class="crayon-sy">(</span><span class="crayon-v">thetaplus</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">thetaminus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-v">parameters_values</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># вычтем epsilon из параметра j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">thetaminus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">thetaminus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">epsilon</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># найдем значение целевой функции J(theta) с учетом theta_j - epsilon</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">J_minus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">vector_to_dictionary</span><span class="crayon-sy">(</span><span class="crayon-v">thetaminus</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># оценим частную производную для данного параметра j</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9c219960612-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">J_plus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">J_minus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af9d486006962" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9d486006962-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9d486006962-1"><span class="crayon-v">gradNumeric</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5af9f100900064" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5af9f100900064-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5af9f100900064-1">(547, 1)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="22-sravnenie-gradienta-s-ego-otsenkoy">Сравнение градиента с его оценкой</h4>



<p>Осталось сравнить фактическое значение градиента с его численной оценкой.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa0847452454" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa0847452454-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa0847452454-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa0847452454-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa0847452454-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa0847452454-1"><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa0847452454-2"><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa0847452454-3"><span class="crayon-v">difference</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">denominator</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa0847452454-4"><span class="crayon-v">difference</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">difference</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa1068810103" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa1068810103-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa1068810103-1">(2.779329944458319e-08, True)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Поместим приведенный выше код проверки градиента в функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa2940697069" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa2940697069-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa2940697069-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa2940697069-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa2940697069-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa2940697069-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa2940697069-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa2940697069-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradient_vector</span><span class="crayon-sy">(</span><span class="crayon-v">parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa2940697069-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa2940697069-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa2940697069-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradients</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">backward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa2940697069-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa2940697069-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">gradients_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">gradients</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa3946969562" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa3946969562-23">23</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradNumeric_vector</span><span class="crayon-sy">(</span><span class="crayon-v">parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters_values</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">dictionary_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">num_parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters_values</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">J_plus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">J_minus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-8"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">gradNumeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">num_parameters</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetaplus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-v">parameters_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetaplus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">thetaplus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">epsilon</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-15"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">J_plus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">vector_to_dictionary</span><span class="crayon-sy">(</span><span class="crayon-v">thetaplus</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetaminus</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-v">parameters_values</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetaminus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">thetaminus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">epsilon</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-19"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">J_minus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">_</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">vector_to_dictionary</span><span class="crayon-sy">(</span><span class="crayon-v">thetaminus</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">J_plus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">J_minus</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa3946969562-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa5259658665" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa5259658665-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa5259658665-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa5259658665-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa5259658665-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa5259658665-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa5259658665-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa5259658665-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa5259658665-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa5259658665-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa5259658665-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">norm</span><span class="crayon-sy">(</span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa5259658665-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa5259658665-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">denominator</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa6458119783" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afa6458119783-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradient_checking</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">params</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradient_vector</span><span class="crayon-sy">(</span><span class="crayon-v">params</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">gradNumeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradNumeric_vector</span><span class="crayon-sy">(</span><span class="crayon-v">params</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afa6458119783-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa7837336279" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa7837336279-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa7837336279-1"><span class="crayon-e">gradient_checking</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afa8982965450" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afa8982965450-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afa8982965450-1">(2.779329944458319e-08, True)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="23-proverka-gradienta-pri-obuchenii">Проверка градиента при обучении</h3>



<p>Убедимся, что значение градиента совпадает с его численной оценкой не только при начальных весах, но и в целом в процессе обучения нейросети.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afaa252056438" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afaa252056438-38">38</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">fit_nn_with_gradcheck</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># инициализируем параметры</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initialize</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># в цикле</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># сохраним текущие параметры (для проверки градиента)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">current_parameters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># выполним прямое и</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">parameters</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># обратное распространение, получив градиенты, а также</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># обновленные параметры (для дальнейшего обучения)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradients</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">backward</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cache</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lr</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># периодически</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Эпоха:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Ошибка:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># создадим вектор градиентов, а также</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradients_to_vector</span><span class="crayon-sy">(</span><span class="crayon-v">gradients</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># вектор численной оценки градиентов на основе текущих параметров,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">gradNumeric</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradNumeric_vector</span><span class="crayon-sy">(</span><span class="crayon-v">current_parameters</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># сравним эти векторы</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">difference</span><span class="crayon-sy">(</span><span class="crayon-v">grad</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">gradNumeric</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># и выведем результат сравнения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Отклонение градиента:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Проверка градиента пройдена:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">diff</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">epsilon</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'-----------------------'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Итоговая ошибка'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Нейросеть успешно обучена'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afaa252056438-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">None</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afab913998321" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afab913998321-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afab913998321-1"><span class="crayon-e">fit_nn_with_gradcheck</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_enc</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa621c5afac028473926" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa621c5afac028473926-27">27</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-1">Эпоха: 0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-2">Ошибка: 2.688947392020406</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-3">Отклонение градиента: 2.779329944458319e-08</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-4">Проверка градиента пройдена: True</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-5">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-6">Эпоха: 400</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-7">Ошибка: 0.12260412116100283</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-8">Отклонение градиента: 1.402760136760584e-08</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-9">Проверка градиента пройдена: True</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-10">-----------------------</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-11">Эпоха: 800</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-12">Ошибка: 0.06027754882884962</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-13">Отклонение градиента: 1.815097040410587e-08</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-14">Проверка градиента пройдена: True</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-15">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-16">Эпоха: 1200</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-17">Ошибка: 0.03802885456674395</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-18">Отклонение градиента: 2.294359641688344e-08</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-19">Проверка градиента пройдена: True</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-20">-----------------------</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-21">Эпоха: 1600</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-22">Ошибка: 0.02675376526940447</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-23">Отклонение градиента: 2.861245060697362e-08</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-24">Проверка градиента пройдена: True</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-25">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-26">Итоговая ошибка 0.020180935722946634</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa621c5afac028473926-27">Нейросеть успешно обучена</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Проверки пройдены успешно.</p>



<h2 class="wp-block-heading" id="24-podvedem-itog">Подведем итог</h2>



<p>Выше мы рассмотрели метод проверки правильности расчета частных производных параметров нейросети.</p>



<p>При создании нейронных сетей с помощью библиотеки (Keras, Tensorflow, PyTorch), необходимость в проверке градиента отсутствует, однако умение провести такое сравнение градиента и его численной оценки дает лучшее понимание работы алгоритма.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"learning\\\/gradcheck\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
