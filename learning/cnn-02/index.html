<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />

<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v26.8 - https://yoast.com/product/yoast-seo-wordpress/ -->
	<title>Свёрточная нейронная сеть. Часть 2</title>
	<meta name="description" content="Архитектура свёрточной нейронной сети обычно включает свёрточный слой, слой подвыборки, а также полносвязные слои." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Свёрточная нейронная сеть. Часть 2" />
	<meta property="og:description" content="Архитектура свёрточной нейронной сети обычно включает свёрточный слой, слой подвыборки, а также полносвязные слои." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/learning/cnn-02/" />
	<meta property="og:site_name" content="Дмитрий Макаров" />
	<meta property="article:modified_time" content="2025-09-04T06:52:41+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2025/03/mnist.png" />
	<meta property="og:image:width" content="822" />
	<meta property="og:image:height" content="234" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="6 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/learning/cnn-02/","url":"https://www.dmitrymakarov.ru/learning/cnn-02/","name":"Свёрточная нейронная сеть. Часть 2","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/learning/cnn-02/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/learning/cnn-02/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/03/mnist.png","datePublished":"2025-03-26T13:24:32+00:00","dateModified":"2025-09-04T06:52:41+00:00","description":"Архитектура свёрточной нейронной сети обычно включает свёрточный слой, слой подвыборки, а также полносвязные слои.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/learning/cnn-02/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/learning/cnn-02/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/learning/cnn-02/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/03/mnist.png","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2025/03/mnist.png","width":822,"height":234},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/learning/cnn-02/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Обучение модели","item":"https://www.dmitrymakarov.ru/learning/"},{"@type":"ListItem","position":3,"name":"Свёрточная нейронная сеть. Часть 2"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/17fb646123c8fccd118e1f2da611da3de8d8e72250637fb08b246e33d4c95395?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/17fb646123c8fccd118e1f2da611da3de8d8e72250637fb08b246e33d4c95395?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Дмитрий Макаров &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Дмитрий Макаров &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<style id='wp-img-auto-sizes-contain-inline-css' type='text/css'>
img:is([sizes=auto i],[sizes^="auto," i]){contain-intrinsic-size:3000px 1500px}
/*# sourceURL=wp-img-auto-sizes-contain-inline-css */
</style>

<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.9.0.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.9.0.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.9.0.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
/*# sourceURL=wp-emoji-styles-inline-css */
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.9.css' type='text/css' media='all' />
<style id='wp-block-heading-inline-css' type='text/css'>
h1:where(.wp-block-heading).has-background,h2:where(.wp-block-heading).has-background,h3:where(.wp-block-heading).has-background,h4:where(.wp-block-heading).has-background,h5:where(.wp-block-heading).has-background,h6:where(.wp-block-heading).has-background{padding:1.25em 2.375em}h1.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h1.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h2.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h2.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h3.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h3.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h4.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h4.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h5.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h5.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]),h6.has-text-align-left[style*=writing-mode]:where([style*=vertical-lr]),h6.has-text-align-right[style*=writing-mode]:where([style*=vertical-rl]){rotate:180deg}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/heading/style.min.css */
</style>
<style id='wp-block-image-inline-css' type='text/css'>
.wp-block-image>a,.wp-block-image>figure>a{display:inline-block}.wp-block-image img{box-sizing:border-box;height:auto;max-width:100%;vertical-align:bottom}@media not (prefers-reduced-motion){.wp-block-image img.hide{visibility:hidden}.wp-block-image img.show{animation:show-content-image .4s}}.wp-block-image[style*=border-radius] img,.wp-block-image[style*=border-radius]>a{border-radius:inherit}.wp-block-image.has-custom-border img{box-sizing:border-box}.wp-block-image.aligncenter{text-align:center}.wp-block-image.alignfull>a,.wp-block-image.alignwide>a{width:100%}.wp-block-image.alignfull img,.wp-block-image.alignwide img{height:auto;width:100%}.wp-block-image .aligncenter,.wp-block-image .alignleft,.wp-block-image .alignright,.wp-block-image.aligncenter,.wp-block-image.alignleft,.wp-block-image.alignright{display:table}.wp-block-image .aligncenter>figcaption,.wp-block-image .alignleft>figcaption,.wp-block-image .alignright>figcaption,.wp-block-image.aligncenter>figcaption,.wp-block-image.alignleft>figcaption,.wp-block-image.alignright>figcaption{caption-side:bottom;display:table-caption}.wp-block-image .alignleft{float:left;margin:.5em 1em .5em 0}.wp-block-image .alignright{float:right;margin:.5em 0 .5em 1em}.wp-block-image .aligncenter{margin-left:auto;margin-right:auto}.wp-block-image :where(figcaption){margin-bottom:1em;margin-top:.5em}.wp-block-image.is-style-circle-mask img{border-radius:9999px}@supports ((-webkit-mask-image:none) or (mask-image:none)) or (-webkit-mask-image:none){.wp-block-image.is-style-circle-mask img{border-radius:0;-webkit-mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-image:url('data:image/svg+xml;utf8,<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg>');mask-mode:alpha;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:contain;mask-size:contain}}:root :where(.wp-block-image.is-style-rounded img,.wp-block-image .is-style-rounded img){border-radius:9999px}.wp-block-image figure{margin:0}.wp-lightbox-container{display:flex;flex-direction:column;position:relative}.wp-lightbox-container img{cursor:zoom-in}.wp-lightbox-container img:hover+button{opacity:1}.wp-lightbox-container button{align-items:center;backdrop-filter:blur(16px) saturate(180%);background-color:#5a5a5a40;border:none;border-radius:4px;cursor:zoom-in;display:flex;height:20px;justify-content:center;opacity:0;padding:0;position:absolute;right:16px;text-align:center;top:16px;width:20px;z-index:100}@media not (prefers-reduced-motion){.wp-lightbox-container button{transition:opacity .2s ease}}.wp-lightbox-container button:focus-visible{outline:3px auto #5a5a5a40;outline:3px auto -webkit-focus-ring-color;outline-offset:3px}.wp-lightbox-container button:hover{cursor:pointer;opacity:1}.wp-lightbox-container button:focus{opacity:1}.wp-lightbox-container button:focus,.wp-lightbox-container button:hover,.wp-lightbox-container button:not(:hover):not(:active):not(.has-background){background-color:#5a5a5a40;border:none}.wp-lightbox-overlay{box-sizing:border-box;cursor:zoom-out;height:100vh;left:0;overflow:hidden;position:fixed;top:0;visibility:hidden;width:100%;z-index:100000}.wp-lightbox-overlay .close-button{align-items:center;cursor:pointer;display:flex;justify-content:center;min-height:40px;min-width:40px;padding:0;position:absolute;right:calc(env(safe-area-inset-right) + 16px);top:calc(env(safe-area-inset-top) + 16px);z-index:5000000}.wp-lightbox-overlay .close-button:focus,.wp-lightbox-overlay .close-button:hover,.wp-lightbox-overlay .close-button:not(:hover):not(:active):not(.has-background){background:none;border:none}.wp-lightbox-overlay .lightbox-image-container{height:var(--wp--lightbox-container-height);left:50%;overflow:hidden;position:absolute;top:50%;transform:translate(-50%,-50%);transform-origin:top left;width:var(--wp--lightbox-container-width);z-index:9999999999}.wp-lightbox-overlay .wp-block-image{align-items:center;box-sizing:border-box;display:flex;height:100%;justify-content:center;margin:0;position:relative;transform-origin:0 0;width:100%;z-index:3000000}.wp-lightbox-overlay .wp-block-image img{height:var(--wp--lightbox-image-height);min-height:var(--wp--lightbox-image-height);min-width:var(--wp--lightbox-image-width);width:var(--wp--lightbox-image-width)}.wp-lightbox-overlay .wp-block-image figcaption{display:none}.wp-lightbox-overlay button{background:none;border:none}.wp-lightbox-overlay .scrim{background-color:#fff;height:100%;opacity:.9;position:absolute;width:100%;z-index:2000000}.wp-lightbox-overlay.active{visibility:visible}@media not (prefers-reduced-motion){.wp-lightbox-overlay.active{animation:turn-on-visibility .25s both}.wp-lightbox-overlay.active img{animation:turn-on-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active){animation:turn-off-visibility .35s both}.wp-lightbox-overlay.show-closing-animation:not(.active) img{animation:turn-off-visibility .25s both}.wp-lightbox-overlay.zoom.active{animation:none;opacity:1;visibility:visible}.wp-lightbox-overlay.zoom.active .lightbox-image-container{animation:lightbox-zoom-in .4s}.wp-lightbox-overlay.zoom.active .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.active .scrim{animation:turn-on-visibility .4s forwards}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active){animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container{animation:lightbox-zoom-out .4s}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .lightbox-image-container img{animation:none}.wp-lightbox-overlay.zoom.show-closing-animation:not(.active) .scrim{animation:turn-off-visibility .4s forwards}}@keyframes show-content-image{0%{visibility:hidden}99%{visibility:hidden}to{visibility:visible}}@keyframes turn-on-visibility{0%{opacity:0}to{opacity:1}}@keyframes turn-off-visibility{0%{opacity:1;visibility:visible}99%{opacity:0;visibility:visible}to{opacity:0;visibility:hidden}}@keyframes lightbox-zoom-in{0%{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale))}to{transform:translate(-50%,-50%) scale(1)}}@keyframes lightbox-zoom-out{0%{transform:translate(-50%,-50%) scale(1);visibility:visible}99%{visibility:visible}to{transform:translate(calc((-100vw + var(--wp--lightbox-scrollbar-width))/2 + var(--wp--lightbox-initial-left-position)),calc(-50vh + var(--wp--lightbox-initial-top-position))) scale(var(--wp--lightbox-scale));visibility:hidden}}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/image/style.min.css */
</style>
<style id='wp-block-list-inline-css' type='text/css'>
ol,ul{box-sizing:border-box}:root :where(.wp-block-list.has-background){padding:1.25em 2.375em}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/list/style.min.css */
</style>
<style id='wp-block-paragraph-inline-css' type='text/css'>
.is-small-text{font-size:.875em}.is-regular-text{font-size:1em}.is-large-text{font-size:2.25em}.is-larger-text{font-size:3em}.has-drop-cap:not(:focus):first-letter{float:left;font-size:8.4em;font-style:normal;font-weight:100;line-height:.68;margin:.05em .1em 0 0;text-transform:uppercase}body.rtl .has-drop-cap:not(:focus):first-letter{float:none;margin-left:.1em}p.has-drop-cap.has-background{overflow:hidden}:root :where(p.has-background){padding:1.25em 2.375em}:where(p.has-text-color:not(.has-link-color)) a{color:inherit}p.has-text-align-left[style*="writing-mode:vertical-lr"],p.has-text-align-right[style*="writing-mode:vertical-rl"]{rotate:180deg}
/*# sourceURL=https://www.dmitrymakarov.ru/wp-includes/blocks/paragraph/style.min.css */
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgb(6,147,227) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgb(252,185,0) 0%,rgb(255,105,0) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgb(255,105,0) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgb(255, 255, 255), 6px 6px rgb(0, 0, 0);--wp--preset--shadow--crisp: 6px 6px 0px rgb(0, 0, 0);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
/*# sourceURL=global-styles-inline-css */
</style>

<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
/*# sourceURL=/wp-includes/css/classic-themes.min.css */
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.9.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.9.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.9.0","is_admin":"0","ajaxurl":"https://www.dmitrymakarov.ru/wp-admin/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
//# sourceURL=urvanov_syntax_highlighter_js-js-extra
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.9.0" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="wp-singular page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-36843 page-child parent-pageid-5658 custom-background wp-theme-mcluhan full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Дмитрий Макаров</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

					<li id="menu-item-36690" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-36690"><a href="../../index.html">Материалы</a></li>
<li id="menu-item-36691" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36691"><a href="../../about/index.html">Об авторе</a></li>
				</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
				<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-home menu-item-36690"><a href="../../index.html">Материалы</a></li>
<li class="menu-item menu-item-type-post_type menu-item-object-page menu-item-36691"><a href="../../about/index.html">Об авторе</a></li>
					<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-697702631e2eb">Поиск:</label>
	<input type="search" id="search-form-697702631e2eb" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-697702631e378">Поиск:</label>
	<input type="search" id="search-form-697702631e378" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-36843 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Свёрточная нейронная сеть. Часть 2</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Обучение модели</a></p>



<p>Теперь, когда у нас достаточно знаний об операции свёртки и понятен принцип, согласно которому свёрточная нейросеть может обнаружить интересующий нас объект, самое время перейти к изучению общей архитектуры сети.</p>



<h2 class="wp-block-heading">Архитектура свёрточной нейросети</h2>



<h3 class="wp-block-heading">Подготовка данных</h3>



<p>Возьмем уже знакомый нам датасет рукописных цифр MNIST и создадим свёрточную нейросеть-классификатор в библиотеке Keras.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-6977026314978114025462" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314978114025462-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314978114025462-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">tensorflow </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">keras</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314978114025462-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314978114025462-3"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-v">mnist</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314978114025462-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314978114025462-5"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314978114025462-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314978114025462-7"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">label </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">zip</span><span class="crayon-sy">(</span><span class="crayon-v">axes</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314978114025462-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'gray'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314978114025462-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-i">f</span><span class="crayon-s">'Target: {label}'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img fetchpriority="high" decoding="async" width="822" height="234" src="../../wp-content/uploads/2025/03/mnist.png" alt="датасет MNIST" class="wp-image-36844" style="width:731px;height:auto" srcset="../../wp-content/uploads/2025/03/mnist.png 822w, ../../wp-content/uploads/2025/03/mnist-300x85.png 300w, ../../wp-content/uploads/2025/03/mnist-768x219.png 768w, ../../wp-content/uploads/2025/03/mnist-600x171.png 600w" sizes="(max-width: 822px) 100vw, 822px" /></figure>



<p>На изображениях выше хорошо видно, что каждая цифра состоит из расположенных под разными углами контуров. Именно эти контуры мы и постараемся запомнить, создав в процессе обучения модели фильтры, похожие на фильтры Собеля.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-6977026314987752615093" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314987752615093-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314987752615093-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314987752615093-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314987752615093-1"><span class="crayon-c"># приведем изображения к диапазону от -0,5 до 0,5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314987752615093-2"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314987752615093-3"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h3 class="wp-block-heading">Свёрточный слой и подвыборка</h3>



<p>Начнем создавать <strong>свёрточный слой</strong> (convolutional layer):</p>



<ul class="wp-block-list">
<li>мы знаем, что каждая картинка имеет размерность 28 x 28 пикселей;</li>



<li>пусть фильтр будет размером 3 x 3;</li>



<li>шаг оставим равным единице; а</li>



<li>отступ пусть будет нулевым.</li>
</ul>



<p>В этом случае размерность карты признаков составит 26 x 26.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img decoding="async" width="1024" height="580" src="../../wp-content/uploads/2025/03/image-27-1024x580.png" alt="свёрточный слой" class="wp-image-36846" style="width:572px;height:auto" srcset="../../wp-content/uploads/2025/03/image-27-1024x580.png 1024w, ../../wp-content/uploads/2025/03/image-27-300x170.png 300w, ../../wp-content/uploads/2025/03/image-27-768x435.png 768w, ../../wp-content/uploads/2025/03/image-27-1200x680.png 1200w, ../../wp-content/uploads/2025/03/image-27-600x340.png 600w, ../../wp-content/uploads/2025/03/image-27.png 1278w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>В самом деле, перемещая фильтр с размером шага 1, мы «съедаем» крайние строки и столбцы, тем самым уменьшая оба измерения на два.</p>



<p>Пойдем дальше. Мы уже отметили, что цифры состоят из контуров, причем эти контуры не обязательно вертикальные или горизонтальные, поэтому, скорее всего, нам понадобится больше двух фильтров. Пусть всего фильтров будет восемь.</p>



<p class="has-background" style="background-color:#ffe8c4">Заметим, что количество фильтров свёрточного слоя, а также размер шага и отступ &#8212; это гиперпараметры, которые настраиваются при обучении модели.</p>



<p>В этом случае мы будем производить свёртку картинки с каждым из восьми фильтров и на выходе ожидаемо получим восемь карт признаков размером 26 x 26.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img decoding="async" width="1024" height="465" src="../../wp-content/uploads/2025/03/image-32-1024x465.png" alt="размерности в операции свёртки" class="wp-image-36853" style="width:460px;height:auto" srcset="../../wp-content/uploads/2025/03/image-32-1024x465.png 1024w, ../../wp-content/uploads/2025/03/image-32-300x136.png 300w, ../../wp-content/uploads/2025/03/image-32-768x348.png 768w, ../../wp-content/uploads/2025/03/image-32-1200x544.png 1200w, ../../wp-content/uploads/2025/03/image-32-600x272.png 600w, ../../wp-content/uploads/2025/03/image-32.png 1488w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Увеличим размерность каждой картинки с двух до трех измерений, то есть 28 x 28 x 1. Это требование библиотеки Keras, и зачем это нужно, станет понятно чуть позже.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-697702631498b033433648" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-697702631498b033433648-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697702631498b033433648-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697702631498b033433648-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697702631498b033433648-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-697702631498b033433648-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-697702631498b033433648-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-697702631498b033433648-1"><span class="crayon-c"># параметр axis функции np.expand_dims() указывает,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697702631498b033433648-2"><span class="crayon-c"># где именно разместить новое измерение</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697702631498b033433648-3"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697702631498b033433648-4"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">expand_dims</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-697702631498b033433648-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-697702631498b033433648-6"><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-6977026314995163772288" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314995163772288-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314995163772288-1">((60000, 28, 28, 1), (10000, 28, 28, 1))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading">Про количество параметров</h3>



<p>Как мы сказали выше, весами в свёрточном слое являются значения фильтров. В нашем случае их 3 x 3 x 8 = 72.</p>



<p>Обратим внимание на важный момент. Количество весов зависит только от размера и количества фильтров, но никак не от размера изображения. Другими словами, мы можем добавить еще один фильтр, и тогда количество весов увеличится до 3 x 3 x 9 = 91, однако если мы возьмем изображение с большей размерностью, скажем 900 x 900 пикселей, количество параметров будет по-прежнему равно 72.</p>



<p>Это свойство свёрточной сети существенно снижает вычислительную затратность обучения модели, а также её склонность к переобучению.</p>



<h3 class="wp-block-heading">Функция активации</h3>



<p>Результат свёртки, то есть каждое значение тензора карты признаков 26 x 26 x 8 необходимо &#171;пропустить&#187; через функцию активации, чтобы добавить нелинейности нашей функции.</p>



<p>Довольно часто в качестве функции активации используется уже <a href="../../python/npmath/index.html">знакомая нам</a> функция <strong>ReLU</strong> или Rectified Linear Unit.</p>



<p>$$ f(x) = \max(0,x) $$</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="631" src="../../wp-content/uploads/2025/03/image-34-1024x631.png" alt="функция активации ReLU" class="wp-image-36856" style="width:437px;height:auto" srcset="../../wp-content/uploads/2025/03/image-34-1024x631.png 1024w, ../../wp-content/uploads/2025/03/image-34-300x185.png 300w, ../../wp-content/uploads/2025/03/image-34-768x473.png 768w, ../../wp-content/uploads/2025/03/image-34-1200x739.png 1200w, ../../wp-content/uploads/2025/03/image-34-600x370.png 600w, ../../wp-content/uploads/2025/03/image-34.png 1424w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Примечание. Прежде чем передавать значения карты признаков в функцию активации, мы могли бы добавить <strong>смещение</strong> (bias), однако пока для простоты не будем этого делать.</p>



<h3 class="wp-block-heading">Операция подвыборки</h3>



<p>После свёрточного слоя возникает желание понизить размерность получившегося тензора. Для этой цели применяется <strong>операция подвыборки</strong> (pooling, а также subsampling или downsampling operation). Сам слой при этом называется слоем <strong>подвыборки</strong> (pooling layer).</p>



<p>Рассмотрим несложный пример. Пусть получившаяся карта признаков имеет размерность 4 x 4, и нам бы хотелось сократить размерность в два раза до 2 x 2. Мы могли бы разделить изображение на квадраты, а затем взять из каждого квадрата только максимальное значение.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="442" src="../../wp-content/uploads/2025/03/image-31-1024x442.png" alt="операция подвыборки или max pooling" class="wp-image-36852" style="width:419px;height:auto" srcset="../../wp-content/uploads/2025/03/image-31-1024x442.png 1024w, ../../wp-content/uploads/2025/03/image-31-300x130.png 300w, ../../wp-content/uploads/2025/03/image-31-768x332.png 768w, ../../wp-content/uploads/2025/03/image-31-1200x518.png 1200w, ../../wp-content/uploads/2025/03/image-31-600x259.png 600w, ../../wp-content/uploads/2025/03/image-31.png 1248w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Такая операция называется <strong>подвыборкой по максимальному значению</strong> (max pooling). Идея, помимо понижения размерности, заключается в том, чтобы сохранить высокие значения (ведь высокие значения означают, что признак, например, контур, обнаружен) и отбросить низкие.</p>



<p>Заметим, что в примере выше итоговая размерность после подвыборки по максимальному значению совпадает с операцией свёртки с размерностью фильтра 2 x 2 и размером шага 2. Это знание пригодится нам чуть позже, когда мы будем собирать модель в Keras.</p>



<p>Применим max pooling к картам признаков создаваемой нами нейросети. <em>Каждая</em> карта признаков, таким образом, сократится с 26 x 26 до 13 x 13 пикселей.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="568" src="../../wp-content/uploads/2025/03/image-30-1024x568.png" alt="этап извлечения признаков" class="wp-image-36851" style="width:606px;height:auto" srcset="../../wp-content/uploads/2025/03/image-30-1024x568.png 1024w, ../../wp-content/uploads/2025/03/image-30-300x166.png 300w, ../../wp-content/uploads/2025/03/image-30-768x426.png 768w, ../../wp-content/uploads/2025/03/image-30-1536x852.png 1536w, ../../wp-content/uploads/2025/03/image-30-1200x666.png 1200w, ../../wp-content/uploads/2025/03/image-30-600x333.png 600w, ../../wp-content/uploads/2025/03/image-30.png 1946w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Дополнительно заметим, что параметры слоя подвыборки не участвуют в обучении модели (расчете обратного распространения ошибки). Их называют <strong>необучаемыми</strong> (non-trainable) параметрами, в отличие <strong>обучаемых</strong> (trainable) параметров свёрточного слоя.</p>



<p>Посмотрим, что было сделано до сих пор:</p>



<ul class="wp-block-list">
<li>мы применили фильтры вначале со случайными, а затем, после обучения, более оптимальными значениями;</li>



<li>обнаружили признаки; и</li>



<li>сократили размерность карт признаков с помощью max pooling.</li>
</ul>



<p>Этот этап называется <strong>извлечением признаков</strong> (feature extraction). Теперь нам хотелось бы сделать прогноз, предсказать, о какой цифре идет речь, то есть перейти к этапу <strong>классификации</strong> (classification).</p>



<p><strong>&#171;Вытягивание&#187; карт признаков</strong>. Для того чтобы двигаться дальше превратим трехмерный тензор 13 x 13 x 8 в вектор (одномерный массив) из 1 352 значений. За такую операцию будет отвечать специальный слой, который в библиотеке Keras называется Flatten.</p>



<h3 class="wp-block-heading">Полносвязный слой</h3>



<p>Наконец, получившийся вектор из 1 352 признаков мы соединим с выходным полносвязным слоем из 10 нейронов, по одному для каждого из десяти предсказываемых классов, и пропустим через функцию softmax (смещение опять же пока применять не будем).</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="567" src="../../wp-content/uploads/2025/03/image-28-1024x567.png" alt="извлечение признаков и классификация" class="wp-image-36859" style="width:598px;height:auto" srcset="../../wp-content/uploads/2025/03/image-28-1024x567.png 1024w, ../../wp-content/uploads/2025/03/image-28-300x166.png 300w, ../../wp-content/uploads/2025/03/image-28-768x425.png 768w, ../../wp-content/uploads/2025/03/image-28-1536x850.png 1536w, ../../wp-content/uploads/2025/03/image-28-1200x664.png 1200w, ../../wp-content/uploads/2025/03/image-28-600x332.png 600w, ../../wp-content/uploads/2025/03/image-28.png 1829w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>По сути здесь мы используем уже знакомую нам полносвязную нейросеть с тем отличием, что у нас остается только входной слой из 1 352 признаков и выходной слой из 10 нейронов. Несложно посчитать, что для полносвязного слоя нам нужно обучить 10 x 1 352 = 13 520 параметров, связывающих каждый нейрон слоя Flatten с каждым нейроном выходного слоя.</p>



<p>Примечание. Здесь будет уместно пояснить, что карта признаков называется так ровно потому, что получившиеся 1 352 значения являются (промежуточными) признаками для дальнейшего обучения классификатора.</p>



<h3 class="wp-block-heading">Создание и обучение модели</h3>



<p>Мы готовы создать модель в Keras. Приведем код с пояснениями.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-6977026314999346437026" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-6977026314999346437026-28">28</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-1"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">InputLayer</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># количество фильтров</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># размер фильтра</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strides</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># размер шага</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">padding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'valid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># тип отступа</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># активация свёрточного слоя</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># применение смещения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># размер окна max pooling</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-v">units</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># количество нейронов выходного слоя</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'softmax'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># активация выходного слоя</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">,</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># применение смещения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-14"><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-16"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-k ">compile</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">metrics</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-20"><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-22"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># будем сразу оценивать качество на тестовых данных</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-6977026314999346437026-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">validation_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-6977026314999346437026-28"><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149a5104218596" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149a5104218596-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149a5104218596-1">Epoch 1/3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149a5104218596-2">1875/1875 ━━━━━━━━━━━━━━━━━━━━ 21s 11ms/step - accuracy: 0.8504 - loss: 0.5991 - val_accuracy: 0.9664 - val_loss: 0.1132</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149a5104218596-3">Epoch 2/3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149a5104218596-4">1875/1875 ━━━━━━━━━━━━━━━━━━━━ 19s 10ms/step - accuracy: 0.9673 - loss: 0.1141 - val_accuracy: 0.9748 - val_loss: 0.0827</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149a5104218596-5">Epoch 3/3</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149a5104218596-6">1875/1875 ━━━━━━━━━━━━━━━━━━━━ 19s 10ms/step - accuracy: 0.9772 - loss: 0.0791 - val_accuracy: 0.9760 - val_loss: 0.0771</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149a5104218596-7">&lt;keras.src.callbacks.history.History at 0x7cfa41528250&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149a8630050553" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149a8630050553-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149a8630050553-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="408" src="../../wp-content/uploads/2025/03/image-29-1024x408.png" alt="простая архитектура свёрточной сети" class="wp-image-36861" style="width:691px;height:auto" srcset="../../wp-content/uploads/2025/03/image-29-1024x408.png 1024w, ../../wp-content/uploads/2025/03/image-29-300x119.png 300w, ../../wp-content/uploads/2025/03/image-29-768x306.png 768w, ../../wp-content/uploads/2025/03/image-29-1536x612.png 1536w, ../../wp-content/uploads/2025/03/image-29-2048x816.png 2048w, ../../wp-content/uploads/2025/03/image-29-1200x478.png 1200w, ../../wp-content/uploads/2025/03/image-29-600x239.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Теперь посмотрим, как улучшить полученный результат.</p>



<h2 class="wp-block-heading">Улучшение базовой модели</h2>



<h3 class="wp-block-heading">Количество свёрточных слоёв</h3>



<p>Очевидным способом улучшить качество нейросети является увеличение количества свёрточных слоёв. Попробуем применить два слоя, причем в первом используем 32 фильтра, а во втором &#8212; 64.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="500" src="../../wp-content/uploads/2025/03/image-33-1024x500.png" alt="увеличение количества свёрточных слоев" class="wp-image-36864" style="width:782px;height:auto" srcset="../../wp-content/uploads/2025/03/image-33-1024x500.png 1024w, ../../wp-content/uploads/2025/03/image-33-300x146.png 300w, ../../wp-content/uploads/2025/03/image-33-768x375.png 768w, ../../wp-content/uploads/2025/03/image-33-1536x749.png 1536w, ../../wp-content/uploads/2025/03/image-33-1200x585.png 1200w, ../../wp-content/uploads/2025/03/image-33-600x293.png 600w, ../../wp-content/uploads/2025/03/image-33.png 1890w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Выбор меньшего количества фильтров для первого слоя и большего для второго не случаен. Первый слой запоминает отдельные фрагменты изображений (контуры), второй и последующие слои собирают из этих фрагментов все более крупные части изображения.</p>



<p class="has-background" style="background-color:#ffe8c4">Также говорят, что алгоритм учится создавать <strong>представления</strong> (Representation Learning) данных (например, изображений или текста) из более простых (низкоуровневых) составляющих.</p>



<p>Приведем упрощенный пример работы нейросети, первый слой которой учится определять фрагменты лиц, а второй слой &#8212; уже сами лица.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="435" src="../../wp-content/uploads/2025/03/image-35-1024x435.png" alt="создание представлений" class="wp-image-36865" style="width:751px;height:auto" srcset="../../wp-content/uploads/2025/03/image-35-1024x435.png 1024w, ../../wp-content/uploads/2025/03/image-35-300x128.png 300w, ../../wp-content/uploads/2025/03/image-35-768x327.png 768w, ../../wp-content/uploads/2025/03/image-35-1536x653.png 1536w, ../../wp-content/uploads/2025/03/image-35-1200x510.png 1200w, ../../wp-content/uploads/2025/03/image-35-600x255.png 600w, ../../wp-content/uploads/2025/03/image-35.png 1978w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Вполне очевидно, что отдельных фрагментов всегда меньше, чем их комбинаций. Например, из двух фрагментов можно составить $2^2 = 4$ комбинации. Именно поэтому мы используем меньшее количество фильтров на первых свёрточных слоях.</p>



<p>Теперь поясним приведенную выше схему сети. <strong>Первый свёрточный слой</strong> использует 32 фильтра размером 3 x 3, а также 32 значения смещений по одному для каждого фильтра (значение смещения соответствующего фильтра поэлементно прибавляется к каждому значению фильтра с помощью <a href="../../python/npmath/index.html">трансляции</a> (broadcasting)).</p>



<p>Таким образом, получается 3 x 3 x 32 + 32 = 320 обучаемых параметров. Все остальные характеристики первого слоя, то есть опять же размер фильтра 3 x 3, размер окна max pooling 2 x 2, а также получающиеся размерности карты признаков 26 x 26 и операции подвыборки 13 x 13 остаются без изменений.</p>



<p>На <strong>втором свёрточном слое</strong> мы используем уже 64 фильтра 3 x 3, которые будучи применёнными к каждому из 32 слоев max pooling предыдущего слоя создают карту признаков размерностью 11 x 11 x 64 и требуют 3 x 3 x 32 x 64 = 18 432 обучаемых параметра. Вместе с 64 значениями смещения получается 18 432 + 64 = 18 496 обучаемых параметров.</p>



<p>Операция подвыборки второго слоя с помощью окна размерностью 2 x 2 сокращает каждую из 64 карт признаков до размера 5 x 5.</p>



<h3 class="wp-block-heading">Классификация</h3>



<p>Получившийся трехмерный тензор второго свёрточного слоя, как и в предыдущем примере, слой Flatten &#171;вытягивает&#187; до вектора, состоящего из 5 x 5 x 64 = 1 600 значений.</p>



<p>Если бы мы сразу, как и в прошлый раз, передали эти значения десяти нейронам выходного слоя, то у нас получилось бы (с учетом 10-ти параметров смещения) 16 000 x 10 + 10 = 16 010 обучаемых значений. Опять же, такое количество параметров может иметь склонность к переобучению.</p>



<h4 class="wp-block-heading">Метод Dropout</h4>



<p>В качестве метода <a href="../reg/index.html">регуляризации</a> нейросети используем технику <strong>Dropout</strong> («исключение», «выпадение»). Ее суть заключается в том, чтобы в процессе <a href="../sgd/index.html">стохастического градиентного спуска</a> в каждой mini batch исключать/отбрасывать определенный процент $p$ нейронов, обнуляя их значения.</p>



<p>Таким образом, эти нейроны не участвуют в прямом распространении на данной итерации и также не учитываются при расчете градиентов и обновлении весов. На следующей итерации при обучении на новой mini batch исключаются другие нейроны (говорят, что используется новая маска (mask)).</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="937" src="../../wp-content/uploads/2025/03/image-36-1024x937.png" alt="метод Dropout" class="wp-image-36866" style="width:353px;height:auto" srcset="../../wp-content/uploads/2025/03/image-36-1024x937.png 1024w, ../../wp-content/uploads/2025/03/image-36-300x275.png 300w, ../../wp-content/uploads/2025/03/image-36-768x703.png 768w, ../../wp-content/uploads/2025/03/image-36-600x549.png 600w, ../../wp-content/uploads/2025/03/image-36.png 1109w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Заметим, что на этапе предсказания Dropout не применяется (в Keras &#171;отключение&#187; этого слоя происходит автоматически). Поэтому для того чтобы на тестовых данных не было искажений, в процессе Dropout значения неисключенных нейронов умножаются на</p>



<p>$$ \frac{1}{1-p}, $$</p>



<p>где $p$ &#8212; вероятность исключения одного нейрона (такой метод называют <strong>Inverted Dropout</strong>). Приведем пример. Пусть некоторый слой нейросети состоит из шести нейронов, а вероятность $p$ равна $0{,}5.$ Тогда каждый из трех неисключенных нейронов необходимо умножить на $\frac{1}{1-0{,}5}=2.$</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="420" src="../../wp-content/uploads/2025/03/image-37-1024x420.png" alt="Inverted Dropout" class="wp-image-36867" style="width:578px;height:auto" srcset="../../wp-content/uploads/2025/03/image-37-1024x420.png 1024w, ../../wp-content/uploads/2025/03/image-37-300x123.png 300w, ../../wp-content/uploads/2025/03/image-37-768x315.png 768w, ../../wp-content/uploads/2025/03/image-37-1536x630.png 1536w, ../../wp-content/uploads/2025/03/image-37-1200x492.png 1200w, ../../wp-content/uploads/2025/03/image-37-600x246.png 600w, ../../wp-content/uploads/2025/03/image-37.png 1857w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Приведем ссылку на <a href="https://www.cs.toronto.edu/~hinton/absps/JMLRdropout.pdf" target="_blank" rel="noreferrer noopener">оригинальную статью</a>⧉ по методу Dropout.</p>



<h3 class="wp-block-heading">Создание и обучение модели</h3>



<p>Напишем код модели в Keras. Вначале зададим архитектуру.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149ae279398538" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ae279398538-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-1"><span class="crayon-v">model2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">InputLayer</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># размер фильтра можно задать через кортеж,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># указывающий на размерность по каждому измерению</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># вероятность исключения нейрона задается через rate</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ae279398538-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ae279398538-21"><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0010 seconds] -->
</div>



<p>Соберем и обучим модель.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149b3192099375" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b3192099375-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-1"><span class="crayon-v">model2</span><span class="crayon-sy">.</span><span class="crayon-k ">compile</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b3192099375-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'adam'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-o">=</span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b3192099375-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">metrics</span><span class="crayon-o">=</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-5"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b3192099375-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-7"><span class="crayon-v">model2</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b3192099375-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b3192099375-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-c"># увеличим размер одной batch</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b3192099375-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">validation_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b3192099375-13"><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149b6368728806" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b6368728806-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-1">Epoch 1/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-2">844/844 ━━━━━━━━━━━━━━━━━━━━ 44s 50ms/step - accuracy: 0.8231 - loss: 0.5951 - val_accuracy: 0.9827 - val_loss: 0.0620</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-3">Epoch 2/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-4">844/844 ━━━━━━━━━━━━━━━━━━━━ 82s 50ms/step - accuracy: 0.9719 - loss: 0.0962 - val_accuracy: 0.9878 - val_loss: 0.0458</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-5">Epoch 3/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-6">844/844 ━━━━━━━━━━━━━━━━━━━━ 82s 49ms/step - accuracy: 0.9774 - loss: 0.0756 - val_accuracy: 0.9878 - val_loss: 0.0459</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-7">Epoch 4/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-8">844/844 ━━━━━━━━━━━━━━━━━━━━ 82s 50ms/step - accuracy: 0.9813 - loss: 0.0595 - val_accuracy: 0.9893 - val_loss: 0.0369</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-9">Epoch 5/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-10">844/844 ━━━━━━━━━━━━━━━━━━━━ 81s 49ms/step - accuracy: 0.9824 - loss: 0.0566 - val_accuracy: 0.9903 - val_loss: 0.0337</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-11">Epoch 6/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-12">844/844 ━━━━━━━━━━━━━━━━━━━━ 83s 50ms/step - accuracy: 0.9859 - loss: 0.0463 - val_accuracy: 0.9902 - val_loss: 0.0331</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-13">Epoch 7/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-14">844/844 ━━━━━━━━━━━━━━━━━━━━ 82s 50ms/step - accuracy: 0.9869 - loss: 0.0427 - val_accuracy: 0.9900 - val_loss: 0.0353</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-15">Epoch 8/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-16">844/844 ━━━━━━━━━━━━━━━━━━━━ 41s 48ms/step - accuracy: 0.9870 - loss: 0.0416 - val_accuracy: 0.9910 - val_loss: 0.0300</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-17">Epoch 9/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-18">844/844 ━━━━━━━━━━━━━━━━━━━━ 42s 49ms/step - accuracy: 0.9873 - loss: 0.0379 - val_accuracy: 0.9912 - val_loss: 0.0296</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-19">Epoch 10/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b6368728806-20">844/844 ━━━━━━━━━━━━━━━━━━━━ 41s 49ms/step - accuracy: 0.9873 - loss: 0.0404 - val_accuracy: 0.9910 - val_loss: 0.0286</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b6368728806-21">&lt;keras.src.callbacks.history.History at 0x7cfa415ce290&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Оценим качество модели на тестовых данных.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149b9345623742" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b9345623742-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149b9345623742-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149b9345623742-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b9345623742-1"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Test accuracy:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model2</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149b9345623742-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149b9345623742-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149bc191409265" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149bc191409265-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149bc191409265-1">Test accuracy: 0.9918000102043152</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Также обратите внимание, в первом примере мы использовали разделение на обучающую и тестовую выборки, а во втором &#8212; на <a href="../sgd-add/index.html">обучающие, валидационные и тестовые данные</a>. Посмотрим на количество параметров.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149bf760844523" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149bf760844523-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149bf760844523-1"><span class="crayon-v">model2</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="557" src="../../wp-content/uploads/2025/03/image-38-1024x557.png" alt="улучшенная архитектура свёрточной сети" class="wp-image-36872" srcset="../../wp-content/uploads/2025/03/image-38-1024x557.png 1024w, ../../wp-content/uploads/2025/03/image-38-300x163.png 300w, ../../wp-content/uploads/2025/03/image-38-768x417.png 768w, ../../wp-content/uploads/2025/03/image-38-1536x835.png 1536w, ../../wp-content/uploads/2025/03/image-38-2048x1113.png 2048w, ../../wp-content/uploads/2025/03/image-38-1200x652.png 1200w, ../../wp-content/uploads/2025/03/image-38-600x326.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Перейдем к работе с цветными изображениями.</p>



<h2 class="wp-block-heading">Работа с цветными изобрежениями</h2>



<h3 class="wp-block-heading">Свёртка по объёму</h3>



<p>Особенность работы с цветными изображениями заключается в том, что теперь у нас есть три матрицы для красного, зеленого и синего <strong>каналов</strong> (RGB channels).</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="697" src="../../wp-content/uploads/2025/03/image-39-1024x697.png" alt="анатомия цветного изображения" class="wp-image-36873" style="width:447px;height:auto" srcset="../../wp-content/uploads/2025/03/image-39-1024x697.png 1024w, ../../wp-content/uploads/2025/03/image-39-300x204.png 300w, ../../wp-content/uploads/2025/03/image-39-768x522.png 768w, ../../wp-content/uploads/2025/03/image-39-1200x816.png 1200w, ../../wp-content/uploads/2025/03/image-39-600x408.png 600w, ../../wp-content/uploads/2025/03/image-39.png 1326w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Как следствие, принято говорить о <strong>высоте</strong> (height), <strong>ширине</strong> (width) и <strong>глубине</strong> (depth) входных данных. Именно по этой причине мы превращали данные MNIST из матрицы в трехмерный тензор 28 x 28 x 1. Черно-белые изображения рассматриваются как частный случай цветных изображений с одним каналом (глубиной 1).</p>



<p>Свёртка, называемая в этом случае <strong>свёрткой по объёму</strong> (convolution over volume), будет происходить с также трехмерным фильтром, глубина которого должна совпадать с глубиной изображения.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="609" src="../../wp-content/uploads/2025/03/image-40-1024x609.png" alt="свёртка по объему" class="wp-image-36874" style="width:491px;height:auto" srcset="../../wp-content/uploads/2025/03/image-40-1024x609.png 1024w, ../../wp-content/uploads/2025/03/image-40-300x178.png 300w, ../../wp-content/uploads/2025/03/image-40-768x457.png 768w, ../../wp-content/uploads/2025/03/image-40-1200x713.png 1200w, ../../wp-content/uploads/2025/03/image-40-600x357.png 600w, ../../wp-content/uploads/2025/03/image-40.png 1529w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Технически, наложив трехмерный фильтр на, скажем, левый верхний угол тензора изображения, мы поэлементно перемножим каждое значение изображения с каждым значением фильтра и сложим произведения.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="567" src="../../wp-content/uploads/2025/03/image-41-1024x567.png" alt="размерности в операции свёртки по объему" class="wp-image-36875" style="width:468px;height:auto" srcset="../../wp-content/uploads/2025/03/image-41-1024x567.png 1024w, ../../wp-content/uploads/2025/03/image-41-300x166.png 300w, ../../wp-content/uploads/2025/03/image-41-768x425.png 768w, ../../wp-content/uploads/2025/03/image-41-1200x664.png 1200w, ../../wp-content/uploads/2025/03/image-41-600x332.png 600w, ../../wp-content/uploads/2025/03/image-41.png 1429w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Например, если фильтр имеет размерность 3 x 3 x 3 мы поэлементно перемножим каждый из 27 элементов выбранного сегмента изображения с соответствующим элементом фильтра и сложим результаты. Эта операция и даст нам один элемент карты признаков. Несложно увидеть, что свёртка по объёму превращает трехмерные объекты в двумерные.</p>



<p>В случае нескольких фильтров каждый из них создаст двумерную карту признаков, которые вместе сформируют трехмерный тензор.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="546" src="../../wp-content/uploads/2025/03/image-42-1024x546.png" alt="свёртка по объему, несколько фильтров" class="wp-image-36881" style="width:514px;height:auto" srcset="../../wp-content/uploads/2025/03/image-42-1024x546.png 1024w, ../../wp-content/uploads/2025/03/image-42-300x160.png 300w, ../../wp-content/uploads/2025/03/image-42-768x410.png 768w, ../../wp-content/uploads/2025/03/image-42-1200x640.png 1200w, ../../wp-content/uploads/2025/03/image-42-600x320.png 600w, ../../wp-content/uploads/2025/03/image-42.png 1499w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<h3 class="wp-block-heading">Калькулятор</h3>



<p>Убедимся в правильности расчетов с помощью <a href="https://madebyollin.github.io/convnet-calculator/" target="_blank" rel="noreferrer noopener">онлайн-калькулятора</a>⧉.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="569" src="../../wp-content/uploads/2025/03/image-43-1024x569.png" alt="онлайн-калькулятор для операции свёртки" class="wp-image-36883" srcset="../../wp-content/uploads/2025/03/image-43-1024x569.png 1024w, ../../wp-content/uploads/2025/03/image-43-300x167.png 300w, ../../wp-content/uploads/2025/03/image-43-768x427.png 768w, ../../wp-content/uploads/2025/03/image-43-1536x854.png 1536w, ../../wp-content/uploads/2025/03/image-43-2048x1139.png 2048w, ../../wp-content/uploads/2025/03/image-43-1200x667.png 1200w, ../../wp-content/uploads/2025/03/image-43-600x334.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p><strong>Немного терминологии</strong>. Поясним, что размер фильтра в этом калькуляторе обозначен через термин &#171;<strong>пространственные границы</strong>&#187; (spatial extent). Также для характеристики площади в пикселях, покрываемой фильтром, говорят о <strong>рецептивном поле</strong> (receptive field) нейрона.</p>



<h3 class="wp-block-heading">CIFAR-10</h3>



<p>Перейдем к созданию уже немного более сложной сети-классификатора цветных изображений из датасета CIFAR-10.</p>



<p>Этот набор данных содержит 60 000 изображений размером 32 x 32 x 3, на которых представлены объекты следующих десяти классов.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="774" src="../../wp-content/uploads/2025/03/image-44-1024x774.png" alt="классы CIFAR-10" class="wp-image-36884" style="width:359px;height:auto" srcset="../../wp-content/uploads/2025/03/image-44-1024x774.png 1024w, ../../wp-content/uploads/2025/03/image-44-300x227.png 300w, ../../wp-content/uploads/2025/03/image-44-768x581.png 768w, ../../wp-content/uploads/2025/03/image-44-1200x908.png 1200w, ../../wp-content/uploads/2025/03/image-44-600x454.png 600w, ../../wp-content/uploads/2025/03/image-44.png 1231w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Импортируем библиотеку и посмотрим на первые изображения.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149c3176421237" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149c3176421237-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149c3176421237-1"><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-v">cifar10</span><span class="crayon-sy">.</span><span class="crayon-e">load_data</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149c7625564469" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149c7625564469-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149c7625564469-1"><span class="crayon-v">X_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149cc575879201" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149cc575879201-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149cc575879201-1">((50000, 32, 32, 3), (10000, 32, 32, 3))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149ce085914416" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ce085914416-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ce085914416-1"><span class="crayon-v">y_train</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149d1909336751" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d1909336751-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d1909336751-1">((50000, 1), (10000, 1))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149d4086166661" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d4086166661-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d4086166661-1"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'airplane'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'automobile'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'bird'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'cat'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'deer'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149d4086166661-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-s">'dog'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'frog'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'horse'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'ship'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'truck'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d4086166661-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149d4086166661-4"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">nrows</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ncols</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d4086166661-5"><span class="crayon-v">axes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">axes</span><span class="crayon-sy">.</span><span class="crayon-e">ravel</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149d4086166661-6"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">arange</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d4086166661-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axes</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149d4086166661-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axes</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">axis</span><span class="crayon-sy">(</span><span class="crayon-s">'off'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d4086166661-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">axes</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">.</span><span class="crayon-e">set_title</span><span class="crayon-sy">(</span><span class="crayon-v">labels</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">squeeze</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149d4086166661-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d4086166661-11"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots_adjust</span><span class="crayon-sy">(</span><span class="crayon-v">wspace</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="639" height="307" src="../../wp-content/uploads/2025/03/cifar.png" alt="первые десять изображений CIFAR-10" class="wp-image-36885" style="width:529px;height:auto" srcset="../../wp-content/uploads/2025/03/cifar.png 639w, ../../wp-content/uploads/2025/03/cifar-300x144.png 300w, ../../wp-content/uploads/2025/03/cifar-600x288.png 600w" sizes="auto, (max-width: 639px) 100vw, 639px" /></figure>



<p>Примечание. Подробный разбор применяемых для визуализации изображений функций и методов можно найти <a href="../../python/numpy/index.html">здесь</a> и <a href="../../data/eda-03/index.html">здесь</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149d7036130711" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149d7036130711-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149d7036130711-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149d7036130711-1"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149d7036130711-2"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<h3 class="wp-block-heading">Batch Normalization (BN)</h3>



<p>Одной из сложностей, возникающих при обучении нейросети является так называемый <strong>внутренний ковариационный сдвиг</strong> (internal covariate shift), явление при котором от одной итерации к другой значения нейронов данного слоя могут существенно изменяться в зависимости от используемых данных (batches), что (1) дестабилизирует обучение (усложняет сходимость) и в конечном итоге (2) негативно сказывается на обобщающей способности алгоритма.</p>



<p>Как следствие, возникла идея на этапе <strong>обучения</strong> для <em>каждой карты признаков</em> (каждого канала) нормализовать (или, говоря более точно, <a href="../../data/transform/index.html">стандартизовать</a>) значения batch $B,$ т.е. привести распределение к нулевому среднему и единичному СКО с помощью выборочных среднего $\hat{\mu}_B$ и СКО $\hat{\sigma}_B.$</p>



<p>При этом для того чтобы приблизить нормализованное распределение к фактическому, результат &#171;восстанавливается&#187;, т.е. масштабируется и сдвигается на величину двух обучаемых параметров $\gamma$ и $\beta.$</p>



<p>$$ B_{\text{norm}} = \gamma \odot \frac{B-\hat{\mu}_B}{\hat{\sigma}_B+\varepsilon} + \beta $$</p>



<p>где $\varepsilon$ &#8212; небольшая константа, предотвращающая деление на ноль, а $\odot$ &#8212; произведение Адамара. Таким образом, для того чтобы нормализовать тензор размерностью, например, 28 x 28 x 64 потребуется два необучаемых $\hat{\mu}_B, \hat{\sigma}_B$ и два обучаемых $\gamma, \beta$ параметра для каждого из 64 каналов или 4 x 64 = 256 параметров.</p>



<p>На этапе предсказания данные нормализуются через скользящее среднее и скользящее СКО, полученные при обучении, а затем преобразуются с помощью выученных значений γ и β.</p>



<p>Важным вопросом является выбор этапа, на котором следует применять batch normalization. Авторы <a href="https://arxiv.org/abs/1502.03167" target="_blank" rel="noreferrer noopener">оригинальной статьи</a>⧉, предложившие этот метод, указывают, что преобразование данных следует использовать после операции свёртки и до применения функции активации (например, ReLU).</p>



<p>При этом многие исследователи и, в частности, создатель Keras Франсуа Шолле (François Chollet) <a href="https://github.com/keras-team/keras/issues/1802#issuecomment-187966878" target="_blank" rel="noreferrer noopener">говорят о том</a>⧉, что BN стоит использовать уже после ReLU.</p>



<p>Перейдем к созданию нейросети для классификации изображений из CIFAR-10.</p>



<h3 class="wp-block-heading">Архитектура сети</h3>



<p>Сеть будет состоять из трёх свёрточных слоёв, причём первый и третий слои будут состоять из свёртки, batch normalization и подвыборки, а второй слой &#8212; только из свёртки и batch normalization.</p>



<p>Примечание. Здесь стоит добавить, что при обсуждении архитектуры CNN, слоями называют как совокупность, например, свёрточного слоя и слоя подвыборки, так и отдельно свёрточный слой или слой max pooling.</p>



<p>Зададим размерности тензоров и рассчитаем количество параметров нейросети. Начнем со свёрточных слоёв. Размер входного изображения составляет 32 x 32 x 3 и при размере одного из 64 фильтров 5 x 5 x 3 результатом первого свёрточного слоя будет тензор признаков 28 x 28 x 64 (размер шага 1).</p>



<p>При этом потребуется 5 x 5 x 3 x 64 + 64 = 4 864 параметра свёртки и 4 x 64 = 256 параметров batch normalization. Еще раз обратим внимание, что только половина из них, то есть 256 / 2 = 128 являются обучаемыми.</p>



<p>Результатом max pooling (размер окна 2 x 2, шаг 2) будет тензор 14 x 14 x 64.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="450" src="../../wp-content/uploads/2025/03/image-45-1024x450.png" alt="архитектура свёрточной сети для работы с цветными изображениями 1" class="wp-image-36907" srcset="../../wp-content/uploads/2025/03/image-45-1024x450.png 1024w, ../../wp-content/uploads/2025/03/image-45-300x132.png 300w, ../../wp-content/uploads/2025/03/image-45-768x337.png 768w, ../../wp-content/uploads/2025/03/image-45-1536x674.png 1536w, ../../wp-content/uploads/2025/03/image-45-2048x899.png 2048w, ../../wp-content/uploads/2025/03/image-45-1200x527.png 1200w, ../../wp-content/uploads/2025/03/image-45-600x263.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Поясним, что #f &#8212; количество фильтров, f &#8212; размер фильтра, s &#8212; stride, то есть размер шага.</p>



<p>Во втором свёрточном слое при размере одного из 128 фильтров 3 x 3 x 3 результатом первого сверточного слоя будет тензор признаков 12 x 12 x 128 (размер шага 1). Для свёртки потребуется 3 x 3 x 64 x 128 + 128 = 73 856 параметров, для BN ㅡ 4 x 128 = 512 параметров. Max pooling здесь не применяется.</p>



<p>В третьем слое будет уже 256 фильтров 3 x 3 x 3 и результатом станет тензор 10 x 10 x 256 (размер шага 1). Потребуется 3 x 3 x 128 x 256 + 256 = 295 168 параметров свёртки и 4 x 128 = 1 024 BN. После max pooling (размер окна 2 x 2, шаг 2) получим тензор 5 x 5 x 256.</p>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="406" src="../../wp-content/uploads/2025/03/image-46-1024x406.png" alt="архитектура свёрточной сети для работы с цветными изображениями 2" class="wp-image-36908" srcset="../../wp-content/uploads/2025/03/image-46-1024x406.png 1024w, ../../wp-content/uploads/2025/03/image-46-300x119.png 300w, ../../wp-content/uploads/2025/03/image-46-768x305.png 768w, ../../wp-content/uploads/2025/03/image-46-1536x610.png 1536w, ../../wp-content/uploads/2025/03/image-46-2048x813.png 2048w, ../../wp-content/uploads/2025/03/image-46-1200x476.png 1200w, ../../wp-content/uploads/2025/03/image-46-600x238.png 600w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Таким образом, общее количество параметров свёртки составит 4 864 + 73 856 + 295 168 = 373 888, а параметров BN 256 + 512 + 1 024 = 1 792, из которых половина или 896 будут необучаемыми.</p>



<p>Перейдем к полносвязным слоям. Слой Flatten состоит из 6 400 нейронов, первый полносвязный слой &#8212; из 1 024. Количество весов 6 400 x 1 024 + 1 024 = 6 554 624. Между последующими слоями (см. схему ниже) потребуется 1 024 x 1 024 + 1 024 = 1 049 600, 1 024 x 512 + 512 = 524 800 и наконец 512 x 10 + 10 = 5 130 параметров.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="475" src="../../wp-content/uploads/2025/03/image-48-1024x475.png" alt="архитектура свёрточной сети для работы с цветными изображениями 3" class="wp-image-36910" style="width:461px;height:auto" srcset="../../wp-content/uploads/2025/03/image-48-1024x475.png 1024w, ../../wp-content/uploads/2025/03/image-48-300x139.png 300w, ../../wp-content/uploads/2025/03/image-48-768x357.png 768w, ../../wp-content/uploads/2025/03/image-48-1536x713.png 1536w, ../../wp-content/uploads/2025/03/image-48-1200x557.png 1200w, ../../wp-content/uploads/2025/03/image-48-600x279.png 600w, ../../wp-content/uploads/2025/03/image-48.png 1904w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>


<p>Таким образом, в полносвязных слоях будет 6 554 624 + 1 049 600 + 524 800 + 5 130 = 8 134 154 параметров. Общее же количество обучаемых параметров составит 373 888 + 896 + 8 134 154 = 8 508 938.</p>



<p>Также заметим, что существуют более эффективные (и более сложные) архитектуры свёрточных сетей. Нашей целью сегодня было познакомиться с основными инструментами таких моделей и продемонстрировать общие принципы построения CNN.</p>



<h3 class="wp-block-heading">Создание и обучение модели</h3>



<p>Зададим архитектуру в Keras.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149db832745099" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149db832745099-43">43</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-1"><span class="crayon-v">model3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">[</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">InputLayer</span><span class="crayon-sy">(</span><span class="crayon-v">shape</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strides</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">padding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'valid'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strides</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">128</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strides</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">padding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'valid'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Conv2D</span><span class="crayon-sy">(</span><span class="crayon-v">filters</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">256</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strides</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">padding</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'valid'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">BatchNormalization</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">MaxPooling2D</span><span class="crayon-sy">(</span><span class="crayon-v">pool_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">strides</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1024</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1024</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dropout</span><span class="crayon-sy">(</span><span class="crayon-v">rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">512</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'relu'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'softmax'</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149db832745099-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149db832745099-43"><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
</div>



<p>Соберём и обучим модель.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149e4575796229" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e4575796229-13">13</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-1"><span class="crayon-v">model3</span><span class="crayon-sy">.</span><span class="crayon-k ">compile</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e4575796229-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">optimizers</span><span class="crayon-sy">.</span><span class="crayon-e">Adam</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.001</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'categorical_crossentropy'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e4575796229-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">metrics</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-5"><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e4575796229-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-7"><span class="crayon-v">model3</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e4575796229-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e4575796229-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e4575796229-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">validation_split</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e4575796229-13"><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149e7076657249" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149e7076657249-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-1">Epoch 1/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-2">704/704 ━━━━━━━━━━━━━━━━━━━━ 477s 666ms/step - accuracy: 0.3067 - loss: 2.1834 - val_accuracy: 0.4960 - val_loss: 1.3971</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-3">Epoch 2/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-4">704/704 ━━━━━━━━━━━━━━━━━━━━ 499s 662ms/step - accuracy: 0.5228 - loss: 1.3261 - val_accuracy: 0.6122 - val_loss: 1.0955</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-5">Epoch 3/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-6">704/704 ━━━━━━━━━━━━━━━━━━━━ 496s 654ms/step - accuracy: 0.6158 - loss: 1.0954 - val_accuracy: 0.6792 - val_loss: 0.9641</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-7">Epoch 4/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-8">704/704 ━━━━━━━━━━━━━━━━━━━━ 503s 656ms/step - accuracy: 0.6705 - loss: 0.9382 - val_accuracy: 0.7122 - val_loss: 0.8334</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-9">Epoch 5/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-10">704/704 ━━━━━━━━━━━━━━━━━━━━ 505s 661ms/step - accuracy: 0.7114 - loss: 0.8438 - val_accuracy: 0.7312 - val_loss: 0.7774</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-11">Epoch 6/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-12">704/704 ━━━━━━━━━━━━━━━━━━━━ 500s 658ms/step - accuracy: 0.7418 - loss: 0.7608 - val_accuracy: 0.7530 - val_loss: 0.7443</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-13">Epoch 7/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-14">704/704 ━━━━━━━━━━━━━━━━━━━━ 494s 647ms/step - accuracy: 0.7656 - loss: 0.6877 - val_accuracy: 0.7696 - val_loss: 0.7124</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-15">Epoch 8/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-16">704/704 ━━━━━━━━━━━━━━━━━━━━ 513s 663ms/step - accuracy: 0.7817 - loss: 0.6502 - val_accuracy: 0.7598 - val_loss: 0.7373</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-17">Epoch 9/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-18">704/704 ━━━━━━━━━━━━━━━━━━━━ 499s 659ms/step - accuracy: 0.7973 - loss: 0.5923 - val_accuracy: 0.7840 - val_loss: 0.6468</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-19">Epoch 10/10</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149e7076657249-20">704/704 ━━━━━━━━━━━━━━━━━━━━ 498s 653ms/step - accuracy: 0.8149 - loss: 0.5487 - val_accuracy: 0.7882 - val_loss: 0.6357</div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149e7076657249-21">&lt;keras.src.callbacks.history.History at 0x7cfa55143910&gt;</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149ea830047970" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ea830047970-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-69770263149ea830047970-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ea830047970-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ea830047970-1"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Test accuracy:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model3</span><span class="crayon-sy">.</span><span class="crayon-e">evaluate</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-69770263149ea830047970-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">to_categorical</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ea830047970-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149ed484107639" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149ed484107639-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149ed484107639-1">Test accuracy: 0.7821999788284302</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Дополнительно сверимся с правильностью расчетов параметров модели.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.9.0 -->

		<div id="urvanov-syntax-highlighter-69770263149f0394373041" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-69770263149f0394373041-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-69770263149f0394373041-1"><span class="crayon-v">model3</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="975" height="1024" src="../../wp-content/uploads/2025/03/summary_3-975x1024.png" alt="архитектура свёрточной сети для работы с цветными изображениями, результат" class="wp-image-36911" style="width:636px;height:auto" srcset="../../wp-content/uploads/2025/03/summary_3-975x1024.png 975w, ../../wp-content/uploads/2025/03/summary_3-286x300.png 286w, ../../wp-content/uploads/2025/03/summary_3-768x807.png 768w, ../../wp-content/uploads/2025/03/summary_3-1200x1261.png 1200w, ../../wp-content/uploads/2025/03/summary_3-600x630.png 600w, ../../wp-content/uploads/2025/03/summary_3.png 1283w" sizes="auto, (max-width: 975px) 100vw, 975px" /></figure>



<p>Теперь создадим свёрточную нейросеть без использования Keras.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2026 <a href="../../index.html" class="site-name"><!--Дмитрий Макаров-->Дмитрий Макаров</a></p>

			</footer> <!-- footer -->

		</main>
		
<!-- Yandex.Metrika counter -->
<script type="text/javascript" >
   (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
   m[i].l=1*new Date();
   for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
   k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
   (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

   ym(100123342, "init", {
        clickmap:true,
        trackLinks:true,
        accurateTrackBounce:true
   });
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/100123342" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->

		<script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"/*"},{"not":{"href_matches":["/wp-*.php","/wp-admin/*","/wp-content/uploads/*","/wp-content/*","/wp-content/plugins/*","/wp-content/themes/mcluhan/*","/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.9" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https://www.dmitrymakarov.ru/wp-admin/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"learning\\/cnn-02\"}"};
//# sourceURL=mcluhan_global-js-extra
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
<script id="wp-emoji-settings" type="application/json">
{"baseUrl":"https://s.w.org/images/core/emoji/17.0.2/72x72/","ext":".png","svgUrl":"https://s.w.org/images/core/emoji/17.0.2/svg/","svgExt":".svg","source":{"concatemoji":"https://www.dmitrymakarov.ru/wp-includes/js/wp-emoji-release.min.js?ver=6.9"}}
</script>
<script type="module">
/* <![CDATA[ */
/*! This file is auto-generated */
const a=JSON.parse(document.getElementById("wp-emoji-settings").textContent),o=(window._wpemojiSettings=a,"wpEmojiSettingsSupports"),s=["flag","emoji"];function i(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function c(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0);const a=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data);return t.every((e,t)=>e===a[t])}function p(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var n=e.getImageData(16,16,1,1);for(let e=0;e<n.data.length;e++)if(0!==n.data[e])return!1;return!0}function u(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\u1fac8")}return!1}function f(e,t,n,a){let r;const o=(r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):document.createElement("canvas")).getContext("2d",{willReadFrequently:!0}),s=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(e=>{s[e]=t(o,e,n,a)}),s}function r(e){var t=document.createElement("script");t.src=e,t.defer=!0,document.head.appendChild(t)}a.supports={everything:!0,everythingExceptFlag:!0},new Promise(t=>{let n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),c.toString(),p.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"});const r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=e=>{i(n=e.data),r.terminate(),t(n)})}catch(e){}i(n=f(s,u,c,p))}t(n)}).then(e=>{for(const n in e)a.supports[n]=e[n],a.supports.everything=a.supports.everything&&a.supports[n],"flag"!==n&&(a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&a.supports[n]);var t;a.supports.everythingExceptFlag=a.supports.everythingExceptFlag&&!a.supports.flag,a.supports.everything||((t=a.source||{}).concatemoji?r(t.concatemoji):t.wpemoji&&t.twemoji&&(r(t.twemoji),r(t.wpemoji)))});
//# sourceURL=https://www.dmitrymakarov.ru/wp-includes/js/wp-emoji-loader.min.js
/* ]]> */
</script>
			
	</body>
</html>


<!-- Page supported by LiteSpeed Cache 7.7 on 2026-01-26 08:57:55 -->