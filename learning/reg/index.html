<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Регуляризация модели | Обучение модели</title>
	<meta name="description" content="Сегодня мы рассмотрим понятия разброса и смещения. Кроме этого, мы изучим регуляризацию и познакомимся с бэггингом для снижения разброса." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Регуляризация модели | Обучение модели" />
	<meta property="og:description" content="Сегодня мы рассмотрим понятия разброса и смещения. Кроме этого, мы изучим регуляризацию и познакомимся с бэггингом для снижения разброса." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/learning/reg/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2025-02-02T14:15:21+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/07/under-over-fitting.jpg" />
	<meta property="og:image:width" content="2424" />
	<meta property="og:image:height" content="845" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="1 минута" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/learning/reg/","url":"https://www.dmitrymakarov.ru/learning/reg/","name":"Регуляризация модели | Обучение модели","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/learning/reg/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/learning/reg/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2021/07/under-over-fitting-1024x357.jpg","datePublished":"2022-04-20T11:07:16+00:00","dateModified":"2025-02-02T14:15:21+00:00","description":"Сегодня мы рассмотрим понятия разброса и смещения. Кроме этого, мы изучим регуляризацию и познакомимся с бэггингом для снижения разброса.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/learning/reg/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/learning/reg/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/learning/reg/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2021/07/under-over-fitting.jpg","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2021/07/under-over-fitting.jpg","width":2424,"height":845},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/learning/reg/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Обучение модели","item":"https://www.dmitrymakarov.ru/learning/"},{"@type":"ListItem","position":3,"name":"Регуляризация модели"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-12563 page-child parent-pageid-5658 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa626e88139">Поиск:</label>
	<input type="search" id="search-form-67aa626e88139" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa626e881a9">Поиск:</label>
	<input type="search" id="search-form-67aa626e881a9" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-12563 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Регуляризация модели</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> > <a href="../index.html">Обучение модели</a></p>



<p>В рамках вводного курса мы обсудили вопрос разделения выборки на <a href="../../intro/train-test/index.html">обучающую и тестовую части</a>, а также затронули проблему переобучения и недообучения модели. Рассмотрим этот вопрос более подробно.</p>



<h2 class="wp-block-heading" id="0-pereobuchenie-i-nedoobuchenie-modeli">Переобучение и недообучение модели</h2>



<p><strong>Переобучение</strong> (overfitting) случается, когда модель показывает хороший результат на обучающей выборке и сильно &#171;проседает&#187; на тестовых данных. При <strong>недообучении</strong> (underfitting) наоборот у алгоритма не получается уловить зависимость на обучающих данных.</p>



<p>Вспомним график из вводного курса.</p>



<figure class="wp-block-image size-large"><img fetchpriority="high" decoding="async" width="1024" height="357" src="../../wp-content/uploads/2021/07/under-over-fitting-1024x357.jpg" alt="переобучение и недообучение модели" class="wp-image-3320" srcset="../../wp-content/uploads/2021/07/under-over-fitting-1024x357.jpg 1024w, ../../wp-content/uploads/2021/07/under-over-fitting-300x105.jpg 300w, ../../wp-content/uploads/2021/07/under-over-fitting-768x268.jpg 768w, ../../wp-content/uploads/2021/07/under-over-fitting-1536x535.jpg 1536w, ../../wp-content/uploads/2021/07/under-over-fitting-2048x714.jpg 2048w, ../../wp-content/uploads/2021/07/under-over-fitting-1200x418.jpg 1200w, ../../wp-content/uploads/2021/07/under-over-fitting-600x209.jpg 600w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Дополним его для наглядности иллюстрацией того, как может повести себя переобученная модель на тестовых данных.</p>



<figure class="wp-block-image size-large is-resized"><img decoding="async" width="1024" height="526" src="../../wp-content/uploads/2022/12/test_overfit-1024x526.jpg" alt="переобученная модель" class="wp-image-16682" style="width:655px;height:336px" srcset="../../wp-content/uploads/2022/12/test_overfit-1024x526.jpg 1024w, ../../wp-content/uploads/2022/12/test_overfit-300x154.jpg 300w, ../../wp-content/uploads/2022/12/test_overfit-768x395.jpg 768w, ../../wp-content/uploads/2022/12/test_overfit-600x308.jpg 600w, ../../wp-content/uploads/2022/12/test_overfit.jpg 1193w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Также рассмотрим пример переобучения и недообучения в задаче классификации.</p>



<figure class="wp-block-image size-large"><img decoding="async" width="1024" height="442" src="../../wp-content/uploads/2022/12/logreg_overfitting-1024x442.jpg" alt="переобучение и недообучение в задаче классификации" class="wp-image-16684" srcset="../../wp-content/uploads/2022/12/logreg_overfitting-1024x442.jpg 1024w, ../../wp-content/uploads/2022/12/logreg_overfitting-300x130.jpg 300w, ../../wp-content/uploads/2022/12/logreg_overfitting-768x332.jpg 768w, ../../wp-content/uploads/2022/12/logreg_overfitting-1200x519.jpg 1200w, ../../wp-content/uploads/2022/12/logreg_overfitting-600x259.jpg 600w, ../../wp-content/uploads/2022/12/logreg_overfitting.jpg 1259w" sizes="(max-width: 1024px) 100vw, 1024px" /></figure>



<p>Приведем еще один график. Предположим, что мы взяли полиномиальную регрессию и смотрим на значение функции потерь на обучающих и тестовых данных для различных степеней полинома.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="527" src="../../wp-content/uploads/2022/12/poly_reg_loss-1024x527.jpg" alt="RMSE и степень полинома" class="wp-image-16683" style="width:513px;height:264px" srcset="../../wp-content/uploads/2022/12/poly_reg_loss-1024x527.jpg 1024w, ../../wp-content/uploads/2022/12/poly_reg_loss-300x155.jpg 300w, ../../wp-content/uploads/2022/12/poly_reg_loss-768x396.jpg 768w, ../../wp-content/uploads/2022/12/poly_reg_loss-600x309.jpg 600w, ../../wp-content/uploads/2022/12/poly_reg_loss.jpg 1066w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Как вы видите, после определенной границы <em>сложности модели</em> ошибка на тестовых данных начала расти. Рассмотрим этот вопрос под разными углами и введем несколько новых терминов.</p>



<h3 class="wp-block-heading" id="1-slozhnost-modeli">Сложность модели</h3>



<p>Причиной пере- и недообучения может быть степень сложности используемой модели (model complexity). Под сложностью в данном случае понимается тип или типы используемых алгоритмов, способность к выявлению линейных или нелинейных зависимостей, количество рассматриваемых признаков и другие факторы.</p>



<p class="has-background" style="background-color:#ffe8c4">В целом, можно сказать, что более простая модель склонна к недообучению, более сложная &#8212; к переобучению.</p>



<p>Например, полиномиальная модель (особенно с полиномом высокой степени) зачастую способна уловить более сложную зависимость, чем модель линейной регрессии. Если модель хорошо описывает исходные данные, говорят, что у нее низкое смещение.</p>



<h3 class="wp-block-heading" id="2-smeshchenie">Смещение</h3>



<p><strong>Cмещение</strong> (bias) представляет собой разность между истинным и прогнозным значением.</p>



<p>$$ Bias = \mathbb{E}[\hat{f}(x)-f(x)] $$</p>



<p>Иными словами, смещение показывает, насколько хорошо модель обучилась на имеющихся данных (настроилась на выборку). </p>



<p>Впрочем, как мы уже сказали в самом начале, идеально обученная (переобученная) модель может иметь минимальное смещение и при этом показать слабые результаты на тестовых данных. В этом случае говорят о большом разбросе.</p>



<h3 class="wp-block-heading" id="3-razbros">Разброс</h3>



<p><strong>Разброс</strong> (variance) показывает насколько результат модели на обучающей выборке отличается от результата модели на тестовой выборке.</p>



<p>Другими словами, предсказания на тесте (например, на нескольких выборках) имеют разброс, и нам важно, чтобы эти результаты не слишком отличались (тогда можно сказать, что у модели хорошая обобщающая способность).</p>



<p>Математически, речь идет о дисперсии прогнозных значений.</p>



<p>$$ Variance = Var(\hat{y}) = \mathbb{E} \left[ \left( \hat{f}(x)-\mathbb{E}[\hat{f}(x)] \right)^2 \right] $$</p>



<h3 class="wp-block-heading" id="4-kompromiss-smeshcheniya-i-razbrosa">Компромисс смещения и разброса</h3>



<p>На практике стремление к снижению смещения может привести к увеличению разброса, т.е. переобучению, и, наоборот, высокое смещение модели может способствовать низкому разбросу, но смысла в этом не будет, потому что модель будет недообучена.</p>



<p>Эту проблему принято называть компромиссом или дилеммой смещения и разброса (bias-variance tradeoff). Посмотрим на рисунок ниже.</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="644" src="../../wp-content/uploads/2022/12/bias_variance_tradeoff-1024x644.png" alt="bias-variance tradeoff" class="wp-image-16687" style="width:732px;height:460px" srcset="../../wp-content/uploads/2022/12/bias_variance_tradeoff-1024x644.png 1024w, ../../wp-content/uploads/2022/12/bias_variance_tradeoff-300x189.png 300w, ../../wp-content/uploads/2022/12/bias_variance_tradeoff-768x483.png 768w, ../../wp-content/uploads/2022/12/bias_variance_tradeoff-1536x966.png 1536w, ../../wp-content/uploads/2022/12/bias_variance_tradeoff-1200x755.png 1200w, ../../wp-content/uploads/2022/12/bias_variance_tradeoff-600x378.png 600w, ../../wp-content/uploads/2022/12/bias_variance_tradeoff.png 1920w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /><figcaption class="wp-element-caption"><em>Источник: <a href="https://en.wikipedia.org/wiki/Bias%E2%80%93variance_tradeoff" target="_blank" rel="noreferrer noopener">Wikipedia</a></em>⧉</figcaption></figure></div>


<p>Рассмотрим еще одну полезную для понимания смещения и разброса иллюстрацию. На <strong>левом графике</strong> изобразим модели (каждая точка на графике &#8212; это прогноз одной модели), которые не очень хорошо описывают данные. Например, представим, что мы пытаемся описать полиномом первой степени зависимость, которая гораздо лучше описывается с помощью квадратичной функции.</p>



<p>Оценим прогнозы этих моделей в условной точке $x = 5.$</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="546" src="../../wp-content/uploads/2022/12/reduce-bias-variance-1024x546.jpg" alt="разложение ошибки на смещение, разброс/дисперсию и шум" class="wp-image-16998" style="width:701px;height:373px" srcset="../../wp-content/uploads/2022/12/reduce-bias-variance-1024x546.jpg 1024w, ../../wp-content/uploads/2022/12/reduce-bias-variance-300x160.jpg 300w, ../../wp-content/uploads/2022/12/reduce-bias-variance-768x409.jpg 768w, ../../wp-content/uploads/2022/12/reduce-bias-variance-600x320.jpg 600w, ../../wp-content/uploads/2022/12/reduce-bias-variance.jpg 1030w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Коричневым цветом обозначены те &#171;правильные&#187; ответы, которые мы хотели бы получить. Свести их в одну точку мы не можем, потому что даже в идеальном случае мы можем получить прогноз с точностью до <strong>шума</strong> (случайных колебаний).</p>



<p><strong>Bias</strong> (фиолетовая стрелка) отражает ошибку, связанную с тем, что мы ошиблись с выбором модели (например, степенью полинома). <strong>Разброс</strong> (зеленый цвет) &#8212; прогнозы моделей на нескольких обучающих выборках.</p>



<p>На правом графике, благодаря правильно подобранным (например, полином второй степени, снижает bias) и хорошо настроенным (снижает variance) моделям мы смогли существенно улучшить качество ответов.</p>



<h3 class="wp-block-heading" id="5-shum">Шум</h3>



<p>Шум представляет собой дисперсию истинных значений.</p>



<p>$$ \sigma^2_{\varepsilon} = Var(y) = \mathbb{E} \left[ \left( f(x)-\mathbb{E}[f(x)] \right)^2 \right] $$</p>



<h3 class="wp-block-heading" id="6-razlozhenie-oshibki-na-kvadrat-smeshcheniya-razbros-i-shum">Разложение ошибки на квадрат смещения, разброс и шум</h3>



<p>Изначально мы хотим предсказать следующую зависимость.</p>



<p>$$ \hat{f}(X) = f(X) + \varepsilon, \varepsilon \sim N(0, \sigma_{\varepsilon}) $$</p>



<p>Ошибка в точке $x$ равна</p>



<p>$$ Err(x) = \mathbb{E}[(f(x)-\hat{f}(x))^2] $$</p>



<p>Эту ошибку можно разложить на</p>



<p>$$ Err(x) = Bias^2 + Variance + Noise $$</p>



<p>$$ = \left( \mathbb{E}[\hat{f}(x)-f(x)] \right)^2 + \mathbb{E} \left[ \left( \hat{f}(x)-\mathbb{E}[\hat{f}(x)] \right)^2 \right] + \sigma^2_{\varepsilon}, $$</p>



<p>Обоснуем это разложение. Прежде всего вспомним, что <a href="https://proofwiki.org/wiki/Variance_as_Expectation_of_Square_minus_Square_of_Expectation" target="_blank" rel="noreferrer noopener">дисперсия равна</a>⧉ матожиданию квадрата случайной величины минус квадрат ее матожидания.</p>



<p>$$ Var(X) = \mathbb{E}[(X-\mathbb{E}[X])^2] = \mathbb{E}[X^2]-\mathbb{E}[X]^2 $$</p>



<p>Обозначим истинные значения как $y,$ прогнозные как $\hat{y}$.</p>



<p>$$ Err(x) = \mathbb{E}(y-\hat{y})^2 = \mathbb{E}(y^2 + \hat{y}^2-2y\hat{y})$$</p>



<p>$$ = \mathbb{E}(y^2)+\mathbb{E}(\hat{y})^2-2(\mathbb{E}y\hat{y})$$</p>



<p>Введем новые слагаемые $(\mathbb{E}y)^2-(\mathbb{E}y)^2$ и $(\mathbb{E}\hat{y})^2-(\mathbb{E}\hat{y})^2$.</p>



<p>$$ Err(x) = \mathbb{E}(y^2)-(\mathbb{E}y)^2+(\mathbb{E}y)^2 + $$</p>



<p>$$ \mathbb{E}(\hat{y}^2)-(\mathbb{E}\hat{y})^2+(\mathbb{E}\hat{y})^2-2(\mathbb{E}y\hat{y}) $$</p>



<p>Заметим, что</p>



<p>$$ \mathbb{E}(y^2)-(\mathbb{E}y)^2 = Var(y)$$</p>



<p>$$ \mathbb{E}(\hat{y}^2)-(\mathbb{E}\hat{y})^2 = Var(\hat{y}) $$</p>



<p>$$ (\mathbb{E}y)^2-2(\mathbb{E}y\hat{y})+(\mathbb{E}\hat{y})^2 = \mathbb{E}(y-\hat{y})^2 $$</p>



<p>Тогда,</p>



<p>$$ Err(x) = \underbrace{\mathbb{E}(y-\hat{y})^2}_{Bias^2} + \underbrace{Var(\hat{y})}_{Variance} + \underbrace{Var(y)}_{Noise} $$</p>



<h3 class="wp-block-heading" id="7-kak-borotsya-s-pereobucheniem">Как бороться с переобучением?</h3>



<p>Сложная, переобученная модель может иметь очень много признаков (особенно если речь идёт о полиноме).</p>



<p>Очевидно, в большинстве случае визуальный подбор степени полинома (как мы это делали ранее для линейной и логистической полиномиальных регрессий) не представляется возможным. Более того, модели с таким количеством признаков в силу их высокой сложности (complexity) склонны к переобучению.</p>



<p>Бороться с этим можно тремя способами:</p>



<p><strong>Первый вариант</strong>. Увеличить размер обучающей выборки. Маленькая выборка снижает обобщающую способность модели, а значит повышает разброс.</p>



<p><strong>Второй вариант</strong>. Уменьшить количество признаков (вручную или через алгоритм, кроме того вводить наказание за новые признаки, как например, скорректированный коэффициент детерминации, adjusted R-square). Опасность здесь &#8212; выбросить нужные признаки.</p>



<p><strong>Третий вариант</strong>. Использовать регуляризацию, которая позволяет снижать параметр (вес, коэффициент) признака и, таким образом, снижать его значимость. Предположим, что мы хотим уменьшить влияние второго признака в модели ниже.</p>



<p>$$ y = 15x_1 + 10x_2 + 5 \rightarrow y = 15x_1 + 5x_2 + 5 $$</p>



<p>Подобное изменение, как правило, приводит к тому, что модель меньше настраивается на шум (излишнюю вариативность) в обучающих данных и, как следствие, показывает лучшие результаты на тестовой выборке.</p>



<p class="has-background" style="background-color:#ffe8c4">Другими словами, по сравнению с обычной линейной регрессией, у нее немного большее смещение (bias), но зато заметно меньший разброс (variance).</p>



<p>Три дополнительных соображения:</p>



<ul class="wp-block-list">
<li>очевидно, что если мы снизим параметр признака до нуля, то этот признак будет удален из модели;</li>



<li>как правило, не имеет смысла применять регуляризацию к свободному коэффициенту $ \theta_0 $;</li>



<li>очень маленькие значения $\theta$ также могут повышать ошибку.</li>
</ul>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/1QxI072wyLmjybv6-EHnKrur6cBSBrFpc?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<div class="wp-block-file"><a id="wp-block-file--media-7c5c26d6-41c5-4071-8aab-9408c199ea3d" href="../../wp-content/uploads/2022/04/boston.csv">boston.csv</a><a href="../../wp-content/uploads/2022/04/boston.csv" class="wp-block-file__button wp-element-button" download aria-describedby="wp-block-file--media-7c5c26d6-41c5-4071-8aab-9408c199ea3d">Скачать</a></div>



<h2 class="wp-block-heading" id="8-regulyarizatsiya-lineynoy-regressii">Регуляризация линейной регрессии</h2>



<p>Рассмотрим несколько вариантов регуляризации линейной регрессии: Ridge, Lasso и Elastic Net.</p>



<h3 class="wp-block-heading" id="9-podgotovka-dannykh">Подготовка данных</h3>



<p>Подгрузим данные о недвижимости в Бостоне, разделим на обучающую и тестовую части и выполним стандартизацию.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dc7f950426273" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc7f950426273-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-1"><span class="crayon-v">boston</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/boston.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-3"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boston</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'LSTAT'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'RM'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'PTRATIO'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'INDUS'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-4"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">boston</span><span class="crayon-sy">.</span><span class="crayon-e">MEDV</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-6"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">model_selection </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-8"><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-12"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-14"><span class="crayon-v">scaler</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StandardScaler</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-16"><span class="crayon-v">X_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc7f950426273-17"><span class="crayon-v">X_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">scaler</span><span class="crayon-sy">.</span><span class="crayon-e">transform</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<h3 class="wp-block-heading" id="10-ordinary-least-squares">Ordinary Least Squares</h3>



<p>Построим регрессию без регуляризации методом наименьших квадратов и выведем RMSE на обучающей и тестовой выборках.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dc93927817764" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc93927817764-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-3"><span class="crayon-v">ols</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-4"><span class="crayon-v">ols</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-6"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ols</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-7"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ols</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-9"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">root_mean_squared_error</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-11"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc93927817764-12"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dc98594483870" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc98594483870-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc98594483870-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc98594483870-1">train: 5.255700309296848</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc98594483870-2">test: 5.127682560624116</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="11-ridge-regression">Ridge Regression</h3>



<h4 class="wp-block-heading" id="12-funktsiya-poter">Функция потерь</h4>



<p>Ридж-регрессия (ridge regression, гребневая регрессия) вводит наказание (penalty) за слишком большие коэффициенты. Это наказание представляет собой сумму коэффициентов $ \theta $, возведенных в квадрат (чтобы положительные и отрицательные значения не взаимоудалялись).</p>



<p>$$ J_{Ridge}(\theta) = MSE + \sum{\theta_i^2} $$</p>



<p>Опять же $\theta_0$ здесь не учитывается. В векторизованной форме,</p>



<p>$$ J_{Ridge}(\theta) = MSE + \theta^T \theta $$</p>



<p>Корень из скалярного произведения вектора на самого себя есть его длина. Так как в данном случае мы корень не извлекаем, то можем записать слагаемое регуляризации (regularization term) как </p>



<p>$$ J_{Ridge}(\theta) = MSE + || \theta ||^2_2 $$</p>



<p>Наконец, введем еще одно дополнение, параметр $\alpha$, который позволит нам контролировать силу воздействия этого слагаемого на уровень ошибки.</p>



<p>$$ J_{Ridge}(\theta) = MSE + \alpha \cdot || \theta ||^2_2 $$</p>



<p>Замечу также, что Ridge Regression также называют L2-регуляризацией, потому что она использует L2-норму в качестве соответствующего слагаемого.</p>



<p>Посмотрим на иллюстрацию регуляризации (параметры $\theta$ заменены на $\beta$).</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="762" height="528" src="../../wp-content/uploads/2022/12/L2_constraint.jpg" alt="ridge regression" class="wp-image-17060" style="width:595px;height:412px" srcset="../../wp-content/uploads/2022/12/L2_constraint.jpg 762w, ../../wp-content/uploads/2022/12/L2_constraint-300x208.jpg 300w, ../../wp-content/uploads/2022/12/L2_constraint-600x416.jpg 600w" sizes="auto, (max-width: 762px) 100vw, 762px" /></figure>



<p>При регуляризации у нас появляется, по сути, две функции ошибки: основная (синяя), наказывающая за отклонение истинных значений от прогнозных, и дополнительная (оранжевая), наказывающая за отклонение коэффициентов от нуля. Их сумму и будет пытаться минимизировать алгоритм.</p>



<p>Источник картинки и подробности <a href="https://explained.ai/regularization/index.html" target="_blank" rel="noreferrer noopener">здесь</a>⧉.</p>



<h4 class="wp-block-heading" id="13-normalnye-uravneniya">Нормальные уравнения</h4>



<p>Вспомним аналитическое решение задачи линейной регрессии.</p>



<p>$$ \theta = (X^TX)^{-1}X^Ty $$</p>



<p>В случае нормальных уравнений с L2-регуляризацией оптимальное решение можно найти через</p>



<p>$$ \theta = (X^TX + \alpha I)^{-1}X^Ty $$</p>



<p>$I$ представляет собой единичную матрицу размером $ (j+1) \times (j+1) $ с нулевым значением первого столбца первой строки (сдвиг), где $j$ &#8212; количество признаков.</p>



<p>Что интересно, регуляризация решает проблему вырожденных или необратимых матриц. Матрица будет вырожденной в случае, если количество признаков больше количества объектов и может быть необратима, если оно равно количеству объектов. Выражение $X^TX + \alpha I $ решает эту проблему.</p>



<p>Напишем собственный класс.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dc9b580925386" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9b580925386-24">24</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">RidgeReg</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-2"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">alpha</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-6"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">I</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">identity</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">I</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">linalg</span><span class="crayon-sy">.</span><span class="crayon-e">inv</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">I</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-23"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9b580925386-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">c_</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0013 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dc9f375352698" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dc9f375352698-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-1"><span class="crayon-v">ridge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeReg</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-3"><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-5"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-6"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dc9f375352698-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dca2299642109" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca2299642109-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca2299642109-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca2299642109-1">train: 5.258077962476522</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca2299642109-2">test: 5.104623428412015</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Ошибка на обучающей выборке немного выросла, на тесте немного уменьшилась. Сравним с sklearn.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dca4687131735" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca4687131735-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Ridge</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-3"><span class="crayon-v">ridge</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Ridge</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-5"><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-7"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-8"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-10"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca4687131735-11"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dca8010396406" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dca8010396406-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dca8010396406-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dca8010396406-1">train: 5.258077962476521</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dca8010396406-2">test: 5.104623428412015</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Выведем изменение коэффициентов на графике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcab495179070" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcab495179070-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-1"><span class="crayon-v">features</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">columns</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ridge</span><span class="crayon-sy">.</span><span class="crayon-v">coef_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linestyle</span><span class="crayon-o">=</span><span class="crayon-s">'none'</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-o">=</span><span class="crayon-s">'*'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">markersize</span><span class="crayon-o">=</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-i">r</span><span class="crayon-s">'Ridge; $\alpha = 10$'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">zorder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">features</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ols</span><span class="crayon-sy">.</span><span class="crayon-v">coef_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">=</span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linestyle</span><span class="crayon-o">=</span><span class="crayon-s">'none'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-o">=</span><span class="crayon-s">'o'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">markersize</span><span class="crayon-o">=</span><span class="crayon-cn">7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-o">=</span><span class="crayon-s">'green'</span><span class="crayon-sy">,</span><span class="crayon-v">label</span><span class="crayon-o">=</span><span class="crayon-s">'Linear Regression'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xticks</span><span class="crayon-sy">(</span><span class="crayon-v">rotation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcab495179070-8"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="318" height="303" src="../../wp-content/uploads/2022/12/ridge_coefs.png" alt="изменение коэффициентов в ridge regression" class="wp-image-17066" srcset="../../wp-content/uploads/2022/12/ridge_coefs.png 318w, ../../wp-content/uploads/2022/12/ridge_coefs-300x286.png 300w" sizes="auto, (max-width: 318px) 100vw, 318px" /></figure>



<h4 class="wp-block-heading" id="14-metod-gradientnogo-spuska">Метод градиентного спуска</h4>



<p>Эту же задачу можно решить методом градиентного спуска. Функция потерь в этом случае будет иметь вид</p>



<p>$$&nbsp;J({\theta_j})&nbsp;=&nbsp;\frac{1}{2n}&nbsp;\sum&nbsp;(y-\theta&nbsp;X)^2&nbsp;+ \frac{1}{2n} \lambda \theta^T \theta $$</p>



<p>Для градиентного спуска, чтобы не запутаться, обозначим коэффициент скорости обучения через $\alpha$, а параметр регуляризации через $\lambda$. При этом градиент будет равен</p>



<p>$$&nbsp;\frac{\partial}{\partial&nbsp;\theta_j}&nbsp;J(\theta)&nbsp;=&nbsp;\left( -x_j(y-X\theta)&nbsp;+ \lambda \theta&nbsp;\right) \times&nbsp;\frac{1}{n} $$</p>



<p>Нормализовывать сдвиг не обязательно (в первую очередь имеют значения наклоны). Здесь мы это делаем, чтобы упростить код. Перейдем к практике. Начнем с собственного класса.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcad093321333" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcad093321333-38">38</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">RidgeGD</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">alpha</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-7"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">c_</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradient</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">iter</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss_history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">gradient</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">grad</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-32"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">thetas</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-33"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">loss_history</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-35"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcad093321333-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0027 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcb0212217036" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcb0212217036-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-1"><span class="crayon-v">ridge_gd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeGD</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-3"><span class="crayon-v">ridge_gd</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-5"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge_gd</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-6"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge_gd</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcb0212217036-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcc7991737046" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc7991737046-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc7991737046-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc7991737046-1">train: 5.255700309301131</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc7991737046-2">test: 5.127682311863072</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Сравним с sklearn. Для того чтобы оптимизировать Ridge регрессию методом градиентного спуска, используем класс SGDRegressor с параметром penalty = &#8216;l2&#8217;. Кроме того, укажем другие параметры для того, чтобы применяемый алгоритм был максимально близок к написанному вручную коду.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcc9431380279" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcc9431380279-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">SGDRegressor</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-3"><span class="crayon-v">ridge_gd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SGDRegressor</span><span class="crayon-sy">(</span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'squared_error'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">penalty</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'l2'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50000</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'constant'</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">eta0</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.001</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-11"><span class="crayon-v">ridge_gd</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-12">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-13"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge_gd</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-14"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">ridge_gd</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-16"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcc9431380279-17"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dccb080590712" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dccb080590712-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dccb080590712-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dccb080590712-1">train: 5.25595467395471</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dccb080590712-2">test: 5.120506389637218</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="15-vybor-alpha">Выбор $\alpha$</h4>



<p>Подобрать оптимальный гиперпараметр регуляризации можно, в частности, с помощью класса RidgeCV, который одновременно выполнит оценку качества модели с помощью перекрестной валидации.</p>



<p>Приведем пример.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcdf513447101" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcdf513447101-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">RidgeCV</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-3"><span class="crayon-c"># укажем параметры регуляризации alpha, которые хотим протестировать</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-4"><span class="crayon-c"># дополнительно укажем количество частей (folds), параметр cv,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-5"><span class="crayon-c"># на которое нужно разбить данные при оценке качества модели</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-6"><span class="crayon-v">ridge_cv</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">RidgeCV</span><span class="crayon-sy">(</span><span class="crayon-v">alphas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cv</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-7"><span class="crayon-v">ridge_cv</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-9"><span class="crayon-c"># выведем оптимальный параметр и достигнутое качество</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcdf513447101-10"><span class="crayon-v">ridge_cv</span><span class="crayon-sy">.</span><span class="crayon-v">alpha_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ridge_cv</span><span class="crayon-sy">.</span><span class="crayon-v">best_score_</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dce1875887163" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce1875887163-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce1875887163-1">(10.0, 0.6482859868459572)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="16-lasso-regression">Lasso Regression</h3>



<p>Регрессия Lasso для регуляризации использует сумму весов по модулю, то есть L1-норму.</p>



<h4 class="wp-block-heading" id="17-sravnenie-l1-i-l2-regulyarizatsii">Сравнение L1 и L2 регуляризации</h4>



<p>$$ J_{Lasso}(\theta) = MSE + \alpha \cdot || \theta ||_1 $$</p>



<p>Отличие заключается в том, что Ridge-регрессия при возведении $\theta$ в квадрат сильнее &#171;наказывает&#187; за большие коэффициенты, Lasso &#171;наказывает&#187; все коэффициенты одинаково. Например, если $\theta$ равен $ \begin{bmatrix} 10&nbsp;\\ 5 \end{bmatrix} $, то в первом случае L2-регрессии penalty составит $ 10^2 + 5^2 = 125 $, в случае L1, только 15. При увеличении первого коэффициента на единицу L2-penalty составит $ 11^2 + 5^2 = 146 $, L1 увеличится до 16.</p>



<p>Одновременно этот пример показывает особую важность масштабирования признаков при использовании алгоритма с регуляризацией.</p>



<h4 class="wp-block-heading" id="18-obnulenie-koeffitsientov">Обнуление коэффициентов</h4>



<p>L1 регуляризация может полностью обнулить часть коэффициентов и, таким образом, исключить соответствующие признаки из модели. Эта особенность Lasso регрессии называется parameter sparcity.</p>



<h5 class="wp-block-heading" id="19-matematika">Математика</h5>



<p>Вначале рассмотрим модель с L2-регуляризацией с одним признаком и одним коэффициентом $\theta$.</p>



<p>$$ L_2 = (y-x\theta)^2+\alpha\theta^2 = y^2-2xy\theta+x^2\theta^2+\alpha\theta^2 $$</p>



<p>Найдем производную относительно $\theta$, приравняем ее к нулю и решим для $\theta$.</p>



<p>$$ \frac{\partial L_2}{\partial \theta} = -2xy + 2x^2\theta + 2\alpha\theta $$</p>



<p>$$ -2xy + 2x^2\theta + 2\alpha\theta = 0 $$</p>



<p>$$ \theta(x^2 + \alpha ) = xy $$</p>



<p>$$ \theta = \frac{xy}{(x^2 + \alpha)} $$</p>



<p>Коэффициент $\theta$ превратится в ноль для ненулевых значений $x$ и $y$ при $\alpha \rightarrow \inf$. Сравним с L1-регуляризацией. Найдем производную относительно $\theta,$ приравняем к нулю и решим для $\theta$ для случаев $\theta &gt; 0$ (в точке ноль производная функции не определена).</p>



<p>$$ \frac{\partial L_1}{\partial \theta} = -2xy + 2x^2\theta + \alpha $$</p>



<p>$$ -2xy + 2x^2\theta + \alpha = 0 $$</p>



<p>$$ 2x^2\theta = 2xy-\alpha $$</p>



<p>$$ \theta = \frac{2xy-\alpha}{2x^2} $$</p>



<p>Сдалаем то же самое для случая, когда $\theta &lt; 0$.</p>



<p>$$ \frac{\partial L_1}{\partial \theta} = -2xy + 2x^2\theta-\alpha $$</p>



<p>$$ -2xy + 2x^2\theta-\alpha = 0 $$</p>



<p>$$ 2x^2\theta = (\alpha + 2xy) $$</p>



<p>$$ \theta = \frac{\alpha + 2xy}{2x^2} $$</p>



<p>В обоих случаях при определенных $x$, $y$ и $\alpha$ параметр $\theta$ может быть равен нулю.</p>



<p>Дополнительно сравним L2 и L1 нормы двух векторов $ \begin{bmatrix} 1&nbsp;\\ 0 \end{bmatrix} $ и $ \begin{bmatrix} \frac{1}{\sqrt{2}}&nbsp;\\ \frac{1}{\sqrt{2}} \end{bmatrix} $.</p>



<p>В случае L2-нормы, их длина будет равна единице. В случае L1-нормы длина первого вектора будет равна единице, а второго $\sqrt{2} \approx 1,41$. Таким образом, L1 регуляризация не только допускает, но и способствует обнулению коэффициентов.</p>



<h5 class="wp-block-heading" id="20-vizualizatsiya">Визуализация</h5>



<p>Приведем визуализацию границ двух видов регуляризации из книги T. Hastie <em>The Elements of Statistical Learning</em>.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="951" height="530" src="../../wp-content/uploads/2022/12/reg_compare.jpg" alt="границы Ridge и Lasso регуляризации" class="wp-image-17058" style="width:650px;height:362px" srcset="../../wp-content/uploads/2022/12/reg_compare.jpg 951w, ../../wp-content/uploads/2022/12/reg_compare-300x167.jpg 300w, ../../wp-content/uploads/2022/12/reg_compare-768x428.jpg 768w, ../../wp-content/uploads/2022/12/reg_compare-600x334.jpg 600w" sizes="auto, (max-width: 951px) 100vw, 951px" /></figure>



<p>Изолинии отображают уровни ошибки при определенных параметрах $\theta$. Синий ромб и круг задают соответственно границу L1 и L2 регуляризации.</p>



<h4 class="wp-block-heading" id="21-koordinatnyy-spusk">Координатный спуск</h4>



<p>Как уже было замечено, производная функции абсолютной величины не определена в точке $x = 0$ и, как следствие, мы не можем использовать обычный алгоритм градиентного спуска.</p>



<p>При этом мы можем на каждой итерации двигаться вниз вдоль одной из координат и остановиться, если этот шаг окажется меньше, чем некоторое заданное нами пороговое значение. Такой метод называется методом <strong>координатного спуска</strong> (coordinate descent).</p>



<p>Приведем иллюстрацию из <a href="https://en.wikipedia.org/wiki/Coordinate_descent" target="_blank" rel="noreferrer noopener">Википедии</a>⧉.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="750" height="750" src="../../wp-content/uploads/2022/12/coordinate_descent.png" alt="алгоритм координатного спуска" class="wp-image-17081" style="width:560px;height:560px" srcset="../../wp-content/uploads/2022/12/coordinate_descent.png 750w, ../../wp-content/uploads/2022/12/coordinate_descent-300x300.png 300w, ../../wp-content/uploads/2022/12/coordinate_descent-150x150.png 150w, ../../wp-content/uploads/2022/12/coordinate_descent-600x600.png 600w" sizes="auto, (max-width: 750px) 100vw, 750px" /></figure>



<p>Примечание. Обратим внимание, что в данном случае $x$ и $y$ обозначают веса или коэффициенты, а не данные. Такая нотация принята в литературе по оптимизации.</p>



<p>Выбрать, по какой координате спускаться можно разными способами, в частности, можно:</p>



<ul class="wp-block-list">
<li>выбирать признак (координату) случайным образом; или</li>



<li>просто идти от признака 0 до $j$ (далее признаки мы будем обозначать именно так).</li>
</ul>



<p>Рассмотрим, как координатный спуск выглядит с точки зрения математики.</p>



<h4 class="wp-block-heading" id="22-matematika">Математика</h4>



<p>Итак, напомню, функция потерь будет иметь вид</p>



<p>$$ J_{Lasso}(\theta) = MSE + \alpha \cdot || \theta ||_1 $$</p>



<p>Вначале обратимся к первому компоненту, а именно MSE. Вспомним, чему равен градиент MSE.</p>



<p>$$ \frac{\partial J}{\partial \theta_j} = \frac{1}{n} \cdot \left( -x_j(y-X\theta) \right) $$</p>



<p>Перепишем $y-X\theta$ как $y-(\theta_kX_k+\theta_jx_j)$.</p>



<p>$$ \frac{1}{n} \cdot \left( -x_j(y-(\theta_kX_k+\theta_jx_j)) \right) $$</p>



<p>Другими словами, выделим ту координату $j$ (признак), по которой мы будем спускаться на конкретной итерации. $\theta_kX_k$ &#8212; это прогноз модели без коордианты $j$. Раскроем, а затем реорганизуем скобки.</p>



<p>$$ \frac{1}{n} \cdot \left( -x_j((y-\theta_kX_k)-\theta_jx_j) \right) $$</p>



<p>Умножим $-x_j$ на каждое из слагаемых.</p>



<p>$$ \frac{1}{n} \cdot \left( -x_j(y-\theta_kX_k) + \theta_j x_j^2 \right) $$</p>



<p>Обозначим компоненты через новые переменные $\rho$ (&#171;ро&#187;) и $z$.</p>



<p>$$ \rho_j = x_j(y-\theta_kX_k) $$</p>



<p>Примечание. Минус перед $x_j$ появится в окончательной формуле ниже.</p>



<p>$$ z_j = x_j^2 $$</p>



<p class="has-background" style="background-color:#ffe8c4">Переменная $\rho$ показывает, насколько признак $x_j$ коррелирует с остатками модели $y-\theta_kX_k$, построенной без $j$. Если $\rho$ (т.е. корреляция) растет, значит этот признак важен для модели, и его вес стоит увеличить.</p>



<p>Тогда выражение будет иметь вид</p>



<p>$$ \frac{\partial L}{\partial \theta_j} = -\frac{1}{n}\rho_j + \frac{1}{n} \theta_jz_j $$</p>



<p>Приравняв производную к нулю, найдем решение относительно $\theta_j$.</p>



<p>$$ \theta_j = \frac{\rho_j}{z_j} $$</p>



<p>Замечу, что $z_j$, то есть скалярное произведение вектора признака $x_j$ на самого себя, будет равно единице, если признаки будут предварительно нормализованы (приведены к единичной L2 норме).</p>



<p>Обратимся ко второму компоненту &#8212; слагаемому регуляризации. Так как производная в точке $|\theta_j| = 0$ не определена, воспользуемся таким понятием как <strong>субградиент</strong> (subgradient). По сути, субградиентом является множество возможных градиентов в определенной точке. Приведем иллюстрацию для субградиентов в точке $|\theta_j| = 0$.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="678" src="../../wp-content/uploads/2023/01/subgradients-1024x678.jpg" alt="субградиенты" class="wp-image-17091" style="width:648px;height:429px" srcset="../../wp-content/uploads/2023/01/subgradients-1024x678.jpg 1024w, ../../wp-content/uploads/2023/01/subgradients-300x199.jpg 300w, ../../wp-content/uploads/2023/01/subgradients-768x509.jpg 768w, ../../wp-content/uploads/2023/01/subgradients-1200x795.jpg 1200w, ../../wp-content/uploads/2023/01/subgradients-600x397.jpg 600w, ../../wp-content/uploads/2023/01/subgradients.jpg 1309w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Как видно, субградиенты могут принимать значения $[-1, 1]$ (градиенты функции абсолютного значения) или вернее от $[-\alpha, \alpha]$, то есть параметра, на который мы умножаем слагаемое регуляризации.</p>



<p>$$ \alpha \frac{\partial |\theta_j|}{\partial \theta_j} = \left\{ \begin{matrix} -\alpha &amp; \text{when } \theta_j &lt; 0 \\ [-\alpha, \alpha] &amp; \text{when } \theta_j = 0 \\ \alpha &amp; \text{when } \theta_j &lt; 0 \end{matrix} \right. ​$$</p>



<p>Объединим две производные.</p>



<p>$$ \frac{\partial L(\theta)}{\partial \theta_j} = -\frac{1}{n} \rho_j + \frac{1}{n} \theta_j z_j + \left\{ \begin{matrix} -\alpha &amp; \text{when } \theta_j &lt; 0 \\ [-\alpha, \alpha] &amp; \text{when } \theta_j = 0 \\ \alpha &amp; \text{when } \theta_j &lt; 0 \end{matrix} \right. ​$$</p>



<p>Рассмотрим каждый из трех случаев по отдельности.</p>



<p><strong>Вариант 1</strong>. $\theta_j &lt; 0$</p>



<p>$$ -\frac{1}{n}\rho_j + \frac{1}{n} \theta_jz_j-\alpha = 0 $$</p>



<p>$$ \theta_j = \frac{\rho_j + n\alpha}{z_j} $$</p>



<p>Для того чтобы $\theta_j &lt; 0$, необходимо чтобы $\rho_j &lt; n\alpha. $</p>



<p><strong>Вариант 2</strong>. $\theta_j = 0$</p>



<p>$$ -\frac{1}{n}\rho_j + \frac{1}{n} \theta_jz_j + [-\alpha, \alpha] = 0 $$</p>



<p>$$ \theta_j = \left[ \frac{\rho_j-n\alpha}{z_j}, \frac{\rho_j + n\alpha}{z_j} \right] $$</p>



<p>Для того чтобы $ \theta_j = 0 $, $ -n\alpha\ \leq \rho_j \leq n\alpha. $</p>



<p><strong>Вариант 3</strong>. $\theta_j &gt; 0$</p>



<p>$$ -\frac{1}{n}\rho_j + \frac{1}{n} \theta_jz_j + \alpha = 0 $$</p>



<p>$$ \theta_j = \frac{\rho_j-n\alpha}{z_j} $$</p>



<p>Для того чтобы $\theta_j &gt; 0$, $\rho_j &gt; n\alpha. $</p>



<p>Сдвиг $\theta_0$ не регуляризуется и изменяется с помощью частной производной MSE (первое слагаемое).</p>



<p>$$ \theta_0 = \frac{\rho_0}{z_0} $$</p>



<p>Таким образом, шаги алгоритма координатного спуска будут следующими:</p>



<p><strong>Шаг 1</strong>. Добавить первый (!) столбец из единиц для коэффициента $\theta_0$. Инициализировать веса $\theta$;</p>



<p><strong>Шаг 2</strong>. Рассчитать $z_j$;</p>



<p>$$&nbsp;z_j&nbsp;=&nbsp;\sum&nbsp;x_j^2 $$</p>



<p><strong>Шаг 3</strong>. Задать начальный максимальный размер шага (max_step) и пороговое значение (tolerance);</p>



<p><strong>Шаг 4</strong>. Пока максимальный размер шага больше порогового значения проходиться в цикле по каждой из координат (признаку), рассчитывать $&nbsp;\rho_j = \sum x_j((y-\theta_kX_k) $ и обновлять вес $\theta$ этого признака в соответствии со следующими правилами.</p>



<p>Если $j = 0,$ то есть речь идет о первом по счету коэффициенте $\theta_0,$ то $\theta_j&nbsp;=&nbsp;\frac{ρ_j}{z_j}.$ В остальных случаях:</p>



<p>$$ \theta_j = \left\{ \begin{array}{ll} \frac{\rho_j + n \alpha}{z_j} &amp; \text{if} &amp; \rho_j &lt; -n \alpha \\ 0 &amp; \text{if} &amp; -n \alpha ≤ \rho_j ≤ n \alpha \\ \frac{\rho_j-n \alpha}{z_j} &amp; \text{if} &amp; \rho_j &gt; n \alpha \end{array} \right. $$</p>



<p>Обратите внимание, если $ -n\alpha\ \leq \rho_j \leq n\alpha $ (то есть корреляция признака очень мала по модулю), то коэффициент будет обнулен и исключен из модели. В двух других случаях (варианты 1 и 3), мы будем увеличивать коэффициент при большом отрицательном $\rho_j$ и уменьшать при большом положительном (т.е. выполнять регуляризацию).</p>



<p>Посмотрим на график ниже.</p>



<figure class="wp-block-image size-large is-resized"><img loading="lazy" decoding="async" width="1024" height="567" src="../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso-1024x567.jpg" alt="сравнение моделей без регуляризации и с Ridge и Lasso регуляризацией" class="wp-image-17103" style="width:798px;height:442px" srcset="../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso-1024x567.jpg 1024w, ../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso-300x166.jpg 300w, ../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso-768x425.jpg 768w, ../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso-1200x664.jpg 1200w, ../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso-600x332.jpg 600w, ../../wp-content/uploads/2023/01/comp_MSE_ridge_lasso.jpg 1239w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<p>Такое ограничение называется мягким порогом (soft thresholding). Для сравнения приведем Ridge регрессию, которая сокращает коэффициенты на всем диапазоне $\theta$, но не приводит их к нулевым значениям.</p>



<h4 class="wp-block-heading" id="23-realizatsiya-na-pitone">Реализация на Питоне</h4>



<p>Объявим вспомогательные функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dce5894468446" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dce5894468446-27">27</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-1"><span class="crayon-c"># добавим столбец из единиц в матрицу признаков</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">c_</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-5"><span class="crayon-c"># объявим функцию гипотезы</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># 506 х (4 + 1) на (4 + 1) х 1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># 506 x 1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-10"><span class="crayon-c"># рассчитаем rho_j</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-11"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">rho</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># удалим признак (координату) j из матрицы признаков и вектора весов</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x_k</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">delete</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">theta_k</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">delete</span><span class="crayon-sy">(</span><span class="crayon-i">theta</span><span class="crayon-h"> </span><span class="crayon-sy">,</span><span class="crayon-v">j</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># сделаем прогноз без j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">y_pred_k</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-v">x_k</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta_k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># найдем остатки при прогнозе без j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-18"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">residuals_k</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y_pred</span><span class="crayon-sy">_</span>k</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-19"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># вычислим rho_j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">residuals_k</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">_</span>j</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-23"><span class="crayon-c"># рассчитаем z</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-24"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">compute_z</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># рассчитаем z (т.е. L2 норму) для каждого столбца (axis = 0)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">z_vector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dce5894468446-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">z_vector</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
</div>



<p>Объявим функцию координатного спуска.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcec684627758" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcec684627758-41">41</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">coordinate_descent</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tolerance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">theta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">dtype</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">float</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-5"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">compute_z</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">max_step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100.</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">iterations</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># tolerance - пороговое значение, если шаг меньше, остановимся</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-v">max_step</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">tolerance</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">iterations</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">old_theta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># поочередно выберем каждый из признаков</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">theta</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># рассчитаем rho_j</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">rho</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># пропишем обновление для сдвига (первый по счету коэффициент)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># пропишем обновления для остальных признаков</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">elif</span><span class="crayon-h"> </span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">elif</span><span class="crayon-h"> </span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">and</span><span class="crayon-h"> </span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">elif</span><span class="crayon-h"> </span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">theta</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rho_j</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-o">*</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># запишем текущий максимальный для всех координат (!!!) размер шага</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># (обратите внимание, код ниже выполняется после цикла for)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">step_sizes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">abs</span><span class="crayon-sy">(</span><span class="crayon-v">old_theta</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">max_step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">step_sizes</span><span class="crayon-sy">.</span><span class="crayon-k ">max</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcec684627758-41"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">theta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_step</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
</div>



<p>Протестируем алгоритм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcef817089421" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcef817089421-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-1"><span class="crayon-v">theta_opt</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">max_step</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">coordinate_descent</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">tolerance</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-5"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">set_printoptions</span><span class="crayon-sy">(</span><span class="crayon-v">precision</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">suppress</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-7"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"Intercept is:"</span><span class="crayon-sy">,</span><span class="crayon-v">theta_opt</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nCoefficients are:\n"</span><span class="crayon-sy">,</span><span class="crayon-v">theta_opt</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcef817089421-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nNumber of iterations is:"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">iterations</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcf1459495639" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf1459495639-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf1459495639-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf1459495639-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf1459495639-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf1459495639-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf1459495639-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf1459495639-1">Intercept is: 23.01581920903955</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf1459495639-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf1459495639-3">Coefficients are:</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf1459495639-4"> [-4.228&nbsp;&nbsp;3.107 -1.811&nbsp;&nbsp;0.&nbsp;&nbsp; ]</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf1459495639-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf1459495639-6">Number of iterations is: 11</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Мы видим, что модель сочла признак INDUS не имеющим значения для данной модели и обнулила соответствующий коэффициент. Сравним с классом Lasso библиотеки sklearn.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcf3555314367" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf3555314367-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">Lasso</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-2"><span class="crayon-v">lasso</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">Lasso</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-3"><span class="crayon-v">lasso</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"sklearn Lasso intercept :"</span><span class="crayon-sy">,</span><span class="crayon-v">lasso</span><span class="crayon-sy">.</span><span class="crayon-v">intercept_</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-6"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nsklearn Lasso coefficients :\n"</span><span class="crayon-sy">,</span><span class="crayon-v">lasso</span><span class="crayon-sy">.</span><span class="crayon-v">coef_</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf3555314367-7"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"\nsklearn Lasso number of iterations :"</span><span class="crayon-sy">,</span><span class="crayon-v">lasso</span><span class="crayon-sy">.</span><span class="crayon-v">n_iter_</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcf6560450819" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf6560450819-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf6560450819-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf6560450819-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf6560450819-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf6560450819-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf6560450819-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf6560450819-1">sklearn Lasso intercept : 23.01581920903955</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf6560450819-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf6560450819-3">sklearn Lasso coefficients :</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf6560450819-4"> [-4.228&nbsp;&nbsp;3.107 -1.811&nbsp;&nbsp;0.&nbsp;&nbsp; ]</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf6560450819-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf6560450819-6">sklearn Lasso number of iterations : 10</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="24-elastic-net-regression">Elastic Net Regression</h3>



<p>Регрессия Elastic Net использует как L1, так и L2 регуляризацию.</p>



<p>$$ J_{ElasticNet}(\theta) = MSE + \alpha_1 \cdot || \theta ||_1 + \alpha_2 \cdot || \theta ||_2^2 $$</p>



<p>Так как в этой модели есть компонент L1, для которого в точке $|\theta_j| = 0$ производная не определена, используем один из возможных субградиентов, а именно нулевой субградиент (красная пунктирная линия $g_3$ на рисунке выше).</p>



<p>Другими словами, субградиент для компонента будет выглядеть следующим образом</p>



<p>$$ \frac{\partial J_{L1}}{\partial_{sub} \theta} = \left\{ \begin{matrix} 1 &amp; \text{if } \theta &gt; 0 \\ 0 &amp; \text{if } \theta = 0 \\ -1 &amp; \text{if } \theta &lt; 0 \end{matrix} \right. ​$$</p>



<p>Это условие соответствует сигнум-функции или функции знака (<a href="https://en.wikipedia.org/wiki/Sign_function" target="_blank" rel="noreferrer noopener">sign function</a>⧉). На Питоне можно использовать <strong>np.sign()</strong>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcf9182760447" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcf9182760447-39">39</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-1"><span class="crayon-t">class</span><span class="crayon-h"> </span><span class="crayon-e">ElasticNet</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">__init__</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">None</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">a1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">a1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-6"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">a2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-8"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-v">c_</span><span class="crayon-sy">[</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">ones</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">a1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">abs</span><span class="crayon-sy">(</span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-14"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradient</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">h</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">a1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">sign</span><span class="crayon-sy">(</span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">a2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">20000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">iter</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss_history</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">grad</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">gradient</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">thetas</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">-=</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">grad</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-33"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">thetas</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-34"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">loss_history</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">loss_history</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-36"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-r">self</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">.</span><span class="crayon-k ">copy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-e">add_ones</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcf9182760447-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-r">self</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0029 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcfb169109042" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcfb169109042-9">9</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-1"><span class="crayon-v">elastic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ElasticNet</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-3"><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-5"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-6"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-8"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcfb169109042-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dcff159376924" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dcff159376924-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dcff159376924-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dcff159376924-1">train: 5.255705191138267</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dcff159376924-2">test: 5.127348870379186</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd01308723407" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd01308723407-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd01308723407-1"><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-v">thetas</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd03360979970" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd03360979970-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd03360979970-1">array([23.009, -4.473,&nbsp;&nbsp;3.219, -1.998,&nbsp;&nbsp;0.317])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<p>Сравним с классом ElasticNet библиотеки sklearn.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd05233990932" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd05233990932-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">ElasticNet</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-3"><span class="crayon-v">elastic</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">ElasticNet</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-4"><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-6"><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-8"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-9"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-11"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd05233990932-12"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">root_mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd06878638555" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd06878638555-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd06878638555-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd06878638555-1">train: 5.259317264886122</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd06878638555-2">test: 5.100827371724984</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd0a503961649" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0a503961649-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0a503961649-1"><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-v">intercept_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">elastic</span><span class="crayon-sy">.</span><span class="crayon-v">coef_</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd0c801659762" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0c801659762-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0c801659762-1">(23.01581920903955, array([-4.287,&nbsp;&nbsp;3.179, -1.944,&nbsp;&nbsp;0.146]))</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Замечу, что класс ElasticNet библиотеки sklearn использует координатный спуск для минимизации функции потерь. Кроме того, в документации можно посмотреть, как единственный параметр $\alpha$ регулирует значимость L1 и L2 компонентов.</p>



<h2 class="wp-block-heading" id="25-regulyarizatsiya-neyroseti">Регуляризация нейросети</h2>



<p>В качестве иллюстрации приведем примеры L2 регуляризации нейронной сети. Реализуем эту модель на основе <a href="../neural/index.html">уже созданного алгоритма</a> бинарной классификации со смещением с двумя признаками и одним скрытым слоем (три нейрона) и сравним результаты обучения.</p>



<h3 class="wp-block-heading" id="26-funktsiya-poter-s-regulyarizatsiey">Функция потерь с регуляризацией</h3>



<p>Посмотрим на функцию потерь с учетом регуляризации (бинарная классификация)</p>



<p>$$ J(W) = J_{\text{nn}}(W) + J_{\text{reg}} (W) = $$</p>



<p>$$ -\frac{1}{n} \sum y \cdot log(a^{(L)}) + (1-y) \cdot log(1-a^{(L)}) + $$</p>



<p>$$ + \frac{\lambda}{2n} \sum \sum \sum W^{(l)2} $$</p>



<p>Мы находим уровень ошибки на основе значений выходного слоя $a^{(L)}$. Кроме того, мы добавляем значение регуляризации, которое рассчитывается как сумма сумм весов слоев (1) и (2) и контролируется коэффициентом $\lambda.$</p>



<p>Приведем код.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd0f790649337" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd0f790649337-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-1"><span class="crayon-c"># в коде обозначим коэффициент lambda как reg</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reg</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">y_one_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">y_pred</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">y_zero_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y_pred</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">log_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">y_zero_loss</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">y_one_loss</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># по умолчанию np.sum() складывает по всем измерениям</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">reg_loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W1</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">reg</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd0f790649337-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">log_loss</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">reg_loss</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<p>Градиент компонента регуляризации для слоя $l$ будет иметь вид</p>



<p>$$ \frac{ \partial J_{\text{reg}} }{ \partial W^{(l)} } \left( \frac{\lambda}{2n} W^{(l)2} \right) = \frac{\lambda}{n} W^{(l)}, $$</p>



<p>и обновление будет происходить согласно</p>



<p>$$ W^{(l)} := W^{(l)}-\frac{\alpha}{n} \left( \frac{\partial J_{\text{nn}} }{\partial W^{(l)}} + \lambda \frac{\partial J_{\text{reg}} }{\partial W^{(l)}} \right), $$</p>



<p>где $\alpha$ &#8212; коэффициент скорости обучения и $\lambda$ &#8212; коэффициент регуляризации. Регуляризация смещения не проводится.</p>



<h3 class="wp-block-heading" id="27-podgotovka-dannykh">Подготовка данных</h3>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd13661005177" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd13661005177-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">sklearn </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">datasets</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-2"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">datasets</span><span class="crayon-sy">.</span><span class="crayon-e">load_wine</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-4"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">DataFrame</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-v">feature_names</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-5"><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'target'</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data</span><span class="crayon-sy">.</span><span class="crayon-e">target</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-7"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-v">df</span><span class="crayon-sy">.</span><span class="crayon-v">target</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-9"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-sy">[</span><span class="crayon-s">'alcohol'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'proline'</span><span class="crayon-sy">]</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-10"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">df</span><span class="crayon-sy">[</span><span class="crayon-s">'target'</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-12"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">std</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-14"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">to_numpy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-i">T</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd13661005177-15"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">to_numpy</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<h3 class="wp-block-heading" id="28-obuchenie-modeli">Обучение модели</h3>



<p>Обучим модель.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd16395265620" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd16395265620-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd16395265620-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd16395265620-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd16395265620-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd16395265620-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">z</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd16395265620-3"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">s</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd18234157518" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-46">46</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-47">47</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-48">48</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-49">49</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-50">50</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd18234157518-51">51</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-1"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">33</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-3"><span class="crayon-v">W1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-4"><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-6"><span class="crayon-v">W2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-7"><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">randn</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-9"><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-11"><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100000</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-12"><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-13"><span class="crayon-v">reg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-15"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># 3 х 2 на 2 х 130</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-18"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># (3 x 130)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># 1 х 3 на 3 х 130</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-21"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">Z2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-22"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">A2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># (1 x 130)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">A2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">reg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2_delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">y</span><span class="crayon-h"> </span><span class="crayon-c"># (1 x 130)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-27"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W1_delta</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">W2_delta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c"># (3 x 130)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># 1 х 130 на 130 х 3</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># значение градиента с учетом регуляризации</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-31"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">reg</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">W2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-c"># (1 x 3)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b2_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W2_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-c"># (1 x 1)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-34"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># 3 х 130 на 130 х 2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># значение градиента с учетом регуляризации</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W1_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W1_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">reg</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">W1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-c"># (3 x 2)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-37"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">b1_derivative</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-v">W1_delta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">axis</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">keepdims</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-c"># (3 x 1)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-38">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">W2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">W2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">W2_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-40"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">b2_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-41"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">W1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">W1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">W1_derivative</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-42"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">b1_derivative</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-44"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Эпоха:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Ошибка:'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'-----------------------'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-49">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-50"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Итоговая ошибка'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">loss</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd18234157518-51"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'Нейросеть успешно обучена'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0024 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd1b659316636" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1b659316636-17">17</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-1">Эпоха: 0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-2">Ошибка: 10.080406829656138</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-3">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-4">Эпоха: 20000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-5">Ошибка: 0.9317231212330214</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-6">-----------------------</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-7">Эпоха: 40000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-8">Ошибка: 0.7472183596959365</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-9">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-10">Эпоха: 60000</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-11">Ошибка: 0.7116253099095151</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-12">-----------------------</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-13">Эпоха: 80000</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-14">Ошибка: 0.6899824534744711</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-15">-----------------------</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-16">Итоговая ошибка 0.6746032823864037</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1b659316636-17">Нейросеть успешно обучена</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Сделаем прогноз.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd1e692083853" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd1e692083853-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">metrics </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">accuracy_score</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-3"><span class="crayon-v">Z1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-4"><span class="crayon-v">A1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-5"><span class="crayon-v">Z2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">dot</span><span class="crayon-sy">(</span><span class="crayon-v">W2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">A1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">b2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-6"><span class="crayon-v">A2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">sigmoid</span><span class="crayon-sy">(</span><span class="crayon-v">Z2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-8"><span class="crayon-v">y_pred</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_true</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">A2</span><span class="crayon-sy">.</span><span class="crayon-e">flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-e">flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd1e692083853-10"><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y_true</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd20600916198" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd20600916198-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd20600916198-1">0.9846153846153847</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h3 class="wp-block-heading" id="29-regulyarizatsiya-v-biblioteke-keras">Регуляризация в библиотеке Keras</h3>



<p>Приведем регуляризацию модели в библиотеке Keras.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd22281898475" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd22281898475-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd22281898475-1"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">tensorflow </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-v">tf</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd24094833835" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd24094833835-28">28</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-1"><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">seed</span><span class="crayon-sy">(</span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-2"><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-k ">random</span><span class="crayon-sy">.</span><span class="crayon-e">set_seed</span><span class="crayon-sy">(</span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-4"><span class="crayon-c"># регуляризация добавляется на каждый слой</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-5"><span class="crayon-v">l2_reg</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">regularizers</span><span class="crayon-sy">.</span><span class="crayon-e">l2</span><span class="crayon-sy">(</span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-7"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">models</span><span class="crayon-sy">.</span><span class="crayon-e">Sequential</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_regularizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">l2_reg</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">layers</span><span class="crayon-sy">.</span><span class="crayon-e">Dense</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">activation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'sigmoid'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">use_bias</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">kernel_regularizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">l2_reg</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-13"><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-15"><span class="crayon-v">sgd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">optimizers</span><span class="crayon-sy">.</span><span class="crayon-e">SGD</span><span class="crayon-sy">(</span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">momentum</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">nesterov</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-19"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-k ">compile</span><span class="crayon-sy">(</span><span class="crayon-v">optimizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sgd</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-20"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">loss</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'binary_crossentropy'</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">metrics</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-23"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">.</span><span class="crayon-v">T</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-24"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">epochs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">batch_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">130</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">verbose</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd24094833835-28"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">summary</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd27383651310" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd27383651310-12">12</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-1">Model: "sequential_2"</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-2">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-3">┃ Layer (type)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ┃ Output Shape&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;┃&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Param # ┃</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-4">┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-5">│ dense_4 (Dense)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│ (130, 3)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 9 │</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-6">├──────────────────────────────────────┼─────────────────────────────┼─────────────────┤</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-7">│ dense_5 (Dense)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│ (130, 1)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;│&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 4 │</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-8">└──────────────────────────────────────┴─────────────────────────────┴─────────────────┘</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-9"> Total params: 15 (64.00 B)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-10"> Trainable params: 13 (52.00 B)</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-11"> Non-trainable params: 0 (0.00 B)</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd27383651310-12"> Optimizer params: 2 (12.00 B)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd2d506634093" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd2d506634093-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd2d506634093-1"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">.</span><span class="crayon-v">history</span><span class="crayon-sy">[</span><span class="crayon-s">'accuracy'</span><span class="crayon-sy">]</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd2f748560493" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd2f748560493-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd2f748560493-1">0.9538461565971375</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В целом регуляризаторы в Keras можно задавать следующим образом.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd31632352445" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd31632352445-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd31632352445-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd31632352445-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd31632352445-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd31632352445-1"><span class="crayon-c"># l1, l2 и ElasticNet</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd31632352445-2"><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">regularizers</span><span class="crayon-sy">.</span><span class="crayon-e">l1</span><span class="crayon-sy">(</span><span class="crayon-cn">0.</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd31632352445-3"><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">regularizers</span><span class="crayon-sy">.</span><span class="crayon-e">l2</span><span class="crayon-sy">(</span><span class="crayon-cn">0.</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd31632352445-4"><span class="crayon-v">tf</span><span class="crayon-sy">.</span><span class="crayon-v">keras</span><span class="crayon-sy">.</span><span class="crayon-v">regularizers</span><span class="crayon-sy">.</span><span class="crayon-e">l1_l2</span><span class="crayon-sy">(</span><span class="crayon-v">l1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<h2 class="wp-block-heading" id="30-podvedem-itog">Подведем итог</h2>



<p>На сегодняшнем занятии мы изучили концепцию смещения и разброса модели, рассмотрели принцип L1 и L2 регуляризации и протестировали регуляризацию на линейной регрессии и нейросети. Кроме этого, мы познакомились с алгоритмом координатного спуска.</p>



<h2 class="wp-block-heading" id="31-dopolnitelnye-materialy">Дополнительные материалы</h2>



<h3 class="wp-block-heading" id="32-begging-dlya-snizheniya-razbrosa">Бэггинг для снижения разброса</h3>



<p>Нам не обязательно использовать прогноз только одной модели. Можно взять группу или ансамбль (от франц. ensemble &#8212; &#171;вместе&#187;) моделей. Рассмотрим один из способов ансамблирования, <strong>бэггинг</strong> (bagging), и постараемся с его помощью снизить разброс модели.</p>



<h4 class="wp-block-heading" id="33-pro-begging">Про бэггинг</h4>



<p>Бэггинг (bagging) или <strong>b</strong>ootstrap <strong>agg</strong>regat<strong>ing</strong> предполагает три основных шага:</p>



<ol class="wp-block-list">
<li><strong>Bootstrapping</strong>. За счет случайных выборок с возвращением (random samples with replacement) создается несколько датасетов на основе исходных данных (subsets). Это означает, что в каждом датасете могут быть как повторяющиеся объекты, так и объекты из других датасетов;</li>



<li><strong>Parallel training</strong>. Затем модели (их называют базовыми моделями, base estimators, или weak learners) обучаются параллельно и независимо друг от друга;</li>



<li><strong>Aggregation</strong>. Наконец, в зависимости от типа задачи, т.е. регрессии или классификации, рассчитывается, соответственно, среднее значение (soft voting) или класс, предсказанный большинством (hard/majority voting).</li>
</ol>



<h4 class="wp-block-heading" id="34-algoritm-reshayushchego-dereva">Алгоритм решающего дерева</h4>



<p>Рассмотрение решающих деревьев (decision trees), алгоритма, который мы будем использовать внутри бэггинга, выходит за рамки сегодняшнего занятия.</p>



<p>При этом будет важно сказать, что одним из недостатков этого алгоритма (когда используется только одно дерево) как раз является склонность к переобучению и высокий разброс модели. Посмотрим, сможет ли бэггинг исправить ситуацию.</p>



<h4 class="wp-block-heading" id="35-podgotovka-dannykh">Подготовка данных</h4>



<p>Используем данные о пациентах с диабетом.</p>



<div class="wp-block-file"><a id="wp-block-file--media-8c33ccf6-a018-436d-b81f-db497c90bb29" href="../../wp-content/uploads/2023/01/diabetes.csv">diabetes.csv</a><a href="../../wp-content/uploads/2023/01/diabetes.csv" class="wp-block-file__button wp-element-button" download aria-describedby="wp-block-file--media-8c33ccf6-a018-436d-b81f-db497c90bb29">Скачать</a></div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd33782248959" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd33782248959-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd33782248959-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd33782248959-1"><span class="crayon-v">diabetes</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">pd</span><span class="crayon-sy">.</span><span class="crayon-e">read_csv</span><span class="crayon-sy">(</span><span class="crayon-s">'/content/diabetes.csv'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd33782248959-2"><span class="crayon-v">diabetes</span><span class="crayon-sy">.</span><span class="crayon-e">head</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="236" src="../../wp-content/uploads/2023/01/diabetes_head-1024x236.jpg" alt="данные о диабете" class="wp-image-18258" srcset="../../wp-content/uploads/2023/01/diabetes_head-1024x236.jpg 1024w, ../../wp-content/uploads/2023/01/diabetes_head-300x69.jpg 300w, ../../wp-content/uploads/2023/01/diabetes_head-768x177.jpg 768w, ../../wp-content/uploads/2023/01/diabetes_head-1200x277.jpg 1200w, ../../wp-content/uploads/2023/01/diabetes_head-600x138.jpg 600w, ../../wp-content/uploads/2023/01/diabetes_head.jpg 1370w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd38690291316" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd38690291316-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd38690291316-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd38690291316-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd38690291316-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd38690291316-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd38690291316-6">6</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd38690291316-1"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">diabetes</span><span class="crayon-sy">.</span><span class="crayon-e">drop</span><span class="crayon-sy">(</span><span class="crayon-v">columns</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Outcome'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd38690291316-2"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">diabetes</span><span class="crayon-sy">.</span><span class="crayon-e">Outcome</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd38690291316-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd38690291316-4"><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">X_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">train_test_split</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd38690291316-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">test_size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd38690291316-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd3a254460160" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3a254460160-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">tree </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-3"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">DecisionTreeClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">max_depth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-4"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-6"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-7"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-9"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd3a254460160-10"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd3e985198968" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3e985198968-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd3e985198968-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd3e985198968-1">train: 0.9795158286778398</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd3e985198968-2">test: 0.696969696969697</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd40827701712" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd40827701712-15">15</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">ensemble </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-3"><span class="crayon-v">bag_model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">BaggingClassifier</span><span class="crayon-sy">(</span><span class="crayon-v">estimator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">n_estimators</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># выборка с возвращением</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">bootstrap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">random_state</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">42</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-9"><span class="crayon-v">bag_model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-11"><span class="crayon-v">y_pred_train</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bag_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_train</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-12"><span class="crayon-v">y_pred_test</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">bag_model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X_test</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-14"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'train: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y_train</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_train</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd40827701712-15"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">'test: '</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-e">accuracy_score</span><span class="crayon-sy">(</span><span class="crayon-v">y_test</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_test</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626e7dd42108547556" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626e7dd42108547556-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626e7dd42108547556-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626e7dd42108547556-1">train: 1.0</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626e7dd42108547556-2">test: 0.7532467532467533</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"learning\\\/reg\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
