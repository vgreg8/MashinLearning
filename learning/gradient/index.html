<!DOCTYPE html>

<html class="no-js" lang="ru-RU">

	<head>

		<meta http-equiv="content-type" content="text/html" charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" >

		<link rel="profile" href="http://gmpg.org/xfn/11">

		<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
<script>
MathJax = {
  tex: {
    inlineMath: [['$','$'],['\\(','\\)']], 
    processEscapes: true
  },
  options: {
    ignoreHtmlClass: 'tex2jax_ignore|editor-rich-text'
  }
};

</script>

	<!-- This site is optimized with the Yoast SEO plugin v24.4 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Метод градиентного спуска | Обучение модели</title>
	<meta name="description" content="Метод градиентного спуска позволяет найти минимум функции потерь и, таким образом, подобрать веса модели машинного обучения." />
	<link rel="canonical" href="index.html" />
	<meta property="og:locale" content="ru_RU" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Метод градиентного спуска | Обучение модели" />
	<meta property="og:description" content="Метод градиентного спуска позволяет найти минимум функции потерь и, таким образом, подобрать веса модели машинного обучения." />
	<meta property="og:url" content="https://www.dmitrymakarov.ru/learning/gradient/" />
	<meta property="og:site_name" content="Машинное обучение" />
	<meta property="article:modified_time" content="2024-12-31T21:11:12+00:00" />
	<meta property="og:image" content="https://www.dmitrymakarov.ru/wp-content/uploads/2022/01/mf1.png" />
	<meta property="og:image:width" content="683" />
	<meta property="og:image:height" content="558" />
	<meta property="og:image:type" content="image/png" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Примерное время для чтения" />
	<meta name="twitter:data1" content="27 минут" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"https://www.dmitrymakarov.ru/learning/gradient/","url":"https://www.dmitrymakarov.ru/learning/gradient/","name":"Метод градиентного спуска | Обучение модели","isPartOf":{"@id":"https://www.dmitrymakarov.ru/#website"},"primaryImageOfPage":{"@id":"https://www.dmitrymakarov.ru/learning/gradient/#primaryimage"},"image":{"@id":"https://www.dmitrymakarov.ru/learning/gradient/#primaryimage"},"thumbnailUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/01/mf1.png","datePublished":"2021-12-04T07:16:13+00:00","dateModified":"2024-12-31T21:11:12+00:00","description":"Метод градиентного спуска позволяет найти минимум функции потерь и, таким образом, подобрать веса модели машинного обучения.","breadcrumb":{"@id":"https://www.dmitrymakarov.ru/learning/gradient/#breadcrumb"},"inLanguage":"ru-RU","potentialAction":[{"@type":"ReadAction","target":["https://www.dmitrymakarov.ru/learning/gradient/"]}]},{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/learning/gradient/#primaryimage","url":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/01/mf1.png","contentUrl":"https://www.dmitrymakarov.ru/wp-content/uploads/2022/01/mf1.png","width":683,"height":558},{"@type":"BreadcrumbList","@id":"https://www.dmitrymakarov.ru/learning/gradient/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Главная страница","item":"https://www.dmitrymakarov.ru/"},{"@type":"ListItem","position":2,"name":"Обучение модели","item":"https://www.dmitrymakarov.ru/learning/"},{"@type":"ListItem","position":3,"name":"Метод градиентного спуска"}]},{"@type":"WebSite","@id":"https://www.dmitrymakarov.ru/#website","url":"https://www.dmitrymakarov.ru/","name":"Машинное обучение","description":"","publisher":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4"},"potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.dmitrymakarov.ru/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"ru-RU"},{"@type":["Person","Organization"],"@id":"https://www.dmitrymakarov.ru/#/schema/person/3fc221e2d391cc5cfd9d31c9c251c2a4","name":"DmitryMakarov","image":{"@type":"ImageObject","inLanguage":"ru-RU","@id":"https://www.dmitrymakarov.ru/#/schema/person/image/","url":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","contentUrl":"https://secure.gravatar.com/avatar/2c5f922d990c667feffc00f99517cc0e?s=96&d=mm&r=g","caption":"DmitryMakarov"},"logo":{"@id":"https://www.dmitrymakarov.ru/#/schema/person/image/"}}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='https://cdn.jsdelivr.net/' />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента" href="../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="Машинное обучение &raquo; Лента комментариев" href="../../comments/feed/index.html" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/15.0.3\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.dmitrymakarov.ru\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.7.1"}};
/*! This file is auto-generated */
!function(i,n){var o,s,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),r=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===r[t]})}function u(e,t,n){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\uddfa\ud83c\uddf3","\ud83c\uddfa\u200b\ud83c\uddf3")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!n(e,"\ud83d\udc26\u200d\u2b1b","\ud83d\udc26\u200b\u2b1b")}return!1}function f(e,t,n){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):i.createElement("canvas"),a=r.getContext("2d",{willReadFrequently:!0}),o=(a.textBaseline="top",a.font="600 32px Arial",{});return e.forEach(function(e){o[e]=t(a,e,n)}),o}function t(e){var t=i.createElement("script");t.src=e,t.defer=!0,i.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",s=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){i.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+f.toString()+"("+[JSON.stringify(s),u.toString(),p.toString()].join(",")+"));",r=new Blob([e],{type:"text/javascript"}),a=new Worker(URL.createObjectURL(r),{name:"wpTestEmojiSupports"});return void(a.onmessage=function(e){c(n=e.data),a.terminate(),t(n)})}catch(e){}c(n=f(s,u,p))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<link rel='stylesheet' id='urvanov_syntax_highlighter-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/css/min/urvanov_syntax_highlighter.min.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-theme-familiar-my-copy-css' href='../../wp-content/uploads/urvanov-syntax-highlighter/themes/familiar-my-copy/familiar-my-copy.css@ver=2.8.38.css' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-consolas-css' href='../../wp-content/plugins/urvanov-syntax-highlighter/fonts/consolas.css@ver=2.8.38.css' type='text/css' media='all' />
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='../../wp-includes/css/dist/block-library/style.min.css@ver=6.7.1.css' type='text/css' media='all' />
<style id='filebird-block-filebird-gallery-style-inline-css' type='text/css'>
ul.filebird-block-filebird-gallery{margin:auto!important;padding:0!important;width:100%}ul.filebird-block-filebird-gallery.layout-grid{display:grid;grid-gap:20px;align-items:stretch;grid-template-columns:repeat(var(--columns),1fr);justify-items:stretch}ul.filebird-block-filebird-gallery.layout-grid li img{border:1px solid #ccc;box-shadow:2px 2px 6px 0 rgba(0,0,0,.3);height:100%;max-width:100%;-o-object-fit:cover;object-fit:cover;width:100%}ul.filebird-block-filebird-gallery.layout-masonry{-moz-column-count:var(--columns);-moz-column-gap:var(--space);column-gap:var(--space);-moz-column-width:var(--min-width);columns:var(--min-width) var(--columns);display:block;overflow:auto}ul.filebird-block-filebird-gallery.layout-masonry li{margin-bottom:var(--space)}ul.filebird-block-filebird-gallery li{list-style:none}ul.filebird-block-filebird-gallery li figure{height:100%;margin:0;padding:0;position:relative;width:100%}ul.filebird-block-filebird-gallery li figure figcaption{background:linear-gradient(0deg,rgba(0,0,0,.7),rgba(0,0,0,.3) 70%,transparent);bottom:0;box-sizing:border-box;color:#fff;font-size:.8em;margin:0;max-height:100%;overflow:auto;padding:3em .77em .7em;position:absolute;text-align:center;width:100%;z-index:2}ul.filebird-block-filebird-gallery li figure figcaption a{color:inherit}

</style>
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #121212;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--dark-gray: #333;--wp--preset--color--medium-gray: #555;--wp--preset--color--light-gray: #777;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 16px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 24px;--wp--preset--font-size--x-large: 42px;--wp--preset--font-size--normal: 18px;--wp--preset--font-size--larger: 28px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='mcluhan-fonts-css' href='../../wp-content/themes/mcluhan/assets/css/fonts.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='fontawesome-css' href='../../wp-content/themes/mcluhan/assets/css/font-awesome.css@ver=6.7.1.css' type='text/css' media='all' />
<link rel='stylesheet' id='mcluhan-style-css' href='../../wp-content/themes/mcluhan/style.css@ver=2.1.1.css' type='text/css' media='all' />
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery.min.js@ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="../../wp-includes/js/jquery/jquery-migrate.min.js@ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" id="urvanov_syntax_highlighter_js-js-extra">
/* <![CDATA[ */
var UrvanovSyntaxHighlighterSyntaxSettings = {"version":"2.8.38","is_admin":"0","ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","prefix":"urvanov-syntax-highlighter-","setting":"urvanov-syntax-highlighter-setting","selected":"urvanov-syntax-highlighter-setting-selected","changed":"urvanov-syntax-highlighter-setting-changed","special":"urvanov-syntax-highlighter-setting-special","orig_value":"data-orig-value","debug":""};
var UrvanovSyntaxHighlighterSyntaxStrings = {"copy":"Copied to the clipboard","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/plugins/urvanov-syntax-highlighter/js/min/urvanov_syntax_highlighter.min.js@ver=2.8.38" id="urvanov_syntax_highlighter_js-js"></script>

			<!-- Customizer CSS -->

			<style type="text/css">

				body .site-header { background-color:#004235; }.social-menu.desktop { background-color:#004235; }.social-menu a:hover { color:#004235; }.social-menu a.active { color:#004235; }.mobile-menu-wrapper { background-color:#004235; }.social-menu.mobile { background-color:#004235; }.mobile-search.active { background-color:#004235; }
			</style>

			<!-- /Customizer CSS -->

					<script>jQuery( 'html' ).removeClass( 'no-js' ).addClass( 'js' );</script>
		<style type="text/css">.broken_link, a.broken_link {
	text-decoration: line-through;
}</style><style type="text/css" id="custom-background-css">
body.custom-background { background-color: #fff9ef; }
</style>
	<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-32x32.png" sizes="32x32" />
<link rel="icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-192x192.png" sizes="192x192" />
<link rel="apple-touch-icon" href="../../wp-content/uploads/2021/08/cropped-wp-favicon-512-180x180.png" />
<meta name="msapplication-TileImage" content="https://www.dmitrymakarov.ru/wp-content/uploads/2021/08/cropped-wp-favicon-512-270x270.png" />

	</head>

	<body class="page-template page-template-full-width-page-template page-template-full-width-page-template-php page page-id-7315 page-child parent-pageid-5658 custom-background full-width-template">

		
		<a class="skip-link button" href="index.html#site-content">Перейти к содержимому</a>

		<header class="site-header group">

			
			<p class="site-title"><a href="../../index.html" class="site-name">Машинное обучение</a></p>

			
			<div class="nav-toggle">
				<div class="bar"></div>
				<div class="bar"></div>
			</div>

			<div class="menu-wrapper">

				<ul class="main-menu desktop">

									</ul>

			</div><!-- .menu-wrapper -->

			
				<div class="social-menu desktop">

					<ul class="social-menu-inner">

						<li class="social-search-wrapper"><a href="../../index.html@s=.html"></a></li>

						
					</ul><!-- .social-menu-inner -->

				</div><!-- .social-menu -->

			
		</header><!-- header -->

		<div class="mobile-menu-wrapper">

			<ul class="main-menu mobile">
									<li class="toggle-mobile-search-wrapper"><a href="index.html#" class="toggle-mobile-search">Поиск</a></li>
							</ul><!-- .main-menu.mobile -->

			
		</div><!-- .mobile-menu-wrapper -->

		
			<div class="mobile-search">

				<div class="untoggle-mobile-search"></div>

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa62666b203">Поиск:</label>
	<input type="search" id="search-form-67aa62666b203" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

				<div class="mobile-results">

					<div class="results-wrapper"></div>

				</div>

			</div><!-- .mobile-search -->

			<div class="search-overlay">

				
<form role="search" method="get" class="search-form" action="../../index.html">
	<label class="screen-reader-text" for="search-form-67aa62666b2be">Поиск:</label>
	<input type="search" id="search-form-67aa62666b2be" class="search-field" placeholder="Введите запрос" value="" name="s" autocomplete="off" />
	</button>
</form>

			</div><!-- .search-overlay -->

		
		<main class="site-content" id="site-content">
		<article class="post-7315 page type-page status-publish hentry missing-thumbnail">

			
			<header class="entry-header section-inner">

				<h1 class="entry-title">Метод градиентного спуска</h1>
			</header><!-- .entry-header -->

			<div class="entry-content section-inner">

				
<p class="has-light-gray-color has-text-color"><a href="../../index.html">Материалы</a> &gt; <a href="../index.html">Обучение модели</a></p>



<p>На <a href="../derivative/index.html">прошлом занятии</a> мы познакомились с понятием производной и нашли минимум функции с одной переменной. При этом, мы отказались от использования второй переменной сдвига.</p>



<p>$$ y = w \cdot x $$</p>



<p>Сегодня мы научимся находить минимум функции с двумя переменными $w$ и $b$ и построим полноценную модель простой линейной регрессии (Simple Linear Regression).</p>



<p>$$ y = w \cdot x + b $$</p>



<p>Для этого мы напишем алгоритм, который называется <strong>методом градиентного спуска</strong> (gradient descent method). Однако перед этим мы возьмем более простую функцию и на ее примере изучим, как работает этот метод.</p>



<h2 class="wp-block-heading" id="0-gradient-i-metod-gradientnogo-spuska">Градиент и метод градиентного спуска</h2>



<h3 class="wp-block-heading" id="1-funktsiya-neskolkikh-peremennykh">Функция нескольких переменных</h3>



<p>Возьмем вот такую функцию потерь.</p>



<p>$$ f(w_1, w_2) = w_1^2 + w_2^2 $$</p>



<p>График этой функции можно представить в трехмерном пространстве, где по осям $w_1$ и $w_2$ отложены веса исходной модели, а по оси $f(w_1, w_2)$ &#8212; уровень потерь при заданных весах.</p>



<p class="has-text-align-center has-white-color has-text-color has-background" style="background-color:#004235"><a href="https://colab.research.google.com/drive/1V9qOJXttFClg0AG4Io6TAaWEfT5DTUu_?usp=sharing" target="_blank" rel="noreferrer noopener">Откроем блокнот к этому занятию</a>⧉</p>



<p>Посмотрим на график этой функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618b7937296796" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618b7937296796-35">35</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-1"><span class="crayon-c"># установим размер графика</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-2"><span class="crayon-v">fig</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">12</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-4"><span class="crayon-c"># создадим последовательность из 1000 точек в интервале от -5 до 5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-5"><span class="crayon-c"># для осей w1 и w2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-6"><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-7"><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-9"><span class="crayon-c"># создадим координатную плоскость из осей w1 и w2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-10"><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">meshgrid</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-12"><span class="crayon-c"># пропишем функцию</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-13"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-15"><span class="crayon-c"># создадим трехмерное пространство</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-16"><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">add_subplot</span><span class="crayon-sy">(</span><span class="crayon-v">projection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'3d'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-18"><span class="crayon-c"># выведем график функции, alpha задает прозрачность</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-19"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot_surface</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Blues'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-21"><span class="crayon-c"># выведем точку A с координатами (3, 4, 25) и подпись к ней</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-22"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'^'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-23"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-25"><span class="crayon-c"># аналогично выведем точку B с координатами (0, 0, 0)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-26"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'^'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-27"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-29"><span class="crayon-c"># укажем подписи к осям</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-30"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-31"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-32"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_zlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'f(w1, w2)'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-34"><span class="crayon-c"># выведем результат</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618b7937296796-35"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
</div>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img fetchpriority="high" decoding="async" width="683" height="558" src="../../wp-content/uploads/2022/01/mf1.png" alt="оптимизация многомерной функции (функции нескольких переменных)" class="wp-image-9377" srcset="../../wp-content/uploads/2022/01/mf1.png 683w, ../../wp-content/uploads/2022/01/mf1-300x245.png 300w, ../../wp-content/uploads/2022/01/mf1-600x490.png 600w" sizes="(max-width: 683px) 100vw, 683px" /></figure></div>


<p>Предположим мы начали с весов в <strong>точке A</strong> с координатами (3, 4, 25). Как нам спуститься в минимум функции в <strong>точке B</strong> (0, 0, 0)? Просто двигаться в направлении обратном производной мы не можем. Ведь единственной производной, которая бы описывала все изменения нашей функции, просто не существует.</p>



<p>Все дело в том, что если смотреть на нашу функцию &#171;сверху&#187; (то есть на <em>график изолиний</em> или линий уровня, contour lines), то в каждой точке у нас теперь два направления, по оси $w_1$ и по оси $w_2.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618d2283405602" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d2283405602-38">38</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-1"><span class="crayon-c"># установим размер графика</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-2"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-4"><span class="crayon-c"># создадим последовательность из 100 точек в интервале от -5 до 5</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-5"><span class="crayon-c"># для осей w1 и w2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-6"><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-7"><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-9"><span class="crayon-c"># создадим координатную плоскость из осей w1 и w2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-10"><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">meshgrid</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-12"><span class="crayon-c"># пропишем функцию</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-13"><span class="crayon-v">C</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-15"><span class="crayon-c"># построим изолинии (линии уровня)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">contourf</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Blues'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-18"><span class="crayon-c"># выведем точку А с координатами на плоскости (3, 4)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-19"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'^'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-20"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-cn">2.85</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-22"><span class="crayon-c"># и точку B с координатами (0, 0)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-23"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'^'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-24"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">0.15</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-26"><span class="crayon-c"># укажем подписи к осям</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-27"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-28"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-30"><span class="crayon-c"># а также стрелки направления изменений вдоль w1 и w2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-31"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">arrow</span><span class="crayon-sy">(</span><span class="crayon-cn">2.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">head_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-32"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">arrow</span><span class="crayon-sy">(</span><span class="crayon-cn">3.005</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">head_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-34"><span class="crayon-c"># создадим сетку в виде прерывистой черты</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-35"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">linestyle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'--'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-36">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-37"><span class="crayon-c"># выведем результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d2283405602-38"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
</div>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img decoding="async" width="613" height="594" src="../../wp-content/uploads/2022/01/mf2.png" alt="изолинии (линии уровня) многомерной функции" class="wp-image-9383" srcset="../../wp-content/uploads/2022/01/mf2.png 613w, ../../wp-content/uploads/2022/01/mf2-300x291.png 300w, ../../wp-content/uploads/2022/01/mf2-600x581.png 600w" sizes="(max-width: 613px) 100vw, 613px" /></figure></div>


<p>Как понять куда нам двигаться?</p>



<h3 class="wp-block-heading" id="2-chastnaya-proizvodnaya">Частная производная</h3>



<p>Если &#171;заморозить&#187; одну из переменных (то есть представить, что это константа), пусть это будет $w_2,$ мы можем найти производную по первой переменной $w_1.$</p>



<p>$$ f_{w_1} =  \frac{\partial f}{\partial w_1} = 2w_1 $$</p>



<p>Такая производная называется <strong>частной</strong> (partial derivative), потому что она описывает изменение только в первой переменной $w_1.$</p>



<p>Графически, мы как бы убираем переменную $w_2$ (получается сечение, представленное параболой) и ищем производную функции, в которой есть только переменная $w_1.$</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618d4390745169" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-42">42</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-43">43</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-44">44</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-45">45</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d4390745169-46">46</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-1"><span class="crayon-c"># зададим размер графика в дюймах</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-4"><span class="crayon-c"># объявим функцию параболы</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-5"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-8"><span class="crayon-c"># объявим ее производную</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-9"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">der</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">x</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-12"><span class="crayon-c"># пропишем уравнение через point-slope form</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-13"><span class="crayon-c"># y - y1 = m * (x - x1) --&gt; y = m * (x - x1) + y1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-14"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">line</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">der</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">y1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-17"><span class="crayon-c"># создадим последовательность координат x для параболы</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-18"><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-20"><span class="crayon-c"># построим график параболы</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-21"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-22">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-23"><span class="crayon-c"># и заполним ее по умолчанию синим цветом с прозрачностью 0,5</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-24"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">fill_between</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-26"><span class="crayon-c"># в цикле пройдемся по точкам -2, 0, 2 на оси х</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-27"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-e">x1 </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-28"><span class="crayon-h">&nbsp;&nbsp;</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># рассчитаем соответствующие им координаты y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">y1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">f</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-32"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># определим пространство по оси x для касательных линий</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">xrange</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-34">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-35"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># построим касательные линии</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-36"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-k ">xrange</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">line</span><span class="crayon-sy">(</span><span class="crayon-k ">xrange</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'C1--'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linewidth</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># и точки соприкосновения с графиком параболы</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-v">x1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'C1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-41"><span class="crayon-c"># укажем подписи к осям</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-42"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-43"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'f(w1, w2)'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-44">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-45"><span class="crayon-c"># выведем результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d4390745169-46"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
</div>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img decoding="async" width="613" height="485" src="../../wp-content/uploads/2022/01/fsection.png" alt="частная производная многомерной функции" class="wp-image-9400" srcset="../../wp-content/uploads/2022/01/fsection.png 613w, ../../wp-content/uploads/2022/01/fsection-300x237.png 300w, ../../wp-content/uploads/2022/01/fsection-600x475.png 600w" sizes="(max-width: 613px) 100vw, 613px" /></figure></div>


<p>Точно таким же образом мы поступаем со второй переменной $w_2.$ Мы замораживаем первую переменную $w_1$ и вычисляем частную производную.</p>



<p>$$ f_{w_2} =  \frac{\partial f}{\partial w_2} = 2w_2 $$ </p>



<p>Теперь, взяв точку на плоскости $(w_1, w_2),$ мы будем точно знать скорость изменения функции $f(w_1, w_2)$ в этой точке в каждом из направлений.</p>



<p>Например, возьмем ту же точку A с координатами $w_1 = 3, w_2 = 4,$ скорость изменения функции в первом измерении будет равна $2 \times 3 = 6,$ во втором $2 \times 4 = 8.$</p>



<h4 class="wp-block-heading" id="3-notatsiya-analiza">Нотация анализа</h4>



<p>Вы вероятно заметили, что мы использовали две нотации (записи) частной производной. С первой мы уже знакомы по <a href="../derivative/index.html">предыдущему занятию</a>, это нотация Лагранжа.</p>



<p>$$ f(w) \rightarrow f'(w) $$</p>



<p>Вторую нотацию, нотацию Лейбница, удобнее использовать для записи частных производных. </p>



<p>$$ f(w_1, w_2) \rightarrow \frac{\partial f}{\partial w_1}, \frac{\partial f}{\partial w_2} $$</p>



<p>Она позволяет сразу увидеть, по какой переменной происходит дифференцирование.</p>



<p class="has-background" style="background-color:#ffe8c4">Напомню, что запись формул (и, в частности, производной) в текстовых ячейках блокнотов с помощью LaTeX мы изучили, когда говорили про <a href="../../python/jupyter-notebook-02/index.html">Jupyter Notebook</a>.</p>



<h4 class="wp-block-heading" id="4-vzyatie-chastnykh-proizvodnykh">Взятие частных производных</h4>



<p>Пошагово рассмотрим, как мы пришли к результату $(2w_1, 2w_2).$ Вначале найдем производную по первой переменой $w_1.$ Вторую переменную, $w_2,$ мы будем считать константой, то есть некоторым числом.</p>



<p>$$ \frac{\partial f}{\partial w_1} (w_1^2 + w_2^2) $$</p>



<p>Первое, что бросается в глаза, это то, что у нас производная суммы, а она, как известно, равна сумме производных.</p>



<p>$$ \frac{\partial f}{\partial w_1} (w_1^2 + w_2^2) = \frac{\partial f}{\partial w_1} (w_1^2) +  \frac{\partial f}{\partial w_1} (w_2^2) $$</p>



<p>Производную первого слагаемого мы найдем по правилу производной степенной функции. Второе слагаемое мы решили считать константой, а производная константы равна нулю.</p>



<p>$$ \frac{\partial f}{\partial w_1} (w_1^2) +  \frac{\partial f}{\partial w_1} (w_2^2) = 2w_1 + 0 = 2w_1 $$</p>



<p>Частная производная по второй переменной находится аналогично.</p>



<h4 class="wp-block-heading" id="5-ispolzovanie-sympy">Использование SymPy</h4>



<p><strong>Функцию diff()</strong> библиотеки SymPy можно также использовать для взятия частных производных. Вначале импортируем функцию <strong>diff()</strong> и символы $x$ и $y$ (мы их используем вместо $w_1$ и $w_2$).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618d6685180181" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d6685180181-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d6685180181-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d6685180181-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">sympy </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">diff</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d6685180181-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sympy</span><span class="crayon-sy">.</span><span class="crayon-k ">abc</span><span class="crayon-h"> </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Напишем функцию, которую хотим дифференцировать.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618d8814196801" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d8814196801-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d8814196801-1"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>После этого мы можем находить частные производные, передав в <strong>diff()</strong> функцию для дифференцирования, а затем либо первую, либо вторую переменную.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618d9260142078" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618d9260142078-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618d9260142078-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618d9260142078-1"><span class="crayon-c"># найдем частную производную по первой переменной</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618d9260142078-2"><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="42" height="33" src="../../wp-content/uploads/2022/01/par1.png" alt="частная производная с помощью функции diff() библиотеки SymPy по первой переменной" class="wp-image-9409"/></figure>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618da388057024" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618da388057024-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618da388057024-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618da388057024-1"><span class="crayon-c"># найдем частную производную по второй переменной</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618da388057024-2"><span class="crayon-e">diff</span><span class="crayon-sy">(</span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="39" height="33" src="../../wp-content/uploads/2022/01/par2.png" alt="частная производная с помощью функции diff() библиотеки SymPy по второй переменной" class="wp-image-9410"/></figure>



<h3 class="wp-block-heading" id="6-gradient">Градиент</h3>



<p><strong>Градиент</strong> (gradient) есть не что иное, как совокупность частных производных по каждой из независимых переменных. Его можно назвать &#171;полной производной&#187;.</p>



<p>Он обозначается через греческую букву &#171;набла&#187;, $\nabla$ или оператор Гамильтона.</p>



<p>$$ \nabla f(w_1, w_2) =&nbsp;\begin{bmatrix}&nbsp; \frac{\partial f}{\partial w_1} \\&nbsp; \frac{\partial f}{\partial w_1}&nbsp;\end{bmatrix} =  \begin{bmatrix}&nbsp; 2w_1 \\&nbsp; 2w_2&nbsp;\end{bmatrix} $$</p>



<p>Еще раз посмотрим, чему равен градиент в точке (3, 4), но уже в новой записи.</p>



<p>$$ \nabla f(3, 4) =  \begin{bmatrix}&nbsp; 2 \cdot 3 \\&nbsp; 2 \cdot 4&nbsp;\end{bmatrix} = \begin{bmatrix}&nbsp; 6 \\&nbsp; 8&nbsp;\end{bmatrix} $$</p>



<p>Как вы видите, такая функция на входе принимает два числа, а на выходе выдает вектор, также состоящий из двух чисел. В этом случае говорят о <strong>вектор-функции</strong> (vector-valued function).</p>



<h3 class="wp-block-heading" id="7-metod-gradientnogo-spuska">Метод градиентного спуска</h3>



<p>Градиент, который мы только что нашли, показывает <strong>направление скорейшего подъема</strong> (возрастания) функции. Нам же, если мы хотим найти минимум функции, нужно двигаться вниз в направлении, обратном направлению градиента (еще говорят про направление антиградиента, negative gradient).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618db179131264" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-38">38</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-39">39</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-40">40</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-41">41</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618db179131264-42">42</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-1"><span class="crayon-c"># установим размер графика</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-2"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-4"><span class="crayon-c"># создадим последовательность из 100 точек в интервале от -10 до 10</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-5"><span class="crayon-c"># для осей w1 и w2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-6"><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">10.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-7"><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">10.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-9"><span class="crayon-c"># создадим координатную плоскость из осей w1 и w2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-10"><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">meshgrid</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-12"><span class="crayon-c"># пропишем функцию</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-13"><span class="crayon-v">C</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-15"><span class="crayon-c"># построим изолинии (линии уровня)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-16"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">contourf</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Blues'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-18"><span class="crayon-c"># выведем точку А с координатами на плоскости (3, 4)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-19"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'^'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-20"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-cn">2.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-22"><span class="crayon-c"># и точку B с координатами (0, 0)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-23"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'^'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-24"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-25">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-26"><span class="crayon-c"># укажем подписи к осям</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-27"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-28"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-30"><span class="crayon-c"># а также стрелки направления изменений вдоль w1 и w2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-31"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">arrow</span><span class="crayon-sy">(</span><span class="crayon-cn">2.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">head_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-32"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">arrow</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">head_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-33">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-34"><span class="crayon-c"># выведем вектор антиградиента с направлением (-6, -8)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-35"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">arrow</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">head_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.3</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-36"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">2.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">4.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'Антиградиент'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rotation</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-38"><span class="crayon-c"># создадим сетку в виде прерывистой черты</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-39"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">grid</span><span class="crayon-sy">(</span><span class="crayon-v">linestyle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'--'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-40">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-41"><span class="crayon-c"># выведем результат</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618db179131264-42"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
</div>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img loading="lazy" decoding="async" width="639" height="598" src="../../wp-content/uploads/2022/01/neggradient.png" alt="метод градиентного спуска: направление антиградиента на графике изолиний" class="wp-image-9415" srcset="../../wp-content/uploads/2022/01/neggradient.png 639w, ../../wp-content/uploads/2022/01/neggradient-300x281.png 300w, ../../wp-content/uploads/2022/01/neggradient-600x562.png 600w" sizes="auto, (max-width: 639px) 100vw, 639px" /></figure></div>


<p>Если мы сдвинемся на $-6$ по оси $w_1$ и на $-8$ по оси $w_2,$ то обязательно пройдем через минимум функции. Теперь мы готовы дать определение.</p>



<p class="has-background" style="background-color:#ffe8c4"><strong>Метод градиентного спуска</strong> &#8212; это способ нахождения локального минимума функции в процессе движения в направлении антиградиента.</p>



<p>При этом, если мы сдвинемся на всю величину градиента, то &#171;перескочим&#187; через минимум. Именно поэтому нам нужен коэффициент скорости обучения (learning rate).</p>



<p>Воспользуемся этим методом для нахождения минимума приведенной выше функции. Другими словами, проделаем путь из точки А в точку B.</p>



<h3 class="wp-block-heading" id="8-metod-gradientnogo-spuska-na-pitone">Метод градиентного спуска на Питоне</h3>



<p>Вначале объявим необходимые функции.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618f4691352942" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f4691352942-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-1"><span class="crayon-c"># пропишем функцию потерь</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-5"><span class="crayon-c"># а также производную по первой</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-6"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">partial_1</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-i">w1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-9"><span class="crayon-c"># и второй переменной</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-10"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">partial_2</span><span class="crayon-sy">(</span><span class="crayon-v">w2</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f4691352942-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">2.0</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">w2</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<p>Зададим исходные параметры модели.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618f6162137608" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f6162137608-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-1"><span class="crayon-c"># пропишем изначальные веса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-2"><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-4"><span class="crayon-c"># количество итераций</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-5"><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-7"><span class="crayon-c"># и скорость обучения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f6162137608-8"><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.05</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Теперь создадим списки для учета обновления весов $w_1$ и $w_2$ и изменения уровня ошибки.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618f7659366534" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f7659366534-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f7659366534-1"><span class="crayon-v">w1_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Найдем минимум функции потерь.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618f8386331351" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f8386331351-21">21</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-1"><span class="crayon-c"># в цикле с заданным количеством итераций</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-2"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">iter</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># будем добавлять текущие веса в соответствующие списки</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">w1_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">w2_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># и рассчитывать и добавлять в список текущий уровень ошибки</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">l_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-11"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># также рассчитаем значение частных производных при текущих весах</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">par_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">partial_1</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">par_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">partial_2</span><span class="crayon-sy">(</span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-15"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># будем обновлять веса в направлении, </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-16"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># обратном направлению градиента, умноженному на скорость обучения</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">par_1</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-18"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">par</span><span class="crayon-sy">_</span>2</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-20"><span class="crayon-c"># выведем итоговые веса модели и значение функции потерь</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f8386331351-21"><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618f9006128193" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618f9006128193-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618f9006128193-1">(7.968419666276241e-05, 0.00010624559555034984, 1.7637697771638315e-08)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как мы видим, уже после ста итераций, как веса модели, так и уровень ошибки приблизились к нулю.</p>



<p class="has-background" style="background-color:#ffe8c4">Разумеется, более сложные функции потерь потребуют большего количества итераций и более тонкой настройки коэффициента скорости обучения.</p>



<p>Остается посмотреть на графике, какой путь проделал наш алгоритм градиентного спуска.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618fb302578424" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fb302578424-24">24</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-1"><span class="crayon-v">fig</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-2">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-3"><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-4"><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1000</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-5">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-6"><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">meshgrid</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-8"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">w1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-10"><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">add_subplot</span><span class="crayon-sy">(</span><span class="crayon-v">projection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'3d'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-12"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot_surface</span><span class="crayon-sy">(</span><span class="crayon-v">w1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">f</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'Blues'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-14"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">28</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'A'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-15"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">text</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'B'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">size</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">25</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-16">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-17"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w1'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-18"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'w2'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-19"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_zlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'f(w1, w2)'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-21"><span class="crayon-c"># выведем путь алгоритма оптимизации</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-22"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">w1_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w2_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'.-'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fb302578424-24"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="795" height="666" src="../../wp-content/uploads/2022/01/3dgd.png" alt="путь алгоритма оптимизации методом градиентного спуска на Питоне" class="wp-image-9451" srcset="../../wp-content/uploads/2022/01/3dgd.png 795w, ../../wp-content/uploads/2022/01/3dgd-300x251.png 300w, ../../wp-content/uploads/2022/01/3dgd-768x643.png 768w, ../../wp-content/uploads/2022/01/3dgd-600x503.png 600w" sizes="auto, (max-width: 795px) 100vw, 795px" /></figure>



<h3 class="wp-block-heading" id="9-promezhutochnye-vyvody">Промежуточные выводы</h3>



<p>Давайте еще раз проговорим основные идеи пройденного материала:</p>



<ol class="wp-block-list">
<li>градиент показывает скорость изменения многомерной функции по каждому из измерений (по каждой из переменных);</li>



<li>если &#171;заморозить&#187; все независимые переменные кроме одной и сделать срез, то наклон касательной к кривой среза будет значением частной производной по этому измерению; и самое важное для нас</li>



<li>градиент показывает направление скорейшего подъёма (возрастания) функции; двигаясь в обратном направлении, мы придем к минимуму функции.</li>
</ol>



<h2 class="wp-block-heading" id="10-prostaya-lineynaya-regressiya">Простая линейная регрессия</h2>



<p>А теперь давайте с нуля напишем нашу первую модель машинного обучения. Мы наконец-то приобрели для этого все необходимые знания. Наша модель будет по-прежнему иметь только один признак, но при этом будет учитываться не только наклон, но и сдвиг прямой.</p>



<p>$$&nbsp;\hat{y}&nbsp;=&nbsp;w&nbsp;\cdot&nbsp;x&nbsp;+&nbsp;b&nbsp;$$</p>



<h3 class="wp-block-heading" id="11-dannye-i-postanovka-zadachi">Данные и постановка задачи</h3>



<p>Сегодня мы возьмем хорошо известные нам <a href="../../intro/relationship/index.html">данные роста и обхвата шеи</a> и сразу преобразуем их в <a href="../../python/numpy/index.html">массив Numpy</a>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618fc301182173" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fc301182173-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fc301182173-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fc301182173-1"><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">1.48</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.49</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.49</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.50</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.51</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.52</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.53</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.54</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.55</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.56</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.57</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.57</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.58</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.58</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.59</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.60</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.61</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.62</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.63</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.64</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.65</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.66</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.67</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.67</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.68</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.68</span><span class="crayon-sy">,</span><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-cn">1.69</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.70</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.71</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.71</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.71</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.74</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.75</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.76</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.77</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.77</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.78</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fc301182173-2"><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">29.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">32.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33.9</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">33.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34.7</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">34.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">35.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36.2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36.3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36.6</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">36.8</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">37.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">38.5</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
</div>



<p>Выведем эти данные на графике с помощью диаграммы рассеяния или точечной диаграммы.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618fe028339478" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618fe028339478-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-1"><span class="crayon-c"># построим точечную диаграмму</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-cn">6</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-4"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-5"><span class="crayon-c"># добавим подписи</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-6"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">xlabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Рост, см'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">ylabel</span><span class="crayon-sy">(</span><span class="crayon-s">'Обхват шеи, см'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-8"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">title</span><span class="crayon-sy">(</span><span class="crayon-s">'Зависимость роста и окружности шеи у женщин в России'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fontsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618fe028339478-10"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="611" height="396" src="../../wp-content/uploads/2021/06/neck-height-relationship.png" alt="точечная диаграмма роста и обхвата шеи" class="wp-image-3101" srcset="../../wp-content/uploads/2021/06/neck-height-relationship.png 611w, ../../wp-content/uploads/2021/06/neck-height-relationship-300x194.png 300w, ../../wp-content/uploads/2021/06/neck-height-relationship-600x389.png 600w" sizes="auto, (max-width: 611px) 100vw, 611px" /></figure>



<p>Как мы помним, нашей задачей является минимизация средней суммы квадрата расстояний между данными и линией регрессии.</p>



<figure class="wp-block-image size-full is-resized"><img loading="lazy" decoding="async" width="749" height="525" src="../../wp-content/uploads/2022/04/MSE.png" alt="MSE" class="wp-image-12216" style="width:573px;height:402px" srcset="../../wp-content/uploads/2022/04/MSE.png 749w, ../../wp-content/uploads/2022/04/MSE-300x210.png 300w, ../../wp-content/uploads/2022/04/MSE-600x421.png 600w" sizes="auto, (max-width: 749px) 100vw, 749px" /></figure>



<p>Также приведем формулу.</p>



<p>$$ MSE = \frac {1}{n} \sum^{n}_{i=1} (y_i-\hat{y}_i)^2 $$</p>



<h3 class="wp-block-heading" id="12-reshenie-metodom-naimenshnikh-kvadratov">Решение методом наименьшних квадратов</h3>



<p>Прежде чем использовать алгоритм градиентного спуска, найдем аналитическое решение с помощью <strong>метода наименьших квадратов</strong> (МНК, least squares method). Для уравнения с одной независимой переменной, <a href="../../python/oop/index.html">напомню</a>, используется следующая формула.</p>



<p>$$&nbsp;w&nbsp;=&nbsp;\frac&nbsp;{\sum_{i&nbsp;=&nbsp;1}^{n}&nbsp;(x_i-\bar{x})(y_i-\bar{y})} {\sum_{i&nbsp;=&nbsp;1}^{n}&nbsp;(x_i-\bar{x})^2}&nbsp;$$</p>



<p>$$&nbsp;b =&nbsp;\bar{y}-w\bar{x} $$</p>



<h4 class="wp-block-heading" id="13-sobstvennaya-model">Собственная модель</h4>



<p>Давайте вычислим наклон и сдвиг прямой с помощью этой формулы на Питоне.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa6266618ff329632066" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa6266618ff329632066-19">19</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-1"><span class="crayon-c"># найдем среднее значение X и y</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-2"><span class="crayon-v">X_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-3"><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">mean</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-5"><span class="crayon-c"># объявим переменные для числителя и знаменателя</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-6"><span class="crayon-v">numerator</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-8"><span class="crayon-c"># в цикле пройдемся по данным</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-9"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-10">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># вычислим значения числителя и знаменателя по формуле выше</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">X_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">X_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-15"><span class="crayon-c"># найдем наклон и сдвиг</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-16"><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">denominator</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-17"><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">_</span>mean</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-18">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa6266618ff329632066-19"><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0008 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661901098272360" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661901098272360-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661901098272360-1">(26.861812005569753, -10.570936299787313)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Также давайте реализуем этот алгоритм с помощью векторизованного кода.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661902047817025" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661902047817025-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661902047817025-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661902047817025-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661902047817025-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661902047817025-1"><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">X_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">X_mean</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661902047817025-2"><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">y_mean</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-sy">_</span>mean</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661902047817025-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661902047817025-4"><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661903274638202" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661903274638202-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661903274638202-1">(26.861812005569757, -10.57093629978732)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<h4 class="wp-block-heading" id="14-model-linearregression-biblioteki-sklearn">Модель LinearRegression библиотеки sklearn</h4>



<p>Надо сказать, что модель LinearRegression, которую мы использовали на <a href="../../intro/optimization/index.html">вводном занятии по оптимизации</a> и затем на <a href="../../intro/regression/index.html">занятии по линейной регрессии</a> применяет именно МНК для минимизации MSE.</p>



<p>Давайте еще раз применим класс LinearRegression, чтобы убедиться в получении одинаковых результатов.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661904438740435" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661904438740435-11">11</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661904438740435-1"><span class="crayon-c"># из набора линейных моделей библиотеки sklearn импортируем линейную регрессию</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661904438740435-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">linear_model </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">LinearRegression</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661904438740435-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661904438740435-4"><span class="crayon-c"># создадим объект этого класса и запишем в переменную model</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661904438740435-5"><span class="crayon-v">model</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LinearRegression</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661904438740435-6">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661904438740435-7"><span class="crayon-c"># обучим модель (для X используем двумерный массив)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661904438740435-8"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661904438740435-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661904438740435-10"><span class="crayon-c"># выведем коэффициенты</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661904438740435-11"><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">coef_</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-v">intercept_</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661905200639068" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661905200639068-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661905200639068-1">(array([26.86181201]), -10.570936299787334)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Как вы видите, результаты одинаковы. Теперь сделаем прогноз и рассчитаем среднеквадратическую ошибку.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661906810303952" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661906810303952-8">8</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661906810303952-1"><span class="crayon-c"># сделаем прогноз</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661906810303952-2"><span class="crayon-v">y_pred_least_squares</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-e">predict</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">.</span><span class="crayon-e">reshape</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661906810303952-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661906810303952-4"><span class="crayon-c"># импортируем модуль метрик</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661906810303952-5"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">sklearn </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-i">metrics</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661906810303952-6"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661906810303952-7"><span class="crayon-c"># выведем среднеквадратическую ошибку (MSE)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661906810303952-8"><span class="crayon-v">metrics</span><span class="crayon-sy">.</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_least_squares</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661907526706268" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661907526706268-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661907526706268-1">0.2273395626677337</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Позднее мы сравним этот результат с аналогичным показателем алгоритма градиентного спуска.</p>



<h4 class="wp-block-heading" id="15-mnk-i-metod-gradientnogo-spuska">МНК и метод градиентного спуска</h4>



<p>Одна из причин использования алгоритма градиентного спуска вместо МНК заключается в том, что этот алгоритм менее требователен к вычислительным ресурсам при большом объеме (количестве наблюдений) и размерности (количестве признаков) данных.</p>



<p>Кроме того, метод градиентного спуска может применяться не только в задачах линейной регрессии, но и в других алгоритмах (например, в <a href="../../intro/classification/index.html">логистической регрессии</a>, <a href="../../intro/cv/index.html">SVM</a> или <a href="../../intro/neural/index.html">нейросетях</a>).</p>



<h3 class="wp-block-heading" id="16-reshenie-metodom-gradientnogo-spuska">Решение методом градиентного спуска</h3>



<h4 class="wp-block-heading" id="17-model-lineynoy-regressii-i-funktsiya-poter">Модель линейной регрессии и функция потерь</h4>



<p>Начнем с того, что объявим функцию линейной модели.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661908054318487" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661908054318487-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661908054318487-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661908054318487-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">regression</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661908054318487-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">b</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<p>Теперь давайте немного модифицируем функцию потерь и найдем половину среднеквадратической ошибки (half MSE). Обозначим нашу функцию буквой $J.$</p>



<p>$$&nbsp;J_{MSE}&nbsp;=&nbsp;\frac{1}{2n}&nbsp;\sum_{i=1}^{n}&nbsp;(y_i-(wx_i+b))^2&nbsp;$$</p>



<p>Число два в знаменателе удачно сократится с двойкой, полученной при дифференцировании степенной функции. При этом точка минимума функции не изменится.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666190a216275479" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190a216275479-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190a216275479-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190a216275479-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190a216275479-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">regression</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<hr class="wp-block-separator has-css-opacity"/>



<p>Дополнительно замечу, что использование именно среднеквадратической, то есть усредненной на количество наблюдений, ошибки (MSE) вместо &#171;простой&#187; суммы квадратов отклонений (Sum of Squared Errors, SSE)</p>



<p>$$ J_{SSE}&nbsp;=&nbsp;\sum_{i=1}&nbsp;(y_i-(wx_i+b))^2 $$</p>



<p>может быть предпочтительнее, поскольку позволяет сравнивать результаты модели на выборках разных размеров.</p>



<hr class="wp-block-separator has-css-opacity"/>



<h4 class="wp-block-heading" id="18-chastnye-proizvodnye-funktsii-poter">Частные производные функции потерь</h4>



<p>Найдем частные производные этой функции. Их будет две: одна по наклону $(w),$ вторая по сдвигу $(b).$ Начнем с <strong>наклона</strong>.</p>



<p>$$&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;w} \left( \frac{1}{2n}&nbsp;\sum_{i=1}^{n}&nbsp;(y_i-(wx_i+b))^2&nbsp;\right) $$</p>



<p><strong>Шаг 1</strong>. Вынесем число $\frac{1}{2n}$ за скобку по правилу умножения на число. В данном случае $n$, то есть количество наблюдений, превратится в число, как только мы применим формулу к набору данных.</p>



<p>$$&nbsp; \frac{\partial&nbsp;J}{\partial&nbsp;w}  = \frac{1}{2n}&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;w} \sum_{i=1}^{n} \left(&nbsp;(y_i-(wx_i+b))^2&nbsp;\right) $$</p>



<p><strong>Шаг 2</strong>. Теперь давайте для удобства перепишем выражение в векторизованной форме. Теперь $x$ и $y$ будут не отдельными числами, а векторами.</p>



<p>$$&nbsp; \frac{\partial&nbsp;J}{\partial&nbsp;w} = \frac{1}{2n}&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;w} \left( (y-(wx+b)) ^2&nbsp;\right) $$</p>



<p><strong>Шаг 3</strong>. Перед нами композиция из двух функций. Применим chain rule.</p>



<p>$$ \frac{\partial&nbsp;J}{\partial&nbsp;w} = \frac{1}{2n} \cdot 2(y-(wx+b)) \cdot \frac{\partial&nbsp;J}{\partial&nbsp;w} (y-(wx+b)) $$</p>



<p><strong>Шаг 4</strong>. К внутренней функции мы можем применить правило суммы и разности производных.</p>



<p>$$ \frac{1}{2n} \cdot 2(y-(wx+b)) \cdot (0-(x+0)) $$</p>



<p>Замечу, что при дифференцировании внутренней функции, $y$ превратился в ноль, потому что это константа. Одновременно переменную $b$ мы &#171;заморозили&#187; и также решили считать константой.</p>



<p><strong>Шаг 5</strong>. Упростим выражение.</p>



<p>$$ \frac{\partial&nbsp;J}{\partial&nbsp;w} = \frac{1}{\cancel{2}n} \cdot \cancel{2}-x(y-(wx+b)) = \frac{1}{n} \cdot -x(y-(wx+b)) $$</p>



<p>Аналогично найдем частную производную по <strong>сдвигу</strong>.</p>



<p>$$ \frac{\partial&nbsp;J}{\partial&nbsp;b}&nbsp;=&nbsp;\frac{1}{n} \cdot -(y-(wx+b)) $$</p>



<p>Здесь стоит лишь уточнить, что при нахождении производной внутренней функции мы &#171;заморозили&#187; переменную $w.$</p>



<p>$$ \frac{\partial&nbsp;J}{\partial&nbsp;b} \left( (y-(wx+b)) \right) = 0-(0+1)$$</p>



<p>В невекторизованной форме производные выглядят следующим образом.</p>



<p>$$&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;w}&nbsp;=&nbsp;\frac{1}{n}&nbsp;\sum_{i=1}^{n}&nbsp;-x_i(y_i-(wx_i+b))&nbsp;$$</p>



<p>$$&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;b}&nbsp;=&nbsp;\frac{1}{n}&nbsp;\sum_{i=1}^{n}&nbsp;-(y_i-(wx_i+b))&nbsp;$$</p>



<p>Поменяв слагаемые в скобках местами и умножив на $-1$, частные производные можно записать и так.</p>



<p>$$&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;w}&nbsp;=&nbsp;\frac{1}{n}&nbsp;\sum_{i=1}^{n}&nbsp;((wx_i+b)-y_i) \cdot x_i&nbsp;$$</p>



<p>$$&nbsp;\frac{\partial&nbsp;J}{\partial&nbsp;b}&nbsp;=&nbsp;\frac{1}{n}&nbsp;\sum_{i=1}^{n}&nbsp;((wx_i+b)-y_i)&nbsp;$$</p>



<p>Пропишем эти функции на Питоне.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666190b245863386" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190b245863386-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190b245863386-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190b245863386-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190b245863386-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190b245863386-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190b245863386-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">partial_w</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190b245863386-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-i">n</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190b245863386-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190b245863386-4"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">partial_b</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190b245863386-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">n</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
</div>



<h4 class="wp-block-heading" id="19-algoritm-gradientnogo-spuska">Алгоритм градиентного спуска</h4>



<p>Создадим функцию, которая будет на входе принимать данные, количество итераций и коэффициент скорости обучения, а на выходе выдавать веса модели и уровень ошибки.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666190d455088601" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190d455088601-30">30</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-1"><span class="crayon-c"># передадим функции данные, количество итераций и скорость обучения</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-2"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">gradient_descent</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># зададим изначальные веса</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-5"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># и количество наблюдений</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">n</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-8">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># создадим списки для записи весов модели и уровня ошибки</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># в цикле с заданным количеством итераций</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">iter</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># добавим в списки текущие веса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">w_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-k ">w</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-17"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">b_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">b</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># и уровень ошибки</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">l_list</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-e">objective</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-20">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-21"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># рассчитаем текущее значение частных производных</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-22"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">par_1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">partial_w</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-23"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">par_2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">partial_b</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">n</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-24">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-25"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># обновим веса в направлении антиградиента</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-26"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">par</span><span class="crayon-sy">_</span>1</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">b</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">par</span><span class="crayon-sy">_</span>2</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-28">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c"># выведем списки с уровнями ошибки и весами</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190d455088601-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
</div>



<h4 class="wp-block-heading" id="20-obuchenie-modeli">Обучение модели</h4>



<p>Применим написанную выше функцию для обучения модели. Используем следующие гиперпараметры модели:</p>



<ul class="wp-block-list">
<li>количество итераций &#8212; 200 000;</li>



<li>коэффициент скорости обучения &#8212; 0,01.</li>
</ul>



<p class="has-background" style="background-color:#ffe8c4">Напомню, что <strong>гиперпараметр</strong> &#8212; это параметр, который мы задаем <em>до обучения модели</em>.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666190f829329721" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190f829329721-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190f829329721-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190f829329721-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666190f829329721-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666190f829329721-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190f829329721-1"><span class="crayon-c"># распакуем результат работы функции в три переменные</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190f829329721-2"><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradient_descent</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190f829329721-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666190f829329721-4"><span class="crayon-c"># и выведем последние достигнутые значения весов и уровня ошибки</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666190f829329721-5"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-v">w_list</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661910603661326" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661910603661326-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661910603661326-1">26.6917462520774 -10.293843835595917 0.1137823984153401</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>В целом, как мы видим, веса модели очень близки к результату, найденному с помощью метода наименьших квадратов. Теперь сделаем прогноз.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661912746829841" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661912746829841-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661912746829841-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661912746829841-3">3</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661912746829841-1"><span class="crayon-c"># передадим функции regression() наиболее оптимальные веса</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661912746829841-2"><span class="crayon-v">y_pred_gd</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">regression</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">w_list</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661912746829841-3"><span class="crayon-v">y_pred_gd</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661913801252872" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661913801252872-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661913801252872-1">array([29.20994062, 29.47685808, 29.47685808, 29.74377554, 30.01069301])</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Посмотрим на результат на графике.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661914870854340" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661914870854340-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661914870854340-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661914870854340-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661914870854340-4">4</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661914870854340-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661914870854340-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661914870854340-3"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_gd</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661914870854340-4"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="592" height="466" src="../../wp-content/uploads/2022/01/y_pred_gd.png" alt="результат метода градиентного спуска: линия регрессии на точечной диаграмме" class="wp-image-9621" srcset="../../wp-content/uploads/2022/01/y_pred_gd.png 592w, ../../wp-content/uploads/2022/01/y_pred_gd-300x236.png 300w" sizes="auto, (max-width: 592px) 100vw, 592px" /></figure>



<p>Кроме того, мы можем посмотреть на то, как снижался уровень ошибки с каждой последующей итерацией.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661915899758198" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661915899758198-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661915899758198-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">l_list</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="486" height="357" src="../../wp-content/uploads/2022/01/loss_curve.png" alt="снижение уровня ошибки в процессе оптимизации, рисунок 1" class="wp-image-9622" srcset="../../wp-content/uploads/2022/01/loss_curve.png 486w, ../../wp-content/uploads/2022/01/loss_curve-300x220.png 300w" sizes="auto, (max-width: 486px) 100vw, 486px" /></figure>



<p>Как мы видим, в первые итерации уровень ошибки снижался настолько стремительно, что последующие изменения практически незаметны. Давайте попробуем отбросить первые 150 наблюдений.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661916454403888" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661916454403888-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661916454403888-1"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">l_list</span><span class="crayon-sy">[</span><span class="crayon-cn">150</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="483" height="357" src="../../wp-content/uploads/2022/01/loss_curve_2.png" alt="снижение уровня ошибки в процессе оптимизации, рисунок 2" class="wp-image-9623" srcset="../../wp-content/uploads/2022/01/loss_curve_2.png 483w, ../../wp-content/uploads/2022/01/loss_curve_2-300x222.png 300w" sizes="auto, (max-width: 483px) 100vw, 483px" /></figure>



<p>И все же кажется, что после 150000 итераций ошибка перестает снижаться и можно было бы обойтись меньшим количеством шагов. На самом деле это не так.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661917846651664" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661917846651664-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661917846651664-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661917846651664-1"><span class="crayon-c"># отбросим первые 150 000 наблюдений</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661917846651664-2"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">l_list</span><span class="crayon-sy">[</span><span class="crayon-cn">150000</span><span class="crayon-o">:</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="502" height="357" src="../../wp-content/uploads/2022/01/loss_curve_3.png" alt="снижение уровня ошибки в процессе оптимизации, рисунок 3" class="wp-image-9624" srcset="../../wp-content/uploads/2022/01/loss_curve_3.png 502w, ../../wp-content/uploads/2022/01/loss_curve_3-300x213.png 300w" sizes="auto, (max-width: 502px) 100vw, 502px" /></figure>



<p>В целом подбор количества итераций и длины шага (коэффициента скорости обучения) довольно существенно влияют на качество обучения. Ближе к концу занятия мы рассмотрим этот момент более подробно.</p>



<h4 class="wp-block-heading" id="21-otsenka-kachestva-modeli">Оценка качества модели</h4>



<p>Оценим качество модели с помощью встроенной в sklearn метрики.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661918722974630" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661918722974630-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661918722974630-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661918722974630-1"><span class="crayon-c"># рассчитаем MSE</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661918722974630-2"><span class="crayon-v">metrics</span><span class="crayon-sy">.</span><span class="crayon-e">mean_squared_error</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y_pred_gd</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661919071596319" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661919071596319-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661919071596319-1">0.2275647968306802</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Результат очень близок к тому, который мы получили, используя МНК.</p>



<h4 class="wp-block-heading" id="22-vizualizatsiya-shagov-algoritma-optimizatsii">Визуализация шагов алгоритма оптимизации</h4>



<p>Мы также как и раньше, можем посмотреть на путь, пройденный алгоритмом оптимизации.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666191b469212258" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-10">10</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-11">11</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-12">12</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-13">13</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-14">14</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-15">15</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-16">16</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-17">17</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-18">18</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-19">19</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-20">20</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-21">21</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-22">22</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-23">23</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-24">24</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-25">25</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-26">26</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-27">27</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-28">28</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-29">29</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-30">30</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-31">31</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-32">32</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-33">33</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-34">34</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-35">35</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-36">36</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-37">37</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191b469212258-38">38</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-1"><span class="crayon-c"># создадим последовательности из 500 значений</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-2"><span class="crayon-v">ww</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-3"><span class="crayon-v">bb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">linspace</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">30</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-5"><span class="crayon-c"># сформируем координатную плоскость</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-6"><span class="crayon-v">www</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bbb</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">meshgrid</span><span class="crayon-sy">(</span><span class="crayon-v">ww</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bb</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-8"><span class="crayon-c"># а также матрицу из нулей для заполнения значениями функции J(w, b)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-9"><span class="crayon-v">JJ</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">zeros</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">ww</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">bb</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-10"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-11"><span class="crayon-c"># для каждой комбинации w и b</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-12"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">ww</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">j</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">bb</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-14">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># рассчитаем соответствующее прогнозное значение</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-16"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">yy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">www</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">X</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">bbb</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-17">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c"># и подставим его в функцию потерь (матрицу JJ)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">JJ</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">j</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">sum</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">yy</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-20"><span class="crayon-h"> </span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-21"><span class="crayon-c"># зададим размер графика</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-22"><span class="crayon-v">fig</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">figure</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">14</span><span class="crayon-sy">,</span><span class="crayon-cn">12</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-24"><span class="crayon-c"># создадим трехмерное пространство</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-25"><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">fig</span><span class="crayon-sy">.</span><span class="crayon-e">add_subplot</span><span class="crayon-sy">(</span><span class="crayon-v">projection</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'3d'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-26">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-27"><span class="crayon-c"># построим функцию потерь</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-28"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot_surface</span><span class="crayon-sy">(</span><span class="crayon-v">www</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bbb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">JJ</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-v">cm</span><span class="crayon-sy">.</span><span class="crayon-v">jet</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-29">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-30"><span class="crayon-c"># а также путь алгоритма оптимизации</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-31"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-32">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-33"><span class="crayon-c"># для наглядности зададим более широкие, чем график</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-34"><span class="crayon-c"># границы пространства</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-35"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_xlim</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-36"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">set_ylim</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">40</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">40</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-37">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191b469212258-38"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="795" height="666" src="../../wp-content/uploads/2022/01/descent_path.png" alt="путь алгоритма градиентного спуска, трехмерный график" class="wp-image-9625" srcset="../../wp-content/uploads/2022/01/descent_path.png 795w, ../../wp-content/uploads/2022/01/descent_path-300x251.png 300w, ../../wp-content/uploads/2022/01/descent_path-768x643.png 768w, ../../wp-content/uploads/2022/01/descent_path-600x503.png 600w" sizes="auto, (max-width: 795px) 100vw, 795px" /></figure>



<p>Мы также можем построить график изолиний (&#171;вид сверху&#187;).</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666191c518952450" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191c518952450-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191c518952450-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191c518952450-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191c518952450-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191c518952450-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191c518952450-1"><span class="crayon-c"># для этого используем функцию plt.contour()</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191c518952450-2"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191c518952450-3"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">www</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bbb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">JJ</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-v">cm</span><span class="crayon-sy">.</span><span class="crayon-v">jet</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191c518952450-4"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191c518952450-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="606" height="579" src="../../wp-content/uploads/2022/01/contour_path.png" alt="путь алгоритма градиентного спуска, график изолиний" class="wp-image-9626" srcset="../../wp-content/uploads/2022/01/contour_path.png 606w, ../../wp-content/uploads/2022/01/contour_path-300x287.png 300w, ../../wp-content/uploads/2022/01/contour_path-600x573.png 600w" sizes="auto, (max-width: 606px) 100vw, 606px" /></figure>



<p>Как мы видим, алгоритм сначала двигался в одном направлении (очевидно, так ошибка снижалась наиболее стремительно), затем повернул на 90 градусов и продолжил движение.</p>



<h4 class="wp-block-heading" id="23-pro-vybor-giperparametrov-modeli">Про выбор гиперпараметров модели</h4>



<p>Давайте посмотрим, как поведет себя алгоритм при изменении гиперпараметров. Вначале попробуем тот же размер шага, но уменьшим количество итераций.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666191d249468970" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191d249468970-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa62666191d249468970-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191d249468970-1"><span class="crayon-v">w_list_t1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list_t1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list_t1</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradient_descent</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa62666191d249468970-2"><span class="crayon-v">w_list_t1</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list_t1</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list_t1</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa62666191f200727286" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa62666191f200727286-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa62666191f200727286-1">(17.113947076094593, 5.311508333809235, 0.4836593999661288)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<p>Коэффициенты довольно сильно отличаются от найденных ранее значений. Посмотрим на графике изолиний, где остановился наш алгоритм.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661920105699189" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661920105699189-7">7</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661920105699189-1"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661920105699189-2"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">www</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bbb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">JJ</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-v">cm</span><span class="crayon-sy">.</span><span class="crayon-v">jet</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661920105699189-3"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661920105699189-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661920105699189-5"><span class="crayon-c"># выведем точку, которой достиг новый алгоритм</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661920105699189-6"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-v">w_list_t1</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list_t1</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'blue'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661920105699189-7"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="606" height="579" src="../../wp-content/uploads/2022/01/test1_path.png" alt="настройка гиперпараметров модели линейной регрессии, изменение количества итераций" class="wp-image-9652" srcset="../../wp-content/uploads/2022/01/test1_path.png 606w, ../../wp-content/uploads/2022/01/test1_path-300x287.png 300w, ../../wp-content/uploads/2022/01/test1_path-600x573.png 600w" sizes="auto, (max-width: 606px) 100vw, 606px" /></figure>



<p>Как мы видим, алгоритм немного не дошел до оптимума. Теперь давайте попробуем уменьшить размер шага. Количество итераций вернем к прежнему значению.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661921872585906" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661921872585906-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661921872585906-2">2</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661921872585906-1"><span class="crayon-v">w_list_t2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list_t2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list_t2</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">gradient_descent</span><span class="crayon-sy">(</span><span class="crayon-v">X</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">iter</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">200000</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">learning_rate</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.0001</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661921872585906-2"><span class="crayon-v">w_list_t2</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list_t2</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">l_list_t2</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661922055136209" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661922055136209-1">1</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661922055136209-1">(15.302448783526573, 8.263028645561734, 0.6339512457580667)</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
</div>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661923239677324" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661923239677324-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661923239677324-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661923239677324-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661923239677324-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661923239677324-5">5</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661923239677324-1"><span class="crayon-v">fig</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ax</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">subplots</span><span class="crayon-sy">(</span><span class="crayon-v">figsize</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">10</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661923239677324-2"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">contour</span><span class="crayon-sy">(</span><span class="crayon-v">www</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bbb</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">JJ</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">cmap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-v">cm</span><span class="crayon-sy">.</span><span class="crayon-v">jet</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661923239677324-3"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">w_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'red'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661923239677324-4"><span class="crayon-v">ax</span><span class="crayon-sy">.</span><span class="crayon-e">scatter</span><span class="crayon-sy">(</span><span class="crayon-v">w_list_t2</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">b_list_t2</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'blue'</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661923239677324-5"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image size-full"><img loading="lazy" decoding="async" width="606" height="579" src="../../wp-content/uploads/2022/01/test2_path.png" alt="настройка гиперпараметров модели линейной регрессии, изменение шага" class="wp-image-9653" srcset="../../wp-content/uploads/2022/01/test2_path.png 606w, ../../wp-content/uploads/2022/01/test2_path-300x287.png 300w, ../../wp-content/uploads/2022/01/test2_path-600x573.png 600w" sizes="auto, (max-width: 606px) 100vw, 606px" /></figure>



<p>В данном случае, так как мы делали слишком маленькие шаги, то продвинулись еще меньше.</p>



<p>Тема выбора гиперпараметров довольно сложна и выходит за рамки сегодняшнего занятия, однако уже на этих простых примерах видно, что один и тот же алгоритм при разных изначальных параметрах показывает совершенно разные результаты.</p>



<h2 class="wp-block-heading" id="24-podvedem-itog">Подведем итог</h2>



<p>В первой части занятия мы посмотрели как применить понятие производной к многомерной функции, познакомились с понятием градиента и методом градиентного спуска. Во второй части мы построили модель простой линейной регрессии и оптимизировали ее с помощью метода наименьших квадратов и алгоритма градиентного спуска.</p>



<h3 class="wp-block-heading" id="26-otvety-na-voprosy">Ответы на вопросы</h3>



<p><strong>Вопрос</strong>. Почему, если умножить функцию потерь на число, в частности на 1/2, точка ее минимума не изменится?</p>



<p><strong>Ответ</strong>. Давайте посмотрим на график параболы и параболы, умноженной на 1/2.</p>



<figure class="wp-block-image"><img decoding="async" src="../../wp-content/uploads/2022/01/halfloss.png" alt="умножение функции потерь на число"/></figure>



<p>Как мы видим, точка минимума не изменилась.</p>



<p>При этом обратите внимание на то, что изменился наклон (значение градиента). Эффект умножения функции потерь на число аналогичен измененению коэффициента скорости обучения (learning rate). Чем круче наклон, тем бо́льшие по размеру шаги мы будем делать.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Скажите, а как работает функция <strong>np.meshgrid()</strong>?</p>



<p><strong>Ответ</strong>. Функция <strong>np.meshgrid()</strong> на входе принимает одномерные массивы и создает двумерный массив с привычной прямоугольной (декартовой) системой координат.</p>



<div class="wp-block-urvanov-syntax-highlighter-code-block"><!-- Urvanov Syntax Highlighter v2.8.38 -->

		<div id="urvanov-syntax-highlighter-67aa626661924105768171" class="urvanov-syntax-highlighter-syntax crayon-theme-familiar-my-copy urvanov-syntax-highlighter-font-consolas urvanov-syntax-highlighter-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 15px; margin-bottom: 15px; margin-left: 15px; margin-right: 15px; font-size: 16px !important; line-height: 22px !important;">
		
			<div class="urvanov-syntax-highlighter-plain-wrap"></div>
			<div class="urvanov-syntax-highlighter-main" style="">
				<table class="crayon-table">
					<tr class="urvanov-syntax-highlighter-row">
				<td class="crayon-nums " data-settings="show">
					<div class="urvanov-syntax-highlighter-nums-content" style="font-size: 16px !important; line-height: 22px !important;"><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-1">1</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-2">2</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-3">3</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-4">4</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-5">5</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-6">6</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-7">7</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-8">8</div><div class="crayon-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-9">9</div><div class="crayon-num crayon-striped-num" data-line="urvanov-syntax-highlighter-67aa626661924105768171-10">10</div></div>
				</td>
						<td class="urvanov-syntax-highlighter-code"><div class="crayon-pre" style="font-size: 16px !important; line-height: 22px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661924105768171-1"><span class="crayon-c"># создадим простые последовательности</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661924105768171-2"><span class="crayon-v">xvalues</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661924105768171-3"><span class="crayon-v">yvalues</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661924105768171-4">&nbsp;</div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661924105768171-5"><span class="crayon-c"># сформируем координатную плоскость</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661924105768171-6"><span class="crayon-v">xx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yy</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">meshgrid</span><span class="crayon-sy">(</span><span class="crayon-v">xvalues</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yvalues</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661924105768171-7">&nbsp;</div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661924105768171-8"><span class="crayon-c"># выведем точки плоскости на графике</span></div><div class="crayon-line" id="urvanov-syntax-highlighter-67aa626661924105768171-9"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-v">xx</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">yy</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">marker</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'.'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">color</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'r'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">linestyle</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'none'</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="urvanov-syntax-highlighter-67aa626661924105768171-10"><span class="crayon-v">plt</span><span class="crayon-sy">.</span><span class="crayon-e">show</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
</div>



<figure class="wp-block-image"><img decoding="async" src="../../wp-content/uploads/2022/01/cartesian.png" alt="функция np.meshgrid() библиотеки Numpy"/></figure>



<p>Обратите внимание, начало координат находится в левом нижнему углу.</p>



<hr class="wp-block-separator has-alpha-channel-opacity"/>



<p><strong>Вопрос</strong>. Функция <strong>plt.fill_between()</strong> заполняет пространство между двумя функциями, но не очень понятно, какие параметры мы ей передаем.</p>



<p><strong>Ответ</strong>. Функция <strong>plt.fill_between(x, y1, y2 = 0)</strong> принимает три основных параметра: координаты по оси x, координаты по оси y (первая функция, y1) и координаты по оси y (вторая функция, y2) и заполняет пространство между y1 и y2. Параметр y2 не является обязательным. Если его не указывать, будет заполняться пространство между линией y1 и осью x (то есть функцией y = 0).</p>



<p>В конце <a href="https://colab.research.google.com/drive/1V9qOJXttFClg0AG4Io6TAaWEfT5DTUu_#scrollTo=qN6ZJh2XwGYq&line=2&uniqifier=1" target="_blank" rel="noreferrer noopener">блокнота</a>⧉ я привел два примера, когда параметр y2 не указывается, то есть равен 0, и когда y2 задает отличную от нуля функцию.</p>

			</div> <!-- .content -->

			
		</div> <!-- .post -->

					<footer class="site-footer section-inner">

				<p class="copyright">&copy; 2025 <a href="../../index.html" class="site-name"><!--Машинное обучение--></a></p>

			</footer> <!-- footer -->

		</main>
		
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js?ver=6.7.1" id="mathjax-js"></script>
<script type="text/javascript" src="../../wp-includes/js/imagesloaded.min.js@ver=5.0.0" id="imagesloaded-js"></script>
<script type="text/javascript" src="../../wp-includes/js/masonry.min.js@ver=4.2.2" id="masonry-js"></script>
<script type="text/javascript" id="mcluhan_global-js-extra">
/* <![CDATA[ */
var mcluhan_ajaxpagination = {"ajaxurl":"https:\/\/www.dmitrymakarov.ru\/wp-admin\/admin-ajax.php","query_vars":"{\"page\":\"\",\"pagename\":\"learning\\\/gradient\"}"};
/* ]]> */
</script>
<script type="text/javascript" src="../../wp-content/themes/mcluhan/assets/js/global.js@ver=2.1.1" id="mcluhan_global-js"></script>
			
	</body>
</html>
